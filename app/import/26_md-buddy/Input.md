
### 爆速エディタの技術的背景

同様の高速なマークダウンエディタを実現するための技術要素
爆速動作は、単一の技術ではなく、以下の要素の組み合わせによって実現されている。

1.  **軽量なアプリケーションフレームワーク**: 高速・軽量な **Tauri** フレームワーク。TauriはバックエンドにRust言語を使用し、フロントエンド（UI）にはOS標準のWebViewを利用するため、アプリケーションのバイナリサイズが小さく、起動や動作が非常に高速。
2.  **高性能なバックエンド言語**: ファイルの読み書きやマークダウンの解析といった重い処理を、**Rust**の高速かつ安全なネイティブ言語で実装。これにより、UIのスレッドをブロックすることなく、瞬時のデータ処理が可能になります。
3.  **高速なマークダウンパーサー**: Rustで書かれた高速なパーサー（例: `pulldown-cmark`）をバックエンドで使用し、HTMLへの変換結果のみをフロントエンドに渡すことで、プレビューのレンダリングを高速化。
4.  **効率的なUIレンダリング**: フロントエンドでは、ReactやSvelteのようなモダンなUIライブラリを使用し、DOMの更新を最小限に抑える「仮想DOM」や差分更新の仕組みを活用して、描画パフォーマンスを最適化。

この仕様に基づき、ご要望の各種定義書をMac M3 Max環境で動作する、あなた専用のローカルアプリケーションとして作成。

---

### 1. 要求定義.md

本ドキュメントは、開発するマークダウンエディタアプリケーション「md-buddy」に対するユーザーの要求を定義する。

-   **目的**: 思考を妨げない、爆速で動作する個人用のマークダウンエディタが欲しい。
-   **使用者**: 自分自身のみ。
-   **動作環境**: ローカルのmacOS（M3 Max）環境。
-   **中核機能**:
    -   指定したフォルダ内のマークダウンファイル（.md）を一覧表示できる。
    -   ファイルを選択すると、瞬時にその内容をプレビュー表示できる。
-   **品質要求**: ファイルの選択からプレビュー表示完了までの一連の動作が「信じられないくらいに爆速」であること。

---

### 2. 要件定義.md

「要求定義.md」を基に、アプリケーション「md-buddy」が満たすべき具体的な機能要件と非機能要件を定義する。

#### 機能要件
-   **ファイル一覧表示機能**:
    -   起動時に、指定された単一のフォルダ内にある`.md`拡張子のファイル名をリスト表示する。
    -   リストはファイル名順（昇順）でソートされる。
-   **ファイル選択機能**:
    -   ファイル一覧から特定のファイルをクリックして選択できる。
-   **プレビュー表示機能**:
    -   選択されたマークダウンファイルの内容を、リアルタイムでHTMLに変換してプレビュー表示する。
    -   GitHub Flavored Markdown (GFM) スタイルのテーブル、打ち消し線、タスクリストをサポートする。

#### 非機能要件
-   **性能**:
    -   アプリケーションの起動時間: 1秒以内。
    -   ファイル選択からプレビュー表示完了までの時間: 100ミリ秒以内（ファイルサイズ1MB以下の場合）。
-   **プラットフォーム**:
    -   macOS Sonoma以降でネイティブに動作すること。
-   **操作性**:
    -   直感的でシンプルなUI。余計な設定項目や機能は不要。
-   **セキュリティ**:
    -   外部へのデータ送信は一切行わない。すべての処理はローカル環境で完結する。

---

### 3. 技術定義.md

「要件定義.md」を実現するための技術スタックとアーキテクチャを定義する。

-   **アプリケーションフレームワーク**: **Tauri**
    -   理由: Rustによる高速なバックエンドと、OSネイティブのWebViewを利用した軽量なフロントエンドを両立できる。バイナリが小さく、リソース消費が少ないため、Mac環境で爆速動作が期待できる。
-   **バックエンド言語**: **Rust**
    -   理由: メモリ安全性と高いパフォーマンスを誇り、ファイルI/OやマークダウンのパースなどのCPU負荷が高い処理を高速に実行できる。
-   **フロントエンドフレームワーク**: **Svelte** または **SolidJS**
    -   理由: 仮想DOMを使用せず、コンパイル時に最適化されたネイティブDOM操作コードを生成するため、React/Vueに比べてランタイムのオーバーヘッドが極めて少なく、レンダリングが高速。
-   **マークダウンパーサー (Rust Crate)**: **pulldown-cmark**
    -   理由: 純粋なRustで実装された、パフォーマンスと仕様準拠に定評のあるCommonMarkパーサー。
-   **アーキテクチャ**:
    -   ユーザーがファイルを選択すると、フロントエンドからTauriのAPIを通じてバックエンド（Rust）のコマンドを呼び出す。
    -   バックエンドは指定されたファイルパスの`.md`ファイルを読み込み、`pulldown-cmark`を用いてHTML文字列に変換する。
    -   変換後のHTML文字列をフロントエンドに返し、Svelte/SolidJSがその内容をプレビューエリアに効率的に描画する。

---

### 4. 工程定義.md

本プロジェクトを完了させるまでの作業工程を定義する。

1.  **Phase 1: 環境構築 (1日)**
    -   RustおよびTauriの開発環境をMac M3 Maxにセットアップする。
    -   Node.js, pnpm (またはnpm) をセットアップする。
    -   Tauri + Svelte/SolidJSの雛形プロジェクトを作成する。
2.  **Phase 2: バックエンド実装 (2日)**
    -   指定されたディレクトリのファイルリストを取得するTauriコマンドを実装する。
    -   指定されたパスのファイルを読み込み、HTMLに変換して返すTauriコマンドを実装する。
3.  **Phase 3: フロントエンド実装 (3日)**
    -   2ペイン（ファイルリスト、プレビュー）のUIレイアウトを構築する。
    -   起動時にファイルリスト取得コマンドを呼び出し、結果を表示する。
    -   ファイルクリック時に、プレビュー更新コマンドを呼び出し、結果を描画する。
    -   シンプルなCSSで見た目を整える。
4.  **Phase 4: テストと最適化 (1日)**
    -   実ファイルを複数用意し、表示の正確性とパフォーマンスを測定する。
    -   ボトルネックがあればコードをレビューし、改善する。
    -   リリースビルドを作成し、最終動作を確認する。

---

### 5. 品質定義.md

成果物の品質基準を定義する。

-   **性能基準**:
    -   「非機能要件」で定義した性能目標（起動時間1秒以内、プレビュー表示100ms以内）をクリアしていること。
    -   100個のファイルをリスト表示した際のCPU・メモリ使用率が、他の著名なエディタ（VSCodeなど）と比較して著しく低いこと。
-   **機能基準**:
    -   「機能要件」で定義したすべての機能が、エラーなく正常に動作すること。
    -   CommonMark Specに準拠した基本的なマークダウン記法が正しくプレビューされること。
-   **コード品質**:
    -   Rustの `clippy --deny warnings` と `fmt --check` をパスすること。
    -   フロントエンドのコードに不要なコメントやロジックが残っていないこと。

---

### 6. 納品定義.md

最終的な成果物と、その納品形態を定義する。

-   **成果物一覧**:
    1.  アプリケーションの全ソースコード。
    2.  ビルド済みのmacOSアプリケーションバンドル（`.app`ファイル）。
    3.  本プロジェクトで作成した6つの定義書ドキュメント。
-   **納品形態**:
    -   すべての成果物を単一のGitリポジトリに格納し、ローカル環境で提供する。
    -   アプリケーションは `src-tauri/target/release/bundle/macos/` 配下に生成された `.app` ファイルを直接実行する形で使用する。
