<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI時代のプレゼン革命 - プレゼンテーション</title>
<!-- Google Fonts - Noto Sans & Noto Sans JP -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* グローバルフォント設定 */
  * {
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
  }
  
  body {
    margin: 0;
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
    font-weight: 700;
    background-color: #f0f0f0;
    overflow: hidden;
  }
  
  .presentation-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
  }
  
  .slide-frame {
    flex: 1;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #fff;
    overflow: hidden;
  }
  
  .slide-frame img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }
  
  .controls {
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #333;
    padding: 20px;
    gap: 20px;
  }
  
  .controls button {
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
    font-weight: 700;
    font-size: 18px;
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .btn-prev, .btn-next {
    background-color: #005bac;
    color: white;
  }
  
  .btn-prev:hover, .btn-next:hover {
    background-color: #0078e8;
    transform: scale(1.05);
  }
  
  .btn-prev:disabled, .btn-next:disabled {
    background-color: #666;
    cursor: not-allowed;
    transform: scale(1);
  }
  
  .btn-fullscreen {
    background-color: #d90000;
    color: white;
  }
  
  .btn-fullscreen:hover {
    background-color: #ff0000;
    transform: scale(1.05);
  }
  
  .btn-pdf {
    background-color: #28a745;
    color: white;
  }
  
  .btn-pdf:hover {
    background-color: #218838;
    transform: scale(1.05);
  }
  
  .slide-info {
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
    font-weight: 700;
    color: white;
    font-size: 20px;
    min-width: 150px;
    text-align: center;
  }
  
  .slide-selector {
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
    font-weight: 700;
    background-color: #444;
    color: white;
    font-size: 16px;
    padding: 8px 16px;
    border: 2px solid #666;
    border-radius: 5px;
    cursor: pointer;
  }
  
  .slide-selector:hover {
    border-color: #005bac;
  }
  
  .shortcuts-info {
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
    font-weight: 400;
    position: fixed;
    bottom: 10px;
    right: 10px;
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px 15px;
    border-radius: 5px;
    font-size: 12px;
    opacity: 0.8;
  }
  
  .slides-menu {
    position: fixed;
    top: 0;
    left: -400px;
    width: 400px;
    height: 100vh;
    background-color: #222;
    color: white;
    overflow-y: auto;
    transition: left 0.3s ease;
    z-index: 1000;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
  }
  
  .slides-menu.open {
    left: 0;
  }
  
  .menu-toggle {
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
    font-weight: 700;
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 1001;
    background-color: #005bac;
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .menu-toggle:hover {
    background-color: #0078e8;
    transform: scale(1.05);
  }
  
  .slides-menu h2 {
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
    font-weight: 700;
    padding: 20px;
    margin: 0;
    background-color: #005bac;
    font-size: 24px;
  }
  
  .slide-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .slide-list li {
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
    font-weight: 400;
    padding: 15px 20px;
    border-bottom: 1px solid #444;
    cursor: pointer;
    transition: background-color 0.3s ease;
    font-size: 14px;
  }
  
  .slide-list li:hover {
    background-color: #444;
  }
  
  .slide-list li.active {
    background-color: #005bac;
  }
  
  .slide-list .slide-number {
    display: inline-block;
    width: 40px;
    color: #77ccff;
    font-weight: 700;
  }

  /* PDF生成時のローディング表示 */
  .loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 2000;
  }

  .loading-overlay.show {
    display: flex;
  }

  .loading-spinner {
    width: 60px;
    height: 60px;
    border: 6px solid #f3f3f3;
    border-top: 6px solid #005bac;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  .loading-text {
    font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
    font-weight: 700;
    color: white;
    font-size: 20px;
    margin-top: 20px;
  }
</style>
<!-- jsPDF ライブラリ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<!-- html2canvas ライブラリ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
  <button class="menu-toggle" onclick="toggleMenu()">☰ メニュー</button>
  
  <div class="slides-menu" id="slidesMenu">
    <h2>スライド一覧</h2>
    <ul class="slide-list" id="slideList"></ul>
  </div>
  
  <div class="presentation-container">
    <div class="slide-frame" id="slideFrame">
      <img id="slideImage" src="slide_01_title.svg" alt="スライド">
    </div>
    
    <div class="controls">
      <button class="btn-prev" onclick="previousSlide()">◀ 前へ</button>
      <div class="slide-info">
        <span id="currentSlide">1</span> / <span id="totalSlides">30</span>
      </div>
      <select class="slide-selector" id="slideSelector" onchange="goToSlide(this.value)">
      </select>
      <button class="btn-next" onclick="nextSlide()">次へ ▶</button>
      <button class="btn-fullscreen" onclick="toggleFullscreen()">全画面</button>
      <button class="btn-pdf" onclick="exportToPDF()">PDF出力</button>
    </div>
  </div>
  
  <div class="shortcuts-info">
    キーボード: ← 前へ | → 次へ | F 全画面 | ESC 終了 | Space 次へ | M メニュー | P PDF出力
  </div>

  <div class="loading-overlay" id="loadingOverlay">
    <div>
      <div class="loading-spinner"></div>
      <div class="loading-text">PDFを生成中...</div>
    </div>
  </div>

  <script>
    const slides = [
      { file: 'slide_01_title.svg', title: '表紙 - AI時代のプレゼン革命' },
      { file: 'slide_02_agenda.svg', title: 'アジェンダ' },
      { file: 'slide_03_problem.svg', title: '現状の課題' },
      { file: 'slide_04_gap_analysis.svg', title: 'ギャップ分析' },
      { file: 'slide_05_ai_limitations.svg', title: 'AIの限界' },
      { file: 'slide_06_three_keys.svg', title: '3つの鍵' },
      { file: 'slide_07_pin_word.svg', title: 'ピン留めワード' },
      { file: 'slide_08_pin_word_flow.svg', title: 'ピン留めワードのフロー' },
      { file: 'slide_09_pin_word_examples.svg', title: 'ピン留めワードの例' },
      { file: 'slide_10_ai_personality.svg', title: 'AIの個性設定' },
      { file: 'slide_11_ai_characteristics.svg', title: 'AI個性の特徴' },
      { file: 'slide_12_effective_instructions.svg', title: '効果的な指示' },
      { file: 'slide_13_instruction_framework.svg', title: '指示フレームワーク' },
      { file: 'slide_14_practice_intro.svg', title: '実践編導入' },
      { file: 'slide_15_case_study_1.svg', title: 'ケーススタディ1' },
      { file: 'slide_16_case_study_2.svg', title: 'ケーススタディ2' },
      { file: 'slide_17_immediate_techniques.svg', title: '即効テクニック' },
      { file: 'slide_18_template_examples.svg', title: 'テンプレート例' },
      { file: 'slide_19_measurement_framework.svg', title: '効果測定フレームワーク' },
      { file: 'slide_20_measurement_dashboard.svg', title: '測定ダッシュボード' },
      { file: 'slide_21_implementation_roadmap.svg', title: '導入ロードマップ' },
      { file: 'slide_22_common_mistakes.svg', title: 'よくある失敗' },
      { file: 'slide_23_success_factors.svg', title: '成功要因' },
      { file: 'slide_24_future_vision.svg', title: '未来ビジョン' },
      { file: 'slide_25_action_items.svg', title: 'アクションアイテム' },
      { file: 'slide_26_summary.svg', title: 'まとめ' },
      { file: 'slide_27_qa_intro.svg', title: 'Q&A導入' },
      { file: 'slide_28_contact.svg', title: 'お問い合わせ' },
      { file: 'slide_29_resources.svg', title: 'リソース' },
      { file: 'slide_30_thank_you.svg', title: 'ありがとうございました' }
    ];
    
    let currentSlideIndex = 0;
    
    function init() {
      document.getElementById('totalSlides').textContent = slides.length;
      
      // セレクタの初期化
      const selector = document.getElementById('slideSelector');
      slides.forEach((slide, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = `${index + 1}. ${slide.title}`;
        selector.appendChild(option);
      });
      
      // スライドリストの初期化
      const slideList = document.getElementById('slideList');
      slides.forEach((slide, index) => {
        const li = document.createElement('li');
        li.innerHTML = `<span class="slide-number">${index + 1}.</span> ${slide.title}`;
        li.onclick = () => {
          goToSlide(index);
          toggleMenu();
        };
        slideList.appendChild(li);
      });
      
      updateSlideDisplay();
    }
    
    function updateSlideDisplay() {
      const image = document.getElementById('slideImage');
      image.src = slides[currentSlideIndex].file;
      
      document.getElementById('currentSlide').textContent = currentSlideIndex + 1;
      document.getElementById('slideSelector').value = currentSlideIndex;
      
      // ボタンの有効/無効
      document.querySelector('.btn-prev').disabled = currentSlideIndex === 0;
      document.querySelector('.btn-next').disabled = currentSlideIndex === slides.length - 1;
      
      // アクティブなスライドをハイライト
      const slideItems = document.querySelectorAll('.slide-list li');
      slideItems.forEach((item, index) => {
        if (index === currentSlideIndex) {
          item.classList.add('active');
        } else {
          item.classList.remove('active');
        }
      });
    }
    
    function nextSlide() {
      if (currentSlideIndex < slides.length - 1) {
        currentSlideIndex++;
        updateSlideDisplay();
      }
    }
    
    function previousSlide() {
      if (currentSlideIndex > 0) {
        currentSlideIndex--;
        updateSlideDisplay();
      }
    }
    
    function goToSlide(index) {
      currentSlideIndex = parseInt(index);
      updateSlideDisplay();
    }
    
    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    }
    
    function toggleMenu() {
      const menu = document.getElementById('slidesMenu');
      menu.classList.toggle('open');
    }
    
    // PDF出力機能
    async function exportToPDF() {
      const overlay = document.getElementById('loadingOverlay');
      overlay.classList.add('show');
      
      try {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({
          orientation: 'landscape',
          unit: 'mm',
          format: 'a4'
        });
        
        // 一時的な処理用のキャンバス
        const tempCanvas = document.createElement('canvas');
        const tempCtx = tempCanvas.getContext('2d');
        
        for (let i = 0; i < slides.length; i++) {
          if (i > 0) {
            pdf.addPage();
          }
          
          // SVGを画像として読み込む
          const img = new Image();
          img.crossOrigin = 'anonymous';
          
          await new Promise((resolve, reject) => {
            img.onload = resolve;
            img.onerror = reject;
            img.src = slides[i].file;
          });
          
          // A4横向きのサイズに合わせて調整
          const pdfWidth = 297;
          const pdfHeight = 210;
          const imgAspect = img.width / img.height;
          const pdfAspect = pdfWidth / pdfHeight;
          
          let width, height, x, y;
          
          if (imgAspect > pdfAspect) {
            // 画像が横長の場合
            width = pdfWidth;
            height = pdfWidth / imgAspect;
            x = 0;
            y = (pdfHeight - height) / 2;
          } else {
            // 画像が縦長の場合
            height = pdfHeight;
            width = pdfHeight * imgAspect;
            x = (pdfWidth - width) / 2;
            y = 0;
          }
          
          // SVGを直接PDFに追加
          pdf.addImage(img, 'SVG', x, y, width, height);
          
          // スライド番号を追加
          pdf.setFontSize(10);
          pdf.setTextColor(128, 128, 128);
          pdf.text(`${i + 1} / ${slides.length}`, pdfWidth - 20, pdfHeight - 10, { align: 'right' });
        }
        
        // PDFをダウンロード
        const fileName = `AI時代のプレゼン革命_${new Date().toISOString().slice(0, 10)}.pdf`;
        pdf.save(fileName);
        
      } catch (error) {
        console.error('PDF生成エラー:', error);
        alert('PDF生成中にエラーが発生しました。');
      } finally {
        overlay.classList.remove('show');
      }
    }
    
    // キーボードショートカット
    document.addEventListener('keydown', (e) => {
      switch(e.key) {
        case 'ArrowLeft':
          previousSlide();
          break;
        case 'ArrowRight':
        case ' ':
          e.preventDefault();
          nextSlide();
          break;
        case 'f':
        case 'F':
          toggleFullscreen();
          break;
        case 'Escape':
          if (document.fullscreenElement) {
            document.exitFullscreen();
          }
          break;
        case 'm':
        case 'M':
          toggleMenu();
          break;
        case 'p':
        case 'P':
          exportToPDF();
          break;
        case 'Home':
          goToSlide(0);
          break;
        case 'End':
          goToSlide(slides.length - 1);
          break;
      }
    });
    
    // 初期化
    window.onload = init;
  </script>
</body>
</html>