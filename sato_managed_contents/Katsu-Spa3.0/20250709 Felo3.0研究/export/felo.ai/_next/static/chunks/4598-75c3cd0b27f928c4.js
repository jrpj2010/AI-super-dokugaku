(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4598],{94487:function(e,t,i){"use strict";i.d(t,{A:function(){return o}});var r=i(66040),n=i(3317);let o=r.hj.create({name:"indent",defaultOptions:{types:["listItem","paragraph"],minLevel:0,maxLevel:8},addGlobalAttributes(){return[{types:this.options.types,attributes:{indent:{renderHTML:e=>(null==e?void 0:e.indent)>this.options.minLevel?{"data-indent":e.indent}:null,parseHTML:e=>{let t=Number(e.getAttribute("data-indent"));return t&&t>this.options.minLevel?t:null}}}}]},addCommands(){let e=(e,t,i)=>{var r;let n=null==e?void 0:null===(r=e.doc)||void 0===r?void 0:r.nodeAt(t);if(n){let r=(n.attrs.indent||0)+i,{minLevel:o,maxLevel:a}=this.options,s=r<o?o:r>a?a:r;if(s!==n.attrs.indent){let{indent:i,...r}=n.attrs,a=s>o?{...r,indent:s}:r;return e.setNodeMarkup(t,n.type,a,n.marks)}}return e},t=(t,i)=>{let{doc:r,selection:o}=t;if(r&&o&&(o instanceof n.Bs||o instanceof n.C1)){let{from:n,to:a}=o;r.nodesBetween(n,a,(r,n)=>!this.options.types.includes(r.type.name)||(t=e(t,n,i),!1))}return t},i=e=>()=>i=>{let{tr:r,state:n,dispatch:o}=i,{selection:a}=n;return!!(r=t(r=r.setSelection(a),e)).docChanged&&(null==o||o(r),!0)};return{indent:i(1),outdent:i(-1)}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.indent(),"Shift-Tab":()=>this.editor.commands.outdent()}}})},82751:function(e,t,i){"use strict";i.d(t,{W:function(){return a},r:function(){return o}});var r=i(34505),n=i(25709);function o(e,t){return(0,n.Vn)(e,(e,i,n)=>{if(n&&"number"==typeof i&&t(e)&&"paragraph"!==n.type)return n.children.splice(i,1,{type:"paragraph",children:[e]}),[r.AM,i]}),e}function a(e,t){return(0,n.Vn)(e,"paragraph",(e,i,r)=>{if(!r||"number"!=typeof i)return;let n=[];for(let i=0;i<e.children.length;i++){let r=e.children[i];if(t(r))n.push(r);else{let e=n[n.length-1];Array.isArray(e)?e.push(r):n.push([r])}}return r.children.splice(i,1,...n.map(e=>Array.isArray(e)?{type:"paragraph",children:e}:e)),i+n.length}),e}},76356:function(e,t,i){"use strict";function r(e){return'<span class="ProseMirror-icon ProseMirror-icon-'.concat(e,'"></span>')}i.d(t,{X6:function(){return Z},Vg:function(){return tf},Dy:function(){return ek}});let n=i(54582).a.extend({name:"subscript",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Subscript"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"textDirective"===e.type&&"sub"===e.name,apply:(e,t,i)=>{e.openMark(i),e.next(t.children),e.closeMark(i)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.withMark(t,{type:"textDirective",name:"sub"})}}},floatMenu:{items:[{id:this.name,name:this.options.dictionary.name,view:r("sub"),shortcut:"Mod-,",active:e=>{let{editor:t}=e;return t.isActive(this.name)},action:e=>{let{editor:t}=e;return t.chain().toggleSubscript().focus().run()}}]}}}}),o=i(20524).$.extend({name:"superscript",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Superscript"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"textDirective"===e.type&&"sup"===e.name,apply:(e,t,i)=>{e.openMark(i),e.next(t.children),e.closeMark(i)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.withMark(t,{type:"textDirective",name:"sup"})}}},floatMenu:{items:[{id:this.name,name:this.options.dictionary.name,view:r("sup"),shortcut:"Mod-.",active:e=>{let{editor:t}=e;return t.isActive(this.name)},action:e=>{let{editor:t}=e;return t.chain().toggleSuperscript().focus().run()}}]}}}});var a=i(89849),s=i(66040);let l=/(?:^|[^*])(\*\*(?!\s+\*\*)([^*]+)\*\*)$/,d=/(?:^|[^*])(\*\*(?!\s+\*\*)([^*]+)\*\*(?!\s+\*\*))/g,c=/(?:^|[^_])(__(?!\s+__)([^_]+)__)$/,h=/(?:^|[^_])(__(?!\s+__)([^_]+)__(?!\s+__))/g,u=a.d8.extend({name:"bold",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Bold"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"strong"===e.type,apply:(e,t,i)=>{e.openMark(i),e.next(t.children),e.closeMark(i)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.withMark(t,{type:"strong"})}}},floatMenu:{items:[{id:this.name,name:this.options.dictionary.name,view:r("bold"),shortcut:"Mod-B",active:e=>{let{editor:t}=e;return t.isActive(this.name)},action:e=>{let{editor:t}=e;return t.chain().toggleBold().focus().run()}}]}}},addInputRules(){return[(0,s.Cf)({find:l,type:this.type}),(0,s.Cf)({find:c,type:this.type})]},addPasteRules(){return[(0,s.K9)({find:d,type:this.type}),(0,s.K9)({find:h,type:this.type})]}});var p=i(27860);let m=/(?:^|[^`])(`(?!\s+`)([^`]+)`)$/,g=/(?:^|[^`])(`(?!\s+`)([^`]+)`(?!\s+`))/g,f=p.EK.extend({name:"code",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Code"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"inlineCode"===e.type,apply:(e,t,i)=>{e.openMark(i),e.addText(t.value),e.closeMark(i)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t,i)=>{var r;return e.addNode({type:"inlineCode",value:null!==(r=i.text)&&void 0!==r?r:""}),!0}}},floatMenu:{items:[{id:this.name,name:this.options.dictionary.name,view:r("code"),shortcut:"Mod-E",active:e=>{let{editor:t}=e;return t.isActive(this.name)},action:e=>{let{editor:t}=e;return t.chain().toggleCode().focus().run()}}]}}},addInputRules(){return[(0,s.Cf)({find:m,type:this.type})]},addPasteRules(){return[(0,s.K9)({find:g,type:this.type})]}});var v=i(26438),y=i(3317),b=i(60011);let w=v.rU.extend({name:"link",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),openOnClick:!1,dictionary:{name:"Link",inputLink:"Enter or paste link",openLink:"Open link",deleteLink:"Delete link"}}},renderHTML(e){let{HTMLAttributes:t}=e;return["a",{...t,target:"_blank",rel:"noopener noreferrer nofollow",class:"tiptap-link"},0]},addProseMirrorPlugins(){var e;return[...(null===(e=this.parent)||void 0===e?void 0:e.call(this))||[],new y.Sy({props:{decorations:e=>{let{doc:t}=e,i=[];return t.descendants((e,t)=>{e.marks.find(e=>"link"===e.type.name)&&e.isText&&/^\d+$/.test(e.text||"")&&i.push(b.p.inline(t,t+e.nodeSize,{nodeName:"a",class:"reference-link inline-block  cursor-pointer no-underline  !bg-[#F6F7F9] dark:!bg-[#353B46] !text-[#5F7698] dark:!text-[#F3F5F7] min-w-4 h-4 text-center rounded-full text-xs"}))}),b.EH.create(t,i)},handleClick(e,t,i){let{state:r}=e,{doc:n}=r,o=n.nodeAt(t);if(o){let e=o.marks.find(e=>"link"===e.type.name);if(e)return i.preventDefault(),window.open(e.attrs.href,"_blank"),!0}return!1}}})]},addKeyboardShortcuts(){return{"Mod-k":()=>this.editor.chain().toggleLink({href:""}).setTextSelection(this.editor.state.selection.to-1).run()}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"link"===e.type,apply:(e,t,i)=>{let r=t.url,n=t.title;e.openMark(i,{href:r,title:n}),e.next(t.children),e.closeMark(i)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.withMark(t,{type:"link",title:t.attrs.title,url:t.attrs.href})}}}}}});var k=i(90966);let x=/(?:^|[^*])(\*(?!\s+\*)([^*]+)\*)$/,M=/(?:^|[^*])(\*(?!\s+\*)([^*]+)\*(?!\s+\*))/g,_=/(?:^|[^_])(_(?!\s+_)([^_]+)_)$/,S=/(?:^|[^_])(_(?!\s+_)([^_]+)_(?!\s+_))/g,L=k.Tx.extend({name:"italic",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Italic"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"emphasis"===e.type,apply:(e,t,i)=>{e.openMark(i),e.next(t.children),e.closeMark(i)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.withMark(t,{type:"emphasis"})}}},floatMenu:{items:[{id:this.name,name:this.options.dictionary.name,view:r("italic"),shortcut:"Mod-I",active:e=>{let{editor:t}=e;return t.isActive(this.name)},action:e=>{let{editor:t}=e;return t.chain().toggleItalic().focus().run()}}]}}},addInputRules(){return[(0,s.Cf)({find:x,type:this.type}),(0,s.Cf)({find:_,type:this.type})]},addPasteRules(){return[(0,s.K9)({find:M,type:this.type}),(0,s.K9)({find:S,type:this.type})]}});var P=i(28373);let A=/(?:^|[^~])(~~(?!\s+~~)([^~]+)~~)$/,T=/(?:^|[^~])(~~(?!\s+~~)([^~]+)~~(?!\s+~~))/g,C=P.Re.extend({name:"strike",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Strike"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"delete"===e.type,apply:(e,t,i)=>{e.openMark(i),e.next(t.children),e.closeMark(i)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.withMark(t,{type:"delete"})}}},floatMenu:{items:[{id:this.name,name:this.options.dictionary.name,view:r("strike"),shortcut:"Mod-Shift-I",active:e=>{let{editor:t}=e;return t.isActive(this.name)},action:e=>{let{editor:t}=e;return t.chain().toggleStrike().focus().run()}}]}}},addInputRules(){return[(0,s.Cf)({find:A,type:this.type})]},addPasteRules(){return[(0,s.K9)({find:T,type:this.type})]}});var N=i(36578),E=i(58445),z=i(25709),D=i(48053);function I(e,t,i){let r=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=i?"([a-z0-9]{0,2})":"()",o=new RegExp("".concat(r).concat(n).concat(r,"\\s*([^").concat(r,"]*[^ ])\\s*").concat(r).concat(r)),a=RegExp("".concat(r).concat(n).concat(r,"\\s*([^").concat(r,"]*[^ ])\\s*").concat(r).concat(r),"g"),s=(t,i,r)=>{if(!r||!o.test(t.value))return;let n=[],s=t.value,l="",d=0,c=0,h=Array.from(s.matchAll(a));for(let t=0;t<h.length;t++){var u,p,m;let i=h[t],r=null!==(u=i.index)&&void 0!==u?u:0,o=i[0].length,a=0===t?0:d+c;if(d=r,c=o,r>a){let e=s.substring(a,r),t=(0,D.u)("text",e);n.push(t)}n.push({type:e,data:{flags:null!==(p=i[1])&&void 0!==p?p:""},children:[{type:"text",value:null!==(m=i[2])&&void 0!==m?m:""}]}),l=s.slice(r+o)}if(l){let e=(0,D.u)("text",l);n.push(e)}n.length&&r.children.splice(i,1,...n)},l=(r,n,o,a)=>{var s;let l=o.enter(e),d=o.createTracker(a),c=d.move(t+(i&&(null===(s=r.data)||void 0===s?void 0:s.flags)?r.data.flags:"")+t);return c+=d.move(o.containerPhrasing(r,{before:c,after:c,...d.current()}))+d.move(t+t),l(),c};return function(){var t,i;let r=this.data();(null!==(t=r.fromMarkdownExtensions)&&void 0!==t?t:r.fromMarkdownExtensions=[]).push({transforms:[e=>{(0,z.Vn)(e,"text",s)}]}),(null!==(i=r.toMarkdownExtensions)&&void 0!==i?i:r.toMarkdownExtensions=[]).push({handlers:{[e]:l}})}}let H=[["gray","z"],["slate","s"],["tomato","e"],["red","r"],["ruby","f"],["crimson","w"],["pink","q"],["plum","u"],["purple","p"],["violet","v"],["iris","h"],["indigo","i"],["blue","b"],["cyan","c"],["teal","t"],["jade","j"],["green","g"],["bronze","n"],["gold","x"],["brown","d"],["orange","o"],["amber","a"],["yellow","y"],["lime","l"],["mint","m"],["sky","k"]],j=/(?:^|[^=])(==(?!\s+==)([^=]+)==)$/,O=/(?:^|[^=])(==(?!\s+==)([^=]+)==(?!\s+==))/g,R=N.y$.extend({name:"highlight",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Highlight",gray:"Gray",slate:"Slate",tomato:"Tomato",red:"Red",ruby:"Ruby",crimson:"Crimson",pink:"Pink",plum:"Plum",purple:"Purple",violet:"Violet",iris:"Iris",indigo:"Indigo",blue:"Blue",cyan:"Cyan",teal:"Teal",jade:"Jade",green:"Green",bronze:"Bronze",gold:"Gold",brown:"Brown",orange:"Orange",amber:"Amber",yellow:"Yellow",lime:"Lime",mint:"Mint",sky:"Sky"}}},addAttributes:()=>({color:{default:null,parseHTML:e=>e.getAttribute("data-color"),renderHTML:e=>e.color?{"data-color":e.color}:{}}}),addStorage(){var e;let t=new Map,i=new Map;for(let[e,r]of H)t.set(r,e),t.set("b".concat(r),"b-".concat(e)),i.set(e,r),i.set("b-".concat(e),"b".concat(r));return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"highlight"===e.type,apply:(e,i,r)=>{var n,o;let a=null!==(o=null===(n=i.data)||void 0===n?void 0:n.flags)&&void 0!==o?o:"";e.openMark(r,{color:t.get(a)}),e.next(i.children),e.closeMark(r)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{var r;let n=null!==(r=t.attrs.color)&&void 0!==r?r:"";e.withMark(t,{type:"highlight",data:{flags:i.get(n)}})}},hooks:{beforeInit:e=>e.use(I("highlight","=",!0))}},floatMenu:{items:[{id:this.name,name:this.options.dictionary.name,view:r("highlight"),shortcut:"Mod-Shift-H",active:e=>{let{editor:t}=e;return t.isActive(this.name)},action:e=>{let{editor:t}=e;return t.chain().toggleHighlight().focus().run()},onInit:e=>{let{editor:t,element:i}=e,r=document.createElement("div");for(let e of(r.classList.add("ProseMirror-fm-color-picker"),[...H.map(e=>e[0]),...H.map(e=>"b-".concat(e[0]))])){let i=document.createElement("button");i.textContent="A",i.setAttribute("data-color",e);let n=document.createElement("span");n.classList.add("ProseMirror-fm-button-popover"),e.startsWith("b-")?n.textContent="Background ".concat(this.options.dictionary[e.replace("b-","")]):n.textContent=this.options.dictionary[e],(0,E.ZP)(i,{appendTo:()=>document.body,content:n,arrow:!1,theme:"ProseMirror-dark",animation:"shift-away",duration:[200,150]}),i.addEventListener("click",i=>{i.stopPropagation(),t.chain().toggleHighlight({color:e}).focus().run()}),r.append(i)}(0,E.ZP)(i,{appendTo:()=>i,content:r,arrow:!1,interactive:!0,theme:"ProseMirror",placement:"bottom",maxWidth:"none",animation:"shift-away",duration:[200,150]})}}]}}},addInputRules(){return[(0,s.Cf)({find:j,type:this.type})]},addPasteRules(){return[(0,s.K9)({find:O,type:this.type})]}}),B=i(1684).v.extend({name:"underline",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Underline"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"underline"===e.type,apply:(e,t,i)=>{e.openMark(i),e.next(t.children),e.closeMark(i)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.withMark(t,{type:"underline"})}},hooks:{beforeInit:e=>e.use(I("underline","+"))}},floatMenu:{items:[{id:this.name,name:this.options.dictionary.name,view:r("underline"),shortcut:"Mod-U",active:e=>{let{editor:t}=e;return t.isActive(this.name)},action:e=>{let{editor:t}=e;return t.chain().toggleUnderline().focus().run()}}]}}}}),$=i(18942).x.extend({name:"text",addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>{let{type:t}=e;return"text"===t},apply:(e,t)=>{e.addText(t.value)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.addNode({type:"text",value:t.text})}}}}}}),F=i(74494).B.extend({name:"doc",addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"root"===e.type,apply:(e,t,i)=>{e.openNode(i),e.next(t.children)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"root"}),e.next(t.content)}}}}}}),Z=i(87334).X.extend({name:"heading",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Heading"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"heading"===e.type,apply:(e,t,i)=>{let r=t.depth;e.openNode(i,{level:r}),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"heading",depth:t.attrs.level}),e.next(t.content),e.closeNode()}}},blockMenu:{items:[1,2,3,4,5,6].map(e=>({id:"".concat(this.name).concat(e),name:"".concat(this.options.dictionary.name," ").concat(e),icon:r("h".concat(e)),shortcut:"Mod-Alt-".concat(e),keywords:"heading".concat(e,",title").concat(e,",bt").concat(e),action:t=>t.chain().toggleHeading({level:e}).focus().run()}))}}}}),U=i(15964).n.extend({name:"paragraph",addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"paragraph"===e.type,apply:(e,t,i)=>{e.openNode(i),t.children?e.next(t.children):e.addText(t.value),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"paragraph"}),"text"===t.type.name?e.addNode({type:"text",value:t.text}):e.next(t.content),e.closeNode()}}}}}}),q=i(3261).V6.extend({name:"blockquote",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Blockquote"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"blockquote"===e.type,apply:(e,t,i)=>{e.openNode(i),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"blockquote"}),e.next(t.content),e.closeNode()}}},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("blockquote"),shortcut:"Mod-Shift-B",keywords:"blockquote,bq,yyk",action:e=>e.chain().toggleBlockquote().focus().run()}]}}}}),W=i(70642).U.extend({name:"hardBreak",addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"break"===e.type,apply:(e,t,i)=>{e.addNode(i)}},serializer:{match:e=>e.type.name===this.name,apply:e=>{e.addNode({type:"break"})}}}}}});var K=i(96668),J=i(18450),G=i(49340),V=i(26831),X=i(52676),Q=i(75271),Y=i(19370),ee=i(25010),et=i(91165),ei=i(91708);let er=e=>{let{node:t,editor:i,getPos:r,getContent:n}=e,[o,a]=(0,Q.useState)(!1),s=(0,Q.useCallback)(async()=>{try{let e=t.textContent;await navigator.clipboard.writeText(e),a(!0),setTimeout(()=>a(!1),1500)}catch(e){}},[n]);return(0,X.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b border-slate-200 dark:border-slate-800 bg-white/50 dark:bg-slate-900/50",children:[(0,X.jsxs)(Y.Ph,{value:t.attrs.language,onValueChange:e=>{if(i.isEditable&&"function"==typeof r){let n=r();i.chain().command(i=>{let{tr:r}=i;return r.setNodeMarkup(n,void 0,{...t.attrs,language:e}),!0}).run()}},children:[(0,X.jsx)(Y.i4,{className:"w-[180px]",children:(0,X.jsx)(Y.ki,{placeholder:"Select language"})}),(0,X.jsx)(Y.Bw,{children:Object.entries({name:"Code Block",copy:"Copy",copied:"Copied!",arduino:"Arduino",bash:"Bash",c:"C",cpp:"C++",csharp:"C#",css:"CSS",diff:"Diff",go:"Go",graphql:"GraphQL",ini:"INI",java:"Java",javascript:"JavaScript",json:"JSON",kotlin:"Kotlin",less:"Less",lua:"Lua",makefile:"Makefile",markdown:"Markdown",objectivec:"Objective-C",perl:"Perl",php:"PHP","php-template":"PHP Template",plaintext:"Text",python:"Python","python-repl":"Python Repl",r:"R",ruby:"Ruby",rust:"Rust",scss:"Scss",shell:"Shell",sql:"SQL",swift:"Swift",typescript:"TypeScript",vbnet:"Visual Basic .NET",wasm:"WebAssembly",xml:"XML",yaml:"YAML"}).map(e=>{let[t,i]=e;return(0,X.jsx)(Y.Ql,{value:t,children:i},t)})})]}),(0,X.jsx)(ee.z,{variant:"outline",size:"icon",onClick:s,disabled:o,children:o?(0,X.jsx)(et.Z,{className:"h-4 w-4"}):(0,X.jsx)(ei.Z,{className:"h-4 w-4"})})]})},en=e=>{let{node:t,editor:i,getPos:r}=e,n=(0,Q.useRef)(null),o=(0,Q.useCallback)(()=>{var e;return(null===(e=n.current)||void 0===e?void 0:e.textContent)||""},[]);return(0,X.jsxs)(V.T5,{className:"relative group rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-950",children:[(0,X.jsx)(er,{node:t,editor:i,getPos:r,getContent:o}),(0,X.jsx)(V.ms,{as:"code",ref:n,className:"block p-4 overflow-auto text-sm w-full custom-scrollbar text-slate-900 dark:text-slate-50"})]})},eo=G.H.extend({name:"codeBlock",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),lowlight:(0,K.B)(J.y),dictionary:{name:"Code Block",copy:"Copy",copied:"Copied!",arduino:"Arduino",bash:"Bash",c:"C",cpp:"C++",csharp:"C#",css:"CSS",diff:"Diff",go:"Go",graphql:"GraphQL",ini:"INI",java:"Java",javascript:"JavaScript",json:"JSON",kotlin:"Kotlin",less:"Less",lua:"Lua",makefile:"Makefile",markdown:"Markdown",objectivec:"Objective-C",perl:"Perl",php:"PHP","php-template":"PHP Template",plaintext:"Text",python:"Python","python-repl":"Python Repl",r:"R",ruby:"Ruby",rust:"Rust",scss:"Scss",shell:"Shell",sql:"SQL",swift:"Swift",typescript:"TypeScript",vbnet:"Visual Basic .NET",wasm:"WebAssembly",xml:"XML",yaml:"YAML"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"code"===e.type,apply:(e,t,i)=>{let r=t.lang,n=t.value;e.openNode(i,{language:r}),e.addText(n),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{var i;e.addNode({type:"code",value:(null===(i=t.content.firstChild)||void 0===i?void 0:i.text)||"",lang:t.attrs.language})}}},floatMenu:{hide:!0},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("code"),shortcut:"Mod-Alt-C",keywords:"codeblock,cb,dmk,",action:e=>e.chain().toggleCodeBlock().focus().run()}]}}},addAttributes:()=>({language:{default:"plaintext"}}),addNodeView:()=>(0,V.fW)(en),addKeyboardShortcuts(){return{Tab:e=>{let{editor:t}=e;return!!t.isActive(this.name)&&t.chain().insertContent("  ").focus().run()},Backspace:e=>{let{editor:t}=e,i=t.state.selection;return i.$anchor.parent.type.name===this.name&&0===i.$anchor.parentOffset&&t.chain().toggleNode(this.name,"paragraph").focus().run()}}}}),ea=i(88834).DY.extend({name:"bulletList",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Bullet List"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>{var t;return"list"===e.type&&!e.ordered&&!(null===(t=e.children)||void 0===t?void 0:t.find(e=>null!==e.checked))},apply:(e,t,i)=>{e.openNode(i),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"list",ordered:!1}),e.next(t.content),e.closeNode()}}},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("ul"),shortcut:"Mod-Shift-8",keywords:"bulletlist,bl,ul,wxlb",action:e=>e.chain().toggleBulletList().focus().run()}]}}}}),es=i(66437).GS.extend({name:"orderedList",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Ordered List"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"list"===e.type&&!!e.ordered,apply:(e,t,i)=>{e.openNode(i),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"list",ordered:!0,start:1}),e.next(t.content),e.closeNode()}}},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("ol"),shortcut:"Mod-Shift-7",keywords:"orderedlist,ol,yxlb",action:e=>e.chain().toggleOrderedList().focus().run()}]}}}}),el=i(4113).H.extend({name:"listItem",addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"listItem"===e.type&&null===e.checked,apply:(e,t,i)=>{e.openNode(i),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"listItem"}),e.next(t.content),e.closeNode()}}}}}}),ed=i(92578).a.extend({name:"taskList",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{name:"Task List"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>{var t;return"list"===e.type&&!e.ordered&&(null===(t=e.children)||void 0===t?void 0:t.find(e=>null!==e.checked))},apply:(e,t,i)=>{e.openNode(i),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"list",ordered:!1}).next(t.content).closeNode()}}},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("tl"),shortcut:"Mod-Shift-9",keywords:"tasklist,tl,rwlb",action:e=>e.chain().toggleTaskList().focus().run()}]}}}}),ec=i(50013).Uf.extend({name:"taskItem",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),nested:!0}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"listItem"===e.type&&null!==e.checked,apply:(e,t,i)=>{e.openNode(i,{checked:t.checked}),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"listItem",checked:t.attrs.checked}),e.next(t.content),e.closeNode()}}}}}});var eh=i(42313);function eu(e,t){if(ep(e)){let i=eh.rU.get(e.$anchorCell.node(-1)),r=e.$anchorCell.start(-1),n=i.cellsInRect(t),o=i.cellsInRect(i.rectBetween(e.$anchorCell.pos-r,e.$headCell.pos-r));for(let e=0,t=n.length;e<t;e++)if(!o.includes(n[e]))return!1;return!0}return!1}function ep(e){return e instanceof eh.Xc}function em(e,t){if(ep(e)){let i=eh.rU.get(e.$anchorCell.node(-1));return eu(e,{left:t,right:t+1,top:0,bottom:i.height})}return!1}function eg(e,t){if(ep(e)){let i=eh.rU.get(e.$anchorCell.node(-1));return eu(e,{left:0,right:i.width,top:t,bottom:t+1})}return!1}function ef(e){if(ep(e)){let t=eh.rU.get(e.$anchorCell.node(-1));return eu(e,{left:0,right:t.width,top:0,bottom:t.height})}return!1}function ev(e){return(0,s.Kk)(e=>e.type.spec.tableRole&&"table"===e.type.spec.tableRole)(e)}function ey(e,t){let i=ev(e);if(i){let e=eh.rU.get(i.node);return(Array.isArray(t)?t:Array.from([t])).reduce((t,r)=>{if(r>=0&&r<=e.width-1){let n=e.cellsInRect({left:r,right:r+1,top:0,bottom:e.height});return t.concat(n.map(e=>{let t=i.node.nodeAt(e),r=e+i.start;return{pos:r,start:r+1,node:t}}))}return t},[])}}function eb(e,t){let i=ev(e);if(i){let e=eh.rU.get(i.node);return(Array.isArray(t)?t:Array.from([t])).reduce((t,r)=>{if(r>=0&&r<=e.height-1){let n=e.cellsInRect({left:0,right:e.width,top:r,bottom:r+1});return t.concat(n.map(e=>{let t=i.node.nodeAt(e),r=e+i.start;return{pos:r,start:r+1,node:t}}))}return t},[])}}function ew(e,t,i){let r=ev(t.selection),n="row"===e;if(r){let e=eh.rU.get(r.node);if(i>=0&&i<(n?e.height:e.width)){let o=n?0:i,a=n?i:0,s=n?e.width:i+1,l=n?i+1:e.height,d=e.cellsInRect({left:o,top:a,right:n?s:o+1,bottom:n?a+1:l}),c=l-a==1?d:e.cellsInRect({left:n?o:s-1,top:n?l-1:a,right:s,bottom:l}),h=r.start+d[0],u=r.start+c[c.length-1],p=t.doc.resolve(h),m=t.doc.resolve(u);return t.setSelection(new eh.Xc(m,p))}}return t}function ek(e){let t;let i=/([^=\s]+)="?([^"]+)"?/g,r={};for(;t=i.exec(e);)r[t[1]]=t[2];return r}function ex(e,t,i){e.isEditable&&"function"==typeof t&&e.view.dispatch(e.view.state.tr.setNodeMarkup(t(),void 0,i))}let eM=s.NB.create({name:"details",group:"block",content:"detailsSummary detailsContent",defining:!0,isolating:!0,allowGapCursor:!1,addOptions:()=>({HTMLAttributes:{},dictionary:{name:"Details"}}),addStorage(){return{markdown:{parser:{match:e=>"containerDirective"===e.type&&e.name===this.name,apply:(e,t,i)=>{e.openNode(i,t.attributes).next(t.children).closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"containerDirective",name:this.name,attributes:t.attrs}).next(t.content).closeNode()}}},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("details"),shortcut:"Mod-Alt-D",keywords:"details,zdnl",action:e=>e.chain().toggleDetails().focus().run()}]}}},addAttributes:()=>({open:{default:!1,parseHTML:e=>e.getAttribute("open"),renderHTML:e=>e.open?{open:""}:{}}}),parseHTML:()=>[{tag:"details"}],renderHTML(e){let{HTMLAttributes:t}=e;return["details",(0,s.P1)(this.options.HTMLAttributes,t),0]},addNodeView(){return e=>{let{node:t,editor:i,getPos:n}=e,o=document.createElement("div"),a=document.createElement("button"),l=document.createElement("div"),d=document.createElement("div");for(let[e,t]of Object.entries((0,s.P1)(this.options.HTMLAttributes)))null!=t&&o.setAttribute(e,t);return o.setAttribute("data-type",this.name),a.setAttribute("data-type","".concat(this.name,"Button")),d.setAttribute("data-type","".concat(this.name,"Container")),t.attrs.open?o.setAttribute("open","true"):o.removeAttribute("open"),l.innerHTML=r("right-line"),a.addEventListener("click",()=>{let e=!o.hasAttribute("open");ex(i,n,{...t.attrs,open:e})}),a.append(l),o.append(a),o.append(d),{dom:o,contentDOM:d,update:e=>e.type===this.type&&(e.attrs.open?o.setAttribute("open","true"):o.removeAttribute("open"),!0)}}},addCommands(){return{setDetails:()=>e=>{var t,i;let{state:r,chain:n}=e,o=r.selection.$from.blockRange(r.selection.$to);if(!o)return!1;let a=r.doc.slice(o.start,o.end);return!!r.schema.nodes.detailsContent.contentMatch.matchFragment(a.content)&&n().insertContentAt({from:o.start,to:o.end},{type:this.name,attrs:{open:!0},content:[{type:"detailsSummary"},{type:"detailsContent",content:null!==(i=null===(t=a.toJSON())||void 0===t?void 0:t.content)&&void 0!==i?i:[]}]}).setTextSelection(o.start+2).run()},unsetDetails:()=>e=>{var t;let{state:i,chain:r}=e,n=(0,s.Kk)(e=>e.type===this.type)(i.selection);if(!n)return!1;let o=(0,s.N2)(n.node,e=>"detailsSummary"===e.type.name),a=(0,s.N2)(n.node,e=>"detailsContent"===e.type.name);if(!o.length||!a.length)return!1;let l={from:n.pos,to:n.pos+n.node.nodeSize},d=i.doc.resolve(l.from).parent.type.contentMatch.defaultType;return r().insertContentAt(l,[null==d?void 0:d.create(null,o[0].node.content).toJSON(),...null!==(t=a[0].node.content.toJSON())&&void 0!==t?t:[]]).setTextSelection(l.from+1).run()},toggleDetails:()=>e=>{let{state:t,chain:i}=e;return(0,s.Kk)(e=>e.type===this.type)(t.selection)?i().unsetDetails().run():i().setDetails().run()}}},addInputRules(){return[(0,s.S0)({find:/^:::details\s$/,type:this.type})]},addKeyboardShortcuts(){return{"Mod-Alt-d":()=>this.editor.commands.toggleDetails()}}}),e_=s.NB.create({name:"detailsContent",group:"block",content:"block*",defining:!0,selectable:!1,addOptions:()=>({HTMLAttributes:{},dictionary:{name:"Details Content"}}),addStorage(){return{markdown:{parser:{match:e=>"containerDirective"===e.type&&e.name===this.name,apply:(e,t,i)=>{e.openNode(i,t.attributes).next(t.children).closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"containerDirective",name:this.name,attributes:t.attrs}).next(t.content).closeNode()}}}}},parseHTML(){return[{tag:'div[data-type="'.concat(this.name,'"]')}]},renderHTML(e){let{HTMLAttributes:t}=e;return["div",(0,s.P1)({"data-type":this.name},this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:e=>{var t;let{editor:i}=e,r=i.view,n=i.state,o=n.selection,a=(0,s.Kk)(e=>e.type.name===this.name)(o);if(!o.empty||!a||!a.node.childCount)return!1;let l=a.node.childCount;if(l!==o.$from.index(a.depth)+1)return!1;let d=null===(t=a.node.type.contentMatch.defaultType)||void 0===t?void 0:t.createAndFill();if(!d)return!1;let c=a.node.child(l-1);if(!c.eq(d))return!1;let h=o.$from.node(-3);if(!h)return!1;let u=o.$from.indexAfter(-3),p=(0,s.Jx)(h.contentMatchAt(u));if(!p||!h.canReplaceWith(u,u,p))return!1;let m=p.createAndFill();if(!m)return!1;let g=n.tr,f=o.$from.after(-2);g.replaceWith(f,f,m),g.setSelection(y.Y1.near(g.doc.resolve(f),1));let v=n.doc.resolve(a.pos+1).posAtIndex(l-1,a.depth),b=v+c.nodeSize;return g.delete(v,b),g.scrollIntoView(),r.dispatch(g),!0}}}}),eS=s.NB.create({name:"detailsSummary",group:"block",content:"inline*",defining:!0,isolating:!0,selectable:!1,addOptions:()=>({HTMLAttributes:{},dictionary:{name:"Details Summary"}}),addStorage(){return{markdown:{parser:{match:e=>"containerDirective"===e.type&&e.name===this.name,apply:(e,t,i)=>{var r;let n=[];for(let e of null!==(r=t.children)&&void 0!==r?r:[])"paragraph"===e.type?e.children&&n.push(...e.children):e&&n.push(e);e.openNode(i,t.attributes).next(n).closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"containerDirective",name:this.name,attributes:t.attrs}).next(t.content).closeNode()}}}}},parseHTML:()=>[{tag:"summary"}],renderHTML(e){let{HTMLAttributes:t}=e;return["summary",(0,s.P1)({"data-type":this.name},this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Backspace:e=>{let{editor:t}=e,i=t.state.selection;return i.$anchor.parent.type.name===this.name&&0===i.$anchor.parentOffset&&t.chain().unsetDetails().focus().run()},Enter:e=>{let{editor:t}=e,i=t.view,r=t.state,n=r.selection.$head;if(n.parent.type.name!==this.name)return!1;let o=null!==i.domAtPos(n.after()+1).node.offsetParent,a=o?r.doc.nodeAt(n.after()):n.node(-2);if(!a)return!1;let l=o?0:n.indexAfter(-1),d=(0,s.Jx)(a.contentMatchAt(l));if(!d||!a.canReplaceWith(l,l,d))return!1;let c=d.createAndFill();if(!c)return!1;let h=r.tr,u=o?n.after()+1:n.after(-1);return h.replaceWith(u,u,c),h.setSelection(y.Y1.near(h.doc.resolve(u),1)),h.scrollIntoView(),i.dispatch(h),!0}}}});var eL=i(50403),eP=i(96115),eA=i(17112);class eT{static create(e){return()=>new eT(e)}show(){this.popover.show()}hide(){this.popover.hide()}update(e,t){var i,r;let n=e.state;if(!(e.composing||t&&t.doc.eq(n.doc)&&t.selection.eq(n.selection))){if(!(null===(i=(r=this.options).show)||void 0===i?void 0:i.call(r,{view:this,editor:this.editor}))){this.hide();return}this.options.onUpdate&&this.options.onUpdate({view:this,editor:this.editor,element:this.element,range:{from:Math.min(...this.editor.state.selection.ranges.map(e=>e.$from.pos)),to:Math.max(...this.editor.state.selection.ranges.map(e=>e.$to.pos))}}),this.popover.setProps({getReferenceClientRect:()=>this._rect()}),this.show()}}destroy(){this.options.onDestroy&&this.options.onDestroy({view:this,editor:this.editor,element:this.element,range:{from:Math.min(...this.editor.state.selection.ranges.map(e=>e.$from.pos)),to:Math.max(...this.editor.state.selection.ranges.map(e=>e.$to.pos))}}),this.popover.destroy(),this.element.remove()}createInput(e){let t=document.createElement("input");if(t.classList.add("ProseMirror-fm-input"),e.id&&(t.name=e.id),e.name&&(t.placeholder=e.name),e.type&&(t.type=e.type),e.value&&(t.value=e.value),e.class)for(let i of Array.isArray(e.class)?e.class:[e.class])t.classList.add(i);if(e.style)for(let i of Array.isArray(e.style)?e.style:[e.style])for(let[e,r]of Object.entries(i))t.style[e]=r;if(e.onEnter&&t.addEventListener("keydown",i=>{if("Enter"===i.key){var r;null===(r=e.onEnter)||void 0===r||r.call(e,t.value,t)}}),e.onInput&&t.addEventListener("input",()=>{var i;null===(i=e.onInput)||void 0===i||i.call(e,t.value,t)}),e.onChange&&t.addEventListener("change",()=>{var i;null===(i=e.onChange)||void 0===i||i.call(e,t.value,t)}),e.onKey&&t.addEventListener("keydown",i=>{var r;null===(r=e.onKey)||void 0===r||r.call(e,{key:i.key,ctrlKey:i.ctrlKey,altKey:i.altKey,metaKey:i.metaKey,shiftKey:i.shiftKey},t.value,t)}),e.onBoundary){let i=-1;t.addEventListener("mouseup",()=>{null!==t.selectionStart&&t.selectionStart===t.selectionEnd&&(i=t.selectionStart)}),t.addEventListener("keyup",r=>{null!==t.selectionStart&&t.selectionStart===t.selectionEnd&&(e.onBoundary&&"ArrowLeft"===r.key&&0===i&&e.onBoundary("left",t.value,t),e.onBoundary&&"ArrowRight"===r.key&&(-1===i||i===t.value.length)&&e.onBoundary("right",t.value,t),i=t.selectionStart)})}return{input:t}}createButton(e){let t=document.createElement("button");if(t.classList.add("ProseMirror-fm-button"),e.id&&(t.name=e.id),e.view&&(t.innerHTML=e.view),e.class)for(let i of Array.isArray(e.class)?e.class:[e.class])t.classList.add(i);if(e.style)for(let i of Array.isArray(e.style)?e.style:[e.style])for(let[e,r]of Object.entries(i))t.style[e]=r;e.onClick&&t.addEventListener("click",()=>{var i;null===(i=e.onClick)||void 0===i||i.call(e,t)});let i=document.createElement("div");i.classList.add("ProseMirror-fm-button-popover"),i.innerHTML=e.name,e.shortcut&&(i.innerHTML+="&nbsp;\xb7&nbsp;",e.shortcut.split("-").forEach((e,t)=>{if(0!==t){let e=document.createElement("span");e.innerHTML="&nbsp;",i.append(e)}let r=document.createElement("kbd");navigator.userAgent.includes("Mac")?r.textContent=e.replace(/mod/i,"Cmd"):r.textContent=e.replace(/mod/i,"Ctrl"),i.append(r)}));let r=(0,E.ZP)(t,{appendTo:()=>document.body,content:i,arrow:!1,inertia:!0,theme:"ProseMirror-dark",placement:"top",animation:"shift-away",duration:[200,150]});return{button:t,popover:i,instance:r}}createUpload(e){let t=document.createElement("input");t.type="file",e.accept&&(t.accept=e.accept),t.addEventListener("change",async()=>{if(t.files&&t.files.length>0){let r=i.button;r.classList.add("loading");try{var e;let i=t.files[0];if(t.size>5242880){eA.Z.error("The image size cannot exceed 5M");return}let r=await (0,eL.Jd)(i,(null===(e=eP.Z.getState().noteData)||void 0===e?void 0:e.note_id)||"");r.data,i.name,i.type,this.editor.chain().focus().setImage({src:r.data,alt:i.name}).run(),t.value=""}catch(e){}finally{r.classList.remove("loading")}}});let i=this.createButton({...e,onClick:()=>t.click()}),r=document.createElement("style");return r.textContent="\n      .ProseMirror-fm-button.loading {\n        opacity: 0.5;\n        pointer-events: none;\n      }\n      .upload-error {\n        color: red;\n        font-size: 12px;\n        margin-top: 4px;\n      }\n    ",document.head.appendChild(r),{...i,file:t}}createGroup(e){let t=document.createElement("div");return t.classList.add("ProseMirror-fm-group"),t.style.flexDirection=e,t}createDivider(){let e=document.createElement("span");return e.classList.add("ProseMirror-fm-divider"),{divider:e}}_rect(){if(this.options.rect)return this.options.rect({view:this,editor:this.editor});let{view:e,state:t}=this.editor;if((0,s.EG)(t.selection)){let i=e.nodeDOM(t.selection.from);if(i)return i.getBoundingClientRect()}return(0,s.pr)(e,t.selection.from,t.selection.to)}_element(){let e=document.createElement("div");if(e.classList.add("ProseMirror-fm"),this.options.class)for(let t of Array.isArray(this.options.class)?this.options.class:[this.options.class])e.classList.add(t);if(this.options.style)for(let t of Array.isArray(this.options.style)?this.options.style:[this.options.style])for(let[i,r]of Object.entries(t))e.style[i]=r;return this.options.onInit&&this.options.onInit({element:e,view:this,editor:this.editor,range:{from:Math.min(...this.editor.state.selection.ranges.map(e=>e.$from.pos)),to:Math.max(...this.editor.state.selection.ranges.map(e=>e.$to.pos))}}),e}_popover(){let e={appendTo:()=>document.body,getReferenceClientRect:null,content:this.element,arrow:!1,interactive:!0,theme:"ProseMirror",trigger:"manual",placement:"top",maxWidth:"none"};return(0,E.ZP)(document.body,this.options.tippy?this.options.tippy({options:e,view:this,editor:this.editor}):e)}constructor(e){this.editor=e.editor,this.options=e,this.element=this._element(),this.popover=this._popover()}}var eC=i(82751);class eN{static create(e){return t=>{var i;return new eN({...e,...t,HTMLAttributes:null!==(i=e.HTMLAttributes)&&void 0!==i?i:{}})}}get dom(){return this._root}get node(){return this._node}get getPos(){return this.options.getPos}get HTMLAttributes(){return this.options.HTMLAttributes}get $root(){return this._root}update(e){if(e.type!==this.options.node.type)return!1;this._node=e;let t=this._node.attrs.width?"".concat(this._node.attrs.width,"px"):"";this._root.style.width!==t&&(this._root.style.width=t);let i=this._node.attrs.height?"".concat(this._node.attrs.height,"px"):"";return this._root.style.height!==i&&(this._root.style.height=i),("left"===this._node.attrs.align||"start"===this._node.attrs.align)&&"flex-start"!==this._root.style.alignSelf&&(this._root.style.alignSelf="flex-start"),("center"===this._node.attrs.align||"start"===this._node.attrs.align)&&"center"!==this._root.style.alignSelf&&(this._root.style.alignSelf="center"),("right"===this._node.attrs.align||"end"===this._node.attrs.align)&&"flex-end"!==this._root.style.alignSelf&&(this._root.style.alignSelf="flex-end"),this.options.onUpdate&&this.options.onUpdate({view:this,editor:this.editor,$root:this._root}),this.options.onRender&&this.options.onRender({view:this,editor:this.editor,$root:this._root}),!0}destroy(){this.options.onDestroy&&this.options.onDestroy({view:this,editor:this.editor,$root:this._root}),this.$root.remove()}_resizer(e){let t={resizing:!1,offset:0,size:0},i=document.createElement("div"),r=document.createElement("div");r.style.display="none",r.style.userSelect="unset","left"===e?i.classList.add("ProseMirror-lresizer"):"right"===e?i.classList.add("ProseMirror-rresizer"):i.classList.add("ProseMirror-bresizer"),i.addEventListener("mousedown",n=>{n.preventDefault();let o=i.getBoundingClientRect();r.style.display="block",r.style.userSelect="none",t.resizing=!0,"left"===e?(t.offset=o.x,t.size=this._root.clientWidth):"right"===e?(t.offset=o.x,t.size=this._root.clientWidth):(t.offset=o.y,t.size=this._root.clientHeight)}),r.addEventListener("mousemove",i=>{if(t.resizing){if("left"===e){let e=t.size+Math.round((i.clientX-t.offset)*("center"===this._root.style.alignSelf?2:1));e>=100&&(this._root.style.width="".concat(e,"px"))}else if("right"===e){let e=t.size-Math.round((i.clientX-t.offset)*("center"===this._root.style.alignSelf?2:1));e>=100&&(this._root.style.width="".concat(e,"px"))}else{let e=t.size+Math.round(i.clientY-t.offset);e>=100&&(this._root.style.height="".concat(e,"px"))}}}),r.addEventListener("mouseup",()=>{t.resizing=!1,t.offset=0,t.size=0,r.style.display="none",r.style.userSelect="unset","left"===e||"right"===e?ex(this.editor,this.options.getPos,{...this._node.attrs,width:this._root.clientWidth}):ex(this.editor,this.options.getPos,{...this._node.attrs,height:this._root.clientHeight})}),r.addEventListener("mouseleave",()=>{t.resizing=!1,t.offset=0,t.size=0,r.style.display="none",r.style.userSelect="unset","left"===e||"right"===e?ex(this.editor,this.options.getPos,{...this._node.attrs,width:this._root.clientWidth}):ex(this.editor,this.options.getPos,{...this._node.attrs,height:this._root.clientHeight})}),i.append(r),this._root.append(i)}constructor(e){var t;if(this.editor=e.editor,this.options=e,this._node=e.node,this._root=document.createElement(null!==(t=e.tag)&&void 0!==t?t:"div"),this._root.classList.add("ProseMirror-inner-resizer"),this._root.setAttribute("data-type",this._node.type.name),this.options.id&&this._root.setAttribute("name",this.options.id),this.options.class)for(let e of Array.isArray(this.options.class)?this.options.class:[this.options.class])this._root.classList.add(e);if(this.options.style)for(let e of Array.isArray(this.options.style)?this.options.style:[this.options.style])for(let[t,i]of Object.entries(e))this._root.style[t]=i;for(let[e,t]of Object.entries((0,s.P1)(this.options.HTMLAttributes)))null!=t&&this._root.setAttribute(e,t);this._root.style.width=this._node.attrs.width?"".concat(this._node.attrs.width,"px"):"",this._root.style.height=this._node.attrs.height?"".concat(this._node.attrs.height,"px"):"",("left"===this._node.attrs.align||"start"===this._node.attrs.align)&&(this._root.style.alignSelf="flex-start"),("center"===this._node.attrs.align||"start"===this._node.attrs.align)&&(this._root.style.alignSelf="center"),("right"===this._node.attrs.align||"end"===this._node.attrs.align)&&(this._root.style.alignSelf="flex-end"),this.options.onInit&&this.options.onInit({view:this,editor:this.editor,$root:this._root}),this.options.onRender&&this.options.onRender({view:this,editor:this.editor,$root:this._root}),(!this.options.resize||this.options.resize.includes("width"))&&(this._resizer("left"),this._resizer("right")),(!this.options.resize||this.options.resize.includes("height"))&&this._resizer("bottom")}}let eE=s.NB.create({name:"embed",inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},addOptions:()=>({items:[{name:"GitHub Gist",match:e=>{var t;let{node:i}=e;return null===(t=i.attrs.src)||void 0===t?void 0:t.match(/(?:https?:\/\/)?gist\.github\.?com\/?(.*)$/i)},render:e=>{var t;let{editor:i,view:r,node:n,element:o}=e,a=null===(t=n.attrs.src)||void 0===t?void 0:t.match(/(?:https?:\/\/)?gist\.github\.?com\/?(.*)$/i);a&&(window.addEventListener("message",e=>{var t,o;(null===(t=e.data)||void 0===t?void 0:t.type)==="resize"&&(null===(o=e.data)||void 0===o?void 0:o.value)&&Math.abs(n.attrs.height-e.data.value)>5&&ex(i,r.getPos,{...n.attrs,height:e.data.value})}),o.src="\n              data:text/html;charset=utf-8,\n              <head>\n                <base target='_blank' />\n                <title>GitHub Gist</title>\n              </head>\n              <body>\n                <script src=\"https://gist.github.com/".concat(a[1],'.js"></script>\n                <script>\n                  window.addEventListener("load", () => {\n                    window.parent.postMessage({ type: "resize", value: document.body.scrollHeight }, "*");\n                  });\n                </script>\n              </body>\n            '))}}],inline:!1,HTMLAttributes:{},dictionary:{name:"Embed",inputEmbed:"Enter or paste embed",openEmbed:"Open embed",deleteEmbed:"Delete embed",alignLeft:"Left alignment",alignCenter:"Center alignment",alignRight:"Right alignment"}}),addAttributes:()=>({src:{default:null},align:{default:"center"},width:{default:null},height:{default:null}}),addStorage(){return{markdown:{parser:{match:e=>"textDirective"===e.type&&e.name===this.name,apply:(e,t,i)=>{e.addNode(i,t.attributes)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.addNode({type:"textDirective",name:this.name,attributes:t.attrs})}},hooks:{afterParse:e=>this.options.inline?e:(0,eC.W)(e,e=>"textDirective"===e.type&&e.name===this.name),beforeSerialize:e=>this.options.inline?e:(0,eC.r)(e,e=>"textDirective"===e.type&&e.name===this.name)}},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("embed"),keywords:"embed,iframe,qrk",action:e=>e.chain().setEmbed({src:""}).focus().run()}]}}},parseHTML:()=>[{tag:"iframe[src]"}],renderHTML(e){let{HTMLAttributes:t}=e;return["iframe",(0,s.P1)(this.options.HTMLAttributes,t)]},addNodeView(){return eN.create({HTMLAttributes:this.options.HTMLAttributes,onInit:e=>{var t;let{editor:i,view:r}=e,n=document.createElement("iframe");for(let[e,t]of Object.entries((0,s.P1)(r.HTMLAttributes)))null!=t&&n.setAttribute(e,t);for(let e of(n.src=null!==(t=r.node.attrs.src)&&void 0!==t?t:"",r.$root.append(n),this.options.items))if(e.match({editor:i,view:r,node:r.node,element:n})){e.render({editor:i,view:r,node:r.node,element:n});break}},onUpdate:e=>{let{editor:t,view:i}=e,r=i.$root.firstElementChild;if(r){var n;let e=null!==(n=i.node.attrs.src)&&void 0!==n?n:"";for(let n of(r.getAttribute("src")!==e&&(r.src=e),this.options.items))if(n.match({editor:t,view:i,node:i.node,element:r})){n.render({editor:t,view:i,node:i.node,element:r});break}}}})},addCommands(){return{setEmbed:e=>t=>{let{commands:i}=t;return i.insertContent({type:this.name,attrs:e})}}},addInputRules(){return[(0,s.x2)({find:/(:embed\{([^}]+)\})/,type:this.type,getAttributes:e=>ek(e[2])})]},addProseMirrorPlugins(){return[new y.Sy({key:new y.H$("".concat(this.name,"-float-menu")),view:eT.create({editor:this.editor,show:e=>{let{editor:t}=e;return t.isEditable&&t.isActive(this.name)},tippy:e=>{let{options:t}=e;return{...t,onMount:e=>{var t;return null===(t=e.popper.querySelector("input"))||void 0===t?void 0:t.focus()}}},onInit:e=>{let{view:t,editor:i,element:n}=e,o=t.createInput({name:this.options.dictionary.inputEmbed,onEnter:e=>{i.chain().updateAttributes(this.name,{src:e}).focus().run()},onBoundary:e=>{i.chain().updateAttributes(this.name,{value:e}).setTextSelection(i.state.selection.from+("left"===e?-1:1)).focus().run()}}),a=t.createButton({name:this.options.dictionary.openEmbed,view:r("open"),onClick:()=>{let e=i.getAttributes(this.name);e.src&&window.open(e.src,e.target)}}),s=t.createButton({name:this.options.dictionary.deleteEmbed,view:r("remove"),onClick:()=>{i.chain().deleteSelection().focus().run()}}),l=t.createButton({name:this.options.dictionary.alignLeft,view:r("align-left"),onClick:()=>i.chain().updateAttributes(this.name,{align:"left"}).run()}),d=t.createButton({name:this.options.dictionary.alignCenter,view:r("align-center"),onClick:()=>i.chain().updateAttributes(this.name,{align:"center"}).run()}),c=t.createButton({name:this.options.dictionary.alignRight,view:r("align-right"),onClick:()=>i.chain().updateAttributes(this.name,{align:"right"}).run()});n.append(o.input),n.append(l.button),n.append(d.button),n.append(c.button),n.append(a.button),n.append(s.button)},onUpdate:e=>{let{editor:t,element:i}=e,r=i.querySelector("input");if(r){var n;r.value=null!==(n=t.getAttributes(this.name).src)&&void 0!==n?n:""}}})})]}}),ez=i(21181).Ee.extend({name:"image",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),isInserting:!1,dictionary:{name:"Image",empty:"Add image",error:"Error loading image",loading:"Loading image...",inputSrc:"Enter or paste link",inputAlt:"Image description",inputTitle:"Image title",imageOpen:"Open image",imageUpload:"Upload image",imageDelete:"Delete image",alignLeft:"Left alignment",alignCenter:"Center alignment",alignRight:"Right alignment"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"image"===e.type,apply:(e,t,i)=>{let r=t.url,n=t.alt,o=t.title;e.addNode(i,{src:r,alt:n,title:o})}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.addNode({type:"image",title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}},hooks:{afterParse:e=>this.options.inline?e:(0,eC.W)(e,e=>"image"===e.type),beforeSerialize:e=>this.options.inline?e:(0,eC.r)(e,e=>"image"===e.type)}},uploader:{match:(e,t)=>t.type.startsWith("image"),apply:(e,t)=>e.chain().setImage({src:t.url,alt:t.name}).run()},floatMenu:{hide:!0},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("image"),keywords:"image,picture,tp,zp",action:e=>e.chain().setImage({src:""}).focus().run()}]}}},addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),align:{default:"center"},width:{default:"500px",parseHTML:e=>e.getAttribute("width"),renderHTML:e=>e.width?{width:e.width,style:"width: ".concat(e.width)}:{}}}},addNodeView(){return eN.create({resize:["width"],HTMLAttributes:this.options.HTMLAttributes,onInit:e=>{var t,i,r;let{view:n}=e,o=document.createElement("img");for(let[e,t]of Object.entries((0,s.P1)(n.HTMLAttributes)))null!=t&&o.setAttribute(e,t);o.src=null!==(t=n.node.attrs.src)&&void 0!==t?t:"",o.alt=null!==(i=n.node.attrs.alt)&&void 0!==i?i:"",o.title=null!==(r=n.node.attrs.title)&&void 0!==r?r:"",n.$root.setAttribute("data-status","loading"),n.$root.setAttribute("data-message",this.options.dictionary.loading),o.addEventListener("load",()=>{n.$root.removeAttribute("data-status"),n.$root.removeAttribute("data-message")}),o.addEventListener("error",()=>{o.getAttribute("src")?(n.$root.setAttribute("data-status","error"),n.$root.setAttribute("data-message",this.options.dictionary.error)):(n.$root.setAttribute("data-status","empty"),n.$root.setAttribute("data-message",this.options.dictionary.empty))}),n.$root.append(o)},onUpdate:e=>{let{view:t}=e,i=t.$root.firstElementChild;if(i){var r,n,o;let e=null!==(r=t.node.attrs.src)&&void 0!==r?r:"";i.getAttribute("src")!==e&&(i.src=e);let a=null!==(n=t.node.attrs.alt)&&void 0!==n?n:"";i.getAttribute("alt")!==a&&(i.alt=a);let s=null!==(o=t.node.attrs.title)&&void 0!==o?o:"";i.getAttribute("title")!==s&&(i.title=s)}}})},addCommands(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),insertImage:e=>t=>{let{chain:i}=t;this.storage.isInserting=!0;let r=i().setImage({...e,alignment:(null==e?void 0:e.align)||"center"}).run();return setTimeout(()=>{this.storage.isInserting=!1},100),r}}}});var eD=i(56873),eI=i(6229),eH=i(74925),ej=i(1587),eO=i(49485);class eR{static create(e){return t=>new eR({...e,...t,HTMLAttributes:{...e.HTMLAttributes,...t.HTMLAttributes}})}get dom(){return this._root}get view(){return this._view}get node(){return this._node}get getPos(){return this.options.getPos}get HTMLAttributes(){return this.options.HTMLAttributes}get $root(){return this._root}get $editor(){return this._editor}get $preview(){return this._preview}update(e){if(e.type!==this.options.node.type)return!1;if(this._node=e,this.options.onUpdate&&this.options.onUpdate({view:this,editor:this.editor,$root:this._root,$editor:this._editor,$preview:this._preview}),this.options.onRender&&this.options.onRender({view:this,editor:this.editor,$root:this._root,$editor:this._editor,$preview:this._preview}),this._view){let t=this._view.state,i=e.content.findDiffStart(t.doc.content);if("number"==typeof i){let r=e.content.findDiffEnd(t.doc.content);if(r){let n=r.a,o=r.b,a=i-Math.min(n,o);a>0&&(n+=a,o+=a),this._view.dispatch(t.tr.replace(i,o,e.slice(i,n)).setMeta("fromOutside",!0))}}}return!0}selectNode(){this.editor.isEditable&&(this.options.onOpen&&this.options.onOpen({view:this,editor:this.editor,$root:this._root,$editor:this._editor,$preview:this._preview}),this.options.onRender&&this.options.onRender({view:this,editor:this.editor,$root:this._root,$editor:this._editor,$preview:this._preview}),this._root.classList.add("ProseMirror-selectednode"),this._root.classList.add("ProseMirror-selectedcard"),this._editor.style.display="block",this._view=new b.tk(this._editor,{state:y.yy.create({doc:this._node,plugins:[(0,ej.h)({Enter:eH.QK,Tab:(e,t)=>(t&&t(e.tr.insertText("  ")),!0),Backspace:e=>0===e.selection.$anchor.parentOffset&&this.editor.chain().toggleNode(this._node.type.name,"paragraph").focus().run(),"Mod-Enter":()=>{let e=this.editor.view,t=e.state,i=t.selection.to,r=t.tr.replaceWith(i,i,t.schema.nodes.paragraph.createAndFill());return e.dispatch(r.setSelection(y.Bs.create(r.doc,i))),e.focus(),!0}})]}),dispatchTransaction:e=>{if(!this._view)return;let{state:t,transactions:i}=this._view.state.applyTransaction(e);if(this._view.updateState(t),!e.getMeta("fromOutside")){let e=this.editor.view,t=e.state.tr,r=eO.KS.offset(this.options.getPos()+1);i.forEach(e=>{e.steps.forEach(e=>{let i=e.map(r);if(!i)throw Error("step discarded!");t.step(i)})}),t.docChanged&&e.dispatch(t)}}}),this._view.focus())}deselectNode(){this.options.onClose&&this.options.onClose({view:this,editor:this.editor,$root:this._root,$editor:this._editor,$preview:this._preview}),this._view&&this._view.destroy(),this._view=void 0,this._root.classList.remove("ProseMirror-selectednode"),this._root.classList.remove("ProseMirror-selectedcard"),this._editor.style.display="none"}stopEvent(e){return!!this._view&&!!e.target&&this._view.dom.contains(e.target)}ignoreMutation(){return!0}destroy(){this.deselectNode(),this.options.onDestroy&&this.options.onDestroy({view:this,editor:this.editor,$root:this._root,$editor:this._editor,$preview:this._preview}),this.$root.remove()}constructor(e){var t;if(this.editor=e.editor,this.options=e,this._node=e.node,this._root=document.createElement(null!==(t=e.tag)&&void 0!==t?t:"div"),this._root.classList.add("ProseMirror-inner-editor"),this._root.setAttribute("data-type",this._node.type.name),this.options.id&&this._root.setAttribute("name",this.options.id),this.options.class)for(let e of Array.isArray(this.options.class)?this.options.class:[this.options.class])this._root.classList.add(e);if(this.options.style)for(let e of Array.isArray(this.options.style)?this.options.style:[this.options.style])for(let[t,i]of Object.entries(e))this._root.style[t]=i;for(let[e,t]of Object.entries((0,s.P1)(this.options.HTMLAttributes)))null!=t&&this._root.setAttribute(e,t);this._editor=document.createElement("div"),this._preview=document.createElement("div"),this._editor.style.display="none",this._editor.classList.add("ProseMirror-inner-editor-editor"),this._preview.classList.add("ProseMirror-inner-editor-preview"),this._root.append(this._editor),this._root.append(this._preview),this.options.onInit&&this.options.onInit({view:this,editor:this.editor,$root:this._root,$editor:this._editor,$preview:this._preview}),this.options.onRender&&this.options.onRender({view:this,editor:this.editor,$root:this._root,$editor:this._editor,$preview:this._preview})}}let eB=s.NB.create({name:"mathBlock",group:"block",marks:"",content:"text*",atom:!0,code:!0,defining:!0,isolating:!0,addOptions:()=>({HTMLAttributes:{},dictionary:{name:"Math Block",inputMath:"Enter or paste the equation",inputHelp:"Help"}}),addStorage(){return{markdown:{parser:{match:e=>"math"===e.type,apply:(e,t,i)=>{let r=t.value;e.openNode(i).addText(r).closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.addNode({type:"math",value:t.textContent})}},hooks:{beforeInit:e=>e.use(eI.Z)}},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("math"),keywords:"mathblock,sxgs,gsk",action:e=>e.chain().setMathBlock("E = mc^2").focus().run()}]}}},parseHTML(){return[{tag:'span[data-type="'.concat(this.name,'"]'),preserveWhitespace:"full"}]},renderHTML(e){let{node:t,HTMLAttributes:i}=e;return["span",(0,s.P1)({"data-type":this.name},this.options.HTMLAttributes,i),t.textContent]},addNodeView(){return eR.create({HTMLAttributes:this.options.HTMLAttributes,onRender:e=>{let{view:t}=e;t.$preview.classList.remove("ProseMirror-card-empty"),t.$preview.classList.remove("ProseMirror-card-error");try{t.node.textContent?eD.ZP.render(t.node.textContent,t.$preview):(t.$preview.classList.add("ProseMirror-card-empty"),t.$preview.innerHTML=this.options.dictionary.inputMath)}catch(e){t.$preview.classList.add("ProseMirror-card-error"),t.$preview.innerHTML=e.message}}})},addCommands(){return{setMathBlock:e=>t=>{let{commands:i}=t;return i.insertContent({type:this.name,content:[{type:"text",text:e}]})}}},addInputRules(){return[(0,s.zK)({find:/^\$\$\s$/,type:this.type}),(0,s.zK)({find:/^:::math$/,type:this.type})]}});class e${static create(e){return t=>new e$({...e,...t,HTMLAttributes:{...e.HTMLAttributes,...t.HTMLAttributes}})}get dom(){return this._root}get node(){return this._node}get getPos(){return this.options.getPos}get HTMLAttributes(){return this.options.HTMLAttributes}get $root(){return this._root}update(e){return e.type===this.options.node.type&&(this._node=e,this.options.onUpdate&&this.options.onUpdate({view:this,editor:this.editor,$root:this._root}),this.options.onRender&&this.options.onRender({view:this,editor:this.editor,$root:this._root}),!0)}destroy(){this.options.onDestroy&&this.options.onDestroy({view:this,editor:this.editor,$root:this._root}),this.$root.remove()}constructor(e){var t;if(this.editor=e.editor,this.options=e,this._node=e.node,this._root=document.createElement(null!==(t=e.tag)&&void 0!==t?t:"div"),this._root.classList.add("ProseMirror-inner-render"),this._root.setAttribute("data-type",this._node.type.name),this.options.id&&this._root.setAttribute("name",this.options.id),this.options.class)for(let e of Array.isArray(this.options.class)?this.options.class:[this.options.class])this._root.classList.add(e);if(this.options.style)for(let e of Array.isArray(this.options.style)?this.options.style:[this.options.style])for(let[t,i]of Object.entries(e))this._root.style[t]=i;for(let[e,t]of Object.entries((0,s.P1)(this.options.HTMLAttributes)))null!=t&&this._root.setAttribute(e,t);this.options.onInit&&this.options.onInit({view:this,editor:this.editor,$root:this._root}),this.options.onRender&&this.options.onRender({view:this,editor:this.editor,$root:this._root})}}let eF=s.NB.create({name:"mathInline",inline:!0,group:"inline",atom:!0,draggable:!0,addOptions:()=>({HTMLAttributes:{},dictionary:{name:"Math Inline",emptyMath:"Add a Tex equation",inputMath:"Enter or paste the equation",inputHelp:"Help"}}),addStorage(){return{markdown:{parser:{match:e=>"inlineMath"===e.type,apply:(e,t,i)=>{e.addNode(i,{value:t.value})}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.addNode({type:"inlineMath",value:t.attrs.value})}},hooks:{beforeInit:e=>e.use(eI.Z)}},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("math"),keywords:"mathinline,sxgs,hngs",action:e=>e.chain().setMathInline("E = mc^2").focus().run()}]}}},addAttributes:()=>({value:{default:""}}),parseHTML(){return[{tag:'span[data-type="'.concat(this.name,'"]'),preserveWhitespace:"full",getAttrs:e=>({value:e.textContent})}]},renderHTML(e){let{node:t,HTMLAttributes:i}=e;return["span",(0,s.P1)({"data-type":this.name},this.options.HTMLAttributes,i),t.attrs.value]},addNodeView(){return e$.create({tag:"span",HTMLAttributes:this.options.HTMLAttributes,onRender:e=>{let{view:t}=e;try{if(t.node.attrs.value)eD.ZP.render(t.node.attrs.value,t.$root);else{let e=document.createElement("span");e.classList.add("ProseMirror-empty"),e.textContent=this.options.dictionary.inputMath,t.$root.innerHTML=e.outerHTML}}catch(i){let e=document.createElement("span");e.classList.add("ProseMirror-error"),e.textContent=i.message,t.$root.innerHTML=e.outerHTML}}})},addCommands(){return{setMathInline:e=>t=>{let{commands:i}=t;return i.insertContent({type:this.name,attrs:{value:e}})}}},addInputRules(){return[new s.VK({find:/\$(.+)\$/,handler:e=>{let{state:t,range:i,match:r}=e,{from:n,to:o}=i,a=t.doc.resolve(n),s=a.index(),l=t.doc.resolve(o);if(!a.parent.canReplaceWith(s,l.index(),this.type))return null;let d=r[1];t.tr.replaceRangeWith(n,o,this.type.create({value:d},this.type.schema.text(d)))}})]},addProseMirrorPlugins(){return[new y.Sy({key:new y.H$("".concat(this.name,"-float-menu")),view:eT.create({editor:this.editor,show:e=>{let{editor:t}=e;return t.isEditable&&t.isActive(this.name)},tippy:e=>{let{options:t}=e;return{...t,onMount:e=>{var t;return null===(t=e.popper.querySelector("input"))||void 0===t?void 0:t.focus()}}},onInit:e=>{let{view:t,editor:i,element:n}=e,o=t.createInput({name:this.options.dictionary.inputMath,onInput:e=>{i.chain().updateAttributes(this.name,{value:e}).setNodeSelection(i.state.selection.from).run()},onEnter:e=>{i.chain().updateAttributes(this.name,{value:e}).setTextSelection(i.state.selection.from+1).focus().run()},onBoundary:(e,t)=>{i.chain().updateAttributes(this.name,{value:t}).setTextSelection(i.state.selection.from+("left"===e?-1:1)).focus().run()}}),a=t.createButton({name:this.options.dictionary.inputHelp,view:r("help"),onClick:()=>window.open("https://katex.org/")});o.input.classList.add("ProseMirror-code"),n.append(o.input),n.append(a.button)},onUpdate:e=>{let{editor:t,element:i}=e,r=i.querySelector("input");if(r){var n,o;r.value=null!==(o=null===(n=t.getAttributes(this.name))||void 0===n?void 0:n.value)&&void 0!==o?o:""}}})})]}});var eZ=i(7717),eU=function(e){let t=(0,eZ.useTranslations)(),{noteData:i,setShowSource:r,setShowSourceList:n}=(0,eP.Z)(),o=e=>{if(!e){n(null==i?void 0:i.other.sources),r(!0);return}n(((null==i?void 0:i.other.sources.find(t=>t.id===e))||[]).sourceList),r(!0)};return(0,X.jsx)(V.T5,{children:(0,X.jsxs)("button",{className:"sourceButton  w-fit select-none no-underline text-inherit px-5 py-3 box-border rounded-[28px] text-base bg-white flex justify-center items-center border border-[#d6d6d6] hover:bg-[#f5f5f5] hover:no-underline visited:text-inherit active:text-inherit dark:bg-[#161b22] dark:text-white dark:border-0 dark:hover:bg-[#30363d]",style:{width:"fit-content"},onClick:()=>o(e.node.attrs.sourcesId),"data-sourceId":e.node.attrs.sourcesId,children:["\uD83C\uDF10 ",e.node.attrs.count||0," ",t("sources")]})})};let eq=s.NB.create({name:"sourceButton",group:"block",selectable:!1,addAttributes:()=>({sourcesId:{},count:{default:0}}),addOptions:()=>({HTMLAttributes:{},dictionary:{name:"SourceButton"}}),addStorage(){return{markdown:{parser:{match:e=>"textDirective"===e.type&&e.name===this.name,apply:(e,t,i)=>{e.addNode(i,t.attributes)}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.addNode({type:"textDirective",name:this.name,attributes:t.attrs})}},hooks:{afterParse:e=>(0,eC.W)(e,e=>"textDirective"===e.type&&e.name===this.name),beforeSerialize:e=>(0,eC.r)(e,e=>"textDirective"===e.type&&e.name===this.name)}}}},parseHTML:()=>[{tag:"button"}],renderHTML(e){let{HTMLAttributes:t}=e;return["button",(0,s.P1)(this.options.HTMLAttributes,t)]},addNodeView:()=>(0,V.fW)(eU),addInputRules(){return[(0,s.x2)({find:/(:sourceButton{([^}]+)})/,type:this.type,getAttributes:e=>ek(e[2])})]}});var eW=i(24764),eK=i(19110),eJ=i(73335),eG=i(36681);let eV=eG.iA.extend({name:"table",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),resizable:!0,dictionary:{name:"Table",alignLeft:"Left alignment",alignCenter:"Center alignment",alignRight:"Right alignment",toggleHeaderRow:"Toggle header row",toggleHeaderCol:"Toggle header column",deleteTable:"Delete table"}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"table"===e.type,apply:(e,t,i)=>{e.openNode(i),t.children&&e.next(t.children.map((e,i)=>({...e,align:t.align[i],isHeader:0===i}))),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{var i;let r=null===(i=t.content.firstChild)||void 0===i?void 0:i.content;if(!r)return;let n=[];r.forEach(e=>n.push(e.attrs.alignment)),e.openNode({type:"table",align:n}),e.next(t.content),e.closeNode()}}},floatMenu:{hide:!0},blockMenu:{items:[{id:this.name,name:this.options.dictionary.name,icon:r("table"),keywords:"table,bg",action:e=>e.chain().insertTable({rows:3,cols:3}).focus().run()}]}}},renderHTML(e){let{HTMLAttributes:t}=e;return["table",{...t,style:"border-collapse: collapse; width: 100%;"},0]},addProseMirrorPlugins(){var e,t;return[...null!==(t=null===(e=eG.iA.config.addProseMirrorPlugins)||void 0===e?void 0:e.apply(this))&&void 0!==t?t:[],new y.Sy({key:new y.H$("".concat(this.name,"-float-menu")),view:eT.create({editor:this.editor,show:e=>{let{editor:t}=e;return!!t.isEditable&&ef(t.state.selection)},rect:e=>{let{editor:t}=e,{view:i,state:r}=t,n=ev(r.selection);if(n){let e=i.nodeDOM(n.pos),t=null==e?void 0:e.querySelector(".ProseMirror-table-grip-table");if(t)return t.getBoundingClientRect()}return(0,s.pr)(i,r.selection.from,r.selection.to)},onInit:e=>{let{view:t,editor:i,element:n}=e,o=t.createButton({name:this.options.dictionary.alignLeft,view:r("align-left"),onClick:()=>i.chain().setCellAttribute("align","left").run()}),a=t.createButton({name:this.options.dictionary.alignCenter,view:r("align-center"),onClick:()=>i.chain().setCellAttribute("align","center").run()}),s=t.createButton({name:this.options.dictionary.alignRight,view:r("align-right"),onClick:()=>i.chain().setCellAttribute("align","right").run()}),l=t.createButton({name:this.options.dictionary.toggleHeaderRow,view:r("header-row"),onClick:()=>i.chain().toggleHeaderRow().run()}),d=t.createButton({name:this.options.dictionary.toggleHeaderCol,view:r("header-col"),onClick:()=>i.chain().toggleHeaderColumn().run()}),c=t.createButton({name:this.options.dictionary.deleteTable,view:r("remove"),onClick:()=>i.chain().deleteTable().run()});n.append(o.button),n.append(a.button),n.append(s.button),n.append(l.button),n.append(d.button),n.append(c.button)}}),props:{decorations:e=>{let{doc:t,selection:i}=e,r=[];if(this.editor.isEditable){let e=function(e,t,i){let r=ev(e);if(r){let e=eh.rU.get(r.node).cellsInRect({left:0,right:1,top:0,bottom:1});if(e.length){let t=r.node.nodeAt(e[0]),i=r.start+e[0];return{pos:i,node:t,start:i+1}}}}(i,0,0);e&&r.push(b.p.widget(e.pos+1,()=>{let e=document.createElement("div");return e.classList.add("ProseMirror-table-grip-table"),e}))}return b.EH.create(t,r)}}})]},addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this)}}});var eX=i(18355),eQ=i(75450),eY=i(62834),e0=i(7110),e1=i(82550),e2=i(99220);class e6{addText(e){let t=this.nodes[this.nodes.length-1].content,i=t[t.length-1],r=this.editor.schema.text(null!=e?e:"",this.marks),n=i&&this.maybeMerge(i,r);n?t[t.length-1]=n:t.push(r)}openMark(e,t){let i=e.create(t);this.marks=i.addToSet(this.marks)}closeMark(e){this.marks=e.removeFromSet(this.marks)}openNode(e,t){this.nodes.push({type:e,attrs:t,content:[]})}addNode(e,t,i){let r=e.createAndFill(t,i,this.marks);return r?(this.nodes.length&&this.nodes[this.nodes.length-1].content.push(r),r):null}closeNode(){this.marks=e2.vc.none;let e=this.nodes.pop();return e?this.addNode(e.type,e.attrs,e.content):null}parse(){let e=null;do e=this.closeNode();while(this.nodes.length);return e}maybeMerge(e,t){if(e.isText&&t.isText&&e2.vc.sameSet(e.marks,t.marks))return this.editor.schema.text(e.text+t.text,e.marks)}constructor(e){this.editor=e,this.marks=e2.vc.none,this.nodes=[]}}class e5{parse(e){var t,i,r,n;for(let r of Object.values(this.editor.storage))(null==r?void 0:null===(i=r.markdown)||void 0===i?void 0:null===(t=i.hooks)||void 0===t?void 0:t.beforeParse)&&(e=r.markdown.hooks.beforeParse(e));let o=this.processor.runSync(this.processor.parse(e));for(let e of Object.values(this.editor.storage))(null==e?void 0:null===(n=e.markdown)||void 0===n?void 0:null===(r=n.hooks)||void 0===r?void 0:r.afterParse)&&(o=e.markdown.hooks.afterParse(o));return this.next(o),this.stack.parse()}next(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(let t of[e].flat())this.runNode(t);return this}addText(e){return this.stack.addText(e),this}addNode(e,t,i){return this.stack.addNode(e,t,i),this}openNode(e,t){return this.stack.openNode(e,t),this}closeNode(){return this.stack.closeNode(),this}openMark(e,t){return this.stack.openMark(e,t),this}closeMark(e){return this.stack.closeMark(e),this}runNode(e){let t=this.matchNode(e);if(t){var i,r;let n=t.name,o=this.editor.schema["node"===t.type?"nodes":"marks"][n],a=t.storage;null==a||null===(r=a.markdown)||void 0===r||null===(i=r.parser)||void 0===i||i.apply(this,e,o)}}matchNode(e){let t=this.editor.extensionManager.extensions.find(t=>{var i,r;let n=t.name,o=t.storage;return"markdown"!==n&&(null==o?void 0:null===(r=o.markdown)||void 0===r?void 0:null===(i=r.parser)||void 0===i?void 0:i.match(e))});if(!t){console.warn("No parser match ".concat(e.type));return}return t}constructor(e,t){this.stack=new e6(e),this.editor=e,this.processor=t}}class e3{openMark(e,t){e.isInSet(this.marks)||(this.marks=e.addToSet(this.marks),this.openNode(t))}closeMark(e){e.isInSet(this.marks)&&(this.marks=e.type.removeFromSet(this.marks),this.closeNode())}openNode(e){this.nodes.push(e)}addNode(e){if(this.nodes.length){let t=this.nodes[this.nodes.length-1];t.children||(t.children=[]),t.children.push(e)}return e}closeNode(){let e=this.nodes.pop();return e?this.addNode(e):null}serialize(){let e=null;do e=this.closeNode();while(this.nodes.length);return e}constructor(e){this.editor=e,this.marks=e2.vc.none,this.nodes=[]}}class e7{serialize(e){var t,i,r,n;this.next(e);let o=this.stack.serialize();for(let e of Object.values(this.editor.storage))(null==e?void 0:null===(i=e.markdown)||void 0===i?void 0:null===(t=i.hooks)||void 0===t?void 0:t.beforeSerialize)&&(o=e.markdown.hooks.beforeSerialize(o));console.log(o);try{let e=this.processor.stringify(o);for(let t of Object.values(this.editor.storage))(null==t?void 0:null===(n=t.markdown)||void 0===n?void 0:null===(r=n.hooks)||void 0===r?void 0:r.afterSerialize)&&(e=t.markdown.hooks.afterSerialize(e));return e}catch(e){return""}}next(e){return this.isFragment(e)?e.forEach(e=>this.runNode(e)):this.runNode(e),this}addNode(e){return this.stack.addNode(e),this}openNode(e){return this.stack.openNode(e),this}closeNode(){return this.stack.closeNode(),this}withMark(e,t){return this.stack.openMark(e,t),this}isFragment(e){return Object.hasOwn(e,"size")}runNode(e){if(e.marks.every(t=>{var i,r,n;let o=null===(i=this.matchNode(t))||void 0===i?void 0:i.storage;return!(null==o?void 0:null===(n=o.markdown)||void 0===n?void 0:null===(r=n.serializer)||void 0===r?void 0:r.apply(this,t,e))})){var t,i,r;let n=null===(t=this.matchNode(e))||void 0===t?void 0:t.storage;null==n||null===(r=n.markdown)||void 0===r||null===(i=r.serializer)||void 0===i||i.apply(this,e)}for(let t of e.marks)this.stack.closeMark(t)}matchNode(e){let t=this.editor.extensionManager.extensions.find(t=>{var i,r;let n=t.name,o=t.storage;return"markdown"!==n&&(null==o?void 0:null===(r=o.markdown)||void 0===r?void 0:null===(i=r.serializer)||void 0===i?void 0:i.match(e))});if(!t){console.warn("No serializer match ".concat(e.type.name));return}return t}constructor(e,t){this.stack=new e3(e),this.editor=e,this.processor=t}}let e4=s.hj.create({name:"markdown",addStorage:()=>({}),onBeforeCreate(){var e,t,i,r;for(let[i,r]of(this.storage.processor=(0,eX.l)().use(eY.Z).use(e0.Z).use(eQ.Z).use(e1.Z),Object.entries(this.editor.storage)))i!==this.name&&(null==r?void 0:null===(t=r.markdown)||void 0===t?void 0:null===(e=t.hooks)||void 0===e?void 0:e.beforeInit)&&(this.storage.processor=r.markdown.hooks.beforeInit(this.storage.processor));for(let[e,t]of Object.entries(this.editor.storage))e!==this.name&&(null==t?void 0:null===(r=t.markdown)||void 0===r?void 0:null===(i=r.hooks)||void 0===i?void 0:i.afterInit)&&(this.storage.processor=t.markdown.hooks.afterInit(this.storage.processor));this.storage.parse=e=>new e5(this.editor,this.storage.processor).parse(e),this.storage.serialize=e=>new e7(this.editor,this.storage.processor).serialize(e),this.storage.get=()=>this.editor.storage[this.name].serialize(this.editor.state.doc),this.storage.set=(e,t)=>{let i=this.editor.state.tr,r=this.editor.storage[this.name].parse(e);this.editor.view.dispatch(i.replaceWith(0,i.doc.content.size,r).setMeta("preventUpdate",!t))}}}),e9=s.hj.create({name:"uploader",addOptions:()=>({upload:e=>{let t=[];for(let i=0;i<e.length;i++){let r=e.item(i);r&&t.push(r)}let i=e=>new Promise(t=>{let i=new FileReader;i.addEventListener("load",()=>t({name:e.name,type:e.type,size:e.size,url:i.result}),!1),i.readAsDataURL(e)});return Promise.all(t.map(e=>i(e)))}}),addStorage(){return{upload:this.options.upload}},addProseMirrorPlugins(){let e=e=>{this.options.upload(e).then(e=>e.forEach(e=>{for(let t of Object.values(this.editor.storage))if(null==t?void 0:t.uploader){for(let i of Array.isArray(t.uploader)?t.uploader:[t.uploader])if(i.match(this.editor,e)){i.apply(this.editor,e);return}}}))};return[new y.Sy({key:new y.H$("".concat(this.name,"-handler")),props:{handlePaste:(t,i)=>{let r=this.editor.isEditable,{clipboardData:n}=i;return!!r&&!!n&&0!==n.files.length&&(e(n.files),!0)},handleDrop:(t,i)=>{var r;if(!(i instanceof DragEvent)||!this.editor.isEditable)return!1;let{files:n}=null!==(r=i.dataTransfer)&&void 0!==r?r:{};return!!n&&!(n.length<=0)&&(e(n),!0)}}})]}});var e8=i(2486);let te=e8.S.extend({name:"tableRow",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{insertTop:"Insert column on the top",insertBottom:"Insert column on the bottom",alignLeft:"Left alignment",alignCenter:"Center alignment",alignRight:"Right alignment",deleteRow:"Delete row"}}},addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),border:"none",align:{default:null}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"tableRow"===e.type,apply:(e,t,i)=>{e.openNode(i),t.children&&e.next(t.children.map((e,i)=>{var r;return{...e,align:null===(r=t.align)||void 0===r?void 0:r[i],isHeader:t.isHeader}})),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"tableRow"}),e.next(t.content),e.closeNode()}}},clickMenu:{hide:!0}}},addProseMirrorPlugins(){var e,t;return[...null!==(t=null===(e=e8.S.config.addProseMirrorPlugins)||void 0===e?void 0:e.apply(this))&&void 0!==t?t:[],new y.Sy({key:new y.H$("".concat(this.name,"-float-menu")),view:eT.create({editor:this.editor,show:e=>{let{editor:t}=e;if(!t.isEditable)return!1;let i=t.state.selection;if(ef(i))return!1;let r=ey(i,0);return!!(null==r?void 0:r.some((e,t)=>eg(i,t)))},rect:e=>{let{editor:t}=e,{view:i,state:r}=t;if(ep(r.selection)){let e=i.nodeDOM(r.selection.$headCell.pos);if(e){let t=e.querySelector(".ProseMirror-table-grip-row");return t?t.getBoundingClientRect():e.getBoundingClientRect()}}return(0,s.pr)(i,r.selection.from,r.selection.to)},onInit:e=>{let{view:t,editor:i,element:n}=e,o=t.createButton({id:"insert-top",name:this.options.dictionary.insertTop,view:r("up"),onClick:()=>i.chain().addRowBefore().run()}),a=t.createButton({id:"insert-bottom",name:this.options.dictionary.insertBottom,view:r("down"),onClick:()=>i.chain().addRowAfter().run()}),s=t.createButton({name:this.options.dictionary.alignLeft,view:r("align-left"),onClick:()=>i.chain().setCellAttribute("align","left").run()}),l=t.createButton({name:this.options.dictionary.alignCenter,view:r("align-center"),onClick:()=>i.chain().setCellAttribute("align","center").run()}),d=t.createButton({name:this.options.dictionary.alignRight,view:r("align-right"),onClick:()=>i.chain().setCellAttribute("align","right").run()}),c=t.createButton({name:this.options.dictionary.deleteRow,view:r("remove"),onClick:()=>i.chain().deleteRow().run()});n.append(o.button),n.append(a.button),n.append(s.button),n.append(l.button),n.append(d.button),n.append(c.button)}}),props:{decorations:e=>{let{tr:t,doc:i,selection:n}=e,o=[];if(this.editor.isEditable){let e=ey(n,0);if(e)for(let i=0;i<e.length;i++)o.push(b.p.widget(e[i].pos+1,()=>{let o=document.createElement("div");o.classList.add("ProseMirror-table-grip-row"),eg(n,i)&&o.classList.add("active"),0===i&&o.classList.add("first"),i===e.length-1&&o.classList.add("last");let a=document.createElement("div");return a.classList.add("ProseMirror-table-grip-drag"),a.innerHTML=r("drag"),a.addEventListener("mousedown",e=>{e.preventDefault(),e.stopImmediatePropagation(),this.editor.view.dispatch(ew("row",t,i))}),o.append(a),o}))}return b.EH.create(i,o)}}})]}});var tt=i(32585);let ti=tt.p.extend({name:"tableCell",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{mergeCells:"Merge cells",splitCells:"Split cells",alignLeft:"Left alignment",alignCenter:"Center alignment",alignRight:"Right alignment"}}},addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),border:"none",align:{default:null}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"tableCell"===e.type&&!e.isHeader,apply:(e,t,i)=>{e.openNode(i,{alignment:t.align}),e.openNode(e.editor.schema.nodes.paragraph),e.next(t.children),e.closeNode(),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"tableCell"}),e.next(t.content),e.closeNode()}}},clickMenu:{hide:!0}}},addProseMirrorPlugins(){var e,t;return[...null!==(t=null===(e=tt.p.config.addProseMirrorPlugins)||void 0===e?void 0:e.apply(this))&&void 0!==t?t:[],new y.Sy({key:new y.H$("".concat(this.name,"-float-menu")),view:eT.create({editor:this.editor,show:e=>{var t,i;let{editor:r}=e;if(!r.isEditable)return!1;let n=r.state.selection;return!(ef(n)||(null===(t=eb(n,0))||void 0===t?void 0:t.some((e,t)=>em(n,t)))||(null===(i=ey(n,0))||void 0===i?void 0:i.some((e,t)=>eg(n,t))))&&ep(n)},rect:e=>{let{editor:t}=e,{view:i,state:r}=t;if(ep(r.selection)){let e=i.nodeDOM(r.selection.$headCell.pos);if(e){let t=e.querySelector(".ProseMirror-table-grip-cell");return t?t.getBoundingClientRect():e.getBoundingClientRect()}}return(0,s.pr)(i,r.selection.from,r.selection.to)},onInit:e=>{let{view:t,editor:i,element:n}=e,o=t.createButton({name:this.options.dictionary.mergeCells,view:r("merge-cells"),onClick:()=>i.chain().mergeCells().run()}),a=t.createButton({name:this.options.dictionary.splitCells,view:r("split-cells"),onClick:()=>i.chain().splitCell().run()}),s=t.createButton({name:this.options.dictionary.alignLeft,view:r("align-left"),onClick:()=>i.chain().setCellAttribute("align","left").run()}),l=t.createButton({name:this.options.dictionary.alignCenter,view:r("align-center"),onClick:()=>i.chain().setCellAttribute("align","center").run()}),d=t.createButton({name:this.options.dictionary.alignRight,view:r("align-right"),onClick:()=>i.chain().setCellAttribute("align","right").run()});n.append(o.button),n.append(a.button),n.append(s.button),n.append(l.button),n.append(d.button)}}),props:{decorations:e=>{let{doc:t,selection:i}=e,r=[];if(this.editor.isEditable){let e=ev(i);if(e){let t=eh.rU.get(e.node);for(let i of t.cellsInRect({left:0,right:t.width,top:0,bottom:t.height}))r.push(b.p.widget(e.start+i+1,()=>{let e=document.createElement("div");return e.classList.add("ProseMirror-table-grip-cell"),e}))}}return b.EH.create(t,r)}}})]}});var tr=i(75050),tn=i(60785);class to{static create(e){return()=>new to(e)}onStart(e){if(this._index=0,this._items=[],this._element=document.createElement("div"),this._element.classList.add("ProseMirror-bm"),this.options.class)for(let e of Array.isArray(this.options.class)?this.options.class:[this.options.class])this._element.classList.add(e);if(this.options.style)for(let e of Array.isArray(this.options.style)?this.options.style:[this.options.style])for(let[t,i]of Object.entries(e))this._element.style[t]=i;this.options.onInit&&this.options.onInit({view:this,range:e.range,editor:this.editor,element:this._element});let t={appendTo:()=>document.body,getReferenceClientRect:null,content:this._element,arrow:!1,interactive:!0,theme:"ProseMirror",trigger:"manual",placement:"top-start",maxWidth:"none"};this._popover=(0,E.ZP)(document.body,this.options.tippy?this.options.tippy({options:t,view:this,editor:this.editor}):t),this.onUpdate(e)}onUpdate(e){void 0!==this._element&&void 0!==this._popover&&void 0!==this._index&&void 0!==this._items&&(this._items=e.items,this.options.onUpdate&&this.options.onUpdate({view:this,range:e.range,editor:this.editor,element:this._element}),this._render(e.range),this._popover.setProps({getReferenceClientRect:e.clientRect}))}onKeyDown(e){if(void 0===this._element||void 0===this._popover||void 0===this._index||void 0===this._items)return!1;if("Escape"===e.event.key)return this._popover&&this._popover.hide(),!0;if("Enter"===e.event.key){let t=this._items[this._index];return t&&"string"!=typeof t&&t.action&&t.action({view:this,range:e.range,editor:this.editor,element:this._element}),!0}if("ArrowUp"===e.event.key){let t=this._index-1,i=this._items[t]&&"string"==typeof this._items[t]?t-1:t;return this._index=i<0?this._items.length-1:i,this._render(e.range),!0}if("ArrowDown"===e.event.key){let t=this._index+1,i=this._items[t]&&"string"==typeof this._items[t]?t+1:t;return this._index=i>=this._items.length?0:i,this._render(e.range),!0}return!1}onExit(e){void 0!==this._element&&void 0!==this._popover&&void 0!==this._index&&void 0!==this._items&&(this._popover.hide(),this.options.onDestroy&&this.options.onDestroy({view:this,range:e.range,editor:this.editor,element:this._element}),this._popover.destroy(),this._element.remove(),this._index=void 0,this._items=void 0,this._element=void 0,this._popover=void 0)}createButton(e,t){if(t.id&&e.setAttribute("name",t.id),t.class)for(let i of Array.isArray(t.class)?t.class:[t.class])e.classList.add(i);if(t.style)for(let i of Array.isArray(t.style)?t.style:[t.style])for(let[t,r]of Object.entries(i))e.style[t]=r;if(t.icon){let i=document.createElement("div");i.classList.add("ProseMirror-bm-button-icon m-4"),i.innerHTML=t.icon,i.title=t.name,e.append(i)}}_render(e){if(void 0!==this._element&&void 0!==this._popover&&void 0!==this._index&&void 0!==this._items){if(this._element.innerHTML="",this._index=Math.min(this._index,Math.max(0,this._items.length-1)),this._items.length){let t=[];for(let i=0;i<this._items.length;i++){let r=this._items[i];if("|"===r){let e=document.createElement("div");e.classList.add("ProseMirror-bm-divider"),t.push(e)}else{let n=document.createElement("button");n.classList.add("ProseMirror-bm-button"),i===this._index&&n.classList.add("active"),r.render({range:e,view:this,editor:this.editor,element:n}),n.addEventListener("click",()=>{this._element&&r.action({range:e,view:this,editor:this.editor,element:n})}),t.push(n)}}this._element.append(...t),(0,tn.Z)(t[this._index],{block:"center",scrollMode:"if-needed",boundary:e=>e!==this._element})}else{let e=document.createElement("div");e.classList.add("ProseMirror-bm-empty"),e.textContent=this.options.dictionary.empty,this._element.append(e)}this._popover.show()}}constructor(e){this.editor=e.editor,this.options=e}}let ta=s.hj.create({name:"blockMenu",addOptions:()=>({items:["heading1","heading2","heading3","|","orderedList","bulletList","taskList","|","image","audio","video","|","blockquote","codeBlock","mathBlock","mermaid","plantuml","|","horizontalRule","table","details","embed"],dictionary:{lineEmpty:"Enter '/' to insert block...",lineSlash:"Continue typing to filter...",queryEmpty:"No results found"}}),addProseMirrorPlugins(){let e=new Map;for(let t of Object.values(this.editor.storage))if((null==t?void 0:t.blockMenu)&&t.blockMenu.items)for(let i of Array.isArray(t.blockMenu.items)?t.blockMenu.items:[t.blockMenu.items])e.set(i.id,i);return e.size&&this.options.items.length?[(0,tr.q$)({editor:this.editor,pluginKey:new y.H$("".concat(this.name,"-suggestion")),char:"/",items:t=>{let{query:i}=t,r=[];for(let t of this.options.items){if("|"===t){r.push(t);continue}let n=e.get(t);if(n){if(""!==i){let e=i.toLowerCase();if(!n.name.toLowerCase().includes(e)&&!n.keywords.toLowerCase().includes(e))continue}r.push({action:e=>{let{editor:t,view:i}=e,{state:r,dispatch:o}=t.view,a=r.selection.$from;o(r.tr.deleteRange(a.start(),a.pos)),n.action(t,i),t.view.focus()},render:e=>{let{view:i,element:r}=e;return i.createButton(r,{id:t,name:n.name,icon:n.icon,shortcut:n.shortcut})}})}}let n=[];for(let e=0;e<r.length;e++){let t=r[e];("|"!==t||0!==e&&e!==r.length-1&&"|"!==r[e+1]&&0!==n.length&&"|"!==n[n.length-1])&&n.push(t)}return n},render:to.create({editor:this.editor,dictionary:{empty:this.options.dictionary.queryEmpty}})}),new y.Sy({key:new y.H$("".concat(this.name,"-placeholder")),props:{decorations:e=>{let t=(0,s.Kk)(e=>"paragraph"===e.type.name)(e.selection);if(!t)return;let i=[],r=t&&0===t.node.content.size,n=t&&"/"===t.node.textContent;return 1===e.selection.$from.depth?(r&&i.push(b.p.node(t.pos,t.pos+t.node.nodeSize,{class:"ProseMirror-bm-placeholder","data-empty":this.options.dictionary.lineEmpty})),n&&i.push(b.p.node(t.pos,t.pos+t.node.nodeSize,{class:"ProseMirror-bm-placeholder","data-empty":" ".concat(this.options.dictionary.lineSlash)})),b.EH.create(e.doc,i)):null}}})]:[]}}),ts=null,tl={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};class td{show(e){var t;"listItem"===e.node.type.name?this.popover.setProps({getReferenceClientRect:()=>e.dom.getBoundingClientRect(),offset:[0,30]}):this.popover.setProps({getReferenceClientRect:()=>e.dom.getBoundingClientRect(),offset:[0,10]}),(null===(t=this._active)||void 0===t?void 0:t.dom)!==e.dom&&this.popover.hide(),this._active=e,this.popover.show()}hide(){this.popover.hide()}keydown(e){this.hide()}drop(e){this._dragging=!1}dragstart(e){this._dragging=!0;let t=this.editor.view,i=this._selection;if(e.dataTransfer&&i){let r=i.content();t.dragging={slice:r,move:!0};let{dom:n,text:o}=function(e,t){let i;let r=[],{openStart:n,openEnd:o,content:a}=t;for(;n>1&&o>1&&1===a.childCount&&1===a.firstChild.childCount;){n-=1,o-=1;let e=a.firstChild;r.push(e.type.name,e.attrs!==e.type.defaultAttrs?e.attrs:null),a=e.content}let s=e.someProp("clipboardSerializer")||e2.PW.fromSchema(e.state.schema),l=ts||(ts=document.implementation.createHTMLDocument("title")),d=l.createElement("div");d.appendChild(s.serializeFragment(a,{document:l}));let c=d.firstChild,h=0;for(;c&&1===c.nodeType&&(i=tl[c.nodeName.toLowerCase()]);){for(let e=i.length-1;e>=0;e--){let t=l.createElement(i[e]);for(;d.firstChild;)t.appendChild(d.firstChild);d.appendChild(t),h++}c=d.firstChild}return c&&1===c.nodeType&&c.setAttribute("data-pm-slice","".concat(n," ").concat(o).concat(h?" -".concat(h):""," ").concat(JSON.stringify(r))),{dom:d,text:e.someProp("clipboardTextSerializer",i=>i(t,e))||t.content.textBetween(0,t.content.size,"\n\n")}}(t,r);e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.clearData(),e.dataTransfer.setData("text/html",n.innerHTML),e.dataTransfer.setData("text/plain",o)}}dragover(e){if(this._dragging){let t=this.editor.view,i=t.dom.parentElement;if(!i)return;let r=i.getBoundingClientRect();if(i.scrollHeight>i.clientHeight){if(i.scrollTop>0&&20>Math.abs(e.y-r.y)){i.scrollTop=i.scrollTop>10?i.scrollTop-10:0;return}Math.round(i.scrollTop+r.height)<Math.round(t.dom.getBoundingClientRect().height)&&20>Math.abs(e.y-(r.height+r.y))&&(i.scrollTop=i.scrollTop+10)}}}dragenter(e){this._dragging=!0}dragleave(e){this._dragging=!1}mouseup(e){if(!this._dragging){requestAnimationFrame(()=>{this.editor.view.focus()});return}this._dragging=!1,this._selection=void 0}mousedown(e){let{state:t,view:i}=this.editor,r=this._active;if(r&&y.qv.isSelectable(r.node)){let e=y.qv.create(t.doc,r.pos.pos-(r.node.isLeaf?0:1));i.dispatch(t.tr.setSelection(e)),i.focus(),this._selection=e}}mousemove(e){let{view:t}=this.editor;return!t.composing&&!!t.editable&&!!e.target&&(clearTimeout(this._timer),this._timer=setTimeout(()=>{let t=this._find(e);t?this.show(t):this.hide()},8),!1)}plus(){if(this._active){let{pos:e,node:t}=this._active;this.editor.chain().insertContentAt(e.pos+t.nodeSize,{type:"paragraph"}).setTextSelection(e.pos+t.nodeSize).focus().run()}}destroy(){this.popover.destroy(),this.element.remove()}_element(){let e=document.createElement("div");if(e.classList.add("ProseMirror-cm"),this.options.class)for(let t of Array.isArray(this.options.class)?this.options.class:[this.options.class])e.classList.add(t);if(this.options.style)for(let t of Array.isArray(this.options.style)?this.options.style:[this.options.style])for(let[i,r]of Object.entries(t))e.style[i]=r;let t=document.createElement("div");t.innerHTML=r("plus"),t.classList.add("ProseMirror-cm-plus"),t.addEventListener("click",this.plus.bind(this));let i=document.createElement("div");return i.innerHTML=r("drag"),i.classList.add("ProseMirror-cm-drag"),i.draggable=!0,i.addEventListener("mouseup",this.mouseup.bind(this)),i.addEventListener("mousedown",this.mousedown.bind(this)),i.addEventListener("dragstart",this.dragstart.bind(this)),e.append(t),e.append(i),e}_popover(){let e={appendTo:()=>document.body,getReferenceClientRect:null,content:this.element,arrow:!1,interactive:!0,theme:"ProseMirror-none",animation:"shift-away",trigger:"manual",placement:"left-start",maxWidth:"none",offset:[0,10],zIndex:998};return(0,E.ZP)(document.body,this.options.tippy?this.options.tippy({options:e,view:this,editor:this.editor}):e)}_find(e){let{view:t}=this.editor;if(t.composing||!t.editable||!e.target||!t.dom.parentElement)return;let i=0,r=e.target;if(r===t.dom&&(r=document.elementFromPoint(e.x+70,e.y)),r&&(i=t.posAtDOM(r,0)),i<=0)return;let n=t.state.doc.resolve(i),o=n.node();if("doc"===o.type.name){let e=t.state.doc.nodeAt(i);if(!e)return;o=e}for(;o&&(this._nodeIsNotBlock(o)||this._nodeIsDisabled(o)||this._nodeIsFirstChild(n));)o=(n=t.state.doc.resolve(n.before())).node();n=n.pos-n.parentOffset==0?n:t.state.doc.resolve(n.pos-n.parentOffset);let a=t.nodeDOM(n.pos);for(a||(a=t.nodeDOM(n.pos-1));(null==a?void 0:a.parentElement)&&a.parentElement!==t.dom.parentElement&&n.pos===t.posAtDOM(a.parentElement,0);)a=a.parentElement;if(a)return{node:o,pos:n,dom:a}}_nodeIsDisabled(e){var t,i;return null===(i=this.editor.storage[e.type.name])||void 0===i?void 0:null===(t=i.clickMenu)||void 0===t?void 0:t.hide}_nodeIsNotBlock(e){return!e.type.isBlock||"doc"===e.type.name}_nodeIsFirstChild(e){let t=e.parent,i=e.node();return t===i&&(t=e.node(e.depth-1)),!!t&&"doc"!==t.type.name&&t.firstChild===i}constructor(e){this.editor=e.editor,this.options=e,this.element=this._element(),this.popover=this._popover()}}let tc=s.hj.create({name:"clickMenu",addProseMirrorPlugins(){let e=new td({editor:this.editor});return[new y.Sy({key:new y.H$("".concat(this.name,"-click-menu")),view:()=>({destroy:()=>e.destroy()}),props:{handleDOMEvents:{drop:(t,i)=>e.drop(i),keydown:(t,i)=>e.keydown(i),dragover:(t,i)=>e.dragover(i),dragenter:(t,i)=>e.dragenter(i),dragleave:(t,i)=>e.dragleave(i),mousemove:(t,i)=>e.mousemove(i)}}})]}}),th=s.hj.create({name:"floatMenu",addOptions:()=>({items:["bold","italic","strike","underline","|","code","highlight","link","|","superscript","subscript"]}),addProseMirrorPlugins(){let e=new Set,t=new Map;for(let[i,r]of Object.entries(this.editor.storage))if((null==r?void 0:r.floatMenu)&&(r.floatMenu.hide&&e.add(i),r.floatMenu.items))for(let e of Array.isArray(r.floatMenu.items)?r.floatMenu.items:[r.floatMenu.items])t.set(e.id,e);return t.size&&this.options.items.length?[new y.Sy({key:new y.H$("".concat(this.name,"-float-menu")),view:eT.create({editor:this.editor,show:e=>{let{editor:t}=e;return!1},onDestroy:e=>{let{view:i,range:r,editor:n,element:o}=e;for(let e of this.options.items)if("|"!==e){let s=o.querySelector('[name="'.concat(e,'"]')),l=t.get(e);if(s&&l){var a;null===(a=l.onDestroy)||void 0===a||a.call(l,{view:i,range:r,editor:n,element:s})}}}})})]:[]}}),tu=s.hj.create({name:"clipboard",addProseMirrorPlugins(){return[new y.Sy({key:new y.H$("".concat(this.name,"-handler")),props:{handlePaste:(e,t)=>{let i=this.editor.isEditable,r=t.clipboardData;if(!i||!r||0!==r.files.length)return!1;let n=r.getData("text/plain");if(r.getData("text/html").length>0)return!1;if(function(e){try{return(0,s.zh)(e,"codeBlock")||(0,s.zh)(e,"code")}catch(e){return!1}}(e.state))return t.preventDefault(),e.dispatch(e.state.tr.insertText(n)),!0;if(n.match(/^```/gm)||n.match(/\[[^]+]\(https?:\/\/\S+\)/gm)||n.match(/\[[^]+]\(\/\S+\)/gm)||n.match(/^#{1,6}\s+\S+/gm)||n.match(/^[\d-*].?\s\S+/gm)){let t=this.editor.storage.markdown.parse(n);if(!t||"string"==typeof t)return!1;let i=e.state.selection.content();return e.dispatch(e.state.tr.replaceSelection(new e2.p2(t.content,i.openStart,i.openEnd))),!0}return!1},clipboardTextSerializer:e=>{let t=this.editor.schema.topNodeType.createAndFill(void 0,e.content);return t?this.editor.storage.markdown.serialize(t):""}}})]}});var tp=i(85440);let tm=tp.x.extend({name:"tableHeader",addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),dictionary:{insertLeft:"Insert column on the left",insertRight:"Insert column on the right",alignLeft:"Left alignment",alignCenter:"Center alignment",alignRight:"Right alignment",deleteCol:"Delete column"}}},addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),border:"none",align:{default:null}}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),markdown:{parser:{match:e=>"tableCell"===e.type&&!!e.isHeader,apply:(e,t,i)=>{e.openNode(i,{alignment:t.align}),e.openNode(e.editor.schema.nodes.paragraph),e.next(t.children),e.closeNode(),e.closeNode()}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.openNode({type:"tableCell"}),e.next(t.content),e.closeNode()}}},clickMenu:{hide:!0}}},addProseMirrorPlugins(){var e,t;return[...null!==(t=null===(e=tp.x.config.addProseMirrorPlugins)||void 0===e?void 0:e.apply(this))&&void 0!==t?t:[],new y.Sy({key:new y.H$("".concat(this.name,"-float-menu")),view:eT.create({editor:this.editor,show:e=>{let{editor:t}=e;if(!t.isEditable)return!1;let i=t.state.selection;if(ef(i))return!1;let r=eb(i,0);return!!(null==r?void 0:r.some((e,t)=>em(i,t)))},rect:e=>{let{editor:t}=e,{view:i,state:r}=t;if(ep(r.selection)){let e=i.nodeDOM(r.selection.$headCell.pos);if(e){let t=e.querySelector(".ProseMirror-table-grip-col");return t?t.getBoundingClientRect():e.getBoundingClientRect()}}return(0,s.pr)(i,r.selection.from,r.selection.to)},onInit:e=>{let{view:t,editor:i,element:n}=e,o=t.createButton({name:this.options.dictionary.insertLeft,view:r("left"),onClick:()=>i.chain().addColumnBefore().run()}),a=t.createButton({name:this.options.dictionary.insertRight,view:r("right"),onClick:()=>i.chain().addColumnAfter().run()}),s=t.createButton({name:this.options.dictionary.alignLeft,view:r("align-left"),onClick:()=>i.chain().setCellAttribute("align","left").run()}),l=t.createButton({name:this.options.dictionary.alignCenter,view:r("align-center"),onClick:()=>i.chain().setCellAttribute("align","center").run()}),d=t.createButton({name:this.options.dictionary.alignRight,view:r("align-right"),onClick:()=>i.chain().setCellAttribute("align","right").run()}),c=t.createButton({name:this.options.dictionary.deleteCol,view:r("remove"),onClick:()=>i.chain().deleteColumn().run()});n.append(o.button),n.append(a.button),n.append(s.button),n.append(l.button),n.append(d.button),n.append(c.button)}}),props:{decorations:e=>{let{tr:t,doc:i,selection:n}=e,o=[];if(this.editor.isEditable){let e=eb(n,0);if(e)for(let i=0;i<e.length;i++)o.push(b.p.widget(e[i].pos+1,()=>{let o=document.createElement("div");o.classList.add("ProseMirror-table-grip-col"),em(n,i)&&o.classList.add("active"),0===i?o.classList.add("first"):i===e.length-1&&o.classList.add("last");let a=document.createElement("div");return a.classList.add("ProseMirror-table-grip-drag"),a.innerHTML=r("drag"),a.addEventListener("mousedown",e=>{e.preventDefault(),e.stopImmediatePropagation(),this.editor.view.dispatch(ew("column",t,i))}),o.append(a),o}))}return b.EH.create(i,o)}}})]}});function tg(e,t,i,r){!1!==i&&("boolean"==typeof i?e.push(t.configure(r)):e.push(t.configure({...r,...i})))}let tf=s.hj.create({name:"starterKit",addExtensions(){let e=[];return tg(e,n,this.options.sub),tg(e,o,this.options.sup),tg(e,u,this.options.bold),tg(e,f,this.options.code),tg(e,w,this.options.link),tg(e,L,this.options.italic),tg(e,C,this.options.strike),tg(e,R,this.options.highlight),tg(e,B,this.options.underline),tg(e,$,this.options.text),tg(e,F,this.options.document),tg(e,Z,this.options.heading),tg(e,U,this.options.paragraph),tg(e,q,this.options.blockquote),tg(e,W,this.options.hardBreak),tg(e,eo,this.options.codeBlock),tg(e,ea,this.options.bulletList),tg(e,es,this.options.orderedList),tg(e,el,this.options.listItem),tg(e,ed,this.options.taskList),tg(e,ec,this.options.taskItem),tg(e,eM,this.options.details),tg(e,e_,this.options.detailsContent),tg(e,eS,this.options.detailsSummary),tg(e,eV,this.options.table),tg(e,te,this.options.tableRow),tg(e,ti,this.options.tableCell),tg(e,tm,this.options.tableHeader),tg(e,eE,this.options.embed),tg(e,ez,this.options.image),tg(e,eB,this.options.mathBlock),tg(e,eF,this.options.mathInline),tg(e,eq,this.options.SourceButton),tg(e,e9,this.options.uploader),tg(e,e4,this.options.markdown),tg(e,tu,this.options.clipboard),tg(e,ta,this.options.blockMenu),tg(e,th,this.options.floatMenu),tg(e,tc,this.options.clickMenu),tg(e,eK.A,this.options.history),tg(e,eW.f,this.options.gapCursor),tg(e,eJ.m,this.options.dropCursor,{color:"var(--tiptap-color-primary)",width:2}),e}})},41529:function(e,t,i){"use strict";i.d(t,{d:function(){return T}});var r=i(21181),n=i(66040),o=i(3317),a=i(82751),s=i(26831),l=i(52676),d=i(75271),c=i(7717),h=i(96115),u=i(79057),p=i(29921),m=i(15133),g=i(60904),f=i(81760),v=i(56066),y=i(25010),b=i(34097),w=i(21581),k=i(17112),x=i(11920),M=i(70017),_=i(64155),S=e=>{let{isSmartArt:t,src:i,smart_art_id:r,translations:n}=e,{noteData:o}=(0,h.Z)(),{setGraphicQueryData:a,setShowGraphicModel:s}=(0,u.Z)(),S=(0,c.useTranslations)(),[L,P]=d.useState("svg"),[A,T]=d.useState(!1),[C,N]=d.useState(null),{copyItem:E,copied:z,copy:D}=(0,M.V)(),I=(0,d.useCallback)(async e=>{try{if(k.Z.info(S("drive.download_loading"),99999),"pdf"===e)await (0,x.F)({title:(null==o?void 0:o.title)||"image",imageUrl:i,onProgress:e=>{k.Z.info(S("drive.download_loading"),99999)},onError:e=>{k.Z.error("".concat(e),3e3)},onComplete:()=>{k.Z.close(),T(!1)},scale:2,quality:1,pageMargin:.8});else{var t,r;let i=null==C?void 0:null===(r=C.images)||void 0===r?void 0:null===(t=r.find(t=>t.type===e))||void 0===t?void 0:t.path;if(!i)return;await (0,x.l)(i,"".concat((null==o?void 0:o.title)||"image",".").concat(e)),k.Z.close(),T(!1)}}catch(e){k.Z.close(),k.Z.error("".concat(e),3e3),console.error("Download failed:",e)}},[i,null==o?void 0:o.title,C,n]),H=(0,d.useCallback)(async e=>{try{var t,i;if("png"===e){let e=null==C?void 0:null===(t=C.images)||void 0===t?void 0:t.find(e=>"png"===e.type);if(e){let t=await fetch(e.path).then(e=>e.blob());E(new ClipboardItem({"image/png":t}))}}else if("svg"===e){let e=null==C?void 0:null===(i=C.images)||void 0===i?void 0:i.find(e=>"svg"===e.type);if(e){let t=await fetch(e.path).then(e=>e.text());D(t)}}}catch(e){console.error("Copy failed:",e)}},[null==C?void 0:C.svg,E,i]),j=()=>{a({messageId:(0,_.Z)(),threadId:(0,_.Z)(),language:"auto",inputText:"test",query:null==o?void 0:o.title,canEdit:!0,template:void 0,note_id:null==o?void 0:o.note_id,smart_art_id:r,mode:"note"}),s(!0)},O=async()=>{N((await (0,b.mU)(r)).data)};(0,d.useEffect)(()=>{!C&&A&&r&&O()},[C,A,o]);let R=e=>{e.stopPropagation(),e.preventDefault()};return r&&(0,l.jsxs)("div",{className:"docImgDispose",onClick:R,onMouseDown:R,onMouseUp:R,children:[(0,l.jsx)("div",{className:"docImgDisposeEdit",onClick:e=>{e.preventDefault(),e.stopPropagation(),j()},children:(0,l.jsx)(p.Z,{className:"h-6 w-6"})}),(0,l.jsxs)("div",{className:"docImgDisposeDownload relative",children:[(0,l.jsx)(m.Z,{className:"h-6 w-6",onClick:()=>T(!A)}),A&&(C?(0,l.jsxs)("div",{className:"flex flex-col w-[360px] min-h-[200px] p-4 gap-6 absolute top-10 right-0 bg-white dark:bg-gray-800 hover:text-[#0080FF] box-border rounded-lg shadow-lg z-10 border border-[#EBEEF3] dark:border-gray-700",children:[(0,l.jsx)("div",{className:"absolute top-3 right-3 cursor-pointer text-[#30394A] dark:text-gray-300",onClick:()=>T(!1),children:(0,l.jsx)(g.Z,{className:"h-6 w-6"})}),(0,l.jsx)("div",{className:"flex gap-2",children:["svg","png","pdf"].map(e=>(0,l.jsx)(y.z,{className:"border-none",size:"sm",onClick:()=>P(e),style:{backgroundColor:L===e?"#0080FF":"rgb(var(--background-rgb, 237 250 255))",color:L===e?"#fff":"rgb(var(--foreground-rgb, 0 128 255))"},children:e.toUpperCase()},e))}),(0,l.jsx)("div",{className:"border rounded-lg overflow-hidden p-2 dark:border-gray-600",children:(0,l.jsx)("img",{src:i,alt:"Preview",className:"w-full h-auto"})}),(0,l.jsxs)("div",{className:"flex justify-between gap-2",children:["pdf"!==L&&(0,l.jsxs)(y.z,{className:"flex-1 dark:bg-gray-700 dark:hover:bg-gray-600",onClick:()=>H(L),children:[z?(0,l.jsx)(f.Z,{className:"h-6 w-6"}):(0,l.jsx)(v.Z,{className:"h-6 w-6"})," ",S("copy")]}),(0,l.jsxs)(y.z,{className:"flex-1 dark:bg-gray-700 dark:hover:bg-gray-600",onClick:()=>I(L),children:[(0,l.jsx)(m.Z,{className:"h-6 w-6"})," ",S("download.label")]})]})]}):(0,l.jsxs)("div",{className:"flex flex-col w-[360px] p-4 gap-6 absolute top-10 right-0 bg-white dark:bg-gray-800 hover:text-[#0080FF] box-border rounded-lg shadow-lg z-10 border border-[#EBEEF3] dark:border-gray-700",children:[(0,l.jsx)("div",{className:"absolute top-3 right-3 cursor-pointer text-[#30394A] dark:text-gray-300",onClick:()=>T(!1),children:(0,l.jsx)(g.Z,{className:"h-6 w-6"})}),(0,l.jsx)("div",{className:"flex justify-center items-center text-[#30394A] dark:text-gray-300 min-h-[300px] w-full",children:(0,l.jsx)(w.Z,{className:"h-6 w-6"})})]}))]})]})},L=i(54836),P=i(24785);let A=(0,s.fW)(e=>{var t,i;let{node:r,editor:n,getPos:o}=e,{shouldRender:a,imageError:h,imageSrc:u}=(0,P.f)((null===(t=r.attrs)||void 0===t?void 0:t.src)||""),p=(0,c.useTranslations)(),m=(0,d.useRef)(null),g=(0,d.useRef)(!1),f=(0,d.useRef)(null),v=(null===(i=r.attrs)||void 0===i?void 0:i.src)||"",y="";if(v)try{y=new URL(v).searchParams.get("smart_art_id")||""}catch(e){console.error("Invalid URL:",v)}let b=e=>{if("function"==typeof o){let t=o(),i=n.state.tr.setNodeMarkup(t,void 0,{...r.attrs,...e});n.view.dispatch(i)}};return((0,d.useEffect)(()=>{let e=f.current;if(!e)return;let t=0,i=0,n=0,o=0,a=e=>{e.preventDefault(),g.current=!0;let r=m.current;r&&(t=e.pageX,e.pageY,i=r.offsetWidth,n=r.offsetHeight,o=i/n,document.addEventListener("mousemove",s),document.addEventListener("mouseup",l))},s=e=>{if(!g.current)return;let n=e.pageX-t,a=Math.max(50,i+n),s=Math.round(a/o);b({width:a,height:s,alignment:r.attrs.alignment})},l=()=>{g.current=!1,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l)};return e.addEventListener("mousedown",a),()=>{e.removeEventListener("mousedown",a),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l)}},[n,a,u,!h]),h)?(0,l.jsx)(l.Fragment,{}):a&&u&&!h?(0,l.jsx)(s.T5,{as:"div",className:"image-container",style:{textAlign:r.attrs.alignment||"center"},"data-alignment":r.attrs.alignment||"center",children:(0,l.jsxs)("div",{className:"image-wrapper",children:[(0,l.jsx)("img",{"data-drag-handle":!0,ref:m,src:u,alt:r.attrs.alt||"",className:"".concat(r.attrs.class||""," ").concat(y?"smart-art":""),"data-id":r.attrs["data-id"]||y,style:{width:r.attrs.width?"".concat(r.attrs.width,"px"):void 0,height:r.attrs.height?"".concat(r.attrs.height,"px"):void 0,cursor:"pointer"},draggable:!1}),(0,l.jsx)(S,{isSmartArt:r.attrs["data-id"]||y||"",src:u,smart_art_id:r.attrs["data-id"]||y||"",translations:{copy:p("copy"),download:p("download")}}),(0,l.jsx)("div",{className:"resize-handle z-10",ref:f,"data-drag-handle":!1,children:(0,l.jsx)(L.Z,{})})]})}):(0,l.jsx)(s.T5,{className:"image-loading",style:{textAlign:r.attrs.alignment||"center"},children:(0,l.jsx)(s.T5,{className:"flex items-center justify-center min-w-[300px] min-h-[200px] bg-gray-100 rounded-lg animate-pulse",style:{textAlign:r.attrs.alignment||"center"},children:(0,l.jsx)("div",{className:"flex flex-col items-center space-y-2"})})})}),T=r.ZP.extend({name:"customImage",draggable:!0,addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),HTMLAttributes:{class:"custom-image"}}},parseHTML:()=>[{tag:"img[src]",getAttrs:e=>{if("string"==typeof e)return{};let t=e.closest(".image-container"),i=t?t.getAttribute("data-alignment"):e.getAttribute("data-alignment")||"center";return{src:e.getAttribute("src"),"data-id":e.getAttribute("data-id"),alt:e.getAttribute("alt"),title:e.getAttribute("title"),width:e.getAttribute("width"),height:e.getAttribute("height"),alignment:i}}}],addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),width:{parseHTML:e=>e.getAttribute("width"),renderHTML:e=>({width:e.width})},height:{default:null,parseHTML:e=>e.getAttribute("height"),renderHTML:e=>({height:e.height})},alignment:{default:"center",parseHTML:e=>{let t=e.closest(".image-container");return(null==t?void 0:t.getAttribute("data-alignment"))||e.getAttribute("data-alignment")||"center"},renderHTML:e=>({"data-alignment":e.alignment||"center"})},"data-id":{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>({"data-id":e["data-id"]})},class:{default:null,parseHTML:e=>e.getAttribute("class"),renderHTML:e=>({class:e.class})}}},renderHTML(e){let{HTMLAttributes:t}=e;return["div",{class:"image-container",draggable:"true"},["div",{class:"image-wrapper"},["img",(0,n.P1)({class:"smart-art",draggable:"true"},t,{"data-id":t["data-id"],class:"smart-art ".concat(t.class||"").trim()})]]]},addNodeView:()=>A,addProseMirrorPlugins(){var e;return[...(null===(e=this.parent)||void 0===e?void 0:e.call(this))||[],new o.Sy({props:{handlePaste:(e,t)=>{var i;let r=Array.from((null===(i=t.clipboardData)||void 0===i?void 0:i.items)||[]).filter(e=>0===e.type.indexOf("image"));return 0!==r.length&&(t.preventDefault(),r.forEach(t=>{let i=t.getAsFile();if(i){let t=new FileReader;t.onload=t=>{var i;let r=null===(i=t.target)||void 0===i?void 0:i.result,{schema:n}=e.state,o=new URL(r).searchParams.get("smart_art_id"),a=n.nodes.customImage.create({src:r,"data-id":o||"",class:o?"smart-art":"",alignment:"center"}),s=e.state.tr.replaceSelectionWith(a);e.dispatch(s)},t.readAsDataURL(i)}}),!0)}}})]},addStorage(){return{markdown:{parser:{match:e=>"image"===e.type,apply:(e,t,i)=>{e.addNode(i,{src:t.url,alt:t.alt,title:t.title})}},serializer:{match:e=>e.type.name===this.name,apply:(e,t)=>{e.addNode({type:"image",title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}},hooks:{afterParse:e=>this.options.inline?e:(0,a.W)(e,e=>"image"===e.type),beforeSerialize:e=>this.options.inline?e:(0,a.r)(e,e=>"image"===e.type)}},isInserting:!1}},addCommands(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),setImage:e=>t=>{let{tr:i,state:r,dispatch:n,chain:o}=t,{selection:a}=r,{from:s,to:l}=a,d=!1;return(r.doc.nodesBetween(s,l,(t,r)=>{if(t.type.name===this.name)return n&&(i.setNodeMarkup(r,void 0,{...t.attrs,...e}),d=!0),!1}),d)?(n&&n(i),!0):o().insertContent({type:this.name,attrs:e}).run()},updateImage:e=>t=>{let{tr:i,state:r,dispatch:n}=t,{selection:o}=r,{from:a,to:s}=o,l=!1;return r.doc.nodesBetween(a,s,(t,r)=>{if(t.type.name===this.name)return n&&(i.setNodeMarkup(r,void 0,{...t.attrs,...e}),l=!0),!1}),n&&l&&n(i),l},insertImage:e=>t=>{let{chain:i,state:r,tr:n,dispatch:o}=t,{selection:a}=r,{$from:s}=a,l=r.schema.nodes.customImage.create({...e,alignment:(null==e?void 0:e.align)||"center"});if("heading"===s.parent.type.name){if(o){let e=s.end();n.insert(e+1,r.schema.nodes.paragraph.create()).insert(e+2,l).insert(e+3,r.schema.nodes.paragraph.create()),o(n)}return!0}return"doc"===s.parent.type.name?(n.insert(0,r.schema.nodes.paragraph.create()).insert(1,l).insert(2,r.schema.nodes.paragraph.create()),null==o||o(n),!0):i().insertContent("\n").insertContent({type:this.name,attrs:{...e,alignment:(null==e?void 0:e.align)||"center"}}).insertContent("\n").run()},insertTopImage:e=>t=>{let{chain:i,state:r,tr:n,dispatch:o}=t,a=r.schema.nodes.customImage.create({...e,alignment:(null==e?void 0:e.align)||"center"});return o&&(n.insert(0,r.schema.nodes.paragraph.create()).insert(1,a).insert(2,r.schema.nodes.paragraph.create()),o(n)),!0},updateSmartArtImage:e=>t=>{let{tr:i,state:r,dispatch:n,view:o}=t,a=!1,{selection:s}=r,l=r.tr.setSelection(s);return r.doc.descendants((t,i)=>{var r,o;let s="";if(null===(r=t.attrs)||void 0===r?void 0:r.src)try{s=new URL((null===(o=t.attrs)||void 0===o?void 0:o.src)||"").searchParams.get("smart_art_id")||""}catch(e){}if(t.attrs["data-id"]===e.oldId||s===e.oldId){if(n){let r={...t.attrs,src:e.src,"data-id":e.newId||e.oldId};e.removeClass&&(r.class=(r.class||"").split(" ").filter(t=>t!==e.removeClass).join(" ")),l.setNodeMarkup(i,void 0,r),a=!0}return!1}return!0}),n&&a&&(l.setMeta("addToHistory",!1).setMeta("preventScroll",!0),n(l)),!0}}}})},51220:function(e,t,i){"use strict";i.d(t,{b:function(){return r}});let r=i(66040).hj.create({name:"fontFamily",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:e=>{var t;return null===(t=e.style.fontFamily)||void 0===t?void 0:t.replace(/['"]/g,"")},renderHTML:e=>e.fontFamily?{style:"font-family: ".concat(e.fontFamily)}:{}}}}]},addCommands:()=>({setFontFamily:e=>t=>{let{chain:i}=t;return i().setMark("textStyle",{fontFamily:e}).run()},unsetFontFamily:()=>e=>{let{chain:t}=e;return t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}})})},8510:function(e,t,i){"use strict";var r=i(66040),n=i(3317),o=i(60011);let a=r.hj.create({name:"selection",addProseMirrorPlugins(){let{editor:e}=this;return[new n.Sy({key:new n.H$("selection"),props:{decorations:t=>t.selection.empty||!0===e.isFocused?null:o.EH.create(t.doc,[o.p.inline(t.selection.from,t.selection.to,{class:"tipatapSelection"})])}})]}});t.Z=a},21581:function(e,t,i){"use strict";var r=i(52676),n=i(37481),o=i(76983),a=i.n(o);t.Z=function(e){let{className:t}=e;return(0,r.jsxs)("div",{className:(0,n.cn)(a().spinner,t),children:[(0,r.jsx)("span",{}),(0,r.jsx)("span",{}),(0,r.jsx)("span",{})]})}},24785:function(e,t,i){"use strict";i.d(t,{f:function(){return o}});var r=i(27976),n=i(75271);function o(e){let[t,i]=(0,n.useState)(!1),[o,a]=(0,n.useState)(!1),[s,l]=(0,n.useState)("");return(0,n.useEffect)(()=>{let t;if(i(!1),a(!1),l(""),!e){a(!0);return}let n=!0,o=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=new Image;t=setTimeout(()=>{n&&(console.log("Image load timeout:",e),a(!0),d.src="")},3e4),d.onload=()=>{n&&(clearTimeout(t),i(!0),a(!1),l(e),console.log("Image loaded successfully:",e))},d.onerror=()=>{if(n){if(clearTimeout(t),console.error("Image load error:",e),s)i(!1),a(!0),l("");else{let t="".concat(r.XJ,"/imgs/").concat(btoa(e));console.log("Trying proxy URL:",t),o(t,!0)}}},d.src=e};return o(e),()=>{n=!1,clearTimeout(t)}},[e]),{shouldRender:t,imageError:o,imageSrc:s}}},50403:function(e,t,i){"use strict";i.d(t,{AG:function(){return g},Dz:function(){return d},Jd:function(){return h},SB:function(){return a},W:function(){return p},_q:function(){return f},f_:function(){return l},gs:function(){return c},kL:function(){return s},t1:function(){return m},yt:function(){return u}});var r=i(27976),n=i(13263),o=i(5517);let a=(e,t)=>(0,o.Z)("".concat(r.Ez,"/note/save"),{method:"POST",headers:(0,n.Fe)(),body:JSON.stringify(e),signal:t?t.signal:void 0}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),s=(e,t)=>(0,o.Z)("".concat(r.Ez,"/note/query?noteId=").concat(e),{method:"GET",headers:(0,n.Fe)()}).then(async e=>200!==e.status?Promise.reject(e):await e.json()),l=e=>(0,o.Z)("".concat(r.Ez,"/note/delete"),{method:"POST",headers:(0,n.Fe)(),body:JSON.stringify({note_id:e})}).then(async e=>200!==e.status?Promise.reject(e):await e.json()),d=(e,t)=>(0,o.Z)("".concat(r.Ez,"/note/ai/expand"),{method:"POST",headers:(0,n.Fe)(),signal:e.signal,body:JSON.stringify({content:t})}),c=(e,t)=>(0,o.Z)("".concat(r.Ez,"/note/ai/abbreviation"),{method:"POST",headers:(0,n.Fe)(),signal:e.signal,body:JSON.stringify({content:t})}),h=(e,t)=>{let i=new FormData;return i.append("note_id",t||""),i.append("file",e),(0,o.Z)("".concat(r.Ez,"/note/uploadImage"),{method:"POST",body:i}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e)},u=e=>(0,o.Z)("".concat(r.Ez,"/ai/image/generate"),{method:"POST",headers:(0,n.Fe)(),body:JSON.stringify(e)}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),p=e=>(0,o.Z)("".concat(r.Ez,"/api/auth/google/refresh/token?refresh_token=").concat(e),{method:"GET"}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),m=async(e,t,i)=>{try{let a=await (0,o.Z)("".concat(r.Ez,"/file/convert"),{method:"POST",headers:(0,n.Fe)(),body:JSON.stringify(e)});if(200!==a.status)throw Error("Error: ".concat(a.status));let s=await a.blob(),l=URL.createObjectURL(s),d=document.createElement("a");d.href=l,d.download="".concat((null==i?void 0:i.slice(0,100))||"exported_file",".").concat(e.file_type.toLowerCase()),null==t||t({status:"success"}),document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(l)}catch(e){throw null==t||t({status:"error"}),Error("Error: ".concat(e))}},g=e=>(0,o.Z)("".concat(r.Ez,"/ai/image/save"),{method:"POST",headers:(0,n.Fe)(),body:JSON.stringify(e)}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),f=e=>(0,o.Z)("".concat(r.Ez,"/ai/image/query?thread_id=").concat(e),{method:"GET",headers:(0,n.Fe)()}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e)},34097:function(e,t,i){"use strict";i.d(t,{KX:function(){return d},NK:function(){return c},Vd:function(){return l},b4:function(){return s},mU:function(){return h},wt:function(){return u},x2:function(){return p}});var r=i(27976),n=i(13263),o=i(52166),a=i(5517);let s=e=>(0,a.Z)("".concat(r.Ez,"/smart/art/struct/query?message_id=").concat(e.message_id,"&thread_id=").concat(e.thread_id),{method:"GET",headers:(0,n.Fe)()}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),l=e=>(0,a.Z)("".concat(r.Ez,"/smart/art/struct/save"),{method:"POST",headers:(0,n.Fe)(),body:JSON.stringify(e)}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),d=e=>(0,a.Z)("".concat(r.Ez,"/smart/art/struct/update"),{method:"POST",headers:(0,n.Fe)(),body:JSON.stringify(e)}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),c=async e=>{try{let t=await (0,a.Z)("".concat(r.Ez,"/smart/art/struct/upload"),{method:"POST",headers:(0,n.Fe)(),body:JSON.stringify(e)});if(200!==t.status)throw Error("Error: ".concat(t.status));return await t.json()}catch(e){throw Error("Error: ".concat(e))}},h=e=>(0,a.Z)("".concat(r.Ez,"/smart/art/struct/query.by.id?smart_art_id=").concat(e),{method:"GET",headers:(0,n.Fe)()}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),u=async(e,t)=>{let i=(0,o.a1)();return(0,a.Z)("".concat(r.XJ,"/threads/finish/").concat(e,"/graphic_render"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"".concat(i)},body:JSON.stringify(t)}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e)},p=(e,t)=>{let i=(0,o.a1)();return(0,a.Z)("".concat(r.XJ,"/threads/messages/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"".concat(i)},body:JSON.stringify(t)}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>{throw e})}},96115:function(e,t,i){"use strict";var r=i(75910),n=i(50403),o=i(76972);let a=(0,r.Ue)((e,t)=>({noteData:void 0,error:void 0,showSource:!1,showSourceList:[],mindmapContent:"",mindmapType:"",setmindmapType:t=>e({mindmapType:t}),setShowSource:t=>e({showSource:t}),setShowSourceList(t){e({showSourceList:t})},setNoteData:t=>e({noteData:t}),setNoteDataItem:i=>{e({noteData:{...t().noteData,...i}})},saveNote:async t=>{e({noteData:await (0,n.SB)(t)})},queryNoteById:async(t,i)=>{try{var r;let a=await (0,n.kL)(t,i);o.Z.getState().setCreatedImgList((null===(r=a.data.other)||void 0===r?void 0:r.aICreateImageList)||[]),e({noteData:a.data,error:void 0})}catch(t){t instanceof Response&&(401===t.status?e({error:"unauthorized"}):404===t.status?e({error:"not_found"}):500===t.status&&e({error:"server_error"}))}},setMindmapContent:t=>{e({mindmapContent:t})}}));t.Z=a},57606:function(e,t,i){"use strict";let r=(0,i(75910).Ue)(e=>({selectedSources:[],sourceTranslatedList:[],sourceHighlightList:[],sourceHighlightTranslatedList:[],sourceAllMatchList:[],sourceOriginalList:[],lastSelectedIndex:null,secondSources:[],setLastSelectedIndex:t=>e({lastSelectedIndex:t}),addSourceTranslatedList:t=>{e(e=>({sourceTranslatedList:[...e.sourceTranslatedList,t]}))},addSourceOriginalList:t=>{e(e=>({sourceOriginalList:[...e.sourceOriginalList,t]}))},addHighlightItem:t=>{e(e=>({sourceHighlightList:[...e.sourceHighlightList,t]}))},addSourceAllMatchListItem:t=>{e(e=>({sourceAllMatchList:[...e.sourceAllMatchList,t]}))},updateSourceAllMatchListItem:t=>{e(e=>({sourceAllMatchList:e.sourceAllMatchList.map(e=>e.id===t.id?{...e,...t}:e)}))},clearItem:()=>{e(()=>({sourceHighlightList:[],sourceAllMatchList:[],sourceOriginalList:[],sourceTranslatedList:[]}))},setSelectedSources:t=>{e(()=>({selectedSources:t}))},setSecondSources:t=>{e(()=>({secondSources:t}))}}));t.Z=r},76972:function(e,t,i){"use strict";let r=(0,i(75910).Ue)((e,t)=>({createLoading:!1,prompt:"",showAICreateModal:!1,createImgList:[],createError:"",cacheRequestData:null,setCacheRequestData:t=>{e(e=>({...e,cacheRequestData:t}))},setCreateError:t=>{e(e=>({...e,createError:t}))},setCreatedImgList:t=>{e(e=>({...e,createImgList:t}))},setCreateLoading:t=>{e(e=>({...e,createLoading:t}))},setPrompt:t=>{e(e=>({...e,prompt:t}))},setShowAICreateModal:t=>{e(e=>({...e,showAICreateModal:t}))}}));t.Z=r},79057:function(e,t,i){"use strict";let r=(0,i(75910).Ue)(e=>({showGraphicModel:!1,setShowGraphicModel:t=>e({showGraphicModel:t}),graphicQueryData:{},setGraphicQueryData:t=>e({graphicQueryData:t}),allGraphicData:{},setAllGraphicData:t=>e({allGraphicData:t}),updateGraphicData:{},setUpdateGraphicData:t=>e({updateGraphicData:t})}));t.Z=r},20796:function(e,t,i){"use strict";i.d(t,{JK:function(){return o},OT:function(){return n},YA:function(){return a}});var r=i(27976);let n=e=>e&&(e.startsWith("https://sandbox_outputs")||e.startsWith("sandbox_outputs"))?e.replace(/^(https:\/\/)?sandbox_outputs/,"".concat("https://api.felo.ai/search","/resources/sandbox_outputs")):e,o=e=>e&&(e.startsWith("http://felo_generate_images")||e.startsWith("felo_generate_images"))?e.replace(/^(http:\/\/)?felo_generate_images/,"".concat("https://api.felo.ai/search","/resources/felo_generate_images")):e,a=e=>e.includes(r.XJ)?e:"".concat(r.XJ,"/imgs/").concat(btoa(e))},72881:function(e,t,i){"use strict";i.d(t,{b:function(){return r}});let r=e=>{switch(null==e?void 0:e.toLowerCase()){case"pdf":return"/icons/PDF.svg";case"doc":return"/icons/DOC.svg";case"docx":return"/icons/DOCX.svg";case"ppt":return"/icons/PPT.svg";case"pptx":return"/icons/PPTX.svg";case"xls":return"/icons/XLS.svg";case"xlsx":return"/icons/XLSX.svg";case"html":return"/icons/HTML.svg";default:return"/icons/default.svg"}}},90515:function(e,t,i){"use strict";i.d(t,{Hd:function(){return l},M$:function(){return s},ad:function(){return c},gs:function(){return h},kn:function(){return d}});var r=i(96115),n=i(76356),o=i(20796);function a(e){return e?e.replace(/\[/g,"").replace(/\]/g,"").replace(/\*/g,"").replace(/_/g,"").replace(/`/g,"").replace(/\|/g,"").replace(/>/g,"").replace(/</g,"").replace(/\(/g,"").replace(/\)/g,"").replace(/#/g,"").replace(/\+/g,"").replace(/-/g,"").replace(/!/g,""):e}function s(e){return e.replace(/(:sourceButton{([^}]+)})/g,(e,t,i)=>{var o,s,l,d,c,h;let{sourcesId:u}=i?(0,n.Dy)(i):{};return u?(null===(h=r.Z.getState().noteData)||void 0===h?void 0:null===(c=h.other.sources.find(e=>e.id===u))||void 0===c?void 0:null===(d=c.sourceList)||void 0===d?void 0:null===(l=d.map((e,t)=>"".concat(t+1,". [").concat(a(e.title),"](").concat(e.link,") \n")))||void 0===l?void 0:l.join("\n"))||"":(null===(s=r.Z.getState().noteData)||void 0===s?void 0:null===(o=s.other.sources.map((e,t)=>" [".concat(t+1,".").concat(a(e.title),"](").concat(e.link,")")))||void 0===o?void 0:o.join("\n"))||""})}function l(e){return e?null==e?void 0:e.replace(/<button(?:\s+sourcesid="([^"]*)")?\s+count="([^"]+)"[^>]*><\/button>/g,(e,t,i)=>{var n;let o=null===(n=r.Z.getState().noteData)||void 0===n?void 0:n.other.sources;if(!o)return"";if(!t)return o?o.slice(0,parseInt(i)).map((e,t)=>{let i=a(e.title),r=e.link;return"<div>".concat(t+1,'.<a href="').concat(r,'" target="_blank"> ').concat(i,"</a></div>")}).join("\n"):"";let s=o.find(e=>e.id===t);return(null==s?void 0:s.sourceList)?s.sourceList.slice(0,parseInt(i)).map((e,t)=>{let i=a(e.title),r=e.link;return"<div>".concat(t+1,'.<a href="').concat(r,'" target="_blank"> ').concat(i,"</a></div>")}).join("\n"):""}):e}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600,i=new DOMParser().parseFromString(e,"text/html");return Array.from(i.getElementsByTagName("img")).forEach(e=>{let i=null,r=e.style.width;r&&(i=parseInt(r));let n=e.getAttribute("width");!i&&n&&(i=parseInt(n)),i&&i>t&&e.setAttribute("width",t.toString())}),i.body.innerHTML}async function c(e,t,i,r){let n=!1,o=Array.from(e.matchAll(/```felo-images\n([\s\S]*?)```/g));return(await Promise.all(o.map(async e=>{let[o,a]=e;try{let e=JSON.parse(a.replace(/[\n\r\s]+/g," ").trim());if(!(null==e?void 0:e.content))return{match:o,replacement:o};let d=await i(e.content||""),c=t[d];if(c){var s,l;n=!0;let e=null===(l=c.images)||void 0===l?void 0:null===(s=l.find(e=>"png"===e.type))||void 0===s?void 0:s.path;return(e=r(null==e?void 0:e.split("?")[0])).searchParams.set("thread_id","thread_".concat(d)),e.searchParams.set("message_id",d),e.searchParams.set("smart_art_id",c.smart_art_id),{match:o,replacement:"![".concat(c.title||"image","](").concat(e,")")}}return{match:o,replacement:o}}catch(e){return{match:o,replacement:o}}}))).forEach(t=>{let{match:i,replacement:r}=t;e=e.replace(i,r)}),{markdown:e,hasReplacement:n}}async function h(e){let t=[...e.matchAll(/!\[.*?\]\((.*?)\)/g)].map(e=>e[1]),i=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(r=>{let n=new window.Image;e=(0,o.OT)(e),e=(0,o.JK)(e),n.onload=()=>r({url:e,ok:!0}),n.onerror=async()=>{if(t)r({url:e,ok:!1});else{let t=(0,o.YA)(e);(await i(t,!0)).ok?r({url:e,ok:!0,proxyUrl:t}):r({url:e,ok:!1})}},n.src=e})},r=await Promise.all(t.map(e=>i(e))),n=!1;return r.forEach(t=>{let{url:i,ok:r,proxyUrl:o}=t;r?o&&(n=!0,e=e.replace(RegExp("!\\[.*?\\]\\(".concat(i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),e=>e.replace(i,o))):(n=!0,e=e.replace(RegExp("!\\[.*?\\]\\(".concat(i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),""))}),{markdown:e,hasReplacement:n}}},11920:function(e,t,i){"use strict";i.d(t,{F:function(){return n},l:function(){return o}});var r=i(37201);async function n(e){let{title:t,imageUrl:i,onProgress:n=()=>{},onError:o=()=>{},onComplete:a=()=>{},scale:s=2,quality:l=1,pageMargin:d=.8}=e;try{n("Downloading image...");let e=await fetch(i),o=await e.blob(),c=new Image;await new Promise((e,t)=>{c.onload=e,c.onerror=t,c.src=URL.createObjectURL(o)}),n("Processing image...");let h=document.createElement("canvas");h.width=c.width*s,h.height=c.height*s;let u=h.getContext("2d");if(!u)throw Error("Failed to get canvas context");u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",u.scale(s,s),u.drawImage(c,0,0);let p=h.toDataURL("image/png",l);n("Creating PDF...");let m=new r.ZP({orientation:c.width>c.height?"landscape":"portrait",unit:"pt",format:"a4"}),g=m.internal.pageSize.getWidth(),f=m.internal.pageSize.getHeight(),v=g*d,y=c.height/c.width*v;y>f*d&&(y=f*d,v=c.width/c.height*y);let b=(g-v)/2,w=(f-y)/2;return m.addImage(p,"PNG",b,w,v,y),m.save("".concat(t,".pdf")),a(),!0}catch(e){return o(e),!1}}async function o(e,t){try{let i=await fetch(e),r=await i.blob(),n=window.URL.createObjectURL(r),o=document.createElement("a");return o.href=n,o.download=t,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(n),document.body.removeChild(o),!0}catch(e){return console.error("Download failed:",e),!1}}},62033:function(e,t,i){"use strict";i.d(t,{f:function(){return l}});var r=JSON.parse('{"attachment":{"clickToDownload":"Click to download","noAttachment":"There is no attachment"},"bookmark":{"noBookmark":"There is no bookmark"},"core":{"askingPassword":{"requirePasswordToOpen":"This document requires a password to open","submit":"Submit"},"wrongPassword":{"submit":"Submit","tryAgain":"The password is wrong. Please try again"},"pageLabel":"Page {{pageIndex}}"},"defaultLayout":{"attachment":"Attachment","bookmark":"Bookmark","thumbnail":"Thumbnail"},"download":{"download":"Download"},"drop":{"dragDropFile":"Drag and drop a PDF document here"},"fullScreen":{"enterFullScreen":"Full screen","exitFullScreen":"Exit full screen"},"localeSwitcher":{"switchLocale":"Switch locale"},"open":{"openFile":"Open file"},"pageNavigation":{"enterPageNumber":"Enter a page number","goToFirstPage":"First page","goToLastPage":"Last page","goToNextPage":"Next page","goToPreviousPage":"Previous page"},"print":{"cancel":"Cancel","preparingDocument":"Preparing document ...","print":"Print"},"properties":{"author":"Author","close":"Close","creationDate":"Creation date","creator":"Creator","fileName":"File name","fileSize":"File size","keywords":"Keywords","modificationDate":"Modification date","pageCount":"Page count","pdfProducer":"PDF producer","pdfVersion":"PDF version","showProperties":"Show properties","subject":"Subject","title":"Title"},"rotate":{"rotateBackward":"Rotate counterclockwise","rotateForward":"Rotate clockwise"},"scrollMode":{"pageScrolling":"Page scrolling","horizontalScrolling":"Horizontal scrolling","verticalScrolling":"Vertical scrolling","wrappedScrolling":"Wrapped scrolling","singlePage":"Single Page","dualPage":"Dual Page","dualPageCover":"Dual page with cover"},"search":{"close":"Close","enterToSearch":"Enter to search","matchCase":"Match case","nextMatch":"Next match","previousMatch":"Previous match","search":"Search","wholeWords":"Whole words"},"selectionMode":{"handTool":"Hand tool","textSelectionTool":"Text selection tool"},"theme":{"switchDarkTheme":"Switch to the dark theme","switchLightTheme":"Switch to the light theme"},"thumbnail":{"thumbnailLabel":"Thumbnail of page {{pageIndex}}"},"toolbar":{"moreActions":"More actions"},"zoom":{"actualSize":"Actual size","pageFit":"Page fit","pageWidth":"Page width","zoomDocument":"Zoom document","zoomIn":"Zoom in","zoomOut":"Zoom out"}}'),n=JSON.parse('{"attachment":{"clickToDownload":"","noAttachment":""},"bookmark":{"noBookmark":""},"core":{"askingPassword":{"requirePasswordToOpen":"","submit":""},"wrongPassword":{"submit":"","tryAgain":" "},"pageLabel":" {{pageIndex}}"},"defaultLayout":{"attachment":"","bookmark":"","thumbnail":""},"download":{"download":""},"drop":{"dragDropFile":"PDF&"},"fullScreen":{"enterFullScreen":"","exitFullScreen":""},"localeSwitcher":{"switchLocale":""},"open":{"openFile":""},"pageNavigation":{"enterPageNumber":"","goToFirstPage":"","goToLastPage":"","goToNextPage":"","goToPreviousPage":""},"print":{"cancel":"","preparingDocument":"..","print":""},"properties":{"author":"","close":"","creationDate":"","creator":"","fileName":"","fileSize":"","keywords":"","modificationDate":"","pageCount":"","pdfProducer":"PDF","pdfVersion":"PDF","showProperties":"","subject":"","title":""},"rotate":{"rotateBackward":"","rotateForward":""},"scrollMode":{"pageScrolling":"","horizontalScrolling":"","verticalScrolling":"","wrappedScrolling":"","singlePage":"","dualPage":"","dualPageCover":""},"search":{"close":"","enterToSearch":"","matchCase":"","nextMatch":"","previousMatch":"","search":"","wholeWords":""},"selectionMode":{"handTool":"","textSelectionTool":""},"theme":{"switchDarkTheme":"","switchLightTheme":""},"thumbnail":{"thumbnailLabel":" {{pageIndex}}"},"toolbar":{"moreActions":""},"zoom":{"actualSize":"","pageFit":"","pageWidth":"","zoomDocument":"","zoomIn":"","zoomOut":""}}'),o=JSON.parse('{"attachment":{"clickToDownload":" ","noAttachment":"  "},"bookmark":{"noBookmark":" "},"core":{"askingPassword":{"requirePasswordToOpen":"    ","submit":""},"wrongPassword":{"submit":"","tryAgain":" .  "},"pageLabel":" {{pageIndex}}"},"defaultLayout":{"attachment":"","bookmark":"","thumbnail":""},"download":{"download":""},"drop":{"dragDropFile":"PDF   "},"fullScreen":{"enterFullScreen":" ","exitFullScreen":"  "},"localeSwitcher":{"switchLocale":" "},"open":{"openFile":" "},"pageNavigation":{"enterPageNumber":"  ","goToFirstPage":" ","goToLastPage":" ","goToNextPage":" ","goToPreviousPage":" "},"print":{"cancel":"","preparingDocument":"  ...","print":""},"properties":{"author":"","close":"","creationDate":" ","creator":"","fileName":" ","fileSize":" ","keywords":"","modificationDate":" ","pageCount":" ","pdfProducer":"PDF ","pdfVersion":"PDF ","showProperties":" ","subject":"","title":""},"rotate":{"rotateBackward":"  ","rotateForward":"  "},"scrollMode":{"pageScrolling":" ","horizontalScrolling":" ","verticalScrolling":" ","wrappedScrolling":" ","singlePage":" ","dualPage":" ","dualPageCover":"   "},"search":{"close":"","enterToSearch":" ","matchCase":"/ ","nextMatch":" ","previousMatch":" ","search":"","wholeWords":" "},"selectionMode":{"handTool":" ","textSelectionTool":" "},"theme":{"switchDarkTheme":"  ","switchLightTheme":"  "},"thumbnail":{"thumbnailLabel":"  {{pageIndex}}"},"toolbar":{"moreActions":" "},"zoom":{"actualSize":" ","pageFit":" ","pageWidth":" ","zoomDocument":" /","zoomIn":"","zoomOut":""}}'),a=JSON.parse('{"attachment":{"clickToDownload":"  ","noAttachment":" "},"bookmark":{"noBookmark":" "},"core":{"askingPassword":{"requirePasswordToOpen":"     ","submit":""},"wrongPassword":{"submit":"","tryAgain":" . ,  "},"pageLabel":" {{pageIndex}}"},"defaultLayout":{"attachment":"","bookmark":"","thumbnail":""},"download":{"download":""},"drop":{"dragDropFile":" PDF- "},"fullScreen":{"enterFullScreen":" ","exitFullScreen":"   "},"localeSwitcher":{"switchLocale":" "},"open":{"openFile":" "},"pageNavigation":{"enterPageNumber":"  ","goToFirstPage":" ","goToLastPage":" ","goToNextPage":" ","goToPreviousPage":" "},"print":{"cancel":"","preparingDocument":" ...","print":""},"properties":{"author":"","close":"","creationDate":" ","creator":"","fileName":" ","fileSize":" ","keywords":" ","modificationDate":" ","pageCount":" ","pdfProducer":" ","pdfVersion":" PDF","showProperties":" ","subject":"","title":""},"rotate":{"rotateBackward":"   ","rotateForward":"   "},"scrollMode":{"pageScrolling":" ","horizontalScrolling":" ","verticalScrolling":" ","wrappedScrolling":" ","singlePage":" ","dualPage":" ","dualPageCover":"   "},"search":{"close":"","enterToSearch":"  ","matchCase":" ","nextMatch":" ","previousMatch":" ","search":"","wholeWords":"  "},"selectionMode":{"handTool":" \\"\\"","textSelectionTool":"  "},"theme":{"switchDarkTheme":"   ","switchLightTheme":"   "},"thumbnail":{"thumbnailLabel":"  {{pageIndex}}"},"toolbar":{"moreActions":" "},"zoom":{"actualSize":" ","pageFit":"  ","pageWidth":"  ","zoomDocument":" ","zoomIn":"","zoomOut":""}}'),s=JSON.parse('{"attachment":{"clickToDownload":"","noAttachment":""},"bookmark":{"noBookmark":""},"core":{"askingPassword":{"requirePasswordToOpen":"","submit":""},"wrongPassword":{"submit":"","tryAgain":""},"pageLabel":" {{pageIndex}}"},"defaultLayout":{"attachment":"","bookmark":"","thumbnail":""},"download":{"download":""},"drop":{"dragDropFile":" PDF "},"fullScreen":{"enterFullScreen":"","exitFullScreen":""},"localeSwitcher":{"switchLocale":""},"open":{"openFile":""},"pageNavigation":{"enterPageNumber":"","goToFirstPage":"","goToLastPage":"","goToNextPage":"","goToPreviousPage":""},"print":{"cancel":"","preparingDocument":"...","print":""},"properties":{"author":"","close":"","creationDate":"","creator":"","fileName":"","fileSize":"","keywords":"","modificationDate":"","pageCount":"","pdfProducer":"PDF","pdfVersion":"PDF","showProperties":"","subject":"","title":""},"rotate":{"rotateBackward":"","rotateForward":""},"scrollMode":{"pageScrolling":"","horizontalScrolling":"","verticalScrolling":"","wrappedScrolling":"","singlePage":"","dualPage":"","dualPageCover":""},"search":{"close":"","enterToSearch":"","matchCase":"","nextMatch":"","previousMatch":"","search":"","wholeWords":""},"selectionMode":{"handTool":"","textSelectionTool":""},"theme":{"switchDarkTheme":"","switchLightTheme":""},"thumbnail":{"thumbnailLabel":" {{pageIndex}}"},"toolbar":{"moreActions":""},"zoom":{"actualSize":"","pageFit":"","pageWidth":"","zoomDocument":"","zoomIn":"","zoomOut":""}}');let l={en:r,ja:n,ko:o,ru:a,"zh-Hans":JSON.parse('{"attachment":{"clickToDownload":"","noAttachment":""},"bookmark":{"noBookmark":""},"core":{"askingPassword":{"requirePasswordToOpen":"","submit":""},"wrongPassword":{"submit":"","tryAgain":""},"pageLabel":" {{pageIndex}}"},"defaultLayout":{"attachment":"","bookmark":"","thumbnail":""},"download":{"download":""},"drop":{"dragDropFile":" PDF "},"fullScreen":{"enterFullScreen":"","exitFullScreen":""},"localeSwitcher":{"switchLocale":""},"open":{"openFile":""},"pageNavigation":{"enterPageNumber":"","goToFirstPage":"","goToLastPage":"","goToNextPage":"","goToPreviousPage":""},"print":{"cancel":"","preparingDocument":"...","print":""},"properties":{"author":"","close":"","creationDate":"","creator":"","fileName":"","fileSize":"","keywords":"","modificationDate":"","pageCount":"","pdfProducer":"PDF","pdfVersion":"PDF","showProperties":"","subject":"","title":""},"rotate":{"rotateBackward":"","rotateForward":""},"scrollMode":{"pageScrolling":"","horizontalScrolling":"","verticalScrolling":"","wrappedScrolling":"","singlePage":"","dualPage":"","dualPageCover":""},"search":{"close":"","enterToSearch":"","matchCase":"","nextMatch":"","previousMatch":"","search":"","wholeWords":""},"selectionMode":{"handTool":"","textSelectionTool":""},"theme":{"switchDarkTheme":"","switchLightTheme":""},"thumbnail":{"thumbnailLabel":" {{pageIndex}}"},"toolbar":{"moreActions":""},"zoom":{"actualSize":"","pageFit":"","pageWidth":"","zoomDocument":"","zoomIn":"","zoomOut":""}}'),"zh-Hant":s}},49905:function(e,t,i){"use strict";i.d(t,{ge:function(){return S},w0:function(){return b},R6:function(){return x},mj:function(){return M},SG:function(){return w},eX:function(){return _}});var r=i(51982),n=i.n(r),o=i(65819),a=i(75284),s=i(57606);class l{construct_url(){let e=this.url+"?";for(let[t,i]of Object.entries(this.data))e=Array.isArray(i)?e+"dt="+i.join("&dt=")+"&":e+t+"="+i+"&";return e.slice(0,-1),e}uo(e,t){for(let i=0;i<t.length-2;i+=3){let r=t.charAt(i+2),n="a"<=r?r.charCodeAt(0)-87:Number(r);n="+"==t.charAt(i+1)?e>>>n:e<<n,e="+"==t.charAt(i)?e+n&4294967295:e^n}return e}wo(e,t){let i=t.split("."),r=Number(i[0]),n=[];for(let t=0,i=0;i<e.length;i++){let r=e.charCodeAt(i);128>r?n[t++]=r:(2048>r?n[t++]=r>>6|192:(55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),n[t++]=r>>18|240,n[t++]=r>>12&63|128):n[t++]=r>>12|224,n[t++]=r>>6&63|128),n[t++]=63&r|128)}let o=r;for(let e=0;e<n.length;e++)o+=n[e],o=this.uo(o,"+-a^+6");return 0>(o=this.uo(o,"+-3^+b+-f")^(Number(i[1])||0))&&(o=(2147483647&o)+2147483648),(o%=1e6).toString()+"."+(o^r)}async query(e,t,i){this.data.tk=this.wo(e,this.TKK),this.data.tl=t,this.data.sl=i||this.data.sl;let r=new AbortController,n=setTimeout(()=>r.abort(),2e4),o=this.construct_url(),a=await fetch(o,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"q=".concat(encodeURIComponent(e)),signal:r.signal});if(clearTimeout(n),200===a.status){let e=await a.json();return(Array.isArray(e[0])?e[0][0]:e[0]).replaceAll(/<i>(.|\s)*?<\/i>/g,"").replaceAll(/<\/?b>/g,"")}{let{status:e,statusText:t}=a;throw Error(JSON.stringify({status:e,statusText:t}))}}async queryArr(e,t,i){let r=new AbortController,n=setTimeout(()=>r.abort(),2e4),o=await fetch("https://translate.googleapis.com/translate_a/single?"+new URLSearchParams({client:"gtx",dt:"t",sl:i||"auto",tl:t,q:e.join("\n")}).toString(),{signal:r.signal});if(clearTimeout(n),200===o.status){let e=await o.json();return Array.isArray(e[0])?e[0].map(e=>e[0].replaceAll(/<i>(.|\s)*?<\/i>/g,"").replaceAll(/<\/?b>/g,"")):[]}{let{status:e,statusText:t}=o;throw Error(JSON.stringify({status:e,statusText:t}))}}async queryArrWithOriginal(e,t,i){let r=[];try{let n=[],o=0;for(let a of e){let e=encodeURIComponent(a);if(o+e.length>15e3){let s=await this.fetchTranslations(n,t,i);r.push(...s),n=[a],o=e.length}else n.push(a),o+=e.length}if(n.length>0){let e=await this.fetchTranslations(n,t,i);r.push(...e)}return r}catch(e){return console.log("error",e),[]}}async fetchTranslations(e,t,i){let r=new AbortController,n=setTimeout(()=>r.abort(),2e4),o=await fetch("https://translate.googleapis.com/translate_a/single?"+new URLSearchParams({client:"gtx",dt:"t",sl:i||"auto",tl:t,q:e.join("\n\n\n\n\n")}).toString(),{signal:r.signal});if(clearTimeout(n),200===o.status){let e=await o.json(),t=Array.isArray(e[0])?e[0].map(e=>({original:e[1],translated:e[0].replace(/<i>[\s\S]*?<\/i>|<\/?b>/g,"")})):[],i=t.map(e=>e.translated).join(""),r=t.map(e=>e.original).join(""),n=i.split("\n\n\n\n\n"),a=r.split("\n\n\n\n\n");return n.map((e,t)=>({original:a[t],translated:e}))}{let{status:e,statusText:t}=o;throw Error(JSON.stringify({status:e,statusText:t}))}}constructor(){this.url="https://translate.googleapis.com/translate_a/t",this.TKK="448487.932609646",this.data={anno:"3",client:"te",v:"1.0",format:"html",sl:"auto",tl:"",tk:""}}}var d=i(29864),c=i(11782);let h=new String(""),u=new String("");function p(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var m=i(78017);let g=[],f=0,v=()=>{if(!(f>=3)&&0!==g.length)for(;f<3&&g.length>0;){f++;let e=g.shift(),t=async()=>{try{let t=await new l().queryArrWithOriginal(Array.isArray(e.text)?e.text:[e.text],e.lang,e.sourceLanguage);e.resolve(t)}catch(t){e.reject(t)}finally{f--,v()}};"undefined"!=typeof requestIdleCallback?requestIdleCallback(t):setTimeout(t,0)}},y=async(e,t)=>{if(!e)return[];let i=b();return new Promise((r,n)=>{g.push({text:e,lang:i,sourceLanguage:t,resolve:r,reject:n}),v()})},b=()=>{let e=o.ZP.getState().userInfo.language;return"auto"===e?(0,a.v0)()||"":e||(0,a.v0)()||""},w=(e,t,i)=>{let r=e=>{let t=(0,d.P)(e,{only:c.HQ});return"cmn"===t&&"traditional"===function(e){let t={inputLength:e.length,simplifiedCharacters:0,traditionalCharacters:0};for(let i=0;i<e.length;i++){let r=e.charAt(i);new RegExp(p(r)).test(h)&&t.simplifiedCharacters++,new RegExp(p(r)).test(u)&&t.traditionalCharacters++}return t.simplifiedCharacters>t.traditionalCharacters?(t.detectedCharacters="simplified",t.detectionRate=Math.floor(t.simplifiedCharacters/t.traditionalCharacters)||1):t.simplifiedCharacters<t.traditionalCharacters?(t.detectedCharacters="traditional",t.detectionRate=Math.floor(t.traditionalCharacters/t.simplifiedCharacters)||1):(t.detectedCharacters="unknown",t.detectionRate=0),t}(e).detectedCharacters&&(t="cmt"),c.HQ.includes(t)?c.Ph[t]:""},n=r(e),o=r(t);return(n!==i||o!==i)&&(n!==i?n:o)},k=(e,t)=>n().compareTwoStrings(e,t)>.85,x=async(e,t,i,r,n,o)=>{let a=w(e,t,n);if(!a)return null;try{let n=Promise.all([y(e,a),y(t.split("\n"),a)]),l=new Promise((e,t)=>setTimeout(()=>t(Error("getTranslate timeout")),15e3)),[d,c]=await Promise.race([n,l]);if(0===d.length||0===c.length)return null;let h=d.map(e=>e.translated).join(""),u=c.map(e=>e.translated).join("\n"),p=k(e,h),m=k(t,u);if(p&&m)return null;s.Z.getState().addSourceOriginalList({id:o,rid:i,link:r,original:c.map(e=>e.original),translated:c.map(e=>e.translated),title:e,translatedTitle:d.map(e=>e.translated).join("\n")})}catch(e){return console.log("Translation error:",e),null}},M=async(e,t)=>{try{let i=b();for(let r of Array.from(new Map(e.map(e=>[e.link,e])).values())){let e="".concat(r.rid,"-").concat(r.link,"-").concat(i);t.find(t=>t.id===e)||await x(r.title,r.snippet,r.rid,r.link,i,e)}}catch(e){console.log("getTranslateContentList error:",e)}},_=e=>{try{if(!e||e.length<=1)return e;let t=[];for(let i=0;i<e.length;i++){let r=e[i],n=t.length>0?t[t.length-1]:null;if("ppt_render"===r.name||"sandbox"===r.name||"mcp"===r.tool_type||r.name===m.ab){t.push(r);continue}if(0===t.length){if(!r.content&&r.params){let e={...r,toolList:[r]};t.push(e)}else t.push(r);continue}if(!r.content&&r.name===n.name&&("image_generation"===r.name||"image_search"===r.name||"ppt_outline_image_search"===r.name)){t[t.length-1]={...n,toolList:[...n.toolList||[n],r]};continue}if("image_generation"===r.name||"image_search"===r.name||"ppt_outline_image_search"===r.name){t.push(r);continue}if(!r.content&&!n.content&&r.params&&n.params&&"image_generation"!==n.name&&"image_search"!==n.name&&"ppt_outline_image_search"!==n.name){t[t.length-1]={...n,toolList:[...n.toolList||[],r]};continue}if(!r.content&&r.params&&n.content){let e={...r,toolList:[r]};t.push(e);continue}t.push(r)}return t}catch(t){return console.error("processTools error:",t),e}},S=e=>{if(!e)return"";try{return new URL(e).hostname}catch(t){return e}}},76983:function(e){e.exports={spinner:"spinner_spinner__c_Sj1",updown:"spinner_updown__1pZcz"}},606:function(){},25210:function(){},21473:function(){},97235:function(){},82605:function(){}}]);