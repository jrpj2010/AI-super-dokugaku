"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8247],{64412:function(e,t,a){a.d(t,{Q:function(){return l}});var s=a(52676),n=a(25568),i=a(4814);let l=e=>{var t;let{fileName:a,w:l,h:r}=e;switch((null===(t=a.split(".").pop())||void 0===t?void 0:t.toLowerCase())||""){case"pdf":return(0,s.jsx)(n.ce,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"doc":return(0,s.jsx)(n.yy,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"docx":return(0,s.jsx)(n.kS,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"xls":return(0,s.jsx)(n.Qk,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"ppt":return(0,s.jsx)(n.PJ,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"txt":return(0,s.jsx)(n.hu,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"xls":return(0,s.jsx)(n.q_,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"xlsx":return(0,s.jsx)(n.$g,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"md":return(0,s.jsx)(n.ep,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});default:return(0,s.jsx)(n.X9,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")})}};t.Z=e=>{var t;let{fileName:a,w:l,h:r}=e;switch((null===(t=a.split(".").pop())||void 0===t?void 0:t.toLowerCase())||""){case"pdf":return(0,s.jsx)(n.X,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"doc":return(0,s.jsx)(n.LV,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"docx":return(0,s.jsx)(n.h_,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"txt":return(0,s.jsx)(n.Ot,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"png":return(0,s.jsx)(n.T3,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"jpg":case"jpeg":return(0,s.jsx)(n.Fc,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"tiff":return(0,s.jsx)(n.Hc,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"gif":return(0,s.jsx)(n.oq,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"webp":return(0,s.jsx)(n.et,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"csv":return(0,s.jsx)(n.u9,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"xls":return(0,s.jsx)(n.n9,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});case"xlsx":return(0,s.jsx)(n.HZ,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")});default:return(0,s.jsx)(n.vU,{className:(0,i.Z)(l?"w-".concat(l):"w-9",r?"h-".concat(r):"h-9")})}}},90488:function(e,t,a){var s=a(52676),n=a(92823),i=a(4814),l=a(8096),r=a(75271),o=a(25568);let d=e=>new Promise(t=>{let a=new window.Image;a.onload=()=>t(!0),a.onerror=()=>t(!1),a.src=e});t.Z=e=>{var t,a,c;let{width:u=16,height:m=16,src:h,title:g=""}=e,[f,p]=(0,r.useState)(!0),{hasHtml:x,...v}=e;if((0,r.useEffect)(()=>{h&&d(h).then(e=>{p(!e)})},[h]),h&&h.includes(".file"))switch((null===(a=g.split(".").pop())||void 0===a?void 0:a.toLowerCase())||""){case"pdf":return(0,s.jsx)(o.X,{width:u,height:m});case"doc":return(0,s.jsx)(o.LV,{width:u,height:m});case"docx":return(0,s.jsx)(o.h_,{width:u,height:m});case"txt":return(0,s.jsx)(o.Ot,{width:u,height:m})}return f||!h?(0,s.jsx)(l.Z,{width:u,height:m,className:(0,i.Z)("inline-block align-top",null===(c=e.classNames)||void 0===c?void 0:c.wrapper,x&&"text-[#8AC5FF]")}):(0,s.jsx)(n.J,{...v,width:u,height:m,alt:"",classNames:{wrapper:(0,i.Z)("inline-block align-top",null===(t=e.classNames)||void 0===t?void 0:t.wrapper)}})}},26894:function(e,t,a){var s=a(52676),n=a(19370),i=a(47649),l=a(8096),r=a(75271),o=a(11782),d=a(7717),c=a(4590);t.Z=e=>{let{language:t,onChangeLanguage:a,hideAutoDetect:u=!1,template:m}=e,h=(0,d.useTranslations)(),g=(0,d.useLocale)(),f=(0,r.useMemo)(()=>{var e,t;return(null==m?void 0:null===(t=m.sub_topics)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.title)=="ppt_generation"?o.g$.filter(e=>c.Po[e.value]):[...o.g$]},[o.g$,m]);return(0,r.useEffect)(()=>{var e,s;(null==m?void 0:null===(s=m.sub_topics)||void 0===s?void 0:null===(e=s[0])||void 0===e?void 0:e.title)!="ppt_generation"||c.Po[t]||a(g||"en")},[m,t]),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[!u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex-none flex items-center justify-center rounded-md border border-input bg-[#F6F7F9] dark:bg-[#454E5D] ring-offset-background file:border-0  file:bg-transparent file:text-sm file:font-medium  file:text-foreground placeholder:text-muted-foreground  focus-visible:outline-none focus-visible:ring-2  focus-visible:ring-ring focus-visible:ring-offset-2  disabled:cursor-not-allowed disabled:opacity-50  md:text-sm cursor-not-allowed w-fit px-3 text-sm h-8",children:h("agent.auto_detect")}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(i.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)(n.Ph,{defaultValue:t,onValueChange:a,children:[(0,s.jsxs)(n.i4,{className:"w-fit gap-2 h-8 bg-[#F6F7F9] dark:bg-[#454E5D]",children:[u&&(0,s.jsx)(l.Z,{className:"w-4 h-4"}),(0,s.jsx)(n.ki,{})]}),(0,s.jsx)(n.Bw,{className:"language-select-dropdown",children:f.map(e=>(0,s.jsx)(n.Ql,{value:e.value,children:e.label},e.value))})]})]})}},96156:function(e,t,a){a.d(t,{Z:function(){return H}});var s=a(52676),n=a(75271),i=a(7717),l=a(96164),r=a(26595),o=a(51054),d=a(26997),c=a(43378),u=a(17224),m=a(31063),h=a(60161),g=a(65105),f=a(37766),p=a(89335),x=a(70262),v=a(84706),w=a(65819),_=a(57546),b=a(4814),j=a(31022),y=a(36551),N=a(38058),Z=a(93071),S=a(6428),E=a(60904),F=a(9369),I=a(59167),k=a(39071),A=a(57207),z=a(25010),C=a(64412),R=a(27976),D=e=>{let{handleClick:t,isMini:a,loading:l,filesList:o,historyFiles:d,threadId:c,disabled:u}=e,m=(0,i.useTranslations)(),{files:h,threadFiles:g,setFiles:p,removeFilesById:x}=(0,f.Z)(),v=e=>{x([e]),c||(0,N.lc)({ids:[e]})},w=(0,n.useCallback)((e,t)=>{var n;return(0,s.jsxs)(z.z,{size:"sm",variant:"ghost",className:(0,b.Z)("h-8 hover:bg-[#EDFAFF] hover:text-primary px-1 gap-1 dark:hover:bg-[#3E536E]",a?"min-w-8 w-8 rounded-full":""),disabled:t,children:[(0,s.jsx)("span",{className:"w-5 h-5 flex items-center justify-center font-medium",children:a?(0,s.jsx)(S.Z,{className:"!w-[18px] !h-[18px]"}):(0,s.jsx)(C.Z,{fileName:e.title})}),a?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"inline-block text-xs truncate flex-1 max-w-20 sm:max-w-24 md:max-w-28 lg:max-w-56 xl:max-w-96",children:[R.r8?"[".concat(null!==(n=null==e?void 0:e.words)&&void 0!==n?n:0,"] "):"",e.title]})," ",(0,s.jsx)("span",{className:"flex items-center justify-center h-4 w-4 min-w-4 min-h-4 text-[#7f94b1] cursor-pointer hover:bg-gray-200  rounded-full text-xs",onClick:t=>{t.preventDefault(),t.stopPropagation(),v(null==e?void 0:e.id)},children:(0,s.jsx)(E.Z,{size:1,className:"scale-75 rounded-full"})})]})]},e.id)},[]);return(0,s.jsxs)(A.J2,{children:[(0,s.jsx)(A.xo,{asChild:!0,children:(null==o?void 0:o.length)===1?w(h[0],l):(0,s.jsxs)(z.z,{size:"sm",variant:"ghost",className:(0,b.Z)("h-8 hover:bg-[#EDFAFF] hover:text-primary px-1 gap-1 dark:hover:bg-[#3E536E]",a?"min-w-8 w-8 rounded-full":""),disabled:l||u,children:[(0,s.jsx)("span",{className:"w-4 h-4 flex items-center justify-center font-medium",children:(0,s.jsx)(S.Z,{className:"!w-[18px] !h-[18px]"})}),a?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"inline-block text-xs truncate flex-1 max-w-20 sm:max-w-24 md:max-w-28 lg:max-w-56 xl:max-w-96",children:m("searchAddition.file_count",{count:(null==o?void 0:o.length)||0})}),(0,s.jsx)(F.Z,{})]})]})}),(0,s.jsx)(A.yk,{className:"p-0 min-w-60 !z-41 rounded-xl border-[#efefef] shadow-lg dark:border-[#222]",children:(0,s.jsxs)("div",{className:"p-0 w-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-1 text-xs py-2.5 px-3 border-b-1 border-[#EBEEF3] dark:border-[#222]",children:[(0,s.jsx)("div",{className:"text-xs font-medium",children:m("searchAddition.addition_file_title")}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,s.jsxs)(z.z,{variant:"ghost",size:"sm",className:(0,b.Z)("mr-2","h-6 px-1 gap-1 min-w-4 font-normal text-xs","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),onClick:t,children:[(0,s.jsx)(I.Z,{size:12,className:"scale-85"}),m("searchAddition.add")]}),c?null:(0,s.jsxs)(z.z,{variant:"ghost",size:"sm",className:(0,b.Z)("h-6 px-1 gap-1 min-w-4 font-normal text-xs","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),onClick:()=>{if(!c){let e=f.Z.getState().homeFiles.map(e=>e.id);(0,N.lc)({ids:e})}p([])},children:[(0,s.jsx)(k.Z,{size:12,className:"scale-85"}),m("searchAddition.remove")]})]})]}),(0,s.jsx)("div",{className:"px-2 py-3",children:o.concat(d).map(e=>{var t;let a=null==d?void 0:d.some(t=>t.id===e.id);return(0,s.jsxs)("div",{className:(0,b.Z)("flex items-center justify-between gap-1 text-xs py-1.5 text-gray-500 px-1 rounded","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-4 h-4 flex items-center justify-center font-medium",children:(0,s.jsx)(C.Z,{fileName:e.title})}),(0,s.jsxs)(Z.O,{className:(0,b.Z)("inline-block text-xs truncate flex-1 max-w-48"),size:"sm",isDisabled:a,children:[R.r8?"[".concat(null!==(t=null==e?void 0:e.words)&&void 0!==t?t:0,"] "):"",e.title]})]}),!a&&(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(r.A,{variant:"light",className:"m-0 p-0 h-4 w-4 min-w-4 min-h-4 text-[#7f94b1]",size:"sm",isIconOnly:!0,startContent:(0,s.jsx)(E.Z,{size:12}),onPress:()=>v(e.id)})})]},e.id)})})]})})]})},P=a(97247),T=a(41223),O=a(74926),L=a(39109),U=a(78236),M=a(88708);let V=(0,n.forwardRef)((e,t)=>{var a,Z;let{isMini:S,threadId:E,loading:F,type:I,mode:k,historyFiles:A,disabled:z,template:C,isUseFileNewEngine:R=!1}=e,V=(0,i.useTranslations)(),H=(0,u.useRouter)(),B=(0,g.WI)(),$=(0,L.Z)(),{homeFiles:G,setHomeFiles:J,files:Q,setFiles:W,isUploading:Y,setIsUploading:q,threadFiles:X,currentFileProgress:K,setCurrentFileProgress:ee,previousSearchCategory:et,setPreviousSearchCategory:ea,homeImages:es,isImageUploading:en,setNThUpload:ei}=(0,f.Z)(),el=(0,w.ZP)(e=>e.isLogin),er=(0,g.P2)(),eo=(0,g.Oi)("chatDocumentsUsage"),[ed,ec]=(0,n.useState)(!1),[eu,em]=(0,n.useState)(!1),eh=(0,n.useRef)(null),[eg,ef]=(0,n.useState)(!0),ep=()=>"home"===I?f.Z.getState().homeFiles:f.Z.getState().files,ex=(0,n.useMemo)(()=>"home"===I?f.Z.getState().homeFiles:f.Z.getState().files,[I,Q,G]),ev=(0,n.useMemo)(()=>eo?x.Mr:x.CD,[eo]),ew=(0,n.useMemo)(()=>{if(!eo){var e,t;return(null!==(t=null==er?void 0:null===(e=er.chatDocumentsUsage)||void 0===e?void 0:e.balance)&&void 0!==t?t:0)<=0}return!1},[null==er?void 0:er.chatDocumentsUsage,eo]),e_=()=>{var e,t;return"home"===I?(null===(e=f.Z.getState().homeFiles)||void 0===e?void 0:e.length)||0:(null===(t=f.Z.getState().files)||void 0===t?void 0:t.length)||0},eb=e=>{let{type:t}=e,a="home"===t?f.Z.getState().homeFiles:f.Z.getState().files,s=f.Z.getState().threadFiles;return Array.from(new Set([...(E?(null==a?void 0:a.filter(e=>(null==e?void 0:e.threadId)===E))||[]:(null==a?void 0:a.filter(e=>!(null==e?void 0:e.threadId)))||[]).map(e=>null==e?void 0:e.id),...(E&&(null==s?void 0:s.filter(e=>(null==e?void 0:e.threadId)===E))||[]).map(e=>null==e?void 0:e.id)]))},ej=(0,n.useMemo)(()=>{var e;return((null===(e=eb({type:I}))||void 0===e?void 0:e.length)||0)+((null==A?void 0:A.length)||0)>ev},[ev,null==A?void 0:A.length]),ey=(0,n.useMemo)(()=>B?x.fc:x.r0,[B]),eN=(0,n.useMemo)(()=>{let e="home"===I?G||[]:Q||[],t=E&&(null==X?void 0:X.filter(e=>(null==e?void 0:e.threadId)===E))||[];return Array.from(new Set([...e,...t].map(e=>e.id))).map(a=>[...e,...t].find(e=>e.id===a)).reduce((e,t)=>{var a;return e+(null!==(a=null==t?void 0:t.words)&&void 0!==a?a:0)},0)>ey},[I,G,Q,E,X,ey]),eZ=(0,n.useMemo)(()=>B?V("searchAddition.max_words"):V("searchAddition.max_words_free"),[B]),eS=()=>{j.Z.getState().setExtensionSelected(et||y.gl),ea(null)},eE=e=>["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain"].includes(e.type)?e.size>26214400?($.default(V("searchAddition.size_limit_exceeded_tip",{size:25,pages:500})),(null==Q?void 0:Q.length)||eS(),!1):eN?($.default(V("searchAddition.thread_words_limit_exceeded_tip",{words:eZ})),(null==Q?void 0:Q.length)||eS(),!1):!ej||(B||v.$.publish("showSubscriptionPlan",void 0),$.default(V("searchAddition.thread_upload_limit_exceeded_tip",{count:ev})),!1):($.default(V("topic.error_file_type_not_supported")),(null==Q?void 0:Q.length)||eS(),!1),eF=e=>{var t;let a=null!==(t=f.Z.getState().currentFileProgress)&&void 0!==t?t:0,s=setInterval(()=>{var t,n;let i=ep();a=(null!==(n=null===(t=i.find(t=>t.id===e))||void 0===t?void 0:t.progress)&&void 0!==n?n:a)+(1.9*Math.random()+.1),"home"===I?J(i.map(t=>t.id===e?{...t,progress:Math.min(a,95),status:"analyzing"}:t)):W(i.map(t=>t.id===e?{...t,progress:Math.min(a,95),status:"analyzing"}:t)),a>=95&&clearInterval(s)},800);return s},eI=async e=>{var t,a,s,n,i;if(Y)return;if(ew){v.$.publish("showSubscriptionPlan",void 0);return}if(ej)return;let l=null===(t=eb({type:I}))||void 0===t?void 0:t.length;if((null!==(a=null==e?void 0:e.length)&&void 0!==a?a:0)+l>ev){if(!B){v.$.publish("showSubscriptionPlan",void 0);return}$.default(V("searchAddition.thread_upload_limit_exceeded_tip",{count:ev}));return}ei((null!==(s=f.Z.getState().nThUpload)&&void 0!==s?s:0)+1);let r=Array.from(e);q(!0),j.Z.getState().setExtensionSelected(y.J5);let o=[];for(let[e,t]of Array.from(r).entries()){o.push(e);let a=ep(),s=null!==(n=f.Z.getState().nThUpload)&&void 0!==n?n:0,i="".concat(s,"_").concat(e),l=[{id:i,title:t.name,size:(0,x.sS)(t.size),token:0,pages:0,progress:0,status:"uploading",type:t.type,created_at:new Date().toISOString(),modified_at:new Date().toISOString(),length:0,words:0,threadId:E||"",tempId:i}];"home"===I&&J([...l,...a])}let d=new Map;for(let[e,t]of Array.from(r).entries()){let a=null!==(i=f.Z.getState().nThUpload)&&void 0!==i?i:0,s="".concat(a,"_").concat(e);q(!0),ee(0);try{if(await (0,N.Wl)()){if(B?$.default(V("searchAddition.upload_limit_exceeded_tip")):v.$.publish("showSubscriptionPlan",void 0),q(!1),ee(0),"home"===I){let e=ep();J((0,x._n)({files:e,tempId:s}))}continue}}catch(e){if($.default(V("server.INTERNAL_SERVER_ERROR")),q(!1),ee(0),"home"===I){let e=ep();J((0,x._n)({files:e,tempId:s}))}continue}new FormData().append("file",t);let n="";if(!eE(t)){if("home"===I){let e=ep();J((0,x._n)({files:e,tempId:s}))}q(!1),ee(0);continue}(0,m.fk)(h.U.SEAECH_FILE,{fileName:t.name},!0),q(!0);let l=(0,x.ct)(0,e=>{if(ee(null!=e?e:0),"home"===I){let t=ep();J((0,x._n)({files:t,tempId:s})),J(t.map(t=>t.tempId===s?{...t,progress:e}:t))}});"1"!==(0,x.y6)()&&(ec(!0),(0,x.ny)());try{d.set(t.name,!0),await (0,p.Vj)({file:t,threadId:E||"",queryParams:"application/pdf"===t.type&&R?{from:"agent"}:void 0,onProgress:a=>{if(n||(n=a.file_id),!d.has(n)){var s,i;let l=null!==(s=f.Z.getState().nThUpload)&&void 0!==s?s:0,r=ep(),o="home"===I?r.map(t=>t.tempId==="".concat(l,"_").concat(e)?{...t,id:n}:t):[{id:n,title:t.name,size:(0,x.sS)(t.size),token:0,pages:0,progress:null!==(i=f.Z.getState().currentFileProgress)&&void 0!==i?i:0,status:"uploading",type:t.type,created_at:new Date().toISOString(),modified_at:new Date().toISOString(),length:(null==a?void 0:a.length)||0,words:(null==a?void 0:a.words)||0,threadId:E||""}];"home"===I?J([...o]):W([...o,...r]);let c=eF(n);d.set(n,c),d.delete(t.name)}},onDone:e=>{if(l(),d.has(n)&&(clearInterval(d.get(n)),d.delete(n)),(null==e?void 0:e.status)==="SUCCESS"){var t;let a=ep(),s=a.reduce((e,t)=>{var a;return e+(null!==(a=null==t?void 0:t.words)&&void 0!==a?a:0)},0);if(eN||s+(null!==(t=null==e?void 0:e.words)&&void 0!==t?t:0)>ey){if($.default(V("searchAddition.thread_words_limit_exceeded_tip",{words:eZ})),"home"===I){let e=ep();J((0,x.mF)({files:e,id:n}))}else W([...(0,x.mF)({files:a,id:n})]);q(!1);return}"home"===I?J(a.map(t=>t.id===n?{...t,progress:100,words:(null==e?void 0:e.words)||0,pages:(null==e?void 0:e.page_count)||0,status:"completed"}:t)):W(a.map(t=>t.id===n?{...t,progress:100,words:(null==e?void 0:e.words)||0,pages:(null==e?void 0:e.page_count)||0,status:"completed"}:t)),q(!1);return}(null==e?void 0:e.status)==="PAGE_OVER_SIZE"?$.default(V("searchAddition.page_limit_exceeded_tip",{pages:"500"})):$.default(V("server.INTERNAL_SERVER_ERROR"));let a=ep();if("home"===I){let e=ep();J((0,x.mF)({files:e,id:n}))}else W([...(0,x.mF)({files:a,id:n})]);q(!1),ee(0)},onError:e=>{"402"!==e&&$.default(V("server.INTERNAL_SERVER_ERROR")),l(),d.delete(t.name),0===d.size&&q(!1);let a=ep();if("home"===I){let e=ep(),t=(0,x.mF)({files:e,id:n,tempId:s});J(t)}else W([...(0,x.mF)({files:a,id:n,tempId:s})]);ee(0)}})}catch(t){l(),$.default(V("server.INTERNAL_SERVER_ERROR")),q(!1),ee(0);let e=ep();if("home"===I){let e=ep();J((0,x.mF)({files:e,id:n}))}else W([...(0,x.mF)({files:e,id:n})])}}e_()||(ee(0),eS())};(0,n.useImperativeHandle)(t,()=>({handleFiles:eI}));let ek=()=>{var e;if((0,T.s2)()){em(!0);return}if(!el){_.Z.getState().setLoginModalVisible(!0);return}if(ew){v.$.publish("showSubscriptionPlan",void 0);return}let t=((null==A?void 0:A.length)||0)+Q.length;if(ej||t>=ev){B||v.$.publish("showSubscriptionPlan",void 0),$.default(V("searchAddition.thread_upload_limit_exceeded_tip",{count:ev}));return}null===(e=eh.current)||void 0===e||e.click()};return(0,n.useEffect)(()=>{let e=O.Z.getState().template,t=!!e&&(0,M.uI)(e);((null==ex?void 0:ex.length)||(null==es?void 0:es.length))&&!t&&(O.Z.getState().clearTemplate(),et===y.Wh&&ea(null)),(null==ex?void 0:ex.length)?j.Z.getState().setExtensionSelected(y.J5):(null==es?void 0:es.length)?j.Z.getState().setExtensionSelected(y.Ys):eg||eS(),ef(!1)},[ex.length,G.length,Q.length,es.length]),(0,n.useEffect)(()=>{let e=e=>{(async()=>{try{await Promise.all([f.Z.getState().setFiles([]),f.Z.getState().setHomeFiles([]),f.Z.getState().setHomeImages([]),f.Z.getState().setIsGoToSearch(!1),f.Z.getState().setHomeImagesQustions([]),U.Z.getState().setFiles([]),U.Z.getState().setHomeFiles([]),U.Z.getState().setHomeImages([]),U.Z.getState().setIsGoToSearch(!1),U.Z.getState().setHomeImagesQustions([])])}catch(e){console.error("Failed to clear search addition store:",e)}})()};return H.events.on("routeChangeStart",e),()=>{H.events.off("routeChangeStart",e)}},[H.events]),(0,s.jsxs)(s.Fragment,{children:[(0,P.N0)()||(0,P.Eg)()?null:(0,s.jsxs)("div",{className:"max-w-fit text-[#30394A] dark:text-[#FFFFFF] relative z-20 h-8 border border-[#E6E9EF] dark:border-[#545D6F] rounded-lg",children:[(0,s.jsx)("input",{type:"file",ref:eh,className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,.txt,.xls,.xlsx,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onChange:e=>{let{files:t}=e.target,a=j.Z.getState().extensionSelected;ea(a===y.J5||a===y.Ys?null:a),t&&eI(t),e.target.value=""}}),!Y&&ex.concat(A).length&&"home"!==I?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(D,{handleClick:ek,isDraggingDisabled:ej,maxFileCount:ev,isMini:S,loading:F,filesList:ex,threadId:E,historyFiles:A,disabled:z})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(l.e,{delay:0,closeDelay:0,content:eo?V("searchAddition.add_file_tip"):V("searchAddition.add_file_tip_free",{count:(null==er?void 0:null===(a=er.chatDocumentsUsage)||void 0===a?void 0:a.balance)||0}),classNames:{content:["text-white bg-gray-600 dark:bg-[#353535]"]},children:"home"===I?(0,s.jsx)(r.A,{variant:"light",size:"sm",className:(0,b.Z)("gap-1 mx-0 px-1 h-8","min-w-8","text-sm","flex items-center"),isDisabled:Y||en||F||(null==es?void 0:es.length)>0,startContent:(0,s.jsx)(d.Z,{size:18}),onPress:ek,radius:S?"full":"sm",disabled:z,children:((null==C?void 0:C.code)==="ppt_generation_v2"||(null==C?void 0:C.code)==="html_agent")&&(0,s.jsx)("div",{className:"text-sm leading-[1.2]",children:V("add_file")})}):(0,s.jsx)(r.A,{variant:"light",size:"sm",className:(0,b.Z)("gap-1 mx-0 px-1",Y?"text-primary":"text-inherit","min-w-8","text-inherit"),isDisabled:Y||en||F||(null==es?void 0:es.length)>0||(null==G?void 0:G.length)>0||z,color:Y?"primary":"default",startContent:Y?K<=0?(0,s.jsx)(o.Z,{"aria-label":"Loading...",classNames:{svg:"w-6 h-6"},size:"sm"}):(0,s.jsx)(o.Z,{"aria-label":"Loading...",classNames:{svg:"w-6 h-6"},size:"sm",value:K,showValueLabel:!0}):(0,s.jsx)(d.Z,{size:18}),onPress:ek,radius:S?"full":"sm"})})})]}),(0,s.jsx)(c.Vq,{open:ed,onOpenChange:ec,children:(0,s.jsxs)(c.cZ,{className:"w-80 rounded-lg overflow-hidden",hideCloseButton:!0,"aria-describedby":"to_web_use_file_upload_tip",children:[(0,s.jsx)(c.a7,{className:"text-gray-500 text-sm leading-6 text-center",children:(0,s.jsx)("p",{dangerouslySetInnerHTML:{__html:null===(Z=V(B?"searchAddition.first_use_file_upload_tip_pro":"searchAddition.first_use_file_upload_tip"))||void 0===Z?void 0:Z.replace("Felo Pro","<span class='text-red-500'>Felo Pro</span>")}})}),(0,s.jsx)("div",{className:"flex justify-center p-0 sm:flex-col border-t-1 border-gray-200 dark:border-[#27272A]",children:(0,s.jsx)(r.A,{className:"w-full rounded-none bg-transparent",onPress:()=>{ec(!1)},children:V("searchAddition.first_use_file_upload_btn")})})]})}),(0,s.jsx)(c.Vq,{open:eu,onOpenChange:em,children:(0,s.jsxs)(c.cZ,{className:"w-2/3 rounded-lg overflow-hidden",hideCloseButton:!0,"aria-describedby":"to_web_use_file_upload_tip",children:[(0,s.jsx)(c.a7,{className:"text-gray-500 text-sm leading-6 text-center",children:(0,s.jsx)("p",{children:V("searchAddition.to_web_use_file_upload_tip")})}),(0,s.jsx)("div",{className:"flex justify-center p-0 sm:flex-col border-t-1 border-gray-200 dark:border-[#27272A]",children:(0,s.jsx)(r.A,{className:"w-full rounded-none bg-transparent",onPress:()=>{em(!1)},children:V("searchAddition.to_web_use_file_upload_btn")})})]})})]})});V.displayName="AddFile";var H=V},70113:function(e,t,a){a.d(t,{Z:function(){return I}});var s=a(52676),n=a(75271),i=a(7717),l=a(96164),r=a(26595),o=a(51054),d=a(71686),c=a(4814),u=a(43378),m=a(97247),h=a(65105),g=a(56885),f=a(31022),p=a(37766),x=a(41223),v=a(93071),w=a(59167),_=a(39071),b=a(60904),j=a(57207),y=a(25010),N=a(38058),Z=a(64412),S=a(70262),E=e=>{let{handleClick:t,maxCount:a,imageList:l,historyImages:o,threadId:u,loading:m,disabled:g}=e,f=(0,i.useTranslations)(),x=(0,h.Oi)("chatDocumentsUsage"),{threadImages:E,setThreadImages:F}=(0,p.Z)(),I=(0,n.useMemo)(()=>x?S.Mr:S.CD,[x]),k=e=>{F(E.filter(t=>t.id!==e))};return(0,s.jsxs)(j.J2,{children:[(0,s.jsx)(j.xo,{asChild:!0,children:(0,s.jsx)(y.z,{size:"sm",variant:"ghost",className:(0,c.Z)("h-8 hover:bg-[#EDFAFF] hover:text-primary px-1 gap-1 dark:hover:bg-[#3E536E]"),disabled:m||g,children:(0,s.jsx)("span",{className:"w-4 h-4 flex items-center justify-center font-medium",children:(0,s.jsx)(d.Z,{className:"!w-[18px] !h-[18px]"})})})}),(0,s.jsx)(j.yk,{className:"p-0 min-w-60 !z-41 rounded-xl border-[#efefef] shadow-lg dark:border-[#222]",children:(0,s.jsxs)("div",{className:"p-0 w-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-1 text-xs py-2.5 px-3 border-b-1 border-[#EBEEF3] dark:border-[#222]",children:[(0,s.jsx)("div",{className:"text-xs font-medium",children:f("searchAddition.addition_image_title")}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,s.jsxs)(y.z,{variant:"ghost",size:"sm",className:(0,c.Z)("mr-2","h-6 px-1 gap-1 min-w-4 font-normal text-xs","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),onClick:t,disabled:m||l.length>=a||l.concat(o).length>=I,children:[(0,s.jsx)(w.Z,{size:12,className:"scale-85"}),f("searchAddition.add")]}),u?null:(0,s.jsxs)(y.z,{variant:"ghost",size:"sm",className:(0,c.Z)("h-6 px-1 gap-1 min-w-4 font-normal text-xs","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),onClick:()=>{if(!u){let e=p.Z.getState().threadImages.map(e=>e.id);(0,N.lc)({ids:e})}F([])},children:[(0,s.jsx)(_.Z,{size:12,className:"scale-85"}),f("searchAddition.remove")]})]})]}),(0,s.jsx)("div",{className:"px-2 py-3",children:l.concat(o).map(e=>{let t=null==o?void 0:o.some(t=>t.id===e.id);return(0,s.jsxs)("div",{className:(0,c.Z)("flex items-center justify-between gap-1 text-xs py-1.5 text-gray-500 px-1 rounded","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-4 h-4 flex items-center justify-center font-medium",children:(0,s.jsx)(Z.Z,{fileName:e.title,w:4,h:4})}),(0,s.jsx)(v.O,{className:(0,c.Z)("inline-block text-xs truncate flex-1 max-w-48"),size:"sm",isDisabled:t,children:e.title})]}),!t&&(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(r.A,{variant:"light",className:"m-0 p-0 h-4 w-4 min-w-4 min-h-4 text-[#7f94b1]",size:"sm",isIconOnly:!0,startContent:(0,s.jsx)(b.Z,{size:12}),onPress:()=>k(e.id)})})]},e.id)})})]})})]})};let F=(0,n.forwardRef)((e,t)=>{var a;let{isMini:v,threadId:w,historyImages:_,disabled:b}=e,j=(0,i.useTranslations)(),y=(0,f.Z)(e=>e.loading),{isImageUploading:N,homeImages:Z,threadImages:S,isUploading:F,currentFileProgress:I,homeFiles:k}=(0,p.Z)(),A=(0,h.P2)(),z=(0,h.Oi)("chatDocumentsUsage"),[C,R]=(0,n.useState)(!1),{choiseFiles:D,fileInputChange:P}=(0,g.Z)({threadId:w}),T=(0,n.useRef)(null),O=(0,n.useMemo)(()=>null==S?void 0:S.filter(e=>!(null==_?void 0:_.some(t=>t.id===e.id))),[S,_]),L=()=>{if((0,x.s2)()){R(!0);return}D({ref:T})};return(0,s.jsxs)(s.Fragment,{children:[(0,m.N0)()||(0,m.Eg)()?null:(0,s.jsxs)("div",{className:"max-w-fit text-[#30394A] dark:text-[#FFFFFF] relative h-8 z-20 border border-[#E6E9EF] dark:border-[#545D6F] rounded-lg",children:[(0,s.jsx)("input",{type:"file",ref:T,className:"hidden",multiple:!1,accept:".jpg,.jpeg,.png,.tiff,.svg,.webp,.gif",onChange:P}),w&&!N&&O.concat(_).length?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(E,{handleClick:L,maxCount:1,loading:y,imageList:O,threadId:w,historyImages:null==_?void 0:_.reverse(),disabled:b})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(l.e,{delay:0,closeDelay:0,content:z?j("search_attached_image.add_image_tip"):j("search_attached_image.add_image_tip_free",{count:(null==A?void 0:null===(a=A.chatDocumentsUsage)||void 0===a?void 0:a.balance)||0}),classNames:{content:["text-white bg-gray-600 dark:bg-[#353535]"]},children:(0,s.jsx)(r.A,{variant:"light",size:"sm",className:(0,c.Z)("gap-1 mx-0 px-1","min-w-8"),isDisabled:b||N||F||y||!w&&((null==Z?void 0:Z.length)>0||(null==k?void 0:k.length)>0),startContent:N&&w?I<=0?(0,s.jsx)(o.Z,{"aria-label":"Loading...",classNames:{svg:"w-6 h-6"},size:"sm"}):(0,s.jsx)(o.Z,{"aria-label":"Loading...",classNames:{svg:"w-6 h-6"},size:"sm",value:I,showValueLabel:!0}):(0,s.jsx)(d.Z,{size:18}),onPress:L,radius:v?"full":"sm"})})})]}),(0,s.jsx)(u.Vq,{open:C,onOpenChange:()=>{},children:(0,s.jsxs)(u.cZ,{className:"w-2/3 rounded-lg overflow-hidden",hideCloseButton:!0,children:[(0,s.jsx)(u.a7,{className:"text-gray-500 text-sm leading-6 text-center",children:(0,s.jsx)("p",{children:j("search_attached_image.to_app_use_image_search_tip")})}),(0,s.jsxs)("div",{className:"flex justify-center p-0 sm:flex-col border-t-1 border-gray-200 dark:border-[#27272A]",children:[(0,s.jsx)(r.A,{className:"w-1/2 rounded-none bg-transparent border-r-1 border-gray-200 dark:border-[#27272A]",onPress:()=>{R(!1)},children:j("search_attached_image.to_app_use_image_search_btn_cancel")}),(0,s.jsx)(r.A,{className:"w-1/2 rounded-none bg-transparent",color:"primary",variant:"light",onPress:()=>{(0,m.s)()?window.open("https://apps.apple.com/us/app/felo-search-the-world/id6598782546"):window.open("https://play.google.com/store/apps/details?id=ai.felo.search"),R(!1)},children:j("search_attached_image.to_app_use_image_search_btn")})]})]})})]})});F.displayName="AddImage";var I=F},12490:function(e,t,a){var s=a(52676),n=a(7717),i=a(8096),l=a(96164),r=a(31022),o=a(38188),d=a(75271),c=a(84781);t.Z=e=>{let{isReply:t}=e,a=(0,n.useTranslations)(),{isTopicSearchNetwork:u,setIsTopicSearchNetwork:m}=(0,r.Z)(),h=e=>{m(e),localStorage.setItem(o.J.TOPIC_WEB_SEARCH,e?"true":"false")};return(0,d.useEffect)(()=>{let e=localStorage.getItem(o.J.TOPIC_WEB_SEARCH);e&&m("true"===e)},[]),(0,s.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,s.jsx)(l.e,{classNames:{content:["text-white bg-gray-600 dark:bg-[#353535]"]},content:a(u?"topic.online_answer":"topic.offline_answer"),children:(0,s.jsxs)("div",{onClick:()=>h(!u),className:"flex justify-center gap-2 text-sm cursor-pointer ".concat(u&&"text-[#0080FF]"),children:[u?(0,s.jsx)(i.Z,{size:20}):(0,s.jsx)(c.x5,{className:"w-5 h-5"}),a("topic.web_search")]})}),t&&(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"|"})]})}},76011:function(e,t,a){a.d(t,{F:function(){return n}}),a(52676),a(26595),a(91840),a(34180),a(48958),a(64657),a(5687),a(55383),a(93650),a(49983),a(3501),a(49264),a(7534),a(9455),a(54313);var s=a(75271);let n="felo_search_setting";t.Z=()=>((0,s.useEffect)(()=>{localStorage.getItem(n)&&localStorage.removeItem(n)},[]),null)},19370:function(e,t,a){a.d(t,{Bw:function(){return f},Ph:function(){return c},Ql:function(){return p},U$:function(){return x},i4:function(){return m},ki:function(){return u}});var s=a(52676),n=a(75271),i=a(18669),l=a(9369),r=a(80145),o=a(91165),d=a(37481);let c=i.fC;i.ZA;let u=i.B4,m=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(i.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-[10px] border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[n,(0,s.jsx)(i.JO,{asChild:!0,children:(0,s.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=i.xz.displayName;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(r.Z,{className:"h-4 w-4"})})});h.displayName=i.u_.displayName;let g=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(l.Z,{className:"h-4 w-4"})})});g.displayName=i.$G.displayName;let f=n.forwardRef((e,t)=>{let{className:a,children:n,position:l="popper",...r}=e;return(0,s.jsx)(i.h_,{children:(0,s.jsxs)(i.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...r,children:[(0,s.jsx)(h,{}),(0,s.jsx)(i.l_,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,s.jsx)(g,{})]})})});f.displayName=i.VY.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=i.__.displayName;let p=n.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,s.jsxs)(i.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(i.wU,{children:(0,s.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(i.eT,{children:n})]})});p.displayName=i.ck.displayName;let x=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...n})});x.displayName=i.Z0.displayName},26949:function(e,t,a){a.d(t,{SP:function(){return d},dr:function(){return o},mQ:function(){return r},nU:function(){return c}});var s=a(52676),n=a(75271),i=a(1262),l=a(37481);let r=i.fC,o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.aV,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...n})});o.displayName=i.aV.displayName;let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.xz,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...n})});d.displayName=i.xz.displayName;let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.VY,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...n})});c.displayName=i.VY.displayName},31442:function(e,t,a){a.d(t,{e:function(){return s}});let s={AdvancedAssistantDisable:"extension.advanced_assistant_disable",LoginExpired:"extension.login_expired",Timeout:"extension.timeout"}},2240:function(e,t,a){var s=a(75271);t.Z=function(){let e=(0,s.useRef)(!0);return(0,s.useEffect)(()=>{let t=()=>{e.current=!1},a=()=>{e.current=!0};return window.addEventListener("compositionstart",t),window.addEventListener("compositionend",a),()=>{window.removeEventListener("compositionstart",t),window.removeEventListener("compositionend",a)}},[]),e}},57591:function(e,t,a){var s=a(75271);t.Z=function(e){let[t,a]=(0,s.useState)(e),n=(0,s.useRef)(t);return(0,s.useEffect)(()=>{n.current=t},[t]),[t,(0,s.useCallback)(e=>{"function"==typeof e?a(t=>{let a=e(t);return n.current=a,a}):(n.current=e,a(e))},[]),n]}},56885:function(e,t,a){var s=a(7717),n=a(75271),i=a(70262),l=a(84706),r=a(65105),o=a(31022),d=a(36551),c=a(37766),u=a(65819),m=a(38058),h=a(31063),g=a(60161),f=a(89335),p=a(39109);t.Z=e=>{let{threadId:t}=e,a=(0,s.useTranslations)(),x=(0,r.WI)(),v=(0,p.Z)(),{setCurrentFileProgress:w,previousSearchCategory:_,setPreviousSearchCategory:b,setIsOpenFirstUseModal:j,isImageUploading:y,setIsImageUploading:N,homeImages:Z,setHomeImages:S,setThreadImages:E,setHomeImagesQustions:F,setNThUpload:I,removeHomeImageSById:k}=(0,c.Z)(),A=(0,u.ZP)(e=>e.isLogin),z=(0,r.P2)(),C=(0,r.Oi)("chatDocumentsUsage"),R=(0,n.useMemo)(()=>x?i.sn:i.w8,[x]),D=(0,n.useMemo)(()=>!1,[null==z?void 0:z.chatDocumentsUsage,C]),P=(0,n.useMemo)(()=>(null==Z?void 0:Z.length)>R,[R,null==Z?void 0:Z.length]),T=()=>{let e=c.Z.getState().homeImages,a=c.Z.getState().threadImages;return t?(null==a?void 0:a.length)||0:(null==e?void 0:e.length)||0},O=()=>{o.Z.getState().setExtensionSelected(_||d.gl),b(null)},L=e=>["image/jpeg","image/png","image/tiff","image/gif","image/webp"].includes(e.type)?e.size>26214400?(v.default(a("search_attached_image.size_limit_exceeded_tip",{size:25})),!1):!P||(v.default(a("search_attached_image.file_count_limit_exceeded_tip",{count:R})),!1):(v.default(a("search_attached_image.unsupported_image_type_tip")),!1),U=()=>{if(!y){if(!A){l.$.publish("showLogin",void 0);return}if(D){l.$.publish("showSubscriptionPlan",void 0);return}if(P){v.default(a("search_attached_image.file_count_limit_exceeded_tip",{count:R}));return}return!0}},M=e=>{var a;let s=null!==(a=c.Z.getState().currentFileProgress)&&void 0!==a?a:0,n=setInterval(()=>{var a,i;let l=t?c.Z.getState().threadImages:c.Z.getState().homeImages,r=t?E:S;s=(null!==(i=null===(a=l.find(t=>t.id===e))||void 0===a?void 0:a.progress)&&void 0!==i?i:s)+(1.9*Math.random()+.1),r(l.map(t=>t.id===e?{...t,progress:Math.min(s,90),status:"analyzing"}:t)),s>=90&&clearInterval(n)},800);return n},V=async e=>{var s,n,l,r;if(!U())return;let u=c.Z.getState().homeImages,p=c.Z.getState().threadImages;if((t?p:u).length>=R){v.default(a("search_attached_image.file_count_limit_exceeded_tip",{count:R}));return}I((null!==(s=c.Z.getState().nThUpload)&&void 0!==s?s:0)+1);let x=Array.from(e);N(!0),o.Z.getState().setExtensionSelected(d.Ys);let _=[];for(let[e,a]of Array.from(x).entries()){_.push(e);let s=t?c.Z.getState().threadImages:c.Z.getState().homeImages,r=t?E:S,o=null!==(n=c.Z.getState().nThUpload)&&void 0!==n?n:0,d=new FileReader,u="".concat(o,"_").concat(e),m=URL.createObjectURL(a),h=[{id:u,title:a.name,size:(0,i.sS)(a.size),token:0,pages:0,progress:null!==(l=c.Z.getState().currentFileProgress)&&void 0!==l?l:0,status:"uploading",type:a.type,created_at:new Date().toISOString(),modified_at:new Date().toISOString(),length:0,words:0,threadId:t||"",url:m,tempId:u}];console.log("reader",d,a),r([...h,...s])}let b=new Map;for(let[e,s]of Array.from(x).entries()){let n=null!==(r=c.Z.getState().nThUpload)&&void 0!==r?r:0,l="".concat(n,"_").concat(e);N(!0),w(0),new FormData().append("file",s);let o="";if(!L(s)){N(!1),w(0);let e=t?c.Z.getState().threadImages:c.Z.getState().homeImages;(t?E:S)([...(0,i._n)({files:e,tempId:l})]);continue}(0,h.fk)(g.U.CHAT_IMAGE,{fileName:s.name},!0),N(!0);let d=(0,i.ct)(0,e=>{w(null!=e?e:0);let a=t?c.Z.getState().threadImages:c.Z.getState().homeImages;(t?E:S)(a.map(t=>t.tempId===l?{...t,progress:e}:t))});"1"!==(0,i.y6)()&&(j(!0),(0,i.ny)());try{b.set(s.name,!0),await (0,f.Vj)({file:s,threadId:t||"",onProgress:a=>{if(o||(o=a.file_id),!b.has(o)){var n;let a=null!==(n=c.Z.getState().nThUpload)&&void 0!==n?n:0,i=t?c.Z.getState().threadImages:c.Z.getState().homeImages,l=t?E:S,r=i.map(t=>t.tempId==="".concat(a,"_").concat(e)?{...t,id:o}:t);l([...r]);let d=M(o);b.set(o,d),b.delete(s.name)}},onDone:async e=>{if(console.log("progress",e),d(),b.has(o),(null==e?void 0:e.status)==="SUCCESS"){let a=t?c.Z.getState().threadImages:c.Z.getState().homeImages,s=t?E:S,n=await (0,m.S6)({id:o});N(!1),console.log("imageQustions",n),clearInterval(b.get(o)),b.delete(o),F([...n]),s(a.map(t=>t.id===o?{...t,progress:100,words:(null==e?void 0:e.words)||0,status:"completed"}:t));return}(null==e?void 0:e.status)==="PAGE_OVER_SIZE"?v.default(a("searchAddition.page_limit_exceeded_tip",{pages:"500"})):v.default(a("server.INTERNAL_SERVER_ERROR")),k([o]),N(!1),w(0)},onError:()=>{v.default(a("server.INTERNAL_SERVER_ERROR")),d(),b.delete(s.name),0===b.size&&N(!1),k([o])}})}catch(e){d(),v.default(a("server.INTERNAL_SERVER_ERROR")),N(!1),k([o]),w(0)}}T()||(O(),w(0))};return{isInsufficientBalance:D,isFileCountLimitExceeded:P,isValidImageFile:L,simulateProgress:M,choiseFiles:e=>{var t;let{ref:a}=e;U()&&(null==a||null===(t=a.current)||void 0===t||t.click())},isValidPermission:U,fileInputChange:e=>{let{files:t}=e.target,a=o.Z.getState().extensionSelected;b(a===d.Ys?null:a),console.log("files",t),t&&V(t),e.target.value=""},uploadFiles:V}}},38058:function(e,t,a){a.d(t,{S6:function(){return o},Wl:function(){return l},lc:function(){return r}});var s=a(27976),n=a(13263),i=a(5517);let l=async()=>{let e=(0,n.LP)();return(0,i.Z)("".concat(s.EG,"/file/upload/limit"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"".concat(e)}}).then(async e=>{if(null==e?void 0:e.ok){var t;if(200!==e.status)return!0;let a=await e.json();return null===(t=null==a?void 0:a.data)||void 0===t||t}throw Error("failure")}).catch(e=>{throw console.log("error",e),Error("failure")})},r=async e=>{let{ids:t}=e,a=(0,n.LP)();return(0,i.Z)("".concat(s.EG,"/file/delete"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"".concat(a)},body:JSON.stringify(t)})},o=async e=>{let{id:t}=e,a=(0,n.LP)();return t?(0,i.Z)("".concat(s.XJ,"/threads/analytics/").concat(t,"/image"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"".concat(a)}}).then(async e=>{if(null==e?void 0:e.ok){if(200!==e.status)return[];let t=await e.json();return console.log("fetchAnalyticsImage response",t),t||[]}return[]}).catch(e=>(console.log("error",e),[])):[]}},13366:function(e,t,a){var s=a(75910),n=a(98496),i=a(11782);let l="agent-params-storage",r=()=>{try{let t=localStorage.getItem(l);if(t){var e;let a=JSON.parse(t);return(null===(e=a.state)||void 0===e?void 0:e.language)||""}}catch(e){console.error("Failed to parse stored language:",e)}try{if("undefined"!=typeof navigator){let e=navigator.language||navigator.userLanguage,t=i.g$.find(t=>t.value===e);if(t)return t.value;let a=e.split("-")[0],s=i.g$.find(e=>e.value===a||e.value.startsWith(a+"-"));if(s)return s.value;if("zh"===a){if(e.includes("CN")||e.includes("SG"))return"zh-Hans";return e.includes("TW")||e.includes("HK")||e.includes("MO"),"zh-Hant"}}}catch(e){console.error("Failed to get browser language:",e)}return"en"},o=(0,s.Ue)()((0,n.tJ)(e=>({language:r(),setLanguage:t=>e(()=>({language:t})),initializeLanguage:t=>e(e=>e.language?e:{language:t})}),{name:l,partialize:e=>({language:e.language}),skipHydration:!0}));t.Z=o},48518:function(e,t,a){let s=(0,a(75910).Ue)(e=>({currentData:void 0,templateData:void 0,setCurrentData:t=>e({currentData:t}),setTemplateData:t=>e({templateData:t}),clearCurrentData:()=>e({currentData:void 0}),clearTemplateData:()=>e({templateData:void 0})}));t.Z=s},78236:function(e,t,a){let s=(0,a(75910).Ue)((e,t)=>({homeFiles:[],setHomeFiles:t=>e(e=>({...e,homeFiles:t})),files:[],setFiles:t=>e(e=>({...e,files:t})),isUploading:!1,setIsUploading:t=>e({isUploading:t}),documents:[],setDocuments:t=>e({documents:t}),chatDocumentsCounts:0,setChatDocumentsCounts:t=>e({chatDocumentsCounts:t}),threadFiles:[],setThreadFiles:t=>e(e=>({...e,threadFiles:t})),currentFileProgress:0,setCurrentFileProgress:t=>e({currentFileProgress:t}),previousSearchCategory:null,setPreviousSearchCategory:t=>e({previousSearchCategory:t}),removeHomeFilesById:a=>{let s=t().homeFiles;e({homeFiles:[...null==s?void 0:s.filter(e=>!a.includes(e.id))]})},removeFilesById:a=>{let s=t().files;e({files:[...null==s?void 0:s.filter(e=>!a.includes(e.id))]})},nThUpload:0,setNThUpload:t=>e({nThUpload:t}),isImageUploading:!1,setIsImageUploading:t=>e({isImageUploading:t}),homeImages:[],setHomeImages:t=>e({homeImages:t}),threadImages:[],setThreadImages:t=>e({threadImages:t}),isOpenFirstUseModal:!1,setIsOpenFirstUseModal:t=>e({isOpenFirstUseModal:t}),removeHomeImageSById:a=>{let s=t().homeImages;e({homeImages:[...null==s?void 0:s.filter(e=>!a.includes(e.id))]})},homeImageSQustions:[],setHomeImagesQustions:t=>e({homeImageSQustions:t}),isImageChat:!0,setIsImageChat:t=>e({isImageChat:t}),isGoToSearch:!1,setIsGoToSearch:t=>e({isGoToSearch:t})}));t.Z=s},88708:function(e,t,a){a.d(t,{Of:function(){return g},Sc:function(){return l},Sq:function(){return f},YX:function(){return r},el:function(){return o},mt:function(){return h},qG:function(){return d},u1:function(){return c},uI:function(){return u},wd:function(){return m}});var s=a(78017),n=a(25994),i=a(81555);let l=e=>e===n.PN,r=e=>e===n.$8||e===n.PN,o=e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.some(e=>r(e.type))},d=e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.some(e=>e.type===n.PN)},c=e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.some(e=>e.type===n.Kp)},u=e=>{var t,a;return"ppt_generation_v2"===e.code||"html_agent"===e.code||(e.template_type===i.W.DEFAULT?!!(null===(t=e.params)||void 0===t?void 0:t.some(e=>"file"===e.type)):e.template_type===i.W.CUSTOM&&!(null===(a=e.params)||void 0===a?void 0:a.some(e=>"hide_file"===e.type)))},m=e=>!!e.code&&[s.m5,s.PZ].includes(e.code),h=e=>{if(e.template_type===i.W.CUSTOM){var t;return!(null===(t=e.params)||void 0===t?void 0:t.some(e=>"hide_image"===e.type))}return!0},g=e=>e.code===s.m5||e.code===s.PZ,f=e=>{try{var t,a,s,n;if(!(null==e?void 0:null===(a=e.sub_topics)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:t.tools))return{external_tool_services:[],mcp_services:[]};let i=e.sub_topics[0].tools,l=i.find(e=>"external_tool_services"===e.name),r=i.find(e=>"mcp_services"===e.name),o=(null==l?void 0:null===(s=l.config)||void 0===s?void 0:s.list)||[],d=(null==r?void 0:null===(n=r.config)||void 0===n?void 0:n.list)||[],c=o.filter(e=>"user"===e.attribution&&e.select_status),u=d.filter(e=>"user"===e.attribution&&e.select_status);return{external_tool_services:c,mcp_services:u}}catch(e){return{external_tool_services:[],mcp_services:[]}}}},15893:function(e,t,a){a.d(t,{D:function(){return s},n:function(){return n}});let s=e=>{var t,a,s;return(null===(t=e.creator)||void 0===t?void 0:t.name)||(e.system?"Felo.ai":(null==e?void 0:null===(a=e.user)||void 0===a?void 0:a.name)?null==e?void 0:null===(s=e.user)||void 0===s?void 0:s.name:"")},n=e=>[{id:"1573ae54-58cb-4cdd-a9ef-2c30b4811f65",name:"Notion",icon:"/icons/mcp/notion.svg",description:e("agent.mcp_servers_notion_desc"),hidden:!1,disabled:!1,scope_auth:"personal",attribution:"user",auth_status:!1},{id:"1573ae54-58cb-4cdd-a9ef-2c30b4811f62",name:"Gmail",icon:"/icons/mcp/gmail.svg",description:e("agent.mcp_servers_gmail_desc"),hidden:!1,disabled:!1,scope_auth:"personal",attribution:"user",auth_status:!1}]},44509:function(e,t,a){a.d(t,{T:function(){return n},Y:function(){return s}});let s=async(e,t,a)=>{var s;let n=e.getBoundingClientRect(),i=null===(s=document.querySelector("#".concat(t)))||void 0===s?void 0:s.getBoundingClientRect();if(!i){null==a||a();return}let{width:l,left:r,top:o}=n,{left:d,bottom:c,height:u,width:m}=i,h=e.animate([{transformOrigin:"top",transform:"translate(0, 0) scale(1)",opacity:1},{opacity:0,transform:"translate(".concat(d-r+(m-l)/2,"px, ").concat(c-o-u/2,"px) scale(0)"),transformOrigin:"top"}],{duration:300,fill:"forwards"});await h.finished,null==a||a()},n=async(e,t,a)=>{var s;let n=e.getBoundingClientRect(),i=null===(s=document.querySelector("#".concat(t)))||void 0===s?void 0:s.getBoundingClientRect();if(!i){null==a||a();return}let{width:l}=n,{left:r,top:o}=i,d=window.innerWidth/2,c=window.innerHeight/2,u=e.animate([{transformOrigin:"top",transform:"translate(0, 0) scale(1)",opacity:1},{opacity:0,transform:"translate(".concat(r-d-l/2,"px, ").concat(o-c,"px) scale(0)"),transformOrigin:"top"}],{duration:600,fill:"forwards"});await u.finished,null==a||a()}},34276:function(e,t,a){a.d(t,{f:function(){return i}});var s=a(97247),n=a(60635);let i=async e=>{let{query:t,setLoading:a}=e;if((0,s.Eg)()){if(!t)return!1;a(!0),(0,n.mN)(t);try{let e=await (0,n.C1)({type:"onGetHKTVMallQueryStatus",timeout:4e3});if(console.log("isValidatedQuery",e),a(!1),!0!==e)return!1}catch(e){return console.log("\uD83D\uDE80 ~ onSubmit ~ error:",e),a(!1),!1}}return!0}},93734:function(e,t,a){a.d(t,{Y:function(){return n},h:function(){return i}});var s=a(36551);let n=e=>{let t="";switch(e){case s.gl:case s.ti:case s.rN:t="extension.all";break;case s.pN:t="extension.social";break;case s.Kp:t="extension.academic";break;case s.hs:t="extension.document";break;case s.zA:t="extension.xiaohongshu";break;case s.X7:t="extension.twitter";break;case s.xn:t="extension.reddit";break;case s.aI:case s.Bv:t="extension.chat";break;case s.J5:t="extension.chat_with_document";break;case s.Wh:t="extension.search_agent";break;case s.V9:t="extension.web_summary";break;case s.Ys:t="extension.chat_with_image";break;case s.RQ:t="topic.topic";break;case s.Ts:t="extension.chat_with_voice"}return t},i=e=>{let t="";switch(e){case s.gl:t="extension.all";break;case s.pN:t="extension.social_search";break;case s.Kp:t="extension.academic_search";break;case s.hs:t="extension.document_search";break;case s.zA:t="extension.xiaohongshu_search";break;case s.X7:t="extension.twitter_search";break;case s.xn:t="extension.reddit_search";break;case s.aI:t="extension.chat";break;case s.RQ:t="topic.topic"}return t}}}]);