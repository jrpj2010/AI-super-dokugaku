(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3265],{35279:function(e,t,r){"use strict";var n=r(52676),a=r(75271),l=r(72135),i=r.n(l),o=r(351),s=r(59427);r(13963),r(33685),r(87518);var d=r(97571),c=r(72070),u=r.n(c),h=r(7717),p=r(62033),m=r(72881),g=r(30674),x=r(4460),f=r(69194),v=r(29871),C=r(18881);let b=i()(()=>Promise.resolve().then(r.t.bind(r,4460,19)).then(e=>e.Viewer),{loadableGenerated:{webpack:()=>[4460]},ssr:!1}),w=i()(()=>Promise.resolve().then(r.t.bind(r,4460,19)).then(e=>e.Worker),{loadableGenerated:{webpack:()=>[4460]},ssr:!1});t.Z=e=>{let{fileUrl:t,fileType:r,pdfFileUrl:l}=e,{isMobile:i}=(0,v.Z)(),{setIsPdfLoaded:c}=(0,C.Z)(),y=(0,s.toolbarPlugin)(),{renderDefaultToolbar:j,Toolbar:k}=y,[_,N]=(0,a.useState)(""),[S,F]=(0,a.useState)(""),[T,E]=(0,a.useState)(""),Z=e=>({...e,Download:()=>(0,n.jsx)(n.Fragment,{}),EnterFullScreen:()=>(0,n.jsx)(n.Fragment,{}),SwitchTheme:()=>(0,n.jsx)(n.Fragment,{}),Open:()=>(0,n.jsx)(n.Fragment,{}),Print:()=>(0,n.jsx)(n.Fragment,{}),ShowSearchPopover:()=>(0,n.jsx)(n.Fragment,{})}),I=(0,o.defaultLayoutPlugin)({renderToolbar:()=>(0,n.jsx)(k,{children:j(Z)}),sidebarTabs:e=>i?[]:[e[0]]}),D=()=>{let{activateTab:e}=I;e(0),c(!0)},A=(0,a.useRef)(null),{isDark:L}=(0,d.Z)(),M=(0,h.useTranslations)(),O=(0,h.useLocale)(),P=(0,m.b)(r);(0,a.useEffect)(()=>{if(l){N(l),F(l||t);return}let e=async()=>{try{let e=encodeURIComponent(btoa(t)),r=await (0,f.D)({fileUrl:e});if(500===r)return E("error"),null;return N(r.data),r.data}catch(e){return console.error("Error fetching data:",e),null}};if("PDF"===r){let r=new Promise(e=>{setTimeout(()=>e(null),1e3)});Promise.race([e(),r]).then(e=>{F(e||t)})}else e()},[t,r,l]),(0,a.useEffect)(()=>{A.current&&A.current.scrollTo(0,0)},[S]);let B=e=>{if(_)return z(_);{let t="";switch(e.name){case"InvalidPDFException":t="The document is invalid or corrupted";break;case"MissingPDFException":t="The document is missing";break;case"UnexpectedResponseException":t="Unexpected server response";break;default:t="Cannot load the document"}return(0,n.jsx)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifyContent:"center"},children:(0,n.jsx)("div",{style:{backgroundColor:"#e53e3e",borderRadius:"0.25rem",color:"#fff",padding:"0.5rem"},children:t})})}},z=e=>(0,n.jsx)(w,{workerUrl:"https://unpkg.com/pdfjs-dist@3.4.120/build/pdf.worker.min.js",children:(0,n.jsx)("div",{ref:A,className:"w-full h-[60vh] max-h-[calc(80vh-144px)]",children:(0,n.jsx)(b,{defaultScale:x.SpecialZoomLevel.PageFit,theme:L?"dark":"light",fileUrl:"/api/fetchFile?url=".concat(encodeURIComponent(e)),plugins:[I,y],onDocumentLoad:D,localization:p.f[O],renderError:B})})}),R=e=>(0,n.jsx)("div",{className:"max-h-[calc(80vh-144px)]",children:(0,n.jsx)("iframe",{src:"https://view.officeapps.live.com/op/view.aspx?src=".concat(encodeURIComponent(e)),className:"w-full h-[60vh] max-h-[calc(80vh-144px)]",frameBorder:"0"})}),H=()=>(0,n.jsxs)("div",{className:"h-full p-4 h-[60vh] max-h-[calc(80vh-144px)] text-center pt-32",children:[(0,n.jsx)("div",{className:"flex justify-center mb-4",children:(0,n.jsx)(u(),{src:P,alt:r,width:80,height:80})}),(0,n.jsxs)("div",{className:"break-words text-[#0A1C38] dark:text-[#FFF] text-lg mb-8",children:[t.split("/").pop(),".",r]}),(0,n.jsx)("div",{className:"text-[#0A1C38] dark:text-[#FFF] text-base",children:M("file_preview_notification")})]}),U=()=>(0,n.jsx)("div",{className:"h-full p-4 h-[60vh] max-h-[calc(80vh-144px)] text-center pt-32",children:(0,n.jsx)(g.c,{label:M("topic.loading")})});return(0,n.jsx)("div",{children:(()=>{if("PDF"===r)return S?z(S):U();if(T)switch(r){case"PPTX":case"PPT":case"DOC":case"DOCX":case"XLS":case"XLSX":return R(t);default:return H()}return _?["XLSX","XLS","CSV","HTML"].includes(r)?(0,n.jsx)("div",{className:"max-h-[calc(80vh-144px)]",children:(0,n.jsx)("iframe",{src:_,className:"w-full h-[60vh] max-h-[calc(80vh-144px)]",frameBorder:"0"})}):z(_):U()})()})}},57527:function(e,t,r){"use strict";r.d(t,{C:function(){return j},T:function(){return y}});var n=r(52676),a=r(75271),l=r(7717),i=r(43378),o=r(97571),s=r(25794),d=r(23083),c=r(65819),u=r(60635),h=r(19527),p=r(70017),m=r(19583),g=r(4814),x=r(79057),f=r(34097),v=r(92774),C=r(17112),b=r(27585),w=r(84706);let y=async(e,t)=>{let r=await fetch(t);return fetch(e,{method:"PUT",body:await r.blob()})},j=e=>{let{type:t="thread",onNoteAddGraphic:r,onNoteUpdateGraphic:j}=e,k=(0,l.useTranslations)(),_=(0,l.useLocale)(),{isDark:N}=(0,o.Z)(),S=(0,a.useRef)(null),F=(0,a.useRef)(null),{isMyThread:T}=(0,d.Z)(),E=(0,p.V)(),{showGraphicModel:Z,setShowGraphicModel:I,graphicQueryData:D,allGraphicData:A,setAllGraphicData:L,setUpdateGraphicData:M,updateGraphicData:O}=(0,x.Z)(),P=(0,a.useRef)(void 0),{uploading:B,setUploading:z}=(0,v.Z)(),R=()=>{I(!1)},H=(0,a.useCallback)(()=>{let e=window.location.href.split("?")[0];if(history.replaceState({},"",e),!T||"note"===D.mode){I(!1);return}V()},[T]),U=(0,a.useMemo)(()=>{let e=(0,b.lx)("https://smartart.felo.ai");return e.searchParams.append("locale",_),e.searchParams.append("theme",N?"dark":"light"),e.searchParams.append("v",new Date().getTime().toString()),e.toString()},[N,_]);(0,a.useEffect)(()=>{let e=e=>{var r,n,a,l,i,o,d,p,g,x,f,v,C;if(e.data.type){if("graphic:init"===e.data.type){let{anonymousToken:e}=c.ZP.getState(),i=c.ZP.getState().userInfo,o=(null==i?void 0:i.user_org_member)?null==i?void 0:null===(n=i.user_org_member)||void 0===n?void 0:null===(r=n.org_member)||void 0===r?void 0:r.uid:null==i?void 0:i.uid;null===(l=F.current)||void 0===l||null===(a=l.contentWindow)||void 0===a||a.postMessage({type:"graphic:init",value:{tokens:{login:(0,s.Nh)(),anonymous:e,visitor:(0,s.Kd)()},options:{uid:o,canEdit:D.canEdit,mode:(null==D?void 0:D.mode)||t,thread_id:null==D?void 0:D.threadId,message_id:null==D?void 0:D.messageId,language:null==D?void 0:D.language,inputText:null==D?void 0:D.inputText,smart_art_id:null==D?void 0:D.smart_art_id,note_id:null==D?void 0:D.note_id,isChangeImgUrl:null==D?void 0:D.isChangeImgUrl}}},"*")}if("graphic:data"===e.data.type)P.current=e.data.value;else if("graphic:save"===e.data.type){if(P.current=e.data.value,!e.data.value.canEdit)return;"note"===e.data.value.mode?q(!1):V(!1)}else if("graphic:insertData"===e.data.type){if(!e.data.value.canEdit)return;"note"===e.data.value.mode?q(!0):V(!0)}else if("graphic:retry"===e.data.type);else if("graphic:download"===e.data.type){let{currentData:t}=m.Z.getState();(0,u.DB)({type:"image/png",filename:"".concat(null==t?void 0:t.query,".png"),data:e.data.value.replace("data:image/png;base64,","")})}else if("graphic:share"===e.data.type){null===(o=F.current)||void 0===o||null===(i=o.contentWindow)||void 0===i||i.postMessage({type:"graphic:shareSucceed"},"*");let t="".concat(window.location.origin,"/search/").concat(e.data.value.thread_id,"?showGraphic=1&message_id=").concat(e.data.value.message_id);E.copy(t),h.Z.getState().setShareData({type:"ppt",link:t}),h.Z.getState().setShowThreadModel(!0),V(!1)}else if("graphic:status"===e.data.type){let{currentData:t}=m.Z.getState();console.log("graphic:status",e.data),t&&m.Z.getState().setCurrentData({...t,status:null==e?void 0:null===(p=e.data)||void 0===p?void 0:null===(d=p.value)||void 0===d?void 0:d.status})}else console.log("graphic:other",e.data),(null===(g=e.data)||void 0===g?void 0:g.type)==="graphic:error"&&(null===(f=e.data)||void 0===f?void 0:null===(x=f.value)||void 0===x?void 0:x.statusCode)===402&&w.$.publish("felo_showPaidModal",{type:(null==e?void 0:null===(C=e.data)||void 0===C?void 0:null===(v=C.value)||void 0===v?void 0:v.codeMessage)||null,data:{}})}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[D]);let V=(0,a.useCallback)(function(){var e,t;let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null===(t=F.current)||void 0===t||null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"graphic:requestData"},"*");let n=window.setTimeout(()=>{if(console.log("getted graphic close data",P.current),P.current&&P.current.content&&P.current.canEdit){var e;(0,f.NK)({message_id:(null===(e=P.current)||void 0===e?void 0:e.message_id)||new Date().getTime().toString(),suffixList:[{path:"",suffix:"svg"},{path:"",suffix:"png"}]}).then(e=>{let t=e.data.files;200===e.status&&Promise.all(t.map(e=>P.current?y(e.path,P.current[e.type]):void 0)).then(e=>{var r,n,a,l,i,o,s,d,c,u,h,p,m,g,v;let C=x.Z.getState().allGraphicData,w={content:(null===(r=P.current)||void 0===r?void 0:r.content)||[],smart_art_id:(null===(n=P.current)||void 0===n?void 0:n.smart_art_id)||(null===(a=C[(null===(l=P.current)||void 0===l?void 0:l.message_id)||""])||void 0===a?void 0:a.smart_art_id)||"",current_template:(null===(i=P.current)||void 0===i?void 0:i.current_template)||"",images:t,theme:(null===(o=P.current)||void 0===o?void 0:o.theme)||"",summary:null===(s=P.current)||void 0===s?void 0:s.inputText,svg:null===(d=P.current)||void 0===d?void 0:d.svgString,language:null===(c=P.current)||void 0===c?void 0:c.language,ratio:null===(u=P.current)||void 0===u?void 0:u.ratio};(null===(h=P.current)||void 0===h?void 0:h.smart_art_id)||(null===(p=C[(null===(m=P.current)||void 0===m?void 0:m.message_id)||""])||void 0===p?void 0:p.smart_art_id)?(0,f.KX)(w).then(e=>{if(200===e.status){var t,r;let n=new Date().getTime(),a={...w,...e.data,images:e.data.images.map(e=>{let t=(0,b.lx)(e.path);return t.searchParams.set("t",n.toString()),{...e,path:"".concat(t.toString())}})};L({...C,[(null===(t=P.current)||void 0===t?void 0:t.message_id)||(null===(r=P.current)||void 0===r?void 0:r.smart_art_id)||""]:a})}}):(delete w.smart_art_id,w={...w,thread_id:(null===(g=P.current)||void 0===g?void 0:g.thread_id)||"",message_id:(null===(v=P.current)||void 0===v?void 0:v.message_id)||""},(0,f.Vd)(w).then(e=>{if(200===e.status){var t;let r=new Date().getTime(),n={...w,...e.data,images:e.data.images.map(e=>{let t=(0,b.lx)(e.path);return t.searchParams.set("t",r.toString()),{...e,path:"".concat(t.toString())}})};L({...C,[(null===(t=P.current)||void 0===t?void 0:t.message_id)||n.smart_art_id||""]:n})}}))})})}r&&R(),window.clearTimeout(n)},400)},[T,A]),q=(0,a.useCallback)(function(){var e,t;let n=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null===(t=F.current)||void 0===t||null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"graphic:requestData"},"*");let a=window.setTimeout(()=>{if(console.log("getted graphic close data",P.current),P.current&&P.current.content){var e,t,l;let n;(null===(e=P.current)||void 0===e?void 0:e.smart_art_id)||(n="template"+Date.now().toString(),null==r||r(n,"",!0)),z(!0),(0,f.NK)({message_id:(null===(t=P.current)||void 0===t?void 0:t.note_id)||(null===(l=P.current)||void 0===l?void 0:l.smart_art_id)||"",suffixList:[{path:"",suffix:"svg"},{path:"",suffix:"png"}]}).then(e=>{let t=e.data.files;200===e.status&&Promise.all(t.map(e=>P.current?y(e.path,P.current[e.type]):void 0)).then(async e=>{var r,a,l,i,o,s,d,c,u,h,p,m,g,v,C;let w=x.Z.getState().allGraphicData,y={content:(null===(r=P.current)||void 0===r?void 0:r.content)||[],smart_art_id:(null===(a=P.current)||void 0===a?void 0:a.smart_art_id)||(null===(l=w[(null===(i=P.current)||void 0===i?void 0:i.message_id)||""])||void 0===l?void 0:l.smart_art_id)||"",current_template:(null===(o=P.current)||void 0===o?void 0:o.current_template)||"",images:t,theme:(null===(s=P.current)||void 0===s?void 0:s.theme)||"",summary:null===(d=P.current)||void 0===d?void 0:d.inputText,svg:null===(c=P.current)||void 0===c?void 0:c.svgString,language:null===(u=P.current)||void 0===u?void 0:u.language,ratio:null===(h=P.current)||void 0===h?void 0:h.ratio};if(j&&(null===(p=P.current)||void 0===p?void 0:p.smart_art_id)){let e=null===(m=t.find(e=>"png"===e.type))||void 0===m?void 0:m.path,r=null==e?void 0:null===(g=e.split("?"))||void 0===g?void 0:g[0],n=(0,b.lx)(r);n.searchParams.set("smart_art_id",null===(v=P.current)||void 0===v?void 0:v.smart_art_id),n.searchParams.set("t",new Date().getTime().toString());let a=n.toString();M({...O,[null===(C=P.current)||void 0===C?void 0:C.smart_art_id]:y}),j(P.current.smart_art_id,a,P.current.smart_art_id),z(!1)}else delete y.smart_art_id,y={...y},(0,f.Vd)(y).then(e=>{if(200===e.status){var r,a;let l=null===(r=t.find(e=>"png"===e.type))||void 0===r?void 0:r.path,i=null==l?void 0:null===(a=l.split("?"))||void 0===a?void 0:a[0],o=(0,b.lx)(i);o.searchParams.set("smart_art_id",e.data.smart_art_id),o.searchParams.set("t",new Date().getTime().toString());let s=o.toString();null==j||j(n,s,e.data.smart_art_id),z(!1)}})})}).catch(e=>{z(!1),C.Z.error("".concat(e))})}n&&R(),window.clearTimeout(a)},400)},[T,A,D,O]);return(0,n.jsx)(i.Vq,{open:Z,onOpenChange:H,children:(0,n.jsxs)(i.cZ,{className:"max-w-screen-2xl overflow-hidden",ref:S,onOpenAutoFocus:e=>e.preventDefault(),"aria-describedby":void 0,children:[(0,n.jsx)(i.fK,{className:"relative z-10 pointer-events-none",children:(0,n.jsx)(i.$N,{children:k(D.smart_art_id?"graphic.edit_graphic":"graphic.title")})}),(0,n.jsx)("iframe",{ref:F,allow:"clipboard-write",className:(0,g.Z)("-mt-[3.75rem] flex-1 min-h-[93vh] w-full"),src:U,style:{visibility:"hidden"},onLoad:()=>F.current&&(F.current.style.visibility="visible")})]})})}},84660:function(e,t,r){"use strict";r.d(t,{X:function(){return a}});var n=r(52676);let a=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",...e,children:(0,n.jsx)("path",{d:"M9.09742 6.15052L4.31009 14.4435L6.06471 17.475L10.8502 9.18634L9.09742 6.15052ZM7.79701 18.4746H17.3651L19.1162 15.4404H9.54877L7.79701 18.4746ZM19.1109 13.4404L14.3252 5.15039H10.8294L15.6156 13.4404H19.1109ZM8.52 3.15039H15.48L22 14.4448L18.52 20.4746H5.49L2 14.4448L8.52 3.15039ZM12.0049 11.1864L10.7035 13.4404H13.3062L12.0049 11.1864Z",fill:"currentColor"})})},46024:function(e,t,r){"use strict";r.d(t,{Hf:function(){return s},e:function(){return i},om:function(){return o},pi:function(){return l},vN:function(){return a}});var n=r(52676);let a=e=>(0,n.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M11.0816 14.2125L10.4441 16.0312C10.3941 16.1687 10.3066 16.2813 10.1816 16.3688C10.0566 16.4563 9.91914 16.5 9.76914 16.5C9.51914 16.5 9.31601 16.3969 9.15976 16.1906C9.00351 15.9844 8.97539 15.7563 9.07539 15.5063L11.9254 7.96875C11.9879 7.83125 12.0816 7.71875 12.2066 7.63125C12.3316 7.54375 12.4691 7.5 12.6191 7.5H13.1816C13.3316 7.5 13.4691 7.54375 13.5941 7.63125C13.7191 7.71875 13.8129 7.83125 13.8754 7.96875L16.7254 15.525C16.8254 15.7625 16.8004 15.9844 16.6504 16.1906C16.5004 16.3969 16.3004 16.5 16.0504 16.5C15.8879 16.5 15.7473 16.4563 15.6285 16.3688C15.5098 16.2813 15.4191 16.1625 15.3566 16.0125L14.7191 14.2125H11.0816ZM6.56289 10.4813L3.30039 13.725C3.16289 13.8625 2.99102 13.9344 2.78477 13.9406C2.57852 13.9469 2.40039 13.875 2.25039 13.725C2.11289 13.5875 2.04414 13.4125 2.04414 13.2C2.04414 12.9875 2.11289 12.8125 2.25039 12.675L5.51289 9.4125C5.07539 8.975 4.67852 8.475 4.32227 7.9125C4.1397 7.62425 3.95468 7.30269 3.77729 6.96178C3.5317 6.4898 3.88878 5.94819 4.42083 5.94819C4.69989 5.94819 4.95397 6.10523 5.09024 6.34875C5.28183 6.69114 5.48216 7.01294 5.66289 7.275C5.91289 7.6375 6.21289 8 6.56289 8.3625C6.97539 7.95 7.40352 7.37188 7.84727 6.62813C8.29102 5.88438 8.62539 5.175 8.85039 4.5H2.02539C1.81289 4.5 1.63477 4.42813 1.49102 4.28438C1.34727 4.14062 1.27539 3.9625 1.27539 3.75C1.27539 3.5375 1.34727 3.35938 1.49102 3.21563C1.63477 3.07188 1.81289 3 2.02539 3H5.77539V2.25C5.77539 2.0375 5.84727 1.85938 5.99102 1.71562C6.13477 1.57187 6.31289 1.5 6.52539 1.5C6.73789 1.5 6.91602 1.57187 7.05977 1.71562C7.20352 1.85938 7.27539 2.0375 7.27539 2.25V3H10.6504C10.8629 3 11.041 3.07188 11.1848 3.21563C11.3285 3.35938 11.4004 3.5375 11.4004 3.75C11.4004 3.9625 11.3285 4.14062 11.1848 4.28438C11.041 4.42813 10.8629 4.5 10.6504 4.5H10.3504C10.0879 5.4 9.69414 6.325 9.16914 7.275C8.64414 8.225 8.12539 8.95 7.61289 9.45L9.0871 10.9549C9.28614 11.1581 9.35066 11.4576 9.25293 11.7247C9.06635 12.2347 8.41136 12.3752 8.03206 11.9865L6.56289 10.4813ZM11.5504 12.9H14.2504L12.9004 9.075L11.5504 12.9Z",fill:"currentColor"})}),l=e=>(0,n.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M22 11.086v.92a10 10 0 1 1-5.93-9.14M22 4L12 14.01l-3-3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),i=e=>(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,n.jsx)("path",{d:"M8.00001 14.6668C11.6667 14.6668 14.6667 11.6668 14.6667 8.00016C14.6667 4.3335 11.6667 1.3335 8.00001 1.3335C4.33334 1.3335 1.33334 4.3335 1.33334 8.00016C1.33334 11.6668 4.33334 14.6668 8.00001 14.6668Z",fill:"#02B66F",stroke:"#02B66F",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M5.16666 7.99995L7.05332 9.88661L10.8333 6.11328",stroke:"white",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"})]}),o=e=>(0,n.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M5 21C4.45 21 3.97917 20.8042 3.5875 20.4125C3.19583 20.0208 3 19.55 3 19V5C3 4.45 3.19583 3.97917 3.5875 3.5875C3.97917 3.19583 4.45 3 5 3H19C19.55 3 20.0208 3.19583 20.4125 3.5875C20.8042 3.97917 21 4.45 21 5V19C21 19.55 20.8042 20.0208 20.4125 20.4125C20.0208 20.8042 19.55 21 19 21H5ZM5 19H19V5H5V19ZM7 17H17C17.2 17 17.35 16.9083 17.45 16.725C17.55 16.5417 17.5333 16.3667 17.4 16.2L14.65 12.525C14.55 12.3917 14.4167 12.325 14.25 12.325C14.0833 12.325 13.95 12.3917 13.85 12.525L11.25 16L9.4 13.525C9.3 13.3917 9.16667 13.325 9 13.325C8.83333 13.325 8.7 13.3917 8.6 13.525L6.6 16.2C6.46667 16.3667 6.45 16.5417 6.55 16.725C6.65 16.9083 6.8 17 7 17Z",fill:"currentColor"})}),s=e=>(0,n.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M15.85 12.425C16 12.325 16.075 12.1833 16.075 12C16.075 11.8167 16 11.675 15.85 11.575L10.275 8C10.1083 7.88333 9.9375 7.875 9.7625 7.975C9.5875 8.075 9.5 8.225 9.5 8.425V15.575C9.5 15.775 9.5875 15.925 9.7625 16.025C9.9375 16.125 10.1083 16.1167 10.275 16L15.85 12.425ZM5 21C4.45 21 3.97917 20.8042 3.5875 20.4125C3.19583 20.0208 3 19.55 3 19V5C3 4.45 3.19583 3.97917 3.5875 3.5875C3.97917 3.19583 4.45 3 5 3H19C19.55 3 20.0208 3.19583 20.4125 3.5875C20.8042 3.97917 21 4.45 21 5V19C21 19.55 20.8042 20.0208 20.4125 20.4125C20.0208 20.8042 19.55 21 19 21H5ZM5 19H19V5H5V19Z",fill:"currentColor"})})},24213:function(e,t,r){"use strict";r.d(t,{$U:function(){return a},RM:function(){return o},e8:function(){return l},y_:function(){return i}});var n=r(52676);let a=e=>(0,n.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,n.jsxs)("g",{clipPath:"url(#clip0_2552_84059)",children:[(0,n.jsx)("path",{d:"M2.24 2.784l9-1.284v15l-9-1.33V2.784zM12.844 3.047h2.86V15h-2.86",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M6.787 9.714H5.53v1.918c0 .274-.065.482-.194.624a.635.635 0 0 1-.49.213.643.643 0 0 1-.5-.208c-.126-.142-.189-.348-.189-.62V6.42c0-.302.07-.517.208-.647.139-.13.36-.194.661-.194h1.76c.522 0 .922.04 1.202.12.278.077.516.205.717.384.203.179.357.397.462.656.105.259.157.55.157.874 0 .69-.213 1.213-.638 1.57-.425.355-1.058.532-1.9.532zM6.454 6.61H5.53v2.07h.924c.324 0 .593-.034.809-.102a.946.946 0 0 0 .499-.332c.114-.154.171-.356.171-.606 0-.299-.088-.542-.263-.73-.198-.2-.603-.3-1.216-.3z",fill:"currentColor"})]}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0_2552_84059",children:(0,n.jsx)("path",{fill:"#fff",d:"M0 0h18v18H0z"})})})]}),l=e=>(0,n.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.7929 1.79312C19.0118 0.574168 20.9882 0.57417 22.2071 1.79312C23.4261 3.01207 23.4261 4.98838 22.2071 6.20733L12.6444 15.7701C12.6246 15.7899 12.605 15.8095 12.5855 15.829C12.2981 16.117 12.0446 16.3709 11.7391 16.5581C11.4707 16.7226 11.178 16.8438 10.8719 16.9173C10.5235 17.001 10.1647 17.0007 9.75781 17.0003C9.73027 17.0003 9.70251 17.0002 9.67452 17.0002H7.99997C7.44769 17.0002 6.99997 16.5525 6.99997 16.0002V14.3257C6.99997 14.2977 6.99995 14.27 6.99992 14.2424C6.99954 13.8355 6.99921 13.4768 7.08286 13.1283C7.15636 12.8222 7.27757 12.5296 7.44206 12.2612C7.62929 11.9556 7.8832 11.7022 8.17119 11.4147C8.19068 11.3953 8.21033 11.3757 8.23013 11.3559L17.7929 1.79312ZM20.7929 3.20733C20.355 2.76943 19.645 2.76943 19.2071 3.20733L9.64434 12.7701C9.26478 13.1496 9.19479 13.2287 9.14733 13.3062C9.0925 13.3956 9.0521 13.4932 9.0276 13.5952C9.0064 13.6835 8.99997 13.7889 8.99997 14.3257V15.0002H9.67452C10.2113 15.0002 10.3167 14.9938 10.405 14.9726C10.5071 14.9481 10.6046 14.9077 10.6941 14.8529C10.7715 14.8054 10.8506 14.7354 11.2302 14.3559L20.7929 4.79312C21.2308 4.35522 21.2308 3.64524 20.7929 3.20733ZM6.7587 3.00023L11 3.00023C11.5523 3.00023 12 3.44794 12 4.00023C12 4.55251 11.5523 5.00023 11 5.00023H6.8C5.94342 5.00023 5.36113 5.00101 4.91104 5.03778C4.47262 5.0736 4.24842 5.13853 4.09202 5.21821C3.7157 5.40996 3.40973 5.71592 3.21799 6.09225C3.1383 6.24865 3.07337 6.47285 3.03755 6.91127C3.00078 7.36135 3 7.94365 3 8.80023V17.2002C3 18.0568 3.00078 18.6391 3.03755 19.0892C3.07337 19.5276 3.1383 19.7518 3.21799 19.9082C3.40973 20.2845 3.7157 20.5905 4.09202 20.7822C4.24842 20.8619 4.47262 20.9269 4.91104 20.9627C5.36113 20.9994 5.94342 21.0002 6.8 21.0002H15.2C16.0566 21.0002 16.6389 20.9994 17.089 20.9627C17.5274 20.9269 17.7516 20.8619 17.908 20.7822C18.2843 20.5905 18.5903 20.2845 18.782 19.9082C18.8617 19.7518 18.9266 19.5276 18.9624 19.0892C18.9992 18.6391 19 18.0568 19 17.2002V13.0002C19 12.4479 19.4477 12.0002 20 12.0002C20.5523 12.0002 21 12.4479 21 13.0002V17.2416C21 18.0465 21 18.7109 20.9558 19.2521C20.9099 19.8141 20.8113 20.3309 20.564 20.8162C20.1805 21.5688 19.5686 22.1808 18.816 22.5643C18.3306 22.8115 17.8139 22.9101 17.2518 22.956C16.7106 23.0002 16.0463 23.0002 15.2413 23.0002H6.75868C5.95372 23.0002 5.28936 23.0002 4.74817 22.956C4.18608 22.9101 3.66937 22.8115 3.18404 22.5643C2.43139 22.1808 1.81947 21.5688 1.43598 20.8162C1.18868 20.3309 1.09012 19.8141 1.04419 19.2521C0.999977 18.7109 0.999988 18.0465 1 17.2415V8.75893C0.999988 7.95396 0.999977 7.2896 1.04419 6.7484C1.09012 6.1863 1.18868 5.6696 1.43597 5.18427C1.81947 4.43162 2.43139 3.8197 3.18404 3.4362C3.66937 3.18891 4.18608 3.09035 4.74817 3.04442C5.28937 3.0002 5.95373 3.00021 6.7587 3.00023Z",fill:"currentColor"})}),i=e=>(0,n.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.2929 2.29319C17.788 0.798101 20.212 0.798103 21.7071 2.2932C23.2022 3.78829 23.2022 6.21232 21.7071 7.70741L18.7098 10.7048L18.7071 10.7074L18.7045 10.71L8.50084 20.9137L8.45099 20.9636C8.20609 21.2089 7.99007 21.4252 7.7334 21.5945C7.50774 21.7433 7.26301 21.8609 7.00584 21.9442C6.71333 22.0389 6.40942 22.0724 6.06489 22.1104L5.99481 22.1181L2.61044 22.4942C2.30851 22.5277 2.00771 22.4222 1.7929 22.2074C1.57809 21.9926 1.47258 21.6918 1.50612 21.3899L1.88216 18.0055L1.88992 17.9354C1.92792 17.5909 1.96144 17.287 2.05613 16.9945C2.13938 16.7373 2.25701 16.4926 2.40582 16.2669C2.57507 16.0102 2.79143 15.7942 3.03672 15.5493L3.03673 15.5493L3.08663 15.4995L16.2929 2.29319ZM14 7.41451L4.50084 16.9137C4.17834 17.2362 4.11846 17.3027 4.07547 17.3679C4.02587 17.4431 3.98666 17.5247 3.95891 17.6104C3.93486 17.6847 3.9203 17.7731 3.86993 18.2264L3.63193 20.3684L5.77394 20.1304C6.22724 20.08 6.31556 20.0655 6.38986 20.0414C6.47559 20.0136 6.55717 19.9744 6.63238 19.9248C6.69758 19.8818 6.76412 19.822 7.08663 19.4995L16.5858 10.0003L14 7.41451ZM18 8.58609L15.4142 6.0003L17.7071 3.70741C18.4212 2.99336 19.5789 2.99336 20.2929 3.70741C21.007 4.42145 21.007 5.57915 20.2929 6.2932L18 8.58609ZM5.29912 6.92207C5.32553 6.94753 5.3567 6.96754 5.39085 6.98095C5.42501 6.99435 5.46147 7.00089 5.49815 7.00019C5.5353 7.00126 5.57228 6.99491 5.60694 6.98149C5.6416 6.96808 5.67322 6.94787 5.69997 6.92207C5.75708 6.87164 5.79407 6.80229 5.80413 6.72676C5.85063 6.42109 5.8993 6.16317 5.95015 5.95298C6.00223 5.74466 6.06857 5.57322 6.14917 5.43868C6.23102 5.30413 6.33735 5.19687 6.46818 5.11689C6.60086 5.03815 6.76827 4.97584 6.9704 4.92995C7.21585 4.875 7.46427 4.83432 7.71443 4.80812C7.79271 4.80311 7.86606 4.76814 7.91923 4.71046C7.9724 4.65279 8.00131 4.57685 7.99995 4.49842C8.00066 4.46108 7.99386 4.42398 7.97996 4.38931C7.96606 4.35464 7.94534 4.32312 7.91904 4.29661C7.86652 4.23806 7.79507 4.19987 7.71722 4.18872C7.46827 4.15554 7.22094 4.11116 6.97598 4.05573C6.80358 4.0184 6.63816 3.95405 6.48585 3.86508C6.35629 3.78696 6.24775 3.67842 6.16964 3.54887C6.07701 3.39149 6.00807 3.22133 5.96503 3.04386C5.91171 2.83554 5.85807 2.57885 5.80413 2.2738C5.79276 2.19782 5.75487 2.12831 5.69718 2.07757C5.64369 2.02647 5.5721 1.99871 5.49815 2.00038C5.42358 1.99992 5.35156 2.02746 5.29633 2.07757C5.2397 2.12852 5.20338 2.1982 5.19403 2.2738C5.1578 2.53355 5.10938 2.79145 5.04894 3.04665C5.00773 3.2275 4.93971 3.40117 4.84712 3.56189C4.76765 3.69256 4.65832 3.80252 4.52812 3.88275C4.39791 3.96211 4.23144 4.02473 4.02869 4.07061C3.78222 4.12258 3.53327 4.162 3.2828 4.18872C3.20462 4.19703 3.13233 4.23417 3.08005 4.29289C3.0272 4.34809 2.99843 4.42202 3.00007 4.49842C2.9989 4.57395 3.02649 4.64709 3.07726 4.70303C3.13058 4.76131 3.19785 4.79634 3.27908 4.80812C3.57421 4.85152 3.82129 4.89709 4.02032 4.94483C4.22059 4.99258 4.38489 5.05582 4.51324 5.13456C4.64344 5.21454 4.74761 5.31994 4.82573 5.45077C4.90757 5.58097 4.97578 5.7493 5.03034 5.95577C5.08614 6.1641 5.14101 6.42078 5.19496 6.72583C5.20703 6.80096 5.24366 6.86997 5.29912 6.92207ZM19.2197 21.8926C19.2951 21.9623 19.3941 22.0008 19.4968 22.0002C19.6013 22.0021 19.7035 21.9636 19.7803 21.8926C19.8603 21.8213 19.9121 21.7238 19.9263 21.6176C19.9902 21.1898 20.0584 20.8288 20.1309 20.5346C20.1881 20.2822 20.2818 20.0394 20.4091 19.814C20.5178 19.629 20.6714 19.4743 20.8556 19.3642C21.0752 19.2412 21.3125 19.1528 21.559 19.102C21.9024 19.0261 22.2496 18.9692 22.5992 18.9314C22.7091 18.9249 22.8121 18.876 22.8868 18.7952C22.9615 18.7143 23.002 18.6077 22.9999 18.4976C22.9992 18.3896 22.9616 18.2951 22.887 18.2141C22.8152 18.1338 22.7207 18.084 22.6035 18.0649C22.1935 18.0066 21.8482 17.944 21.5675 17.8773C21.2897 17.8105 21.0606 17.7216 20.8801 17.6108C20.6997 17.4999 20.5526 17.3528 20.4389 17.1695C20.3252 16.9861 20.2293 16.7502 20.1511 16.4617C20.0758 16.1704 20.0009 15.8108 19.9263 15.383C19.9112 15.2764 19.8583 15.1787 19.7771 15.108C19.6989 15.0362 19.6058 15.0003 19.4978 15.0003C19.3932 14.9992 19.2919 15.0377 19.2143 15.108C19.1343 15.1787 19.0838 15.2768 19.0726 15.383C19.0094 15.8108 18.9415 16.1718 18.869 16.466C18.7973 16.7573 18.7028 16.9975 18.5855 17.1865C18.4719 17.3727 18.3234 17.5227 18.1401 17.6364C17.9575 17.7472 17.7241 17.8346 17.4399 17.8986C17.1571 17.9625 16.8089 18.018 16.3954 18.0649C16.2861 18.075 16.185 18.1269 16.113 18.2098C16.0377 18.2908 16 18.3868 16 18.4976C15.9992 18.6037 16.0379 18.7064 16.1087 18.7854C16.183 18.8655 16.2829 18.9171 16.3911 18.9314C16.8054 18.9918 17.151 19.0558 17.4281 19.1233C17.671 19.175 17.9041 19.265 18.1187 19.3898C18.2984 19.4988 18.4485 19.6503 18.5557 19.8311C18.6851 20.052 18.782 20.2903 18.8435 20.5389C18.9216 20.8302 18.998 21.1898 19.0726 21.6176C19.0896 21.7231 19.1414 21.8199 19.2197 21.8926Z",fill:"currentColor"})}),o=e=>(0,n.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.7587 23H15.2413H15.2414C16.0463 23 16.7107 23 17.2518 22.9558C17.8139 22.9099 18.3306 22.8113 18.816 22.564C19.5686 22.1805 20.1805 21.5686 20.564 20.816C20.8113 20.3306 20.9099 19.8139 20.9558 19.2518C21 18.7106 21 18.0463 21 17.2413V13.5C21 12.9477 20.5523 12.5 20 12.5C19.4477 12.5 19 12.9477 19 13.5V17.2C19 18.0566 18.9992 18.6389 18.9624 19.089C18.9266 19.5274 18.8617 19.7516 18.782 19.908C18.5903 20.2843 18.2843 20.5903 17.908 20.782C17.7516 20.8617 17.5274 20.9266 17.089 20.9624C16.6389 20.9992 16.0566 21 15.2 21H8.8C7.94342 21 7.36113 20.9992 6.91104 20.9624C6.47262 20.9266 6.24842 20.8617 6.09202 20.782C5.7157 20.5903 5.40973 20.2843 5.21799 19.908C5.1383 19.7516 5.07337 19.5274 5.03755 19.089C5.00078 18.6389 5 18.0566 5 17.2V6.8C5 5.94342 5.00078 5.36113 5.03755 4.91104C5.07337 4.47262 5.1383 4.24842 5.21799 4.09202C5.40973 3.7157 5.7157 3.40974 6.09202 3.21799C6.24842 3.1383 6.47262 3.07337 6.91104 3.03755C7.36113 3.00078 7.94342 3 8.8 3H11.5C12.0523 3 12.5 2.55228 12.5 2C12.5 1.44772 12.0523 1 11.5 1H8.75868C7.95372 0.999987 7.28937 0.999978 6.74818 1.04419C6.18608 1.09012 5.66937 1.18868 5.18404 1.43597C4.43139 1.81947 3.81947 2.43139 3.43598 3.18404C3.18868 3.66937 3.09012 4.18608 3.04419 4.74818C2.99998 5.28937 2.99999 5.95372 3 6.75869V6.7587V17.2413V17.2413C2.99999 18.0463 2.99998 18.7106 3.04419 19.2518C3.09012 19.8139 3.18868 20.3306 3.43598 20.816C3.81947 21.5686 4.43139 22.1805 5.18404 22.564C5.66937 22.8113 6.18608 22.9099 6.74818 22.9558C7.28935 23 7.95367 23 8.75859 23H8.7587ZM12.0062 14.515H10.3301V17.0722C10.3301 17.4378 10.2438 17.7151 10.0713 17.904C9.89877 18.093 9.68105 18.1875 9.41813 18.1875C9.1429 18.1875 8.92107 18.0951 8.75264 17.9102C8.58421 17.7212 8.5 17.446 8.5 17.0845V10.1215C8.5 9.7189 8.59243 9.43134 8.77729 9.2588C8.96215 9.08627 9.25587 9 9.65845 9H12.0062C12.7004 9 13.2344 9.0534 13.6083 9.16021C13.978 9.26291 14.2964 9.43339 14.5634 9.67165C14.8345 9.90992 15.0399 10.2016 15.1796 10.5467C15.3192 10.8917 15.3891 11.2799 15.3891 11.7113C15.3891 12.6315 15.1056 13.3298 14.5387 13.8063C13.9718 14.2788 13.1276 14.515 12.0062 14.515ZM11.5625 10.3741H10.3301V13.1347H11.5625C11.9938 13.1347 12.3533 13.0895 12.6408 12.9991C12.9325 12.9087 13.1543 12.7609 13.3063 12.5555C13.4583 12.3501 13.5343 12.081 13.5343 11.7482C13.5343 11.3498 13.4173 11.0252 13.1831 10.7746C12.9202 10.5076 12.38 10.3741 11.5625 10.3741ZM17.9972 10.9998C17.8458 10.9998 17.7129 10.9484 17.5986 10.8456V10.8442C17.4872 10.7404 17.4182 10.6094 17.3915 10.4514C17.2829 9.84099 17.1734 9.32727 17.0629 8.9102C16.9525 8.49884 16.8158 8.16176 16.6529 7.89894C16.4939 7.63708 16.2858 7.42712 16.0287 7.26905C15.7696 7.11098 15.4401 6.98434 15.0401 6.88912C14.6439 6.79294 14.1501 6.70153 13.5587 6.61488C13.3968 6.59107 13.2621 6.52156 13.1544 6.40634C13.0516 6.29208 13.0002 6.15544 13.0002 5.99641C12.9984 5.9209 13.0116 5.84579 13.0391 5.77543C13.0666 5.70507 13.1077 5.64085 13.1602 5.58648C13.2645 5.46863 13.4093 5.39421 13.5659 5.37795C14.1573 5.31034 14.6544 5.23083 15.0573 5.13942C15.4081 5.06766 15.7455 4.94139 16.0572 4.7652C16.3176 4.60452 16.536 4.3842 16.6944 4.12245C16.8817 3.8027 17.0181 3.45575 17.0986 3.09406C17.2194 2.58317 17.3167 2.067 17.3901 1.54718C17.4079 1.39601 17.48 1.25644 17.5929 1.15439C17.7019 1.05232 17.8465 0.996949 17.9958 1.00013C18.1441 0.997697 18.2875 1.05301 18.3958 1.15439C18.5119 1.25544 18.588 1.39482 18.61 1.54718C18.7177 2.1585 18.8248 2.67222 18.9315 3.08834C19.0195 3.44315 19.1575 3.78365 19.3414 4.0996C19.499 4.35618 19.7148 4.57199 19.9714 4.72949C20.2771 4.90588 20.6081 5.03403 20.9528 5.10942C21.3547 5.2056 21.8485 5.29511 22.4342 5.37795C22.5904 5.39952 22.7341 5.47536 22.8399 5.5922C22.9445 5.70059 23.002 5.84586 22.9999 5.99641C23.0021 6.15308 22.944 6.30459 22.8377 6.41968C22.7314 6.53477 22.5849 6.60464 22.4285 6.61488C21.9284 6.66762 21.4319 6.74965 20.9414 6.86055C20.5376 6.95196 20.2024 7.0767 19.9357 7.23477C19.6738 7.39284 19.4619 7.60709 19.3 7.87752C19.1167 8.19857 18.9824 8.54519 18.9015 8.90591C18.7986 9.32584 18.7015 9.84147 18.61 10.4528C18.5895 10.6044 18.5155 10.7436 18.4015 10.8456C18.2921 10.948 18.147 11.0034 17.9972 10.9998Z",fill:"currentColor"})})},29463:function(e,t,r){"use strict";r.d(t,{Z:function(){return e_}});var n=r(52676),a=r(75271),l=r(82313),i=r(14701),o=r.n(i),s=r(43220),d=r.n(s),c=r(13003),u=r(31022),h=r(70235),p=r.n(h),m=r(17224),g=r(7717),x=r(43378),f=r(25010),v=r(66945),C=r(29764),b=r(27585),w=r(90488),y=r(37639),j=r(39109),k=r(87106),_=r(74926),N=r(65819),S=r(57546),F=r(52597),T=r(29871),E=r(60635),Z=r(97247);let I=e=>{let{show:t,position:r,onFactCheck:a,onTraditionalSearch:l,factCheckLoading:i}=e,o=(0,g.useTranslations)(),{isMobile:s}=(0,T.Z)(),d=0;return t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p(),{id:"55bcbd1d93cda171",dynamic:[r.x,r.y],children:".text-selection-popover.__jsx-style-dynamic-selector{position:absolute;left:".concat(r.x,"px;top:").concat(r.y,"px;-webkit-transform:translate(-50%,-webkit-calc(-100% - 2px));-moz-transform:translate(-50%,-moz-calc(-100% - 2px));-ms-transform:translate(-50%,calc(-100% - 2px));-o-transform:translate(-50%,calc(-100% - 2px));transform:translate(-50%,-webkit-calc(-100% - 2px));transform:translate(-50%,-moz-calc(-100% - 2px));transform:translate(-50%,calc(-100% - 2px))}.text-selection-popover.mobile.__jsx-style-dynamic-selector,.text-selection-popover.show-below.__jsx-style-dynamic-selector{-webkit-transform:translate(-50%,6px);-moz-transform:translate(-50%,6px);-ms-transform:translate(-50%,6px);-o-transform:translate(-50%,6px);transform:translate(-50%,6px)}")}),(0,n.jsx)("div",{"data-popover":"text-selection",className:p().dynamic([["55bcbd1d93cda171",[r.x,r.y]]])+" "+"text-selection-popover ".concat(s?"mobile":""," ").concat(s?"z-[99999]":"z-[1]"),children:(0,n.jsxs)("div",{"data-theme-border":!0,onClick:e=>{e.stopPropagation()},className:p().dynamic([["55bcbd1d93cda171",[r.x,r.y]]])+" "+"bg-white dark:bg-gray-800 border rounded-lg shadow-lg p-1 flex items-center\n                   ".concat(s?"mx-2":""),children:[!(0,Z.N0)()&&(0,n.jsx)(f.z,{size:"sm",variant:"ghost",onClick:e=>{let t=Date.now();t-d<300||(d=t,a())},onTouchEnd:e=>{let t=Date.now();t-d<300||(d=t,e.preventDefault(),a())},onMouseDown:e=>{e.stopPropagation()},className:"text-xs border-none bg-transparent hover:bg-[#F6F7F9] dark:hover:bg-[#545D6F] py-1 px-2 text-[#30394A] dark:text-white",disabled:i,children:i?(0,n.jsxs)("div",{className:p().dynamic([["55bcbd1d93cda171",[r.x,r.y]]])+" flex items-center gap-1",children:[(0,n.jsx)("div",{className:p().dynamic([["55bcbd1d93cda171",[r.x,r.y]]])+" animate-spin rounded-full h-3 w-3 border-b border-current"}),o("text_selection.fact_check")]}):(0,n.jsxs)("div",{className:p().dynamic([["55bcbd1d93cda171",[r.x,r.y]]])+" flex items-center gap-1",children:[(0,n.jsx)(F.lM,{className:"w-5 h-5"}),o("text_selection.fact_check")]})}),!(0,Z.N0)()&&(0,n.jsx)("div",{className:p().dynamic([["55bcbd1d93cda171",[r.x,r.y]]])+" w-[2px] mx-2 h-4 bg-[#E6E9EF] dark:bg-[#545D6F]"}),(0,n.jsx)(f.z,{size:"sm",variant:"ghost",onClick:e=>{let t=Date.now();t-d<300||(d=t,l())},onTouchEnd:e=>{let t=Date.now();t-d<300||(d=t,e.preventDefault(),l())},onMouseDown:e=>{e.stopPropagation()},className:"text-xs border-none bg-transparent hover:bg-[#F6F7F9] dark:hover:bg-[#545D6F] py-1 px-2 text-[#30394A] dark:text-white",children:(0,n.jsxs)("div",{className:p().dynamic([["55bcbd1d93cda171",[r.x,r.y]]])+" flex items-center gap-1",children:[(0,n.jsx)(F.tG,{className:"w-5 h-5"}),o("text_selection.traditional_search")]})})]})})]}):null},D=e=>{let{open:t,onOpenChange:r,selectedText:a,searchResults:l,searchLoading:i,searchError:o,onRetry:s}=e,d=(0,g.useTranslations)(),c=(e,t)=>{if(!t||0===t.length)return e;let r=RegExp("(".concat(t.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),")"),"gi");return e.split(r).map((e,r)=>t.some(t=>e.toLowerCase()===t.toLowerCase())?(0,n.jsx)("span",{className:"text-red-500 font-medium",children:e},r):e)};return(0,n.jsx)(x.Vq,{open:t,onOpenChange:r,children:(0,n.jsxs)(x.cZ,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,n.jsx)(x.fK,{children:(0,n.jsxs)(x.$N,{className:"flex items-center gap-2",children:[(0,n.jsx)(C.Z,{size:20}),d("text_selection.search_results_title")]})}),(0,n.jsxs)(x.a7,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[d("text_selection.search_content"),': "',a,'"']}),i&&(0,n.jsx)("div",{className:"flex justify-center py-8",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),o&&(0,n.jsxs)("div",{className:"text-center py-8",children:[(0,n.jsx)("p",{className:"text-red-500 mb-4",children:o}),(0,n.jsx)(f.z,{onClick:s,variant:"outline",size:"sm",children:d("websearch.retry")})]}),0===l.length&&!i&&!o&&(0,n.jsx)("div",{className:"text-center py-8 text-gray-500",children:d("websearch.no_results_found")}),l.map((e,t)=>(0,n.jsxs)("div",{className:"flex flex-col gap-1 my-8",children:[(0,n.jsxs)("a",{className:"flex items-center gap-2",href:e.site.url,target:"_blank",onClick:t=>{(0,Z.N0)()&&(t.preventDefault(),(0,E.oh)({url:e.site.url}))},children:[(0,n.jsx)(w.Z,{src:e.site.icon,width:28,height:28,classNames:{wrapper:"bg-gray-300 rounded-full"}}),(0,n.jsxs)("div",{className:"ml-1",children:[(0,n.jsx)("p",{className:"line-clamp-1 text-base",children:e.site.name||e.title}),(0,n.jsx)("p",{className:"text-sm line-clamp-1 break-all text-[#888888]",children:(0,b.CN)({url:e.site.url||""})})]})]}),(0,n.jsx)("a",{href:e.link,target:"_blank",className:"text-[#179eff] hover:underline text-xl",onClick:t=>{(0,Z.N0)()&&(t.preventDefault(),(0,E.oh)({url:e.link}))},children:e.title}),(0,n.jsxs)("div",{className:"text-sm text-[#7f7f7f]",children:[e.updated_at&&"".concat(e.updated_at," â€” "),c(e.snippet,e.words)]})]},t))]})]})})},A=e=>{let{containerRef:t}=e,r=(0,g.useTranslations)();(0,m.useRouter)();let n=(0,j.Z)(),[l,i]=(0,a.useState)(""),[o,s]=(0,a.useState)({x:0,y:0}),[d,c]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!1),[p,x]=(0,a.useState)([]),[f,C]=(0,a.useState)(!1),[b,w]=(0,a.useState)(""),[F,E]=(0,a.useState)(!1),{isMobile:I}=(0,T.Z)(),D=(0,g.useLocale)(),A=()=>{var e,r,n;let a=window.getSelection();if(!a||0===a.rangeCount){c(!1);return}let l=a.toString().trim();if(!l||0===l.length||l.length<1){c(!1);return}let o=a.getRangeAt(0);if(!(null===(e=t.current)||void 0===e?void 0:e.contains(o.commonAncestorContainer))){c(!1);return}let d=null===(r=a.anchorNode)||void 0===r?void 0:r.parentElement;if((null==d?void 0:d.closest("button"))||(null==d?void 0:d.closest('[data-popover="text-selection"]'))){c(!1);return}i(l);let u=o.getBoundingClientRect(),h=null===(n=t.current)||void 0===n?void 0:n.getBoundingClientRect();if(I){let e=u.left,t=u.right,r=u.bottom+8,n=((0,Z.N0)()?140:280)/2,a=window.innerWidth-16-n;s({x:Math.min(Math.max(e+(t-e)/2,16+n),a)-((null==h?void 0:h.left)||0),y:r-((null==h?void 0:h.top)||0)})}else{let e=u.top-((null==h?void 0:h.top)||0)<30;s({x:u.left-((null==h?void 0:h.left)||0)+u.width/2,y:e?u.bottom-((null==h?void 0:h.top)||0)+8:u.top-((null==h?void 0:h.top)||0)-10}),setTimeout(()=>{let t=document.querySelector("[data-popover='text-selection']");t&&(e?t.classList.add("show-below"):t.classList.remove("show-below"))},0)}c(!0)},L=async()=>{c(!1);let e=window.getSelection();e&&e.removeAllRanges(),h(!0),C(!0),w(""),x([]);try{let e=await (0,v.O)(l);e?x(e):w(r("websearch.no_results_found"))}catch(e){w(r("websearch.search_failed"))}finally{C(!1)}},M=async()=>{E(!0);try{var e,t;if(!N.ZP.getState().isLogin){S.Z.getState().setLoginModalVisible(!0);return}let a=await (0,k.Vk)(D,"fact_checking"),i={query:l};if(null===(e=a.data)||void 0===e?void 0:e.template_info){let e=null===(t=a.data)||void 0===t?void 0:t.template_info;_.Z.getState().setTemplate(e),i.category="google",i.model=e.sub_topics[0].llm_model,i.templateId=e.id;let r=(0,y.MD)(i);(0,Z.s)()?location.href=r:window.open(r,"_blank"),c(!1);let n=window.getSelection();n&&n.removeAllRanges()}else n.error(r("ppt.failed_generate"))}catch(e){n.error(r("ppt.failed_generate"))}finally{E(!1)}};return(0,a.useEffect)(()=>{let e;let t=!1,r=0,n=e=>{e.target.closest('[data-popover="text-selection"]')||(t=!0,c(!1))},a=r=>{!r.target.closest('[data-popover="text-selection"]')&&t&&(t=!1,e&&clearTimeout(e),e=setTimeout(()=>{A()},150))},l=e=>{e.target.closest('[data-popover="text-selection"]')||(r=Date.now(),t=!0,c(!1))},i=n=>{!n.target.closest('[data-popover="text-selection"]')&&t&&(t=!1,Date.now()-r<100||(e&&clearTimeout(e),e=setTimeout(()=>{A()},200)))},o=e=>{e.target.closest('[data-popover="text-selection"]')||c(!1)},s=()=>{let t=window.getSelection();if(!(null==t?void 0:t.toString().trim())){c(!1);return}I&&(e&&clearTimeout(e),e=setTimeout(()=>{let e=window.getSelection();e&&e.toString().trim()&&A()},300))},d=()=>{setTimeout(()=>{let e=window.getSelection();e&&e.toString().trim()||c(!1)},100)};return I?(document.addEventListener("touchstart",l,{passive:!0}),document.addEventListener("touchend",i,{passive:!0})):(document.addEventListener("mousedown",n),document.addEventListener("mouseup",a),document.addEventListener("click",o)),document.addEventListener("selectionchange",s),document.addEventListener("copy",d),()=>{e&&clearTimeout(e),I?(document.removeEventListener("touchstart",l),document.removeEventListener("touchend",i)):(document.removeEventListener("mousedown",n),document.removeEventListener("mouseup",a),document.removeEventListener("click",o)),document.removeEventListener("selectionchange",s),document.removeEventListener("copy",d)}},[I]),{selectedText:l,selectionPosition:o,showSelectionPopover:d,showSearchDialog:u,searchResults:p,searchLoading:f,searchError:b,factCheckLoading:F,handleFactCheck:M,handleTraditionalSearch:L,setShowSearchDialog:h}};var L=r(46264),M=r(13288),O=r(57434),P=r(75450),B=r(6229),z=r(77774);r(16832);var R=r(4590),H=r(25339),U=r(2839),V=r(69593),q=r(82550),G=r(20271),J=r(99421),X=r(20796),W=r(15133),$=r(79057),K=r(23083),Y=r(72035),Q=r(72696),ee=r(17112),et=r(11920),er=r(34097);let en=e=>{let{src:t,alt:r,sources:l,...i}=e,o=(0,g.useTranslations)(),{setShowGraphicModel:s,setGraphicQueryData:d,allGraphicData:c}=(0,$.Z)(),{isMyThread:u}=(0,K.Z)(),h=t?(0,b.lx)(t):null,p=(null==h?void 0:h.searchParams.get("message_id"))||"",m=(null==h?void 0:h.searchParams.get("thread_id"))||"",x=(null==h?void 0:h.searchParams.get("smart_art_id"))||"",f=null==t?void 0:t.startsWith("https://felo-smart-art.s3.ap-northeast-1.amazonaws.com/smart/"),[v,C]=(0,a.useState)(!1);(0,a.useCallback)(()=>{f&&u&&(d({messageId:p,threadId:m,language:"auto",inputText:"test",query:"test",canEdit:u,template:void 0,mode:"thread",smart_art_id:x||"",isChangeImgUrl:!1}),s(!0))},[s,d,u,p,m,x,f]);let w=(0,a.useCallback)(async e=>{if(f){ee.Z.info(o("drive.download_loading"),99999);try{var t,r,n,a,l,i,s;let d;if(p&&m?d=await (0,er.b4)({thread_id:m,message_id:p}):x&&(d=await (0,er.mU)(x)),null==d?void 0:null===(t=d.data)||void 0===t?void 0:t.content){let t=$.Z.getState().allGraphicData,c={...d.data,images:d.data.images.map(e=>({...e,path:"".concat((0,b.lx)(e.path),"?t=").concat(new Date().getTime())}))};if($.Z.getState().setAllGraphicData({...t,[p]:c}),"png"===e||"svg"===e){let t=(null===(a=d.data)||void 0===a?void 0:null===(n=a.images)||void 0===n?void 0:null===(r=n.find(t=>t.type===e))||void 0===r?void 0:r.path)||"";await (0,et.l)(t,"image.".concat(e)),ee.Z.close()}else if("pdf"===e){let e=(null===(s=d.data)||void 0===s?void 0:null===(i=s.images)||void 0===i?void 0:null===(l=i.find(e=>"png"===e.type))||void 0===l?void 0:l.path)||"";await (0,et.F)({title:"export",imageUrl:e,onProgress:()=>ee.Z.info(o("drive.download_loading"),99999),onError:e=>ee.Z.error("".concat(e),3e3),onComplete:()=>ee.Z.close(),scale:1.5,quality:1,pageMargin:.8})}}}catch(e){ee.Z.close(),ee.Z.error("".concat(e),3e3)}}},[p,m,x,c,o,f]);if(f)return(0,n.jsxs)("div",{className:"flex group flex-wrap gap-4  w-full rounded-2xl relative border border-transparent hover:border-[#E6E9EF] hover:dark:border-[#242A38]",children:[(0,n.jsx)("div",{className:"items-center justify-around gap-2 absolute top-5 right-6 ".concat(v?"flex":"hidden group-hover:flex"),children:(0,n.jsxs)(Q.h_,{open:v,onOpenChange:C,children:[(0,n.jsx)(Q.$F,{asChild:!0,children:(0,n.jsx)("div",{className:"w-[32px] h-[32px] flex items-center rounded-full justify-center cursor-pointer bg-gray-100 dark:bg-gray-900 text-gray-500 dark:text-gray-400",children:(0,n.jsx)(W.Z,{size:16})})}),(0,n.jsxs)(Q.AW,{className:"z-50",children:[(0,n.jsx)(Q.Xi,{onClick:()=>w("svg"),children:"SVG"}),(0,n.jsx)(Q.Xi,{onClick:()=>w("png"),children:"PNG"}),(0,n.jsx)(Q.Xi,{onClick:()=>w("pdf"),children:"PDF"})]})]})}),(0,n.jsx)("div",{className:"flex-1 overflow-hidden flex items-center justify-center rounded-2xl",children:(0,n.jsx)("img",{src:t,alt:r,...i,className:"flex-1 m-0 object-cover max-w-full rounded-lg"})})]});if(null==t?void 0:t.startsWith("https://DATA_URI/")){let e=decodeURIComponent(t.replace("https://DATA_URI/",""));return(0,n.jsx)(Y.O,{src:e,sources:l,alt:r||""})}let y=(0,X.OT)(t||"");return(0,n.jsx)(Y.O,{src:y,sources:l,alt:r||""})},ea=e=>{let t;let r=/(\$\$[\s\S]+?\$\$|\$[^\$\n]+?\$)/g,n=[];for(;null!==(t=r.exec(e));)n.push({start:t.index,end:t.index+t[0].length-1});let a=[];n.forEach((t,r)=>{el(e.slice(t.start,t.end))||a.push(r)});for(let e=a.length-1;e>=0;e--)n.splice(a[e],1);let l="";for(let t=0;t<e.length;t++)!n.some(e=>t>=e.start&&t<=e.end)&&"$"===e[t]&&t+1<e.length&&/\d/.test(e[t+1])?l+="\\$":l+=e[t];return l},el=e=>{let t=["\\alpha","\\beta","\\gamma","\\delta","\\epsilon","\\zeta","\\eta","\\theta","\\sum","\\prod","\\int","\\frac","\\sqrt","\\lim","\\infty","\\partial","\\nabla","\\pm","\\mp","\\times","\\div","\\cdot","\\leq","\\geq","\\neq","\\approx","\\equiv","\\in","\\notin","\\subset","\\supset","\\cup","\\cap","\\emptyset","\\varnothing","\\forall","\\exists","\\circ"].some(t=>e.includes(t)),r=["\\begin{equation}","\\end{equation}","\\begin{align}","\\end{align}","\\begin{matrix}","\\end{matrix}","\\begin{pmatrix}","\\end{pmatrix}","\\begin{bmatrix}","\\end{bmatrix}"].some(t=>e.includes(t)),n=["\\frac{","\\sqrt{","\\sum_{","\\prod_{","\\int_{","\\lim_{","\\overline{","\\underline{","\\vec{","\\hat{","\\text{","^","! ="].some(t=>e.includes(t));return t||r||n},ei=(e,t)=>{let r=/(?:```[\s\S]*?```|~~~[\s\S]*?~~~|`[^`]+`|<svg[\s\S]*?<\/svg>)/g,n=e.split(r),a=e.match(r)||[],l=n.map(t),i="";for(let e=0;e<l.length;e++)i+=l[e],e<a.length&&(i+=a[e]);return i};var eo=r(44342),es=r(25773),ed=r(85216),ec=r(1167),eu=r(46571),eh=e=>{let t=(0,a.useRef)(null),[r,l]=(0,a.useState)(!1),{isMobile:i}=(0,eo.b)(),o=(0,g.useTranslations)(),s=async()=>{if(t.current)try{var r,n;l(!0);let a=((null==e?void 0:null===(r=e.title)||void 0===r?void 0:r.slice(0,100))||(null===(n=t.current.querySelector("caption"))||void 0===n?void 0:n.textContent)||"table").toLowerCase().replace(/\s+/g,"_");(0,R.el)(t.current,a)}catch(e){console.error("Failed to download table:",e)}finally{l(!1)}};return(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsx)("table",{ref:t,className:"min-w-full  ",children:e.children}),!i&&(0,n.jsx)("div",{className:"absolute bottom-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:(0,n.jsx)("div",{className:"relative group/tooltip",children:(0,n.jsx)(ec.pn,{children:(0,n.jsxs)(ec.u,{delayDuration:300,children:[(0,n.jsx)(ec.aJ,{asChild:!0,children:(0,n.jsx)(f.z,{variant:"outline",size:"icon",onClick:s,disabled:r,className:(0,eu.cn)("relative rounded-full","hover:scale-105 transition-transform duration-200",r&&"cursor-not-allowed"),children:r?(0,n.jsx)(es.Z,{className:"h-4 w-4 animate-spin"}):(0,n.jsx)(ed.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(ec._v,{children:(0,n.jsx)("p",{children:o("download.download_csv")})})]})})})})]})},ep=r(70017),em=r(13263),eg=r(91165),ex=r(91708),ef=r(25568),ev=r(67241),eC=r(49759),eb=r(56975),ew=r(26595),ey=r(47014),ej=r(74538),ek=a.memo(e=>{var t,r,l,i,o,s,d;let c=(0,ep.V)(),h=(0,a.useRef)(null),p=(0,g.useTranslations)(),[m,x]=(0,a.useState)(!1),f=null===(r=e.children)||void 0===r?void 0:null===(t=r.props)||void 0===t?void 0:t.className,v=(0,g.useLocale)(),C=(0,K.Z)(e=>e.isMyThread),b=(0,$.Z)(e=>e.allGraphicData),{loading:w}=(0,u.Z)(),[y,j]=(0,a.useState)(""),k=(0,a.useMemo)(()=>{try{var t,r;let n=(null===(r=e.children)||void 0===r?void 0:null===(t=r.props)||void 0===t?void 0:t.children)||"";return JSON.parse(n.replace(/[\n\r\s]+/g," ").trim())}catch(e){return null}},[null===(i=e.children)||void 0===i?void 0:null===(l=i.props)||void 0===l?void 0:l.children]);(0,a.useEffect)(()=>{null==k||k.content},[null==k?void 0:k.content]);let _=async e=>{if(h.current){let t=N.ZP.getState().userInfo,r=t.language&&"auto"!==t.language?t.language:v;x(!0);let n=h.current.textContent||"";await (0,em.zC)({file_type:e,markdown:n,language:r},()=>{x(!1)})}};if(f&&f.includes("felo-images")){if(!C)return(0,n.jsx)(n.Fragment,{});if(!(null==k?void 0:k.content))return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("pre",{ref:h,className:"relative whitespace-break-spaces rounded-2xl dark:border dark:border-[#606B80]",children:e.children})});let t=null==b?void 0:null===(d=b[y])||void 0===d?void 0:null===(s=d.images)||void 0===s?void 0:null===(o=s.find(e=>"png"===e.type))||void 0===o?void 0:o.path;if(!t)return(0,n.jsxs)("div",{className:"py-3 px-5 box-border rounded-[8px] w-fit gap-[16px] bg-[#EDFAFF] text-[#0080FF] flex items-center justify-center dark:bg-[#243248] dark:text-[#1EB1FF]",children:[(0,n.jsxs)("div",{className:"p-[3px] box-border rounded-full relative",children:[(0,n.jsx)("div",{className:"absolute inset-0 border-l-[16px] border-t-[16px] border-[#0080FF] dark:border-[#0694FF] z-[0] rounded-full animate-spin"}),(0,n.jsx)("div",{className:"w-[32px] h-[32px] bg-[#0080FF] dark:bg-[#0694FF] border-[4px] border-[#EDFAFF] dark:border-[#243248] rounded-full flex items-center z-[1] relative justify-center",children:(0,n.jsx)("div",{className:"w-[12px] h-[12px]",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 12 12",fill:"none",children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.61704 1.46534C5.76671 1.39957 5.93726 1.39957 6.08693 1.46534C6.21227 1.52042 6.2878 1.61503 6.32973 1.67353C6.37037 1.73024 6.41237 1.80197 6.45214 1.86989L8.10409 4.6897C8.10624 4.69336 8.1084 4.69705 8.11056 4.70074C8.15049 4.76887 8.19266 4.8408 8.22229 4.90409C8.25259 4.96882 8.29909 5.08249 8.28453 5.22046C8.26712 5.38547 8.17978 5.53402 8.04624 5.62998C7.93502 5.70989 7.81474 5.7268 7.74351 5.73326C7.67375 5.73958 7.59008 5.73957 7.51021 5.73955C7.50596 5.73955 7.50173 5.73955 7.49751 5.73955H4.20647C4.20225 5.73955 4.19801 5.73955 4.19377 5.73955C4.11389 5.73957 4.03022 5.73958 3.96047 5.73326C3.88923 5.7268 3.76896 5.70989 3.65774 5.62998C3.52419 5.53402 3.43685 5.38547 3.41944 5.22046C3.40488 5.08249 3.45138 4.96882 3.48168 4.90409C3.51131 4.8408 3.55348 4.76886 3.59342 4.70073C3.59558 4.69704 3.59773 4.69336 3.59988 4.6897L5.2454 1.88087C5.24754 1.87722 5.24968 1.87356 5.25183 1.86989C5.2916 1.80197 5.3336 1.73024 5.37425 1.67353C5.41618 1.61503 5.49171 1.52042 5.61704 1.46534ZM6.01754 8.32247C6.01754 7.06994 7.04375 6.06226 8.30011 6.06226C9.55647 6.06226 10.5827 7.06994 10.5827 8.32247C10.5827 9.575 9.55647 10.5827 8.30011 10.5827C7.04375 10.5827 6.01754 9.575 6.01754 8.32247ZM2.74445 6.16111H4.45267C4.60889 6.16111 4.74816 6.1611 4.86378 6.17043C4.98713 6.18039 5.1166 6.20282 5.24321 6.26657C5.42764 6.35943 5.57843 6.50806 5.67321 6.69188C5.73851 6.81854 5.76146 6.94815 5.77162 7.07104C5.78111 7.18585 5.78111 7.32398 5.7811 7.47805V9.16689C5.78111 9.32096 5.78111 9.45908 5.77162 9.5739C5.76146 9.69679 5.73851 9.8264 5.67321 9.95305C5.57843 10.1369 5.42764 10.2855 5.24321 10.3784C5.1166 10.4421 4.98713 10.4645 4.86378 10.4745C4.74816 10.4838 4.60888 10.4838 4.45265 10.4838H2.74446C2.58823 10.4838 2.44896 10.4838 2.33333 10.4745C2.20998 10.4645 2.08051 10.4421 1.9539 10.3784C1.76947 10.2855 1.61868 10.1369 1.5239 9.95305C1.4586 9.8264 1.43565 9.69679 1.42549 9.5739C1.416 9.45908 1.41601 9.32096 1.41602 9.16689V7.47805C1.41601 7.32398 1.416 7.18586 1.42549 7.07104C1.43565 6.94815 1.4586 6.81854 1.5239 6.69188C1.61868 6.50806 1.76947 6.35943 1.9539 6.26657C2.08051 6.20282 2.20998 6.18039 2.33333 6.17043C2.44895 6.1611 2.58822 6.16111 2.74445 6.16111Z",fill:"white"}),(0,n.jsx)("path",{d:"M2.56098 1.64521C2.59486 1.64445 2.62778 1.65718 2.65229 1.68057C2.67871 1.70381 2.69585 1.73575 2.70108 1.77054C2.7258 1.91035 2.75049 2.02821 2.77493 2.12369C2.79466 2.20499 2.82649 2.283 2.86893 2.35509C2.90472 2.41442 2.9546 2.46433 3.01394 2.50011C3.08364 2.5408 3.15932 2.5703 3.23819 2.58739C3.35039 2.61278 3.46388 2.63306 3.57791 2.64827C3.61352 2.65336 3.64651 2.67076 3.67056 2.6975C3.6826 2.70963 3.69239 2.72417 3.69876 2.74002C3.70512 2.75589 3.70803 2.77306 3.70771 2.79015C3.70833 2.8261 3.69493 2.86085 3.67056 2.88728C3.64623 2.91367 3.61283 2.9297 3.57701 2.93204C3.4624 2.94405 3.34841 2.96282 3.23595 2.98799C3.14331 3.00902 3.06625 3.03739 3.00544 3.07348C2.94552 3.11013 2.89702 3.15955 2.85953 3.22118C2.82258 3.28285 2.79209 3.36158 2.76822 3.45706C2.74493 3.55337 2.72238 3.67154 2.70108 3.81156C2.69646 3.84614 2.67978 3.87797 2.65363 3.90107C2.64141 3.91287 2.62694 3.92223 2.61111 3.92838C2.59523 3.93453 2.57801 3.93737 2.56098 3.93688C2.5442 3.93719 2.52738 3.93406 2.51175 3.92793C2.49615 3.92179 2.48174 3.91271 2.46967 3.90107C2.4443 3.87721 2.42776 3.8455 2.42223 3.81111C2.39751 3.67129 2.37216 3.55344 2.34659 3.45796C2.32159 3.36343 2.29052 3.28619 2.25304 3.22655C2.21728 3.16668 2.16938 3.11862 2.10981 3.08198C2.05099 3.0459 1.97555 3.01658 1.88378 2.9947C1.79257 2.97282 1.6793 2.95193 1.54406 2.93204C1.50685 2.92664 1.47584 2.91083 1.4514 2.88415C1.42814 2.85851 1.41551 2.82477 1.41604 2.79015C1.41531 2.7552 1.42859 2.72144 1.45275 2.69616C1.47671 2.66925 1.51001 2.65207 1.54585 2.64827C1.66053 2.63603 1.7745 2.6179 1.88736 2.59411C1.98028 2.57308 2.05685 2.54454 2.11652 2.50817C2.1762 2.4714 2.22646 2.4208 2.26289 2.36091C2.30524 2.28735 2.33621 2.20779 2.35509 2.12503C2.38279 2.00807 2.40518 1.88959 2.42178 1.77054C2.42608 1.73592 2.44284 1.70391 2.46878 1.68057C2.49405 1.65772 2.52691 1.64502 2.56098 1.64521Z",fill:"white"})]})})})]}),p("graphic.graphic_loading")]});if(!w&&t)return(0,n.jsx)(n.Fragment,{});if(w&&t)return(0,n.jsx)("div",{className:"flex group flex-wrap gap-4 py-1 md:py-4 w-full rounded-2xl relative border border-transparent hover:border-[#E6E9EF] hover:dark:border-[#242A38]",children:(0,n.jsx)("div",{className:"flex-1 overflow-hidden flex items-center justify-center",children:(0,n.jsx)("img",{src:t,alt:"image",className:"flex-1 m-0 object-cover max-w-full rounded-lg"})})})}return(0,n.jsxs)("pre",{ref:h,className:"relative whitespace-break-spaces rounded-2xl dark:border dark:border-[#606B80]",children:[e.isDocument&&(0,n.jsx)("div",{className:"cursor-pointer",children:(0,n.jsxs)(eC.F,{children:[(0,n.jsx)(eb.S,{children:(0,n.jsx)(ew.A,{isIconOnly:!0,size:"sm",className:"absolute w-[14px] mr-2 top-2 right-8 text-white",variant:"light",onPress:()=>{if(h.current){let e=h.current.innerText;c.copy(e)}},children:m?(0,n.jsx)(ev.dP,{}):(0,n.jsx)(ev.oA,{})})}),(0,n.jsxs)(ey.a,{variant:"flat",onAction:e=>_(e),className:"p-2",children:[(0,n.jsx)(ej.W,{startContent:(0,n.jsx)(ef.O3,{}),className:"text-[#1D3C6D] hover:!bg-blue-100 hover:!text-[#1D3C6D] dark:text-[#EDF3FC] hover:dark:!bg-[#1D3C6D] hover:dark:!text-[#EDF3FC]",children:p("export_docx")},"DOCX"),(0,n.jsx)(ej.W,{startContent:(0,n.jsx)(ef.IG,{}),className:"text-[#1D3C6D] hover:!bg-blue-100 hover:!text-[#1D3C6D] dark:text-[#EDF3FC] hover:dark:!bg-[#1D3C6D] hover:dark:!text-[#EDF3FC]",children:p("export_pdf")},"PDF")]})]})}),(0,n.jsx)(ew.A,{isIconOnly:!0,size:"sm",className:"absolute top-2 right-2 text-white",variant:"light",onPress:()=>{if(h.current){let e=h.current.innerText;c.copy(e)}},children:c.copied?(0,n.jsx)(eg.Z,{size:16,color:"#4ba570"}):(0,n.jsx)(ex.Z,{size:14})}),e.children]})}),e_=a.memo(e=>{let{className:t,children:r,sources:i,rid:s,loading:h,isVisible:p,isDocument:m,thread:x,threadId:f}=e,v=(0,g.useTranslations)(),C=(0,a.useRef)(""),[b,w]=(0,a.useState)(!1),y=(0,a.useRef)([]),j=(0,a.useRef)(null),{isMobile:k}=(0,T.Z)(),_=K.Z.getState().isMyThread,N=$.Z.getState().allGraphicData,S=A({containerRef:j}),F=(0,a.useMemo)(()=>e=>{let{node:t,...r}=e;if(!r.href)return null;let{extensionEnable:a,legacyExtensionEnable:l}=u.Z.getState(),o=i?i[+r.href-1]:void 0,h=(null==o?void 0:o.url)||(null==o?void 0:o.link)||r.href;h=(0,X.OT)(h);let p=e=>{if(e.preventDefault(),(0,Z.N0)()){(0,E.oh)({url:h});return}a?window.open((0,R.m1)(h),"_blank"):l?window.open((0,R.m1)(h,!0),"_blank"):window.open(h,"_blank")};if(!o){let e=r.children||h||"";if(/^-?\d+(\.\d+)?$/.test(e))return;let t=e.length>200?/https?:\/\/[-a-zA-Z0-9@:%._+~#=]{2,256}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)/g:RegExp(H.FK,"gi"),a=t.exec(e),l=[];for(;null!==a&&a&&a[0]!==a.input;){let[e,r]=a,n=a.input.substring(0,a.index),i=new H.fh(e,r),o=a.input.substring(a.index+a[0].length);a=t.exec(o),l=[...l,{type:"text",content:n},{type:"link",content:i.getAnchorText(),href:i.getAnchorHref()},{type:"text",content:a?"":o}]}let i="inline cursor-pointer no-underline text-blue-500 dark:text-blue-500 hover:underline";return l.length?(0,n.jsx)(n.Fragment,{children:l.map((e,t)=>"link"===e.type?(0,n.jsx)("a",{href:e.href,target:"_blank",className:i,children:e.content},t):e.content)}):(0,n.jsx)("a",{href:h,target:"_blank",className:i,onClick:p,children:r.children})}if(o){var m;null==t||null===(m=t.position)||void 0===m||m.start.offset}return(0,n.jsx)("span",{className:"".concat(d().footnoteRef," footnote-ref"),children:(0,n.jsx)(c.Z,{source:o,precedingText:"",rid:s,children:(0,n.jsx)("a",{className:"hover:bg-[#0080FF] hover:text-white dark:hover:bg-[#0080FF] dark:hover:text-white inline-block flex items-center leading-normal cursor-pointer no-underline font-medium flex-shrink-0 h-4 px-1 rounded-md text-[9px] bg-[#F6F7F9] dark:bg-[#353B46] text-[#5F7698] dark:text-[#F3F5F7]",href:h,target:"_blank",onClick:p,children:r.href})})})},[i]),W=(0,a.useMemo)(()=>e=>{let{...t}=e;return(0,n.jsx)("p",{...t,dir:"auto"})},[]),Y=(0,a.useMemo)(()=>e=>{let{id:t,className:r,children:a,...l}=e;return t&&t.includes("answer_reflection_start")?(0,n.jsxs)("div",{className:r,...l,children:[(0,n.jsx)("hr",{}),(0,n.jsxs)("div",{className:"mt-[0px] mb-4 text-[#0080FF] flex items-center gap-x-2",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("path",{d:"M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),(0,n.jsx)("span",{children:v("step.searching_internet")}),(0,n.jsxs)("span",{className:"inline-flex items-center h-4",children:[(0,n.jsx)("span",{className:"w-1 h-1 mx-0.5 rounded-full bg-current animate-loading-dot"}),(0,n.jsx)("span",{className:"w-1 h-1 mx-0.5 rounded-full bg-current animate-loading-dot delay-200"}),(0,n.jsx)("span",{className:"w-1 h-1 mx-0.5 rounded-full bg-current animate-loading-dot delay-400"})]})]})]}):t&&t.includes("answer_reflection")?(0,n.jsxs)("div",{className:r,...l,children:[(0,n.jsx)("hr",{}),(0,n.jsx)("div",{className:"mt-[0px] mb-4 text-[#0080FF] flex items-center gap-x-2",children:(0,n.jsx)("span",{children:v("step.supplement_from_search")})})]}):(0,n.jsx)("div",{className:r,...l,children:a})},[N,_]);(0,a.useEffect)(()=>{h||y.current.forEach(e=>{(0,J.cC)(e.source,e.rid,e.precedingText,e.link)})},[h]),(0,a.useEffect)(()=>{let e=(null==i?void 0:i.some(e=>"scholar"===e.engine_name||"scholar"===e.engine))||!1;!h&&p&&(b||e||k||w(!0))},[h,p,b,k]);let Q=e=>ei(e,e=>e.replace(/((\[\d+\][ \t]*)+)/g,'<span class="footnote-wrapper">$1</span>')),ee=(0,a.useMemo)(()=>{let e=null==r?void 0:r.replace(/\[(\d+(?:,\s*\d+)*)\]/g,(e,t)=>t.split(",").map(e=>"[".concat(e.trim(),"]")).join(""));return e=(0,J.k5)(Q(e||"")),e="".replace("",e),C.current=e,e},[r]);(0,a.useEffect)(()=>{let e=e=>{j.current&&j.current.contains(e.target)&&(e.preventDefault(),(0,J.$5)(e))};return document.addEventListener("copy",e),()=>{document.removeEventListener("copy",e)}},[]);let et=(0,a.useMemo)(()=>e=>(0,n.jsx)(en,{...e,sources:i}),[i]),er=(0,a.useMemo)(()=>e=>(0,n.jsx)(ek,{...e,isDocument:m}),[m]),el=(0,a.useMemo)(()=>e=>(0,n.jsx)(eh,{...e,title:null==x?void 0:x.query}),[]);return(0,n.jsxs)("div",{className:"".concat(t," relative"),ref:j,children:[(0,n.jsx)(l.U,{className:o().markdown,remarkPlugins:[B.Z,P.Z,O.Z,V.Z,q.Z,G.Z],rehypePlugins:[z.Z,M.Z,[L.Z,{detect:!1,ignoreMissing:!0}],U.Z],components:{pre:er,p:W,a:F,div:Y,img:et,table:el},children:(e=>{if(!e)return"";let t=e=>e.replace(/\[(\d+)\]\(\d+\)/g,"[$1]"),r=e=>{try{if(e.startsWith("data:image"))return e;return new URL(e).toString()}catch(t){return console.error("Invalid image URL:",e),e}};return ei(e=e.replace(/<svg[^>]*>[\s\S]*?<\/svg>/g,e=>e.replace(/\n/g," ")),e=>e.replace(/!(.*?)\((.*?)\)/g,(e,n,a)=>{try{let e=t(n),l=r(a);return"![".concat(e,"](").concat(l,")")}catch(t){return console.error("Error processing image:",t),e}}))})(ea(ee))}),(0,n.jsx)(I,{show:S.showSelectionPopover,position:S.selectionPosition,onFactCheck:S.handleFactCheck,onTraditionalSearch:S.handleTraditionalSearch,factCheckLoading:S.factCheckLoading}),(0,n.jsx)(D,{open:S.showSearchDialog,onOpenChange:S.setShowSearchDialog,selectedText:S.selectedText,searchResults:S.searchResults,searchLoading:S.searchLoading,searchError:S.searchError,onRetry:S.handleTraditionalSearch})]})})},69996:function(e,t,r){"use strict";r.d(t,{E:function(){return a}});var n=r(52676);let a=e=>{let{children:t,className:r="",style:a={}}=e;return(0,n.jsx)("div",{className:"p-[16px] text-[#30394A] text-[16px] h-[68px] box-border border-[#D6F3FF] text-center bg-[#D6F3FF] min-w-[200px] flex items-center justify-center rounded-[8px] dark:text-[#FFF] dark:bg-[#0E335D] dark:border-[#0D549B] ".concat(r),style:{boxShadow:"0px 4px 12px 0px rgba(0, 128, 255, 0.12)",...a},children:t})}},70400:function(e,t,r){"use strict";r.d(t,{K:function(){return i},_:function(){return o}});var n=r(52676),a=r(75271);let l=(0,a.createContext)(void 0);function i(e){let{editor:t,children:r}=e;return(0,n.jsx)(l.Provider,{value:{editor:t},children:r})}function o(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useEditorContext must be used within a EditorProvider");return e}},24321:function(e,t,r){"use strict";r.d(t,{Z:function(){return C}});var n=r(52676),a=r(25010),l=r(75271),i=r(8924),o=r(91165),s=r(72696);let d=[{label:"1:1",value:"1:1",width:1024,height:1024,icon:(0,n.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("rect",{width:"14",height:"14",rx:"2",fill:"#C6C7C7"})})},{label:"3:2",value:"3:2",width:1536,height:1024,icon:(0,n.jsx)("svg",{width:"15",height:"10",viewBox:"0 0 15 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("rect",{width:"15",height:"10",rx:"2",fill:"#C6C7C7"})})},{label:"2:3",value:"2:3",width:1024,height:1536,icon:(0,n.jsx)("svg",{width:"15",height:"10",viewBox:"0 0 15 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("rect",{width:"10",height:"15",rx:"2",fill:"#C6C7C7"})})}];function c(e){let{onRatioChange:t}=e,[r,a]=l.useState(d[0]),c=e=>{a(e),t&&t(e)};return(0,n.jsxs)(s.h_,{children:[(0,n.jsx)(s.$F,{asChild:!0,children:(0,n.jsxs)("div",{className:" flex items-center justify-center gap-1 py-2 px-2 text-[#0080FF]",children:[(0,n.jsxs)("span",{children:[" ",r.label]})," ",(0,n.jsx)(i.Z,{size:18})]})}),(0,n.jsxs)(s.AW,{className:"w-[200px]",children:[(0,n.jsx)(s.VD,{}),(0,n.jsx)(s.Qk,{children:d.map(e=>(0,n.jsxs)(s.Xi,{onClick:()=>c(e),className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[e.icon," ",(0,n.jsx)("span",{children:e.label})]}),(null==r?void 0:r.value)===e.value&&(0,n.jsx)(o.Z,{className:"h-4 w-4"})]},e.value))})]})]})}var u=r(76972),h=r(3317),p=r(60904),m=r(25773),g=r(7717),x=r(55149),f=r(31063),v=r(60161),C=e=>{let{editor:t,height:r}=e,[i,o]=(0,l.useState)({label:"1:1",value:"1:1",width:1024,height:1024}),{createLoading:s,setCreateLoading:d,prompt:C,setPrompt:b,createError:w,setCreateError:y,setShowAICreateModal:j,showAICreateModal:k,setCreatedImgList:_,createImgList:N,cacheRequestData:S}=(0,u.Z)(),{generateImage:F}=(0,x.I)(),T=(0,g.useTranslations)(),E=async e=>{d(!0),y("");let t=e||{prompt:C,width:i.width,height:i.height,output_format:"png"};try{await F(t)}catch(e){}(0,f.fk)(v.U.SEARCH_CREATE_IMAGE,{draw_words:C||""},!0)},Z=e=>{if(!t)return;let{selection:r}=t.state;if(r.empty){if(r.$from.pos>0){let n=r.$from.pos;t.chain().command(e=>{let{tr:t}=e;return t.setSelection(h.Bs.create(t.doc,n)),!0}).insertImage({src:e.url,alt:"image",title:"",width:Math.floor(e.width/2)}).run()}else{let r=t.state.doc.content.size;t.chain().command(e=>{let{tr:n}=e,a=Math.min(r,t.state.doc.content.size);return n.setSelection(h.Bs.create(n.doc,a)),!0}).insertImage({src:e.url,alt:"image",title:"",width:Math.floor(e.width/2)}).run()}}else{let n=r.$to.after();t.chain().command(e=>{let{tr:t}=e;return t.setSelection(h.Bs.create(t.doc,n)),!0}).insertImage({src:e.url,alt:"image",title:"",width:Math.floor(e.width/2)}).run()}},I=e=>{Z(e)};return(0,n.jsxs)("div",{className:"fixed w-[375px] z-[11]  h-full right-0 bottom-0 bg-white dark:bg-[#353B46]  border p-[16px] rounded-[16px] box-border",style:{height:r||"calc(100vh - 136px)",transform:k?"translateX(0)":"translateX(100%)",opacity:k?1:0,visibility:k?"visible":"hidden",transition:"transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0.3s ease-in-out"},children:[(0,n.jsxs)("div",{className:"absolute right-[20px] t-[20px] w-[24px] h-[24px] cursor-pointer",onClick:()=>{j(!1)},children:[(0,n.jsx)(p.Z,{})," "]}),(0,n.jsxs)("div",{className:"text-[16px] font-bold mb-4 w-[300px] overflow-hidden text-ellipsis flex-nowrap",children:[" ",T("note.ai_tool.ai_img_create")]}),(0,n.jsxs)("div",{className:"mb-2 flex items-center justify-between text-[14px]",children:[(0,n.jsxs)("div",{className:"flex items-center text-[14px]",children:[T("note.ai_tool.img_size"),":"," ",(0,n.jsx)(c,{onRatioChange:e=>{o(e)}})]})," ",(0,n.jsxs)("div",{className:"text-[12px]",children:["(âœ¨",T("limited_time_experience"),")"]})]}),(0,n.jsxs)("div",{className:"flex h-[52px] text-[14px] items-center gap-2 mb-3 w-full py-[4px] px-[16px] box-border border-1 rounded-[12px] dark:bg-[#202531] border-[#D3D9E4] ",children:[(0,n.jsx)("input",{value:C,onChange:e=>b(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||s||!C||(e.preventDefault(),E())},placeholder:T("note.ai_tool.input_placeholder"),className:"w-full appearance-none bg-transparent border-none focus:outline-none"}),(0,n.jsx)(a.z,{onClick:()=>E(),disabled:s||!C,className:"w-[36px] h-[36px] flex items-center justify-center",children:s?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(m.Z,{className:"h-4 w-4 animate-spin"})}):(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 18 18",fill:"none",children:(0,n.jsx)("path",{d:"M10.397 18C10.1762 18.0014 9.96311 17.9188 9.80095 17.769C9.63343 17.6145 9.5237 17.4074 9.48995 17.182C9.32995 16.2693 9.16662 15.5017 8.99995 14.879C8.83395 14.263 8.62962 13.7593 8.38695 13.368C8.15598 12.9835 7.836 12.6601 7.45395 12.425C7.06795 12.1883 6.57595 11.9987 5.97795 11.856C5.2462 11.6878 4.50751 11.5513 3.76395 11.447C3.53227 11.4175 3.31823 11.3078 3.15895 11.137C3.00745 10.9687 2.92496 10.7494 2.92795 10.523C2.92431 10.2948 3.01051 10.0743 3.16795 9.909C3.32388 9.73381 3.53968 9.62324 3.77295 9.599C4.65629 9.49767 5.39995 9.37867 6.00395 9.242C6.60862 9.106 7.10662 8.91933 7.49795 8.682C7.88612 8.44135 8.21197 8.11242 8.44895 7.722C8.69829 7.31867 8.89995 6.806 9.05395 6.184C9.20795 5.556 9.35329 4.78533 9.48995 3.872C9.51658 3.64661 9.62385 3.43847 9.79195 3.286C9.95652 3.13477 10.1725 3.05183 10.396 3.054C10.628 3.054 10.8266 3.13133 10.992 3.286C11.1653 3.43675 11.2788 3.64467 11.312 3.872C11.472 4.78467 11.632 5.55233 11.792 6.175C11.9573 6.79167 12.162 7.29533 12.406 7.686C12.6486 8.078 12.9626 8.39233 13.348 8.629C13.734 8.86633 14.223 9.056 14.815 9.198C15.4136 9.34 16.1516 9.47333 17.029 9.598C17.2776 9.64 17.4793 9.74667 17.634 9.918C17.794 10.09 17.874 10.2917 17.874 10.523C17.878 10.7574 17.7915 10.9842 17.6324 11.1564C17.4733 11.3285 17.2539 11.4326 17.02 11.447C16.1433 11.5483 15.4023 11.67 14.797 11.812C14.193 11.948 13.6923 12.1347 13.295 12.372C12.9043 12.6096 12.5778 12.9392 12.344 13.332C12.1 13.7353 11.9013 14.248 11.748 14.87C11.5933 15.4993 11.448 16.27 11.312 17.182C11.2823 17.4087 11.1719 17.6171 11.001 17.769C10.8371 17.9219 10.621 18.0048 10.397 18ZM3.81695 7.353C3.52095 7.353 3.35529 7.199 3.31995 6.891C3.26769 6.4405 3.19629 5.99243 3.10595 5.548C3.03462 5.222 2.91595 4.976 2.74995 4.81C2.58462 4.63733 2.33595 4.51 2.00395 4.428C1.54611 4.32143 1.08319 4.23799 0.616953 4.178C0.290286 4.13133 0.126953 3.96567 0.126953 3.681C0.126953 3.39633 0.272286 3.23033 0.562953 3.183C1.04068 3.1026 1.51532 3.00487 1.98595 2.89C2.32995 2.8 2.58495 2.67533 2.75095 2.516C2.91629 2.35 3.03462 2.11 3.10595 1.796C3.17662 1.476 3.24795 1.03433 3.31995 0.471C3.35529 0.157 3.52095 0 3.81695 0C4.10762 0 4.27362 0.151 4.31495 0.453C4.38629 1.04633 4.45762 1.50867 4.52895 1.84C4.60562 2.172 4.72695 2.421 4.89295 2.587C5.05895 2.747 5.31095 2.86567 5.64895 2.943C5.98695 3.02033 6.45529 3.10033 7.05395 3.183C7.18395 3.195 7.29062 3.24833 7.37395 3.343C7.45582 3.43636 7.50002 3.55684 7.49795 3.681C7.49795 3.95967 7.35562 4.12567 7.07095 4.179C6.46095 4.279 5.98429 4.37667 5.64095 4.472C5.30229 4.562 5.04995 4.68967 4.88395 4.855C4.71795 5.015 4.59962 5.255 4.52895 5.575C4.45762 5.895 4.38629 6.33933 4.31495 6.908C4.30139 7.03052 4.24306 7.1437 4.15114 7.22584C4.05923 7.30797 3.94022 7.35325 3.81695 7.353Z",fill:"white"})})})]}),k&&(0,n.jsxs)("div",{className:"aiImgView mt-[16px] aiImgView overflow-y-auto custom-scrollbar  h-[calc(100%-160px)]",children:[s||w?(0,n.jsxs)("div",{className:"aiMainImg mb-[12px] w-[335px] h-[335px] flex items-center justify-center rounded-[16px] overflow-hidden",style:{background:"linear-gradient(180deg, #DDF1FF 0%, #DDE5FF 100%)"},children:[w&&(0,n.jsxs)("div",{className:"text-[#30394A] text-[16px] mb-2 flex flex-col items-center font-bold",children:[(0,n.jsx)("div",{children:w}),(0,n.jsx)("div",{className:"text-[#0080FF] cursor-pointer",onClick:()=>{E(S)},children:T("ppt.retry_generate")})]}),s&&(0,n.jsx)(m.Z,{className:" h-8 w-8 text-[#0080FF] animate-spin"})]}):N.length>0&&(0,n.jsx)("div",{className:"aiMainImg mb-[12px] w-[335px] h-[335px] flex items-center justify-center rounded-[16px] overflow-hidden",style:{background:"linear-gradient(180deg, #DDF1FF 0%, #DDE5FF 100%)"},onClick:()=>I(N[0]),children:(0,n.jsx)("img",{src:N[0].url,className:"max-w-full max-h-full object-contain",alt:"image"})}),(0,n.jsx)("div",{className:"aidedImgList w-[335px] flex items-center flex-wrap justify-between",children:N.map((e,t)=>(0,n.jsx)("div",{className:"w-[160px] h-[160px] mb-[12px] rounded-[16px] flex items-center justify-center cursor-pointer  overflow-hidden",style:{background:"linear-gradient(180deg, #DDF1FF 0%, #DDE5FF 100%)",display:w||s?"flex":0===t?"none":"flex"},onClick:()=>I(e),children:(0,n.jsx)("img",{src:e.url,className:"max-w-full max-h-full object-contain",alt:"image"})},t))})]})]})}},55149:function(e,t,r){"use strict";r.d(t,{I:function(){return d}});var n,a,l=r(50403),i=r(76972),o=r(7717),s=r(75271);(n=a||(a={})).NOT_FOUND="Task not found",n.PENDING="Pending",n.REQUEST_MODERATED="Request Moderated",n.CONTENT_MODERATED="Content Moderated",n.READY="Ready",n.ERROR="Error";let d=function(){let{onSuccess:e,onError:t,onProgress:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,o.useTranslations)(),{setCreateError:a,setCreateLoading:d,setShowAICreateModal:c}=(0,i.Z)(),u=(0,s.useCallback)((e,t)=>{i.Z.setState(r=>({createImgList:[{...e,url:t},...r.createImgList]}))},[]);return{generateImage:(0,s.useCallback)(async r=>{try{d(!0),a(""),c(!0);let t=await (0,l.yt)(r);if(!t.data||200!==t.status)throw Error("generation.id_failed");let n=t.data;return u(r,n),null==e||e(n),n}catch(r){let e=r instanceof Error?r.message:"generation.failure_tip";return a("".concat(n("ppt.generate_failure_tip"))),null==t||t(r instanceof Error?r:Error(e)),null}finally{d(!1)}},[n,u,e,t]),resetState:(0,s.useCallback)(()=>{d(!1),a(""),c(!1)},[])}}},89039:function(e,t,r){"use strict";r.d(t,{H:function(){return u}});var n=r(17112),a=r(94572),l=r(41223),i=r(60161),o=r(16427),s=r(73522),d=r(31063),c=r(7717);let u=e=>{let{onSuccess:t,onFailed:r}=e,{setNotionDirectories:u,setIsSaveLoading:h}=(0,s.Z)();(0,c.useTranslations)();let p=async e=>{let{templateId:a,content:l,sources:i,title:s,threadId:d}=e;if(h(!0),!a){await m({content:l,sources:i,title:s,threadId:d});return}let c=await (0,o.kG)({shortId:d||"",databaseId:a,title:(null==s?void 0:s.slice(0,100))||"",url:location.href,summary:l,content:l,sources:[],relates:[],thread:{}});n.Z.close(),(null==c?void 0:c.code)==="OK"?null==t||t(c):null==r||r(c),h(!1)},m=async e=>{h(!0);try{(0,l.iL)(),await (0,l.N6)();let r=await (0,l.EY)();if(!r){var t,n;h(!0);let r=await (0,o.ey)({}),a=null===(t=r.find(e=>{var t,r,n,a;return(null==e?void 0:e.object)==="database"&&(null==e?void 0:null===(t=e.parent)||void 0===t?void 0:t.type)==="workspace"&&(null==e?void 0:null===(a=e.title)||void 0===a?void 0:null===(n=a.find(e=>(null==e?void 0:e.type)==="text"))||void 0===n?void 0:null===(r=n.text)||void 0===r?void 0:r.content)==="Felo.ai"}))||void 0===t?void 0:t.id;if(!a){let e=null===(n=r.find(e=>{var t;return(null==e?void 0:e.object)==="page"&&(null==e?void 0:null===(t=e.parent)||void 0===t?void 0:t.type)==="workspace"}))||void 0===n?void 0:n.id;e&&(a=await (0,o.C8)({pageId:e}))}if(!a){m(e);return}await p({templateId:a,...e});return}h(!0),await (0,a.gw)(l.xI),await p({templateId:r,...e})}catch(t){if((null==t?void 0:t.message)==="403"){m(e);return}null==r||r(t)}finally{h(!1)}},g=async e=>{let{templateId:t,...r}=e,{isExist:n,notionDirectories:a}=await (0,l.Do)({templateId:t,setNotionDirectories:u});if(!n){(null==a?void 0:a.length)||m(r);return}await p({templateId:t,...r})};return{handleSaveNotion:async e=>{(0,d.fk)(i.U.DOCS_SAVE_TO_NOTION,{value:"generate"},!0);try{let r=await (0,o.Zl)();if(null==r?void 0:r.isAuthorized){var t,n;if(null==r?void 0:r.templateId){await g({templateId:r.templateId,...e});return}let l=await (0,o.ey)({}),i=null===(t=l.find(e=>{var t,r,n,a;return(null==e?void 0:e.object)==="database"&&(null==e?void 0:null===(t=e.parent)||void 0===t?void 0:t.type)==="workspace"&&(null==e?void 0:null===(a=e.title)||void 0===a?void 0:null===(n=a.find(e=>(null==e?void 0:e.type)==="text"))||void 0===n?void 0:null===(r=n.text)||void 0===r?void 0:r.content)==="Felo.ai"}))||void 0===t?void 0:t.id;if(!i){let e=null===(n=l.find(e=>{var t;return(null==e?void 0:e.object)==="page"&&(null==e?void 0:null===(t=e.parent)||void 0===t?void 0:t.type)==="workspace"}))||void 0===n?void 0:n.id;e&&(i=await (0,o.C8)({pageId:e}),await (0,a.gw)(3e3))}if(!i){m(e);return}await p({templateId:i,...e});return}await m(e)}catch(t){if((null==t?void 0:t.message)==="403"){m(e);return}null==r||r(t)}}}}},92683:function(e,t,r){"use strict";r.d(t,{T:function(){return v}});var n=r(52676),a=r(62351),l=r(45598),i=r(49492),o=r(74641),s=r(9369),d=r(75271),c=r(71912),u=r(37481),h=r(26831),p=r(7717);let m=e=>{let t=(0,p.useTranslations)();return(0,h.sZ)({editor:e,selector:e=>[{type:"category",label:t("note.format.hierarchy"),id:"hierarchy"},{icon:"Pilcrow",onClick:()=>e.editor.chain().setParagraph().focus().run(),id:"paragraph",disabled:()=>!e.editor.can().setParagraph(),isActive:()=>e.editor.isActive("paragraph")&&!e.editor.isActive("orderedList")&&!e.editor.isActive("bulletList")&&!e.editor.isActive("taskList"),label:t("note.format.paragraph"),type:"option"},{icon:"Heading1",onClick:()=>e.editor.chain().setHeading({level:1}).focus().run(),id:"heading1",disabled:()=>!e.editor.can().setHeading({level:1}),isActive:()=>e.editor.isActive("heading",{level:1}),label:t("note.format.heading_1"),type:"option"},{icon:"Heading2",onClick:()=>e.editor.chain().setHeading({level:2}).focus().run(),id:"heading2",disabled:()=>!e.editor.can().setHeading({level:2}),isActive:()=>e.editor.isActive("heading",{level:2}),label:t("note.format.heading_2"),type:"option"},{icon:"Heading3",onClick:()=>e.editor.chain().setHeading({level:3}).focus().run(),id:"heading3",disabled:()=>!e.editor.can().setHeading({level:3}),isActive:()=>e.editor.isActive("heading",{level:3}),label:t("note.format.heading_3"),type:"option"}]})},g={Pilcrow:(0,n.jsx)(a.Z,{className:"w-4 h-4"}),Heading1:(0,n.jsx)(l.Z,{className:"w-4 h-4"}),Heading2:(0,n.jsx)(i.Z,{className:"w-4 h-4"}),Heading3:(0,n.jsx)(o.Z,{className:"w-4 h-4"})},x=e=>"option"===e.type,f=e=>"category"===e.type,v=e=>{let{editor:t}=e,r=m(t),a=(0,d.useMemo)(()=>r.find(e=>"option"===e.type&&e.isActive()),[r]);return(0,n.jsxs)(c.fC,{children:[(0,n.jsx)(c.xz,{asChild:!0,children:(0,n.jsxs)("button",{className:(0,u.cn)("inline-flex items-center p-2 hover:bg-theme-bg-100 dark:hover:bg-theme-bg-dark-200 rounded-lg",(null==a?void 0:a.id)!=="paragraph"&&!!(null==a?void 0:a.type)&&"bg-theme-bg-200 dark:bg-theme-bg-dark-300"),children:[g[(null==a?void 0:a.type)==="option"&&a.icon||"Pilcrow"],(0,n.jsx)(s.Z,{className:"w-4 h-4"})]})}),(0,n.jsx)(c.VY,{asChild:!0,children:(0,n.jsx)("div",{className:"flex flex-col gap-1 px-2 py-4 bg-white dark:bg-theme-bg-dark-100 border border-theme-border-200 dark:border-theme-border-dark-200 shadow-md rounded-lg text-sm z-10 ",children:r.map(e=>x(e)?(0,n.jsxs)("div",{className:(0,u.cn)("flex gap-2 items-center rounded-lg p-1.5 hover:bg-theme-bg-100 dark:hover:bg-theme-bg-dark-200 transition-colors cursor-pointer",e.isActive()&&"bg-theme-bg-200 dark:bg-theme-bg-dark-300"),onClick:t=>{e.onClick()},children:[g[e.icon]||null,e.label]},e.id):f(e)?(0,n.jsx)("div",{className:"mt-2 mb-1 ml-2 first:mt-0 opacity-60 text-xs",children:e.label},e.id):void 0)})})]})}},5245:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var n=r(52676),a=r(7717),l=r(71686),i=r(9369),o=r(8924),s=r(71912),d=r(37481),c=r(50403),u=r(95174),h=r(75271),p=function(e){(0,h.useState)();let t=(0,h.useRef)(),r=(0,h.useCallback)(async r=>{let n;if(!e)return;t.current&&t.current.abort(),t.current=new AbortController;let a=e.state.selection,l=e.state.doc.textBetween(a.from,a.to),i=a.from,o=await r(t.current,l);if("application/json"===o.headers.get("content-type"))return;let s=(0,u.U)(o,t.current.signal),d=0;for await(let t of(e.chain().focus().deleteSelection().run(),s)){if(!t.data||!e)return;console.log(t.data),(n=JSON.parse(t.data)).delta&&(e.chain().focus().insertContentAt(i+d,n.delta).run(),d+=n.delta)}console.log("ended")},[e]);return{expand:async()=>{r(c.Dz)},abbreviation:async()=>{r(c.gs)}}},m=r(76972),g=r(55149),x=r(31063),f=r(60161),v=e=>{let{editor:t}=e,r=(0,a.useTranslations)(),{expand:c,abbreviation:u}=p(t),{setCreateLoading:h,setCreatedImgList:v,setCreateError:C,setShowAICreateModal:b,setCacheRequestData:w}=(0,m.Z)(),{generateImage:y}=(0,g.I)(),j=[{name:"ai-drawing",label:"note.ai_tool.drawing",icon:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",fill:"none",children:[(0,n.jsx)("path",{d:"M17.9972 10.9998C17.8458 10.9998 17.7129 10.9484 17.5986 10.8456V10.8442C17.4872 10.7404 17.4182 10.6094 17.3915 10.4514C17.2829 9.84099 17.1734 9.32727 17.0629 8.9102C16.9525 8.49884 16.8158 8.16176 16.6529 7.89894C16.4939 7.63708 16.2858 7.42712 16.0287 7.26905C15.7696 7.11098 15.4401 6.98434 15.0401 6.88912C14.6439 6.79294 14.1501 6.70153 13.5587 6.61488C13.3968 6.59107 13.2621 6.52156 13.1544 6.40634C13.0516 6.29208 13.0002 6.15543 13.0002 5.99641C12.9984 5.9209 13.0116 5.84579 13.0391 5.77543C13.0666 5.70507 13.1077 5.64085 13.1602 5.58648C13.2645 5.46863 13.4093 5.39421 13.5659 5.37795C14.1573 5.31034 14.6544 5.23083 15.0573 5.13942C15.4081 5.06766 15.7455 4.94139 16.0572 4.7652C16.3176 4.60452 16.536 4.3842 16.6944 4.12245C16.8817 3.8027 17.0181 3.45575 17.0986 3.09406C17.2194 2.58316 17.3167 2.06699 17.3901 1.54718C17.4079 1.39601 17.48 1.25644 17.5929 1.15439C17.7019 1.05232 17.8465 0.996948 17.9958 1.00013C18.1441 0.997696 18.2875 1.05301 18.3958 1.15439C18.5119 1.25543 18.588 1.39482 18.61 1.54718C18.7177 2.1585 18.8248 2.67222 18.9315 3.08834C19.0195 3.44315 19.1575 3.78365 19.3414 4.0996C19.499 4.35618 19.7148 4.57199 19.9714 4.72949C20.2771 4.90588 20.6081 5.03403 20.9528 5.10942C21.3547 5.2056 21.8485 5.29511 22.4342 5.37795C22.5904 5.39952 22.7341 5.47536 22.8399 5.5922C22.9445 5.70059 23.002 5.84586 22.9999 5.99641C23.0021 6.15308 22.944 6.30459 22.8377 6.41968C22.7314 6.53477 22.5849 6.60464 22.4285 6.61488C21.9284 6.66762 21.4319 6.74965 20.9414 6.86055C20.5376 6.95196 20.2024 7.0767 19.9357 7.23477C19.6738 7.39284 19.4619 7.60709 19.3 7.87752C19.1167 8.19857 18.9824 8.54519 18.9015 8.90591C18.7986 9.32584 18.7015 9.84147 18.61 10.4528C18.5895 10.6044 18.5155 10.7436 18.4015 10.8456C18.2921 10.948 18.147 11.0034 17.9972 10.9998Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M12 3C12.5523 3 13 3.44772 13 4C13 4.55228 12.5523 5 12 5H5V19H19V12C19 11.4477 19.4477 11 20 11C20.5523 11 21 11.4477 21 12V19C21 19.55 20.8042 20.0208 20.4125 20.4125C20.0208 20.8042 19.55 21 19 21H5C4.45 21 3.97917 20.8042 3.5875 20.4125C3.19583 20.0208 3 19.55 3 19V5C3 4.45 3.19583 3.97917 3.5875 3.5875C3.97917 3.19583 4.45 3 5 3H12Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M6.55 16.725C6.65 16.9083 6.8 17 7 17H17C17.2 17 17.35 16.9083 17.45 16.725C17.55 16.5417 17.5333 16.3667 17.4 16.2L14.65 12.525C14.55 12.3917 14.4167 12.325 14.25 12.325C14.0833 12.325 13.95 12.3917 13.85 12.525L11.25 16L9.4 13.525C9.3 13.3917 9.16667 13.325 9 13.325C8.83333 13.325 8.7 13.3917 8.6 13.525L6.6 16.2C6.46667 16.3667 6.45 16.5417 6.55 16.725Z",fill:"currentColor"})]}),subMenu:[{name:"Painting",label:"note.ai_tool.drawing_paint",onClick:()=>_("Painting")},{name:"Photograph",label:"note.ai_tool.drawing_portrait",icon:(0,n.jsx)(l.Z,{className:"w-4 h-4"}),onClick:()=>_("Photograph")},{name:"Illustration",label:"note.ai_tool.drawing_illustration",onClick:()=>_("Illustration")},{name:"Diagram",label:"note.ai_tool.drawing_diagram",onClick:()=>_("Diagram")}]},{name:"abbreviation",label:"note.ai_tool.abbreviation",icon:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",fill:"none",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 2C3.55228 2 4 2.44772 4 3V21C4 21.5523 3.55228 22 3 22C2.44772 22 2 21.5523 2 21V3C2 2.44772 2.44772 2 3 2ZM14.7071 4.29289C15.0976 4.68342 15.0976 5.31658 14.7071 5.70711L9.41421 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H9.41421L14.7071 18.2929C15.0976 18.6834 15.0976 19.3166 14.7071 19.7071C14.3166 20.0976 13.6834 20.0976 13.2929 19.7071L6.29289 12.7071C5.90237 12.3166 5.90237 11.6834 6.29289 11.2929L13.2929 4.29289C13.6834 3.90237 14.3166 3.90237 14.7071 4.29289Z",fill:"currentColor"})}),onClick:u},{name:"expand",label:"note.ai_tool.expand",icon:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",fill:"none",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 2C21.5523 2 22 2.44772 22 3V21C22 21.5523 21.5523 22 21 22C20.4477 22 20 21.5523 20 21V3C20 2.44772 20.4477 2 21 2ZM9.29289 4.29289C9.68342 3.90237 10.3166 3.90237 10.7071 4.29289L17.7071 11.2929C17.8946 11.4804 18 11.7348 18 12C18 12.2652 17.8946 12.5196 17.7071 12.7071L10.7071 19.7071C10.3166 20.0976 9.68342 20.0976 9.29289 19.7071C8.90237 19.3166 8.90237 18.6834 9.29289 18.2929L14.5858 13H3C2.44772 13 2 12.5523 2 12C2 11.4477 2.44772 11 3 11H14.5858L9.29289 5.70711C8.90237 5.31658 8.90237 4.68342 9.29289 4.29289Z",fill:"currentColor"})}),onClick:c}],k=()=>t?t.state.doc.textBetween(t.state.selection.from,t.state.selection.to):"",_=async e=>{if(!t)return;b(!0),C(""),h(!0);let r={prompt:"",width:1024,height:1024,output_format:"png",style:e,draw_words:k()||""};try{await y(r)}catch(e){console.error("Image generation failed:",e)}(0,x.fk)(f.U.SEARCH_SELETE_CREATE_IMAGE,{draw_words:k()||""},!0)};return(0,n.jsxs)(s.fC,{children:[(0,n.jsx)(s.xz,{asChild:!0,children:(0,n.jsxs)("button",{className:"inline-flex items-center  gap-1 hover:text-theme-blue-500 hover:bg-theme-bg-100 dark:hover:bg-theme-bg-dark-200 rounded-lg",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.6986 1.97036C17.9829 1.96183 18.1915 2.24073 18.0974 2.50909C17.3272 4.70435 16.5564 6.1874 15.7862 6.95896C15.6049 7.14028 15.4247 7.32107 15.245 7.50095C15.0827 7.66373 15.0832 7.92761 15.2458 8.09015L15.42 8.26349C15.6432 8.48659 15.7249 8.81873 15.6031 9.10984C14.6259 11.4408 12.2365 13.6548 9.11789 14.0447C7.07851 14.2996 5.7409 15.606 5.10503 17.9632C5.00161 18.3462 4.6636 18.6281 4.26682 18.6281H3.60845C3.43892 18.6281 3.30976 18.4755 3.33745 18.3082C4.17778 13.2322 5.98407 2.32181 17.6986 1.97036ZM15.4631 4.50128C15.6149 4.20786 15.363 3.87949 15.0399 3.94871C10.8225 4.85239 8.18522 7.64028 6.56662 11.9915C6.37342 12.5109 6.2096 12.9915 6.06288 13.4767C6.86218 12.8963 7.81425 12.5282 8.91118 12.3911C10.7871 12.1565 12.4754 11.0221 13.4839 9.53953C13.6912 9.23457 13.6283 8.83025 13.3676 8.56948L13.1836 8.38556C12.8582 8.06034 12.8578 7.53277 13.1828 7.20717L13.7712 6.61798C14.0492 6.3396 14.3273 6.06099 14.6054 5.78302C14.869 5.51933 15.1583 5.09017 15.4631 4.50128Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M16.2484 12.5001C16.3384 12.5002 16.4161 12.5299 16.4812 12.5897C16.5488 12.6486 16.5931 12.7303 16.6057 12.8192C16.6678 13.1756 16.7301 13.4756 16.7929 13.7184C16.8579 13.9585 16.9375 14.1549 17.0321 14.3076C17.1268 14.4603 17.2497 14.5831 17.4 14.6754C17.5503 14.7678 17.7414 14.8419 17.9729 14.8976C18.2067 14.9533 18.4947 15.0053 18.8363 15.0539C18.934 15.0698 19.0125 15.1115 19.0723 15.1784C19.1344 15.2458 19.1661 15.3245 19.1667 15.4144C19.1685 15.5061 19.1346 15.5952 19.0723 15.6626C19.0101 15.7299 18.9245 15.771 18.8331 15.7765C18.5417 15.808 18.2517 15.8549 17.9655 15.9181C17.7602 15.9604 17.5625 16.0346 17.3796 16.137C17.2263 16.2287 17.0983 16.3573 17.0077 16.5114C16.9017 16.6992 16.8235 16.9016 16.7758 17.112C16.7154 17.3571 16.659 17.658 16.6057 18.0145C16.5939 18.103 16.5503 18.1846 16.4836 18.244C16.4197 18.303 16.3346 18.335 16.2476 18.3335C16.1621 18.3339 16.0793 18.302 16.0165 18.244C15.9513 18.1834 15.9078 18.1024 15.8936 18.0145C15.8315 17.6582 15.7683 17.3587 15.7032 17.116C15.652 16.909 15.5709 16.7101 15.4631 16.526C15.3738 16.3755 15.249 16.249 15.0993 16.1582C14.9205 16.0541 14.7255 15.9791 14.5232 15.936C14.2924 15.8798 14.0046 15.8268 13.6597 15.7765C13.5695 15.7646 13.4856 15.7212 13.4237 15.6544C13.3648 15.5886 13.3327 15.5027 13.3334 15.4144C13.3334 15.3221 13.3651 15.2425 13.4278 15.1751C13.4878 15.106 13.5719 15.0623 13.663 15.0539C14.0074 15.0148 14.2974 14.9688 14.5329 14.9155C14.7697 14.8622 14.9643 14.7889 15.1164 14.6966C15.2692 14.6018 15.3936 14.4774 15.4883 14.3222C15.586 14.1647 15.6645 13.9644 15.7243 13.7217C15.7847 13.4765 15.8409 13.1756 15.8936 12.8192C15.9029 12.7307 15.9457 12.6486 16.0124 12.5897C16.077 12.5313 16.1613 12.4992 16.2484 12.5001Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M4.58176 1.66681C4.64335 1.66542 4.70321 1.68856 4.74777 1.7311C4.79581 1.77334 4.82697 1.83142 4.83648 1.89467C4.88143 2.14888 4.92632 2.36316 4.97076 2.53676C5.00663 2.68458 5.0645 2.82641 5.14165 2.9575C5.20674 3.06537 5.29743 3.15611 5.40533 3.22117C5.53204 3.29514 5.66964 3.34877 5.81304 3.37986C6.01704 3.42602 6.22339 3.46289 6.43072 3.49054C6.49547 3.4998 6.55544 3.53143 6.59917 3.58006C6.62106 3.60211 6.63886 3.62854 6.65044 3.65737C6.66201 3.68622 6.66729 3.71743 6.66672 3.74851C6.66785 3.81387 6.64348 3.87705 6.59917 3.92511C6.55494 3.97308 6.4942 4.00224 6.42909 4.00649C6.22069 4.02832 6.01345 4.06244 5.80897 4.10821C5.64053 4.14645 5.50043 4.19803 5.38986 4.26365C5.28091 4.33028 5.19274 4.42015 5.12456 4.5322C5.05739 4.64432 5.00195 4.78747 4.95855 4.96108C4.91621 5.13618 4.87521 5.35103 4.83648 5.60561C4.82808 5.66849 4.79776 5.72637 4.75021 5.76837C4.72799 5.78981 4.70169 5.80683 4.6729 5.81801C4.64402 5.82919 4.61271 5.83437 4.58176 5.83347C4.55124 5.83404 4.52066 5.82835 4.49224 5.8172C4.46389 5.80603 4.43768 5.78952 4.41574 5.76837C4.36961 5.72498 4.33953 5.66733 4.32948 5.6048C4.28453 5.35059 4.23845 5.13631 4.19195 4.96271C4.14649 4.79083 4.09001 4.65039 4.02186 4.54197C3.95684 4.43311 3.86975 4.34572 3.76145 4.27911C3.6545 4.2135 3.51734 4.1602 3.35048 4.12042C3.18464 4.08064 2.9787 4.04265 2.7328 4.00649C2.66515 3.99668 2.60877 3.96793 2.56434 3.91941C2.52204 3.8728 2.49908 3.81145 2.50005 3.74851C2.49872 3.68496 2.52286 3.62357 2.56678 3.57761C2.61035 3.52868 2.6709 3.49746 2.73605 3.49054C2.94457 3.46828 3.1518 3.43532 3.35699 3.39207C3.52593 3.35384 3.66515 3.30194 3.77365 3.23582C3.88216 3.16896 3.97354 3.07697 4.03977 2.96808C4.11678 2.83433 4.17308 2.68967 4.20741 2.5392C4.25778 2.32654 4.29848 2.11113 4.32867 1.89467C4.33648 1.83172 4.36696 1.77353 4.41411 1.7311C4.46006 1.68954 4.5198 1.66646 4.58176 1.66681Z",fill:"currentColor"})]}),(0,n.jsx)("span",{className:"text-sm",children:r("note.ai_tool.label")}),(0,n.jsx)(i.Z,{className:"w-4 h-4"})]})}),(0,n.jsx)(s.VY,{asChild:!0,children:(0,n.jsx)("div",{className:"flex flex-col gap-1  mt-3 bg-white dark:bg-theme-bg-dark-100 border border-theme-border-200 dark:border-theme-border-dark-200 shadow-md rounded-lg text-sm",children:j.map(e=>(0,n.jsx)("div",{children:e.subMenu?(0,n.jsxs)(s.Tr,{children:[(0,n.jsxs)(s.fF,{className:(0,d.cn)("flex gap-2 items-center rounded-lg px-2 py-1.5 hover:bg-theme-bg-100 dark:hover:bg-theme-bg-dark-200 transition-colors cursor-pointer w-full"),children:[(0,n.jsx)("div",{className:"w-4 flex items-center justify-center",children:e.icon}),(0,n.jsx)("span",{children:r(e.label)}),(0,n.jsx)(o.Z,{className:"w-4 h-4 ml-auto"})]}),(0,n.jsx)(s.tu,{className:"min-w-[8rem] p-1 mt-2 -ml-2 bg-white dark:bg-theme-bg-dark-100 border border-theme-border-200 dark:border-theme-border-dark-200 shadow-md rounded-lg",sideOffset:10,alignOffset:-10,children:e.subMenu.map(e=>(0,n.jsx)(s.ck,{className:(0,d.cn)("flex gap-2 items-center rounded-lg p-1.5 hover:bg-theme-bg-100 dark:hover:bg-theme-bg-dark-200 transition-colors cursor-pointer"),onClick:e.onClick,children:r(e.label)},e.name))})]}):(0,n.jsxs)(s.ck,{className:(0,d.cn)("flex gap-2 items-center rounded-lg p-2 hover:bg-theme-bg-100 dark:hover:bg-theme-bg-dark-200 transition-colors cursor-pointer"),onClick:e.onClick,children:[(0,n.jsx)("div",{className:"w-4 flex items-center justify-center",children:e.icon}),(0,n.jsxs)("span",{children:[" ",r(e.label)]})]})},e.name))})})]})}},53492:function(e,t,r){"use strict";r.d(t,{S:function(){return Z},Z:function(){return I}});var n=r(52676),a=r(26831),l=r(62273),i=r(37481),o=r(5245),s=r(44342),d=r(70400),c=r(75271),u=r(80538),h=r(25773),p=r(31162),m=r(70469),g=r(96022),x=r(13976),f=r(25010),v=r(17112),C=r(7717),b=r(50403),w=r(96115);function y(e){let{editor:t}=e,r=t.getAttributes("image").src?t.getAttributes("image"):t.getAttributes("customImage"),[a,l]=(0,c.useState)({src:r.src||"",alt:r.alt||"",width:r.width||"",height:r.height||"",alignment:r.alignment||"left"}),[i,o]=(0,c.useState)(!1),s=(0,C.useTranslations)(),d=()=>{let e=t.getAttributes("image").src?t.getAttributes("image"):t.getAttributes("customImage");return{src:e.src||"",alt:e.alt||"",width:e.width||"",height:e.height||"",alignment:e.alignment||"left"}};(0,c.useEffect)(()=>{let e=()=>{l(d())};return t.on("selectionUpdate",e),t.on("update",e),()=>{t.off("selectionUpdate",e),t.off("update",e)}},[t]);let y=async e=>{var r,n;let i=null===(r=e.target.files)||void 0===r?void 0:r[0];if(i){if(i.size>5242880){v.Z.error(s("note.format.img_limit_size",{size:"5"})),e.target.value="";return}try{o(!0);let e=await (0,b.Jd)(i,(null===(n=w.Z.getState().noteData)||void 0===n?void 0:n.note_id)||""),r={...a,src:e.data,alt:i.name};l(r),t.chain().focus().updateImage({src:r.src,class:"docImg","data-id":""}).run()}catch(e){console.error("Upload error:",e),v.Z.error(s("common.upload_failed"))}finally{o(!1),e.target.value=""}}},j=e=>{l(t=>({...t,alignment:e})),t.chain().focus().setImage({...a,alignment:e}).run()};return(0,n.jsx)("div",{className:"p-2 ",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(f.z,{size:"icon",variant:"outline",onClick:()=>window.open(a.src,"_blank"),children:(0,n.jsx)(u.Z,{className:"w-4 h-4"})}),(0,n.jsx)(f.z,{variant:"outline",size:"icon",asChild:!0,children:(0,n.jsxs)("label",{className:"cursor-pointer",children:[i?(0,n.jsx)(h.Z,{className:"h-4 w-4 animate-spin"}):(0,n.jsx)(p.Z,{className:"w-4 h-4"}),(0,n.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:y})]})}),(0,n.jsx)("div",{className:"flex gap-2",children:["left","center","right"].map(e=>(0,n.jsxs)(f.z,{size:"icon",variant:a.alignment===e?"default":"outline",onClick:()=>j(e),children:["left"===e&&(0,n.jsx)(m.Z,{className:"w-4 h-4"}),"center"===e&&(0,n.jsx)(g.Z,{className:"w-4 h-4"}),"right"===e&&(0,n.jsx)(x.Z,{className:"w-4 h-4"})]},e))})]})})}var j=r(91165),k=r(39071),_=r(5588);function N(e){let{editor:t}=e,r=t.getAttributes("link"),[a,l]=(0,c.useState)(r.href||""),[i,o]=(0,c.useState)("_blank"===r.target),[s,d]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let e=t.getAttributes("link");l(e.href||""),o("_blank"===e.target)},[t.state.selection]);let p=()=>{t.commands.selectParentNode(),t.chain().focus().unsetLink().run(),l("")};return(0,n.jsx)("div",{className:"grid p-1",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(_.I,{value:a,onChange:e=>l(e.target.value),placeholder:"https://example.com"}),(0,n.jsx)(f.z,{size:"sm",onClick:()=>{if(""===a){p();return}t.state.selection.empty&&t.commands.selectParentNode(),t.chain().focus().extendMarkRange("link").setLink({href:a,target:i?"_blank":null}).run()},children:(0,n.jsx)(j.Z,{className:"h-4 w-4"})}),(0,n.jsxs)(f.z,{variant:"destructive",size:"sm",onClick:p,disabled:!a,children:[" ",(0,n.jsx)(k.Z,{className:"h-4 w-4"})]}),(0,n.jsx)(f.z,{size:"sm",variant:"secondary",onClick:()=>{a&&window.open(a,"_blank")},disabled:!a,children:(0,n.jsx)(u.Z,{className:"w-4 h-4"})}),s&&(0,n.jsx)(f.z,{variant:"outline",size:"icon",disabled:!0,children:(0,n.jsx)(h.Z,{className:"h-4 w-4 animate-spin"})})]})})}var S=r(79057),F=r(31063),T=r(60161),E=r(64155);let Z=(0,c.forwardRef)((e,t)=>{let{onClick:r,isActive:a,disabled:l,children:o}=e;return(0,n.jsx)("button",{ref:t,onClick:r,className:(0,i.cn)("  rounded-lg [&_svg]:size-5 hover:bg-theme-bg-100 dark:hover:bg-theme-bg-dark-200",a&&"bg-theme-bg-200 dark:bg-theme-bg-dark-300",l&&"opacity-60"),disabled:l,children:o})});function I(){let{isMobile:e}=(0,s.b)(),{editor:t}=(0,d._)(),{noteData:r}=(0,w.Z)(),i=(0,l.J)(t);(0,C.useLocale)();let{setShowGraphicModel:c,setGraphicQueryData:u}=(0,S.Z)(),h=(0,C.useTranslations)();if(!t)return;let p=()=>t?t.state.doc.textBetween(t.state.selection.from,t.state.selection.to):"",m=e=>{if(!e.length){v.Z.warning(h("graphic.select_text_not_empty"),3e3);return}u({messageId:(0,E.Z)(),threadId:(0,E.Z)(),language:"auto",inputText:e,query:null==r?void 0:r.title,canEdit:!0,template:void 0,note_id:null==r?void 0:r.note_id,smart_art_id:"",mode:"note"}),c(!0),(0,F.fk)(T.U.DOCS_CREATE_SMARTART,{query:null==r?void 0:r.title,note_id:null==r?void 0:r.note_id},!0)};return(0,n.jsx)(a.NM,{editor:t,tippyOptions:{arrow:!1,placement:e?"bottom-start":"top-start",popperOptions:{modifiers:[{name:"preventOverflow",options:{boundary:"viewport",padding:8}}]},zIndex:5,maxWidth:"calc(100vw - 16px)"},shouldShow:i.shouldShow,children:(0,n.jsx)("div",{className:"flex gap-2 p-2 bg-white dark:bg-theme-bg-dark-100 border border-theme-border-200 dark:border-theme-border-dark-200 rounded-lg shadow-md select-none",children:t.isActive("image")||(null==t?void 0:t.isActive("customImage"))?(0,n.jsx)(y,{editor:t}):t.isActive("link")?(0,n.jsx)(N,{editor:t}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Z,{editor:t}),(0,n.jsxs)(Z,{onClick:()=>m(p()),children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 justify-center text-sm hover:text-[#0694FF]",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 20 20",fill:"none",children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.30425 1.75631C9.57637 1.63673 9.88646 1.63673 10.1586 1.75631C10.3865 1.85645 10.5238 2.02847 10.6 2.13484C10.6739 2.23795 10.7503 2.36836 10.8226 2.49185L13.8262 7.61877C13.8301 7.62544 13.834 7.63214 13.8379 7.63885C13.9105 7.76272 13.9872 7.89351 14.0411 8.00858C14.0962 8.12628 14.1807 8.33295 14.1542 8.5838C14.1226 8.88381 13.9638 9.15391 13.721 9.32837C13.5187 9.47367 13.3001 9.50442 13.1705 9.51616C13.0437 9.52766 12.8916 9.52763 12.7464 9.52759C12.7386 9.52759 12.7309 9.52759 12.7233 9.52759H6.73956C6.73189 9.52759 6.72419 9.52759 6.71647 9.52759C6.57125 9.52763 6.41912 9.52766 6.29229 9.51616C6.16276 9.50442 5.94409 9.47367 5.74187 9.32837C5.49907 9.15391 5.34025 8.88381 5.3086 8.5838C5.28214 8.33295 5.36668 8.12628 5.42178 8.00858C5.47564 7.89351 5.55232 7.76271 5.62493 7.63883C5.62886 7.63213 5.63278 7.62544 5.63668 7.61877L8.62854 2.51182C8.63242 2.50519 8.63632 2.49853 8.64023 2.49185C8.71254 2.36836 8.7889 2.23795 8.8628 2.13484C8.93903 2.02847 9.07636 1.85645 9.30425 1.75631ZM9.73142 3.3769L6.94177 8.1387H12.5211L9.73142 3.3769ZM14.1826 11.5032C12.6498 11.5032 11.4213 12.729 11.4213 14.2238C11.4213 15.7186 12.6498 16.9444 14.1826 16.9444C15.7153 16.9444 16.9438 15.7186 16.9438 14.2238C16.9438 12.729 15.7153 11.5032 14.1826 11.5032ZM10.0324 14.2238C10.0324 11.9465 11.8983 10.1143 14.1826 10.1143C16.4668 10.1143 18.3327 11.9465 18.3327 14.2238C18.3327 16.5011 16.4668 18.3333 14.1826 18.3333C11.8983 18.3333 10.0324 16.5011 10.0324 14.2238ZM4.08134 10.2941H7.1872C7.47124 10.2941 7.72446 10.294 7.93468 10.311C8.15895 10.3291 8.39435 10.3699 8.62455 10.4858C8.95988 10.6547 9.23404 10.9249 9.40637 11.2591C9.5251 11.4894 9.56682 11.725 9.5853 11.9485C9.60255 12.1572 9.60254 12.4084 9.60253 12.6885V15.7591C9.60254 16.0392 9.60255 16.2904 9.5853 16.4991C9.56682 16.7226 9.5251 16.9582 9.40637 17.1885C9.23404 17.5227 8.95988 17.793 8.62455 17.9618C8.39435 18.0777 8.15895 18.1185 7.93468 18.1366C7.72445 18.1536 7.47122 18.1536 7.18717 18.1536H4.08138C3.79732 18.1536 3.54409 18.1536 3.33386 18.1366C3.10959 18.1185 2.87419 18.0777 2.64399 17.9618C2.30866 17.793 2.0345 17.5227 1.86217 17.1885C1.74344 16.9582 1.70172 16.7226 1.68325 16.4991C1.66599 16.2904 1.666 16.0392 1.66602 15.7591V12.6885C1.666 12.4084 1.66599 12.1572 1.68325 11.9485C1.70172 11.725 1.74344 11.4894 1.86217 11.2591C2.0345 10.9249 2.30866 10.6547 2.64399 10.4858C2.87419 10.3699 3.10959 10.3291 3.33386 10.311C3.54408 10.294 3.7973 10.2941 4.08134 10.2941ZM3.26862 11.7263C3.19328 11.7643 3.13355 11.824 3.09664 11.8956C3.09664 11.8956 3.07851 11.9286 3.06741 12.0629C3.05546 12.2075 3.05491 12.4004 3.05491 12.714V15.7336C3.05491 16.0472 3.05546 16.2401 3.06741 16.3847C3.07851 16.519 3.09662 16.552 3.09662 16.552C3.13354 16.6236 3.19328 16.6834 3.26862 16.7213C3.27257 16.7233 3.30767 16.7411 3.44564 16.7522C3.59318 16.7641 3.78958 16.7647 4.10649 16.7647H7.16205C7.47896 16.7647 7.67536 16.7641 7.8229 16.7522C7.96086 16.7411 7.99584 16.7234 7.99979 16.7214C8.07513 16.6834 8.13499 16.6236 8.17191 16.552C8.17191 16.552 8.18987 16.5209 8.20113 16.3847C8.21308 16.2401 8.21364 16.0472 8.21364 15.7336V12.714C8.21364 12.4004 8.21308 12.2075 8.20113 12.0629C8.19003 11.9286 8.17193 11.8956 8.17193 11.8956C8.13501 11.824 8.07526 11.7643 7.99992 11.7263C7.99597 11.7243 7.96087 11.7065 7.8229 11.6954C7.67536 11.6835 7.47896 11.683 7.16205 11.683H4.10649C3.78958 11.683 3.59318 11.6835 3.44564 11.6954C3.30767 11.7065 3.27257 11.7243 3.26862 11.7263Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M3.74777 2.08335C3.80937 2.08196 3.86922 2.1051 3.91379 2.14764C3.96182 2.18989 3.99298 2.24796 4.00249 2.31122C4.04745 2.56542 4.09234 2.7797 4.13677 2.95331C4.17264 3.10112 4.23052 3.24295 4.30767 3.37404C4.37276 3.48191 4.46345 3.57266 4.57134 3.63771C4.69806 3.71168 4.83566 3.76532 4.97906 3.79641C5.18306 3.84257 5.38941 3.87943 5.59673 3.90708C5.66149 3.91635 5.72145 3.94797 5.76519 3.9966C5.78707 4.01865 5.80488 4.04509 5.81646 4.07391C5.82803 4.10276 5.83331 4.13398 5.83273 4.16506C5.83386 4.23042 5.8095 4.29359 5.76519 4.34165C5.72095 4.38962 5.66021 4.41879 5.5951 4.42303C5.38671 4.44486 5.17946 4.47899 4.97499 4.52476C4.80655 4.56299 4.66645 4.61458 4.55588 4.68019C4.44693 4.74683 4.35875 4.83669 4.29058 4.94875C4.22341 5.06087 4.16797 5.20402 4.12456 5.37762C4.08222 5.55272 4.04122 5.76758 4.00249 6.02215C3.9941 6.08503 3.96377 6.14291 3.91623 6.18491C3.89401 6.20636 3.8677 6.22338 3.83892 6.23456C3.81004 6.24574 3.77873 6.25091 3.74777 6.25002C3.71725 6.25059 3.68667 6.2449 3.65826 6.23374C3.62991 6.22257 3.60369 6.20607 3.58176 6.18491C3.53562 6.14152 3.50555 6.08387 3.49549 6.02134C3.45054 5.76713 3.40446 5.55285 3.35796 5.37925C3.31251 5.20737 3.25603 5.06694 3.18788 4.95851C3.12286 4.84966 3.03576 4.76226 2.92746 4.69566C2.82052 4.63004 2.68336 4.57675 2.51649 4.53697C2.35066 4.49719 2.14472 4.4592 1.89881 4.42303C1.83116 4.41322 1.77478 4.38448 1.73036 4.33596C1.68805 4.28934 1.6651 4.228 1.66607 4.16506C1.66474 4.1015 1.68888 4.04012 1.7328 3.99416C1.77637 3.94523 1.83692 3.91401 1.90207 3.90708C2.11059 3.88483 2.31781 3.85187 2.523 3.80861C2.69194 3.77038 2.83117 3.71849 2.93967 3.65236C3.04817 3.5855 3.13955 3.49351 3.20578 3.38462C3.2828 3.25087 3.3391 3.10622 3.37342 2.95575C3.42379 2.74308 3.46449 2.52767 3.49468 2.31122C3.5025 2.24827 3.53298 2.19007 3.58013 2.14764C3.62608 2.10609 3.68582 2.083 3.74777 2.08335Z",fill:"currentColor"})]})," ",(0,n.jsx)("span",{children:h("graphic.name")})," "]})," "]})]})})})}Z.displayName="TextMenuButton"},62273:function(e,t,r){"use strict";r.d(t,{J:function(){return o}});var n=r(26831),a=r(75271),l=r(66040);let i=e=>{let{editor:t}=e,{state:{doc:r,selection:n,selection:{empty:a,from:i,to:o}}}=t,s=!r.textBetween(i,o).length&&(0,l.xh)(n);return!a&&!s&&!!t.isEditable},o=e=>{let t=(0,n.sZ)({editor:e,selector:e=>{var t,r,n,a,l,i,o,s,d,c,u,h,p,m,g,x,f,v,C;return{isBold:null===(t=e.editor)||void 0===t?void 0:t.isActive("bold"),isItalic:null===(r=e.editor)||void 0===r?void 0:r.isActive("italic"),isStrike:null===(n=e.editor)||void 0===n?void 0:n.isActive("strike"),isUnderline:null===(a=e.editor)||void 0===a?void 0:a.isActive("underline"),isCode:null===(l=e.editor)||void 0===l?void 0:l.isActive("code"),isSubscript:null===(i=e.editor)||void 0===i?void 0:i.isActive("subscript"),isSuperscript:null===(o=e.editor)||void 0===o?void 0:o.isActive("superscript"),isAlignLeft:null===(s=e.editor)||void 0===s?void 0:s.isActive({textAlign:"left"}),isAlignCenter:null===(d=e.editor)||void 0===d?void 0:d.isActive({textAlign:"center"}),isAlignRight:null===(c=e.editor)||void 0===c?void 0:c.isActive({textAlign:"right"}),isAlignJustify:null===(u=e.editor)||void 0===u?void 0:u.isActive({textAlign:"justify"}),currentColor:(null===(p=e.editor)||void 0===p?void 0:null===(h=p.getAttributes("textStyle"))||void 0===h?void 0:h.color)||void 0,currentHighlight:(null===(g=e.editor)||void 0===g?void 0:null===(m=g.getAttributes("highlight"))||void 0===m?void 0:m.color)||void 0,currentFont:(null===(f=e.editor)||void 0===f?void 0:null===(x=f.getAttributes("textStyle"))||void 0===x?void 0:x.fontFamily)||void 0,currentSize:(null===(C=e.editor)||void 0===C?void 0:null===(v=C.getAttributes("textStyle"))||void 0===v?void 0:v.fontSize)||void 0}}});return{shouldShow:(0,a.useCallback)(t=>{let{view:r,from:n}=t;return!!r&&!e.view.dragging&&(r.domAtPos(n||0).node,r.nodeDOM(n||0),i({editor:e})&&!(null==e?void 0:e.isActive("code"))&&!(null==e?void 0:e.isActive("table"))&&!(null==e?void 0:e.isActive("tableCell"))&&!(null==e?void 0:e.isActive("tableHeader"))&&!(null==e?void 0:e.isActive("sourceButton")))},[e]),...t}}},35030:function(e,t,r){"use strict";let n;var a=r(52676),l=r(9455),i=r(64657),o=r(5687),s=r(55383),d=r(93650),c=r(26595),u=r(93071),h=r(7717),p=r(18881),m=r(64787),g=r(75271),x=r(40341),f=r(94572),v=r(72070),C=r.n(v),b=r(39344),w=r(25773),y=r(31063),j=r(60161),k=r(39109);let _=0;async function N(e){let{threadId:t,jobId:r,time:a,businessType:l}=e;return new Promise(e=>{n=setInterval(async()=>{++_>=10&&(clearInterval(n),e({editUrl:"",thumbnailUrl:""}));let a=await (0,x.IQ)({threadId:t,jobId:r,businessType:l});console.log("\uD83D\uDE80 ~ interval=setInterval ~ res:",a),(null==a?void 0:a.status)==="success"?(e({editUrl:null==a?void 0:a.editUrl,thumbnailUrl:null==a?void 0:a.thumbnailUrl}),clearInterval(n)):(null==a?void 0:a.status)==="failed"?(e({editUrl:"",thumbnailUrl:""}),clearInterval(n)):console.log("Not obtaining the permission to continue polling...")},a||5e3)})}let S=(0,g.forwardRef)((e,t)=>{let{threadId:r,businessType:n}=e,v=(0,h.useTranslations)(),{isCanvaAuthorized:_,setIsCanvaAuthorized:S,isCanvaConnectedLoading:F,setIsCanvaConnectedLoading:T,isOpenCanvaEditorLoading:E,setIsOpenCanvaEditorLoading:Z,setIsReauthorized:I,isShowCanvaModal:D,setIsShowCanvaModal:A,isImportLoading:L,setIsImportLoading:M,design:O,setDesign:P}=(0,p.Z)(),B=(0,k.Z)(),{isOpen:z,onClose:R,onOpen:H,onOpenChange:U}=(0,l.q)(),V=async e=>{let{threadId:t,businessType:r}=e;try{let{status:e}=await (0,m.Es)({threadId:t,businessType:r});return S(e),e}catch(e){return console.error("Error checking authorization:",e),S(!1),!1}},q=async()=>{F||(T(!0),await (0,m.Iv)({threadId:r,businessType:n})?(S(!1),B.default(v("ppt.canva_disconnected")),R()):B.default(v("ppt.canva_disconnect_failed")),T(!1))},G=async()=>{T(!0);try{if(await (0,m.qf)({threadId:r,businessType:n}))return S(!0),B.default(v("ppt.canva_connected")),!0;return S(!1),B.default(v("ppt.canva_connect_failed")),!1}catch(e){return console.error(e),S(!1),B.default(v("ppt.canva_connect_failed")),!1}finally{T(!1)}},J=async()=>{M(!0),Z(!0);try{let e=await (0,x.$E)({threadId:r,businessType:n});if(!e)return B.default(v("ppt.import_ppt_failed")),!1;let t=await N({time:5e3,jobId:e,threadId:r,businessType:n}),a=null==t?void 0:t.editUrl;if(!a)return B.default(v("ppt.import_ppt_failed")),!1;return(0,f.bs)({threadId:r,canvaEditUrl:a,canvaThumbnailUrl:null==t?void 0:t.thumbnailUrl}),P(t),window.open(a),H(),!0}catch(e){if(console.error(e,null==e?void 0:e.message),!p.Z.getState().isReauthorized&&(null==e?void 0:e.message)==="CANVA_GET_TOKEN_FAIL")return R(),Z(!0),S(!1),I(!0),X(!0),!1;return B.default(v("ppt.import_ppt_failed")),!1}finally{M(!1)}},X=async e=>{Z(!0);let t=await V({threadId:r,businessType:n});if(!0!==e&&t){let{canvaEditUrl:e,canvaThumbnailUrl:t}=(0,f.OW)({threadId:r});if(H(),!e){if(!await J()){Z(!1),R();return}Z(!1);return}P({editUrl:e,thumbnailUrl:t}),(0,y.fk)(j.U.THREAD_CANVA_EDIT,{id:r},!0),window.open(e),Z(!1);return}if((0,y.fk)(j.U.THREAD_CONNECT_CANVA,{id:r},!0),!await G()){Z(!1);return}if(H(),!await J()){Z(!1),R();return}Z(!1)};return(0,g.useImperativeHandle)(t,()=>({openCanvaEditor:X,revokeCanva:q})),(0,g.useEffect)(()=>{z?A(!0):A(!1)},[z]),(0,g.useEffect)(()=>{D?H():R()},[D]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i.R,{isOpen:z,isDismissable:!1,onOpenChange:U,classNames:{base:"max-w-lg max-h-[80dvh] min-h-[300px]",body:"justify-center items-center",footer:"justify-center"},children:(0,a.jsxs)(o.A,{children:[(0,a.jsx)(s.k,{className:"flex flex-col gap-1"}),(0,a.jsxs)(d.I,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center w-[300px] relative mb-4",children:[(0,a.jsx)(C(),{src:"/icon.svg",alt:"check",width:80,height:80,className:"shadow-lg rounded-full relative z-10"}),(0,a.jsx)("div",{className:"relative z-10 bg-white rounded-full dark:bg-slate-800",children:E?(0,a.jsx)(w.Z,{className:"text-primary animate-spin"}):(0,a.jsx)(b.NhS,{color:"#4ba570",className:"w-[26px] h-[26px]"})}),(0,a.jsx)("div",{className:"w-[80px] h-[80px] border border-gray-200 rounded-full flex justify-center items-center shadow-lg relative z-10 bg-white dark:bg-slate-800 dark:border-slate-400",children:(0,a.jsx)(C(),{src:"/canva.svg",width:50,height:50,alt:"Canva"})}),(0,a.jsx)("hr",{className:"border-dashed border w-full absolute left-0 top-1/2 -translate-y-1/2 z-0 dark:bg-slate-600"})]}),E?(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg mb-2 text-center",children:v("ppt.please_wait")}),(0,a.jsx)("p",{className:"text-center text-sm opacity-60",children:v("ppt.canva_import_loading")})]}):(0,a.jsxs)("div",{className:"max-w-xs mx-auto",children:[(0,a.jsx)(c.A,{className:"w-full bg-purple-500 mb-4",color:"primary",as:u.O,href:null==O?void 0:O.editUrl,target:"_blank",onClick:()=>{(0,y.fk)(j.U.THREAD_CANVA_EDIT,{id:r},!0)},children:v("ppt.edit_in_canva")}),(0,a.jsx)("p",{className:"text-sm opacity-60 text-center",children:v.rich("canva.cancel_connected",{link:e=>(0,a.jsx)("a",{href:"javascript:void(0)",className:"text-primary",onClick:q,children:e})})})]})]})]})})})});S.displayName="ConnectCanva",t.Z=S},7363:function(e,t,r){"use strict";r.d(t,{Z:function(){return $}});var n=r(52676),a=r(75271),l=r(9455),i=r(26595),o=r(33935),s=r(64657),d=r(5687),c=r(55383),u=r(93650),h=r(49983),p=r(4080),m=r(60904),g=r(7717),x=r(18881),f=r(45360),v=r(77998),C=r(94572),b=r(31063),w=r(60161),y=r(30674),j=r(25273),k=r(9369),_=r(8924),N=r(4814),S=r(78467),F=r(86386),T=r.n(F);let E=e=>{let{templateColourId:t,setTemplateColourId:r,templateStyleId:a,setTemplateStyleId:l,templateColourOptions:o,templateStyleOptions:s}=e,d=(0,g.useTranslations)();return(0,n.jsxs)("div",{className:"p-2 m-2 mt-0 border border-gray-200 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"w-[60px]  text-gray-700 text-sm pt-0 md:pt-1.5 font-medium dark:text-gray-400",children:d("ppt.select_colour")}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-1 md:gap-2 w-[calc(100%-60px)]",children:[(0,n.jsx)(i.A,{className:(0,N.Z)("rounded-full p-0 h-[24px] w-[24px] min-w-0 border relative before:absolute before:left-0 before:top-0 before:rounded-full  before:border before:border-white dark:before:border-[#18181B]","h-[19px] w-[19px] before:h-[17px] before:w-[17px]","md:h-[24px] md:w-[24px] md:before:h-[22px] md:before:w-[22px]",T()["bg--colors"],t?"":"border-primary"),onPress:()=>{r("")}}),o.map(e=>(0,n.jsx)(i.A,{onPress:()=>{r(String(e.id))},className:(0,N.Z)("rounded-full p-0 min-w-0 border relative before:absolute before:left-0 before:top-0 before:rounded-fullbefore:border before:border-white hover:border-primary dark:before:border-[#18181B]","h-[20px] w-[20px] before:h-[18px] before:w-[18px]","md:h-[24px] md:w-[24px] md:before:h-[22px] md:before:w-[22px]",t===String(e.id)?"border-primary":"inherit"),style:{backgroundColor:e.code}},e.id))]})]}),(0,n.jsxs)("div",{className:"flex mt-3 md:mt-4",children:[(0,n.jsx)("div",{className:"w-[60px] text-gray-700 text-sm pt-0 md:pt-1.5 font-medium dark:text-gray-400",children:d("ppt.select_style")}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-1 md:gap-2 w-[calc(100%-60px)]",children:[(0,n.jsx)(i.A,{onPress:()=>{l("")},className:(0,N.Z)("rounded-full px-3 py-0 gap-1 border min-w-0 dark:border-0","px-2 md:px-3 py-0 h-6 md:h-8",a?"text-gray-500":""),size:"sm",color:a?void 0:"primary",variant:a?"bordered":void 0,children:d("ppt.all_option")}),s.map(e=>(0,n.jsx)(i.A,{onPress:()=>{l(String(e.id))},className:(0,N.Z)("rounded-full gap-1 border min-w-0 dark:border-0","px-2 md:px-3 py-0 h-6 md:h-8",a===String(e.id)?"":"text-gray-500 "),size:"sm",variant:a===String(e.id)?void 0:"ghost",color:a===String(e.id)?"primary":void 0,children:e.title},e.id))]})]})]})};var Z=e=>{let{templateList:t,templateId:r,setTemplateId:a}=e;return(0,n.jsx)("ul",{className:(0,N.Z)("grid overflow-y-auto grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:pr-2"),children:t.map(e=>(0,n.jsx)("li",{className:(0,N.Z)("rounded cursor-pointer",{"border-[#0370EF] border-2":r===e.id},T()["bg--ppt"],"bg--ppt"),onClick:()=>{a(e.id)},children:(0,n.jsx)("div",{className:(0,N.Z)("rounded border",T()["bg--ppt__img"],"dark:border-gray-500"),children:(0,n.jsx)("img",{src:e.cover_img,alt:e.id.toString()})})},e.id))})},I=r(82180),D=r(29463),A=r(11122),L=r(65550);let M=()=>(0,n.jsx)("div",{className:"flex justify-center items-center min-h-[calc(60dvh)] md:min-h-[calc(77vh-200px)]",children:(0,n.jsx)(A.w,{className:"space-y-10 p-4 border-0",fullWidth:!0,radius:"none",shadow:"none",children:(0,n.jsx)("div",{className:"space-y-6",children:[1,2,3,4,5].map((e,t)=>(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)(L.X,{className:"w-3/5 rounded-lg",children:(0,n.jsx)("div",{className:"h-3 w-3/5 rounded-lg bg-default-200"})}),(0,n.jsx)(L.X,{className:"w-4/5 rounded-lg",children:(0,n.jsx)("div",{className:"h-3 w-4/5 rounded-lg bg-default-200"})}),(0,n.jsx)(L.X,{className:"w-2/5 rounded-lg",children:(0,n.jsx)("div",{className:"h-3 w-2/5 rounded-lg bg-default-300"})})]},"".concat(e,"_").concat(t)))})})});var O=e=>{let{handleRegenerateOutline:t}=e,r=(0,a.useRef)(null),{outlineLoading:l,outlineStatus:i,outline:o}=(0,v.Z)(),s=async()=>{await (0,C.gw)(4e3),r.current&&r.current.scrollIntoView(!1)};return(0,a.useEffect)(()=>{s()},[o]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"h-[calc(70dvh+76px)] py-2 text-gray-700 mx-2 dark:text-gray-400 relative md:h-[calc(80dvh)] overflow-hidden",children:l?(0,n.jsx)(M,{}):"error"===i?(0,n.jsx)(S.Z,{type:"error",message:o,handleOpen:t}):(0,n.jsx)("div",{className:(0,N.Z)("prose prose-md dark:prose-invert max-w-full","h-[calc(70dvh+60px)] md:h-[calc(80dvh-30px)]"," felo--scrollbar overflow-y-auto","border border-gray-200 rounded-lg dark:border-gray-800"),children:(0,n.jsx)("div",{ref:r,className:(0,N.Z)("mx-4 my-5"),children:(0,n.jsx)(D.Z,{children:o})})})})})},P=r(35063),B=r(84706),z=r(97247),R=r(65819),H=r(24213),U=r(39109);let V=(0,a.forwardRef)((e,t)=>{let{templateLoading:r,templateOptionsStatus:l,templateSceneOptions:o,handleOpen:s,showMoreTemplateOptions:d,setShowMoreTemplateOptions:c,templateStyleOptions:u,templateStyleId:h,setTemplateStyleId:p,templateColourOptions:m,setTemplateColourId:f,templateColourId:b,templateStatus:w,templateList:F,templateId:T,setTemplateId:D,templateListLoading:A,hasNextPage:L,loaderMoreRef:M,currentPage:V,templateEmptyRef:q,isOpenRetry:G,handleDownload:J,shortId:X}=e,W=(0,g.useTranslations)(),$=(0,g.useLocale)(),{pptStatus:K,setPptStatus:Y,setOutlineLoading:Q,setOutline:ee,setOutlineStatus:et,setGeneratePptProgress:er,updateGeneratePptProgress:en,clearUpdateGeneratePptProgress:ea,setPptDetail:el,pptDetail:ei,isPptLoading:eo,setIsPptLoading:es,setTemplateStatus:ed,isLoadingButton:ec,getOutline:eu}=(0,v.Z)(),{isPdfLoaded:eh,setIsRegenerate:ep,setCoverUrl:em,coverUrl:eg}=(0,x.Z)(),ex=(0,U.Z)(),{mergedSources:ef}=(0,P.Z)(),ev=(0,R.ZP)(e=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.language}),eC=async e=>{e=null==e||e,Y("generate"),Q(!0),et("init"),ed("init"),er(0),em(""),P.Z.getState().setMergedSourcesPptCover("");let t=(0,C.NV)({lang:ev||"",locale:$});console.log("\uD83D\uDE80 ~ handleGenerateOutline ~ outputLang:",t);try{var r,n,a,l,i;let{templateId:o}=(0,C.OW)({threadId:X}),s=T||o;(0,C.bs)({threadId:X,isProgress:!0}),el({status:C.nV.OUTLINE}),er(1),en({maxProgress:70,increment:2,interval:2e3,threadId:X});let d=await eu({thread_id:X,template_id:String(s),stream:e,language:t});if((null==d?void 0:null===(r=d.data)||void 0===r?void 0:r.status)===402){ea(),Q(!1),ee(""),Y("init"),et("init"),ed("init"),er(0),el({status:C.nV.TIMEOUT}),B.$.publish("showSubscriptionPlan",void 0);return}if((null==d?void 0:null===(n=d.data)||void 0===n?void 0:n.status)===507){ea(),Q(!1),ee(""),Y("init"),et("init"),ed("init"),er(0),el({status:C.nV.TIMEOUT}),ex.default(W("ppt.generate_warn_tip"));return}if(!(null==d?void 0:null===(a=d.data)||void 0===a?void 0:a.outline)){ea(),Y("init"),er(0),Q(!1),ee(""),et("error");return}er(70),ea(),e||ee(null===(i=d.data.outline)||void 0===i?void 0:null===(l=i.replace("```markdown",""))||void 0===l?void 0:l.replaceAll("```","")),Q(!1),(0,C.bs)({threadId:X,status:C.nV.OUTLINE}),el({status:C.nV.OUTLINE}),en({maxProgress:95,increment:1,interval:1e3,threadId:X});let c=await (0,C.TT)({threadId:X});if(ea(),Y("preview"),!c){et("error");return}es(!0),console.log("newPptDetail",c),(0,C.bs)({threadId:X,expiryTime:Date.now()+348e4,pptUrl:null==c?void 0:c.ppt_url,templateId:s,pdfUrl:null==c?void 0:c.pdf_url,isProgress:!1}),el({cover_url:null==c?void 0:c.cover_url,ppt_url:null==c?void 0:c.ppt_url,pdf_url:null==c?void 0:c.pdf_url,status:C.nV.SUCCESS}),es(!1)}catch(e){console.log("handleGenerateOutline error",e),Q(!1),et("error")}},eb=async()=>{ep(!0),eC(!1)};return((0,a.useImperativeHandle)(t,()=>({handleRegenerateOutline:eb})),!(0,z.N0)()&&ec)?null:(0,n.jsxs)("div",{className:"flex flex-col h-full",children:["init"===K?r?(0,n.jsx)("div",{className:"flex justify-center items-center h-[70dvh] md:h-[calc(80dvh-1rem)]",children:(0,n.jsx)(y.c,{size:"sm",label:W("ppt.loading_template")})}):"error"!==l||(null==o?void 0:o.length)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex p-2 gap-2 justify-between",children:(0,n.jsx)("div",{className:"flex gap-2 items-center",children:(0,n.jsx)(i.A,{className:"rounded-full px-3 py-0 gap-1 border text-gray-500",size:"sm",variant:"bordered",startContent:(0,n.jsx)(j.Z,{size:12}),endContent:d?(0,n.jsx)(k.Z,{size:12}):(0,n.jsx)(_.Z,{size:12}),onPress:()=>{c(!d)},children:W("ppt.all_filter")})})}),d?(0,n.jsx)(E,{templateColourOptions:m,templateStyleOptions:u,setTemplateColourId:f,setTemplateStyleId:p,templateColourId:b,templateStyleId:h}):null,"error"===w?(0,n.jsx)(S.Z,{type:"error",handleOpen:s}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:(0,N.Z)("overflow-y-auto","relative","felo--scrollbar","p-2 pt-0"),children:[(null==F?void 0:F.length)?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(Z,{templateList:F,templateId:T,setTemplateId:D})}):A?null:(0,n.jsx)("div",{ref:q,className:"hidden",children:(0,n.jsx)(S.Z,{handleOpen:s,type:"empty"})}),(A||L)&&(0,n.jsx)("div",{ref:M,className:(0,N.Z)("flex justify-center items-center w-full ",V<=1?"h-[calc(70dvh-300px)] md:h-[calc(80dvh-220px)]]":"my-4"),children:(0,n.jsx)(y.c,{size:"sm",label:W("ppt.loading_template")})})]}),(null==F?void 0:F.length)?(0,n.jsx)("div",{className:"flex justify-center p-2 w-full",children:(0,n.jsx)(i.A,{className:"rounded-full gap-1 border-1 dark:border-0 w-full",color:"primary",size:"md",startContent:(0,n.jsx)(H.$U,{className:"w-[24px]"}),isDisabled:!T,onPress:()=>{console.log("\uD83D\uDE80 ~ handleGenerateOutline"),eC()},children:W("ppt.generate_ppt_btn")})}):null]})]}):(0,n.jsx)(S.Z,{type:"error",handleOpen:s}):null,"generate"===K?(0,n.jsx)(O,{handleRegenerateOutline:eb}):null,(0,n.jsxs)("div",{className:(0,N.Z)("relative flex flex-col h-full","preview"===K?"":"hidden"),children:[(0,n.jsxs)("div",{className:(0,N.Z)("flex flex-1 justify-center items-center absolue z-[-1] inset-0",eo?"":"hidden"),children:[(0,n.jsx)(y.c,{size:"sm",className:"mr-2"}),W("ppt.generate_outline_loading")]}),(0,n.jsx)("div",{className:(0,N.Z)("flex flex-wrap justify-between","mx-[-24px]",eo?"opacity-0":"opacity-100"),children:(0,n.jsx)("div",{className:(0,N.Z)("flex flex-col flex-grow h-full w-full justify-center m-[20px] mt-0 overflow-hidden rounded-lg felo--pdfviewer felo--mobile__pdfviewer"),children:(null==ei?void 0:ei.pdf_url)&&"error"!==K?(0,n.jsx)(I.Z,{fileUrl:(null==ei?void 0:ei.ppt_url)||"",shortId:X,isOpenRetry:G,handleGeneratePpt:eb,handleDownload:J,pdfFileUrl:null==ei?void 0:ei.pdf_url}):eo||!ei?null:(0,n.jsx)(S.Z,{type:"error",handleOpen:eb})})}),eh?null:(0,n.jsx)("div",{className:(0,N.Z)("absolute left-0 right-0 top-0 z-40","h-[calc(80dvh-80px)] mt-2","bg-contain bg-center bg-no-repeat","opacity-50 pointer-events-none"),style:{backgroundImage:"url(".concat((null==ei?void 0:ei.cover_url)?null==ei?void 0:ei.cover_url:"",")")}})]})]})});V.displayName="MobileView";var q=r(44342),G=r(60635),J=r(41223),X=r(99178),W=r.n(X),$=e=>{let{shortId:t}=e,r=(0,g.useTranslations)(),y=(0,g.useLocale)(),{isShowPptModal:j,setIsShowPptModal:k,isRegenerate:_,setIsRegenerate:S,isMyThread:F,setShowPpt:T}=(0,x.Z)(),E=(0,U.Z)(),{generatePptProgress:Z,pptStatus:I,pptModalType:D,templateStatus:A,setTemplateStatus:L,updatePptGenerateStatusList:M,setPptStatus:O,setGeneratePptProgress:P,isHiddenModal:B,pptDetail:R}=(0,v.Z)(),{isApp:X}=(0,q.b)(),{isOpen:$,onOpen:K,onClose:Y}=(0,l.q)(),Q=(0,a.useRef)(null),ee=(0,a.useRef)(null),et=(0,a.useRef)(null),er=(0,a.useRef)(null),en=(0,a.useRef)(null),[ea,el]=(0,a.useState)(!0),[ei,eo]=(0,a.useState)(!0),[es,ed]=(0,a.useState)([]),[ec,eu]=(0,a.useState)([]),[eh,ep]=(0,a.useState)([]),[em,eg]=(0,a.useState)([]),[ex,ef]=(0,a.useState)("init"),[ev,eC]=(0,a.useState)(),[eb,ew]=(0,a.useState)(""),[ey,ej]=(0,a.useState)(""),[ek,e_]=(0,a.useState)(""),[eN,eS]=(0,a.useState)(1),[eF,eT]=(0,a.useState)(!1),[eE,eZ]=(0,a.useState)({templateColourId:"",templateStyleId:"",templateSceneId:""}),[eI,eD]=(0,a.useState)(!0),[eA,eL]=(0,a.useState)(!1),eM=()=>{Y(),console.log("modal handleClose"),T("0"),S(!1),M();let e=t?"".concat(location.origin,"/search/").concat(t):location.href;history.replaceState({},"",e),k(!1)},eO=(0,a.useCallback)(async()=>{var e,r;el(!0),eD(!0),eo(!1),L("init");let n=await (0,f.RM)({thread_id:t,scene_id:ek,style_id:ey,colour_id:eb,page:String(eN),page_size:"24"});if((null==n?void 0:n.status)!==200){L("error"),eD(!1);return}let a=(null==n?void 0:null===(e=n.data)||void 0===e?void 0:e.list)||[],l=(null==n?void 0:null===(r=n.data)||void 0===r?void 0:r.pagination)||{},i=Math.ceil((null==l?void 0:l.total)/(null==l?void 0:l.page_size)),o=l.current_page<i;ed(e=>[...e,...a]),el(o),eS(e=>e+1),eD(!1)},[ek,eN,eb,ey,eI]),eP=async e=>{let{type:r}=e;if(K(),!(null==em?void 0:em.length)){let e=await (0,f.ax)({thread_id:t});if(!e){eo(!1),ef("error");return}eg((null==e?void 0:e.suit_scene)||[]),ep((null==e?void 0:e.suit_style)||[]),eu((null==e?void 0:e.colour)||[])}eo(!1),await eO()},eB=e=>{if((0,b.fk)(F?w.U.AUTHOR_DOWNLOAD_PPT:w.U.DOWNLOAD_PPT,{value:t},!0),X){e.preventDefault(),e.stopPropagation(),(0,G.vE)({url:(null==R?void 0:R.ppt_url)||""});return}if((0,z.s)()&&!(0,J.G6)()){e.preventDefault(),e.stopPropagation(),E.default(r("ppt.download_ppt_tip")),W()(()=>{window.open((null==R?void 0:R.ppt_url)||"","_blank")},3e3);return}},ez=()=>{(0,b.fk)(w.U.REGENERATE_PPT,{value:"generate"},!0),S(!0),O("init"),P(0),eP({})},eR=async()=>{console.log("ppt mobile modal init"),j&&(K(),"generate"===D&&await eP({}))};return(0,a.useEffect)(()=>{eR()},[j]),(0,a.useEffect)(()=>{!eI&&et.current&&setTimeout(()=>{var e;null===(e=et.current)||void 0===e||e.classList.remove("hidden")},1e3)},[eI]),(0,a.useEffect)(()=>{en.current&&en.current.disconnect();let{expiryTime:e,pptUrl:r}=(0,C.OW)({threadId:t}),n=(0,C.XQ)({expiryTime:e});if(!r||n||_)return((null==eE?void 0:eE.templateColourId)!==eb||(null==eE?void 0:eE.templateStyleId)!==ey)&&(ed([]),eS(1),eo(!1),eD(!0),el(!0)),"error"===A&&(ed([]),eD(!0),L("init")),en.current=new IntersectionObserver(e=>{e[0].isIntersecting&&setTimeout(async()=>{await eO(),eZ({templateColourId:eb,templateStyleId:ey,templateSceneId:ek})},300)}),er.current&&en.current.observe(er.current),()=>{en.current&&en.current.disconnect()}},[er.current,ek,eN,eb,ey]),(0,a.useEffect)(()=>{B&&(0,C.F_)()},[B]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(s.R,{ref:Q,isOpen:$,isDismissable:!1,scrollBehavior:"inside",backdrop:"opaque",classNames:{header:"block p-0 py-1 bg-[#F5F7F9] rounded-t-xl dark:bg-gray-800",base:(0,N.Z)("min-w-[80dvw] h-[calc(80dvh+60px)] max-h-[calc(80dvh+60px)] mb-0 mx-2"),footer:"py-0",wrapper:(0,N.Z)(B?"!opacity-0 !pointer-events-none !hidden":""),backdrop:(0,N.Z)(B?"!opacity-0 !pointer-events-none !hidden":"")},closeButton:(0,n.jsx)(n.Fragment,{}),children:(0,n.jsx)(d.A,{children:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c.k,{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center py-0 px-1",children:[(0,n.jsxs)("div",{className:"flex justify-start items-center w-full pl-4 text-sm font-bold ",children:["init"===I?r("ppt.select_template"):"generate"===I?Z>=75?r("ppt.generating_ppt"):r("ppt.generate_ppt"):"preview"===I?r("ppt.download_ppt"):r("ppt.select_template"),"preview"===I&&(F||X)&&["en","ja","ko","zh-hant"].includes(null==y?void 0:y.toLocaleLowerCase())&&(0,n.jsx)(i.A,{color:"primary",variant:"bordered",className:"rounded-full ml-2 border-1 border-inherit px-3 py-0 h-7 font-normal dark:border-gray-600",size:"sm",onPress:ez,startContent:(0,n.jsx)(H.$U,{className:"w-[24px]"}),children:r("ppt.regenerate")})]}),(0,n.jsx)(i.A,{className:"rounded-full text-[#98A2B3]",isIconOnly:!0,variant:"light",onPress:eM,children:Z>0&&Z<100?(0,n.jsx)(p.Z,{size:18}):(0,n.jsx)(m.Z,{size:18})})]}),Z>0&&Z<100&&(0,n.jsx)("div",{className:"w-full flex justify-center items-center",children:(0,n.jsx)(o.W,{size:"sm",radius:"none","aria-label":"Loading...",value:Z})})]}),(0,n.jsx)(u.I,{className:"relative h-[72dvh] min-h-[72dvh] p-0 overflow-hidden",children:(0,n.jsx)(V,{ref:ee,templateLoading:ei,templateOptionsStatus:ex,templateSceneOptions:em,handleOpen:eP,showMoreTemplateOptions:eF,setShowMoreTemplateOptions:eT,templateStyleOptions:eh,templateStyleId:ey,setTemplateStyleId:ej,templateColourOptions:ec,setTemplateColourId:ew,templateColourId:eb,templateStatus:A,templateList:es,templateId:null!=ev?ev:0,setTemplateId:eC,templateListLoading:eI,hasNextPage:ea,loaderMoreRef:er,currentPage:eN,templateEmptyRef:et,shortId:t,isOpenRetry:eA,handleDownload:eB})}),(0,n.jsx)(h.R,{})]})})})})}},22313:function(e,t,r){"use strict";r.d(t,{Z:function(){return E}});var n=r(52676),a=r(9455),l=r(26595),i=r(64657),o=r(5687),s=r(55383),d=r(93650),c=r(49983),u=r(60904),h=r(75271),p=r(4814),m=r(18881),g=r(31063),x=r(60161),f=r(45360),v=r(30674),C=r(7717),b=r(94572),w=r(78467),y=r(65819),j=r(82180),k=r(65105),_=r(50403),N=r(39109),S=r(50802),F=e=>{let{shortId:t,businessType:r}=e,l=(0,C.useTranslations)(),s=(0,C.useLocale)(),{isOpen:c,onOpen:u,onOpenChange:F}=(0,a.q)(),{isMyThread:T,isPdfLoaded:E,setIsRegenerateLoading:Z,setIsShowPptModal:I,setIsPptGenerated:D,uiModalType:A,setSelectedOptionValue:L,setSelectedOptionKey:M,setSelectedOption:O,setPptBtnKey:P,setPptDetailCache:B,setCoverUrl:z,generateType:R,isGeneratedSuccess:H,setIsGeneratedSuccess:U,agentOutline:V,previewPPTData:q,setPreviewPPTData:G,pptGenerateStep:J,pptLanguage:X}=(0,m.Z)(),{setThreadPptBtnEntrance:W}=(0,S.Z)(),$=(0,N.Z)();(0,y.ZP)(e=>e.isLogin);let K=(0,y.ZP)(e=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.language}),Y=(0,h.useRef)(null),[Q,ee]=(0,h.useState)(!1),[et,er]=(0,h.useState)(!1),[en,ea]=(0,h.useState)(),[el,ei]=(0,h.useState)(!1),eo=async()=>{let e=t||(0,b.qR)()||"",n=await (0,f.OQ)({thread_id:e,businessType:r});if(!n)return ee(!0),er(!0),{cacheStatus:null,pptId:0};let{ppt_url:a,pdf_url:l,status:i,id:o}=n;return(G({...q,...n}),!T&&b.Wx.includes(i))?(ea("wait"),u(),{cacheStatus:i,pptId:o}):2===i?{pptUrl:a,pdfUrl:l,pptId:o,cacheStatus:i}:{cacheStatus:i,pptId:o}},es=async()=>{Z(!0),await eo(),Z(!1),ei(!1)},ed=async e=>{var n,a,l;let i,{type:o,answers:d,pptId:c}=e;er(!1),ee(!1);let u=(0,b.uN)(s),h=(0,b.BN)({lang:K||"",locale:s});console.log("\uD83D\uDE80 ~ initAipptIframe ~ lang:",u,h);let p=null===(n=y.ZP.getState().userInfo.user_org_member)||void 0===n?void 0:n.org.org_id;p&&(i=await (0,f.a1)(p));try{let e={fc_plate:[2024,2014,2012,2013],download_mode:2,language_list:[u],output_language:h,custom_generate:{content:"",type:11}},n={list:["generate","editor"],editor:{id:0},generate:{step:1,subClassId:i}};if(("regenerate"===o||"generate"===o)&&(e={...e,custom_generate:{content:d||"",type:11}}),"agent"===o&&(e={...e,output_language:1===J?X:h,custom_generate:{content:d||"",type:1===J?11:7,step:J||1}}),"edit"===o){if(!c){ee(!0),er(!0);return}delete e.custom_generate,n={...n,editor:{id:c}}}if(!Y.current){ee(!0),er(!0);return}let s=await (0,f.TH)({thread_id:t,businessType:r});if(!s){ee(!0),er(!0);return}await (null===(l=window)||void 0===l?void 0:null===(a=l.AipptIframe)||void 0===a?void 0:a.show({appkey:"66d02c9660652",channel:"",code:s,editorModel:!0,container:Y.current,options:e,routerOptions:n,async onMessage(e,n){switch(console.log(e,n),e){case"START":(null==n?void 0:n.status)&&ee(!0),await (0,b.gw)(1e3);break;case"AI_SMART_COMPLETE":(null==n?void 0:n.markdown)&&(0,f.uO)({thread_id:t,outline:null==n?void 0:n.markdown,businessType:r});break;case"OUTLINE_DOWNLOAD":break;case"GENERATE_PPT_SUCCESS":{D(!0),L("ppt.edit_ppt_btn"),M("edit"),P("edit"),O(new Set(["edit"]));let{id:e}=n;if(e){let n=await (0,f.Cl)({thread_id:t,id:e,businessType:r});if(!(null==n?void 0:n.data)||H)return;U(!0)}break}case"PPT_DOWNLOAD":{(0,g.fk)(T?x.U.AUTHOR_DOWNLOAD_PPT:x.U.DOWNLOAD_PPT,{value:t},!0);let{id:e}=n;e&&(0,f.X3)({thread_id:t,id:e,businessType:r});break}case"TOKEN_EXPIRE":ep();break;case"CHARGING":(0,f.f0)({threadId:t,businessType:r}).then(e=>{e&&k.ZP.getState().refreshPointsInfo()})}}}))}catch(e){console.log("\uD83D\uDE80 ~ initAipptIframe ~ e:",e),ee(!0),er(!0)}},ec=async()=>{try{console.log("generateType",R);let n="";if("answer"===R&&r===b.LB.THREAD){let e=await (0,f.aL)({thread_id:t});n=null==e?void 0:e.map(e=>{var t,r;return(b.OA.includes(null==e?void 0:e.category)?null==e?void 0:null===(r=e.recall_contexts)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.snippet:null==e?void 0:e.answer)||""}).join("")}if("file"===R){let e=await (0,f.LK)({threadId:t});if((null==e?void 0:e.status)==="SUCCESS"&&(n=(null==e?void 0:e.summary)||""),(null==e?void 0:e.status)==="LENGTH_OVER_SIZE"){ee(!0),I(!1),$.default(l("searchAddition.word_limit_exceeded_tip",{word:"200ä¸‡"}));return}if((null==e?void 0:e.status)===500){ee(!0),er(!0);return}}if(r===b.LB.MESSAGE){n=V,await ed({type:"agent",answers:n});return}if(r===b.LB.NOTE){var e;let r=await (0,_.kL)(t);console.log("\uD83D\uDE80 ~ generatePpt ~ notes:",r),n=null==r?void 0:null===(e=r.data)||void 0===e?void 0:e.content}if(!(null==n?void 0:n.length)){ee(!0),er(!0);return}await ed({type:"generate",answers:n})}catch(e){ee(!0),er(!0)}},eu=async e=>{let{pptId:t}=e;await ed({type:"edit",pptId:t})},eh=async()=>{let e="";if("answer"===R&&r===b.LB.THREAD){let r=await (0,f.aL)({thread_id:t});e=null==r?void 0:r.map(e=>{var t,r;return(b.OA.includes(null==e?void 0:e.category)?null==e?void 0:null===(r=e.recall_contexts)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.snippet:null==e?void 0:e.answer)||""}).join("")}if("file"===R){let r=await (0,f.LK)({threadId:t});if((null==r?void 0:r.status)==="SUCCESS"&&(e=(null==r?void 0:r.summary)||""),(null==r?void 0:r.status)==="LENGTH_OVER_SIZE"){ee(!0),I(!1),$.default(l("searchAddition.word_limit_exceeded_tip",{words:l("searchAddition.max_words")}));return}if((null==r?void 0:r.status)===500){ee(!0),er(!0);return}}if(r===b.LB.MESSAGE){e=V,await ed({type:"agent",answers:e});return}if(r===b.LB.NOTE){var n;let r=await (0,_.kL)(t);e=null==r?void 0:null===(n=r.data)||void 0===n?void 0:n.content}if(!(null==e?void 0:e.length)){ee(!0),er(!0);return}await ed({type:"regenerate",answers:e})},ep=async()=>{em()},em=async()=>{switch(er(!1),ee(!1),A){case"regenerate":eh();break;case"generate":ec();break;case"edit":{let{cacheStatus:e,pptId:t=0}=await eo();if(!e||!t){$.default(l("ppt.generating_ppt_tip"));return}(T||r===b.LB.NOTE||r===b.LB.MESSAGE)&&t&&(ea("editPpt"),eu({pptId:t}));break}case"preview":{let{cacheStatus:e}=await eo();if(!e||b.Wx.includes(e)){$.default(l("ppt.generating_ppt_tip"));return}2===e&&ea("showPdf")}}};return((0,h.useEffect)(()=>{em()},[A,T]),"showPdf"===en)?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:(0,p.Z)("flex flex-wrap w-full justify-between items-center relative","h-[calc(90dvh)] w-full overflow-hidden rounded-lg","felo--pdfviewer"),children:[(0,n.jsx)(j.Z,{fileUrl:(null==q?void 0:q.ppt_url)||"",shortId:t,isOpenRetry:el,handleGeneratePpt:es,handleDownload:e=>{(0,g.fk)(T?x.U.AUTHOR_DOWNLOAD_PPT:x.U.DOWNLOAD_PPT,{value:t},!0);let{expiryTime:r}=(0,b.OW)({threadId:t});if((0,b.XQ)({expiryTime:r})){e.preventDefault(),e.stopPropagation(),ei(!0);return}},pdfFileUrl:(null==q?void 0:q.pdf_url)||"",businessType:r}),E?null:(0,n.jsx)("div",{className:(0,p.Z)("absolute left-0 right-0 top-0 z-40","h-[calc(90dvh)] mt-2","bg-contain bg-center bg-no-repeat","opacity-50 pointer-events-none"),style:{backgroundImage:"url(".concat((null==q?void 0:q.cover_url)?null==q?void 0:q.cover_url:"",")")}})]})}):"wait"===en?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(i.R,{isOpen:c,onOpenChange:F,onClose:()=>{I(!1)},backdrop:"opaque",placement:"center",classNames:{base:"text-white bg-gray-800"},children:(0,n.jsx)(o.A,{children:()=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(d.I,{children:(0,n.jsx)("p",{children:l("ppt.generating_ppt_tip")})})})})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,p.Z)("h-[calc(90dvh)] justify-center items-center w-full",Q?"hidden":"flex"),children:(0,n.jsx)(v.c,{})}),(0,n.jsx)("div",{className:(0,p.Z)("h-[calc(90dvh)] w-full overflow-hidden rounded-lg ",Q&&!et?"block":"hidden"),ref:Y}),(0,n.jsx)("div",{className:(0,p.Z)("h-[calc(90dvh)] justify-center items-center w-full overflow-hidden rounded-lg ",et?"flex":"hidden"),children:(0,n.jsx)(w.Z,{handleOpen:ep})})]})},T=r(44509),E=e=>{let{shortId:t,businessType:r}=e,{isOpen:p,onOpen:g}=(0,a.q)(),{isShowPptModal:x,setIsShowPptModal:v,setIsShowPptBtnAnimate:C,setShowPpt:w,pptDetailCahce:y,uiModalType:j,previewPPTData:k,setIsGeneratedSuccess:_}=(0,m.Z)(),N=(0,h.useRef)(null),S=()=>{var e,n,a;if(null===(a=window)||void 0===a||null===(n=a.AipptIframe)||void 0===n||null===(e=n.deleteIframe)||void 0===e||e.call(n),w("0"),(null==N?void 0:N.current)&&(0,T.Y)(N.current,"pptGenerate",()=>{v(!1),null==C||C(!0)}),"edit"===j&&(null==y?void 0:y.id)&&((0,f.X3)({thread_id:t,id:String(null==y?void 0:y.id),businessType:r}),r!==b.LB.MESSAGE)){let e=t?"".concat(location.origin,"/").concat(r===b.LB.NOTE?"docs":"search","/").concat(t):location.href;history.replaceState({},"",e)}let l=m.Z.getState().previewPPTData;"edit"===j&&(null==l?void 0:l.id)&&((0,f.X3)({thread_id:t,id:(null==l?void 0:l.id)||"",businessType:r}),_(!0))},E=async()=>{g()},Z=async()=>{x&&(g(),await E())};return(0,h.useEffect)(()=>{Z()},[x]),(0,n.jsx)(i.R,{ref:N,isOpen:p,isDismissable:!1,scrollBehavior:"inside",backdrop:"opaque",classNames:{wrapper:"z-[100001]",header:"relative p-0 m-0 h-[1px]",base:"min-w-[90dvw] h-[calc(90dvh)] max-h-[calc(90dvh)]",footer:"py-0"},closeButton:(0,n.jsx)(n.Fragment,{}),children:(0,n.jsx)(o.A,{children:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.k,{children:(0,n.jsx)(l.A,{className:"rounded-full absolute top-[-36px] right-0 z-50 md:top-[-28px] md:right-[-28px]",isIconOnly:!0,radius:"full",size:"sm",onPress:S,children:(0,n.jsx)(u.Z,{})})}),(0,n.jsx)(d.I,{className:"relative h-[90dvh] min-h-[90dvh] md:h-[90dvh] p-0 justify-between overflow-hidden",children:(0,n.jsx)(F,{shortId:t,businessType:r})}),(0,n.jsx)(c.R,{})]})})})}},82180:function(e,t,r){"use strict";var n=r(52676),a=r(26595),l=r(93071),i=r(29197),o=r(9585),s=r(91165),d=r(416),c=r(15133),u=r(7717);r(75271);var h=r(4814),p=r(70017),m=r(35279),g=r(18881),x=r(31063),f=r(60161),v=r(77844),C=r(44342),b=r(19527),w=r(94572),y=r(65819);t.Z=e=>{let{fileUrl:t,shortId:r,isOpenRetry:j,handleGeneratePpt:k,handleDownload:_,pdfFileUrl:N,businessType:S}=e,{isMobile:F}=(0,C.b)(),{isRegenerateLoading:T,isMyThread:E}=(0,g.Z)(),Z=(0,u.useTranslations)();(0,y.gQ)();let I=(0,p.V)();return(0,n.jsxs)(n.Fragment,{children:[N?(0,n.jsx)(m.Z,{fileUrl:t,pdfFileUrl:N,fileType:"PDF",fileName:"PPT"}):(0,n.jsx)("iframe",{src:"https://view.officeapps.live.com/op/view.aspx?src=".concat(encodeURIComponent(t)),loading:"eager",className:(0,h.Z)("w-full  mt-[-100px] ","h-[calc(80vh+20px)]","border-1 border-gray-200 rounded-lg overflow-hidden dark:border-gray-600"),title:"PPT"}),(0,n.jsx)("div",{className:(0,h.Z)("flex  w-full items-center px-3 py-2 absolute bottom-0 left-0 right-0 bg-white min-h-10 dark:bg-gray-800 rounded-b-lg",F?"justify-center":"justify-end"),children:j?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{className:"mr-2 text-sm inline-flex items-center text-yellow-400",children:[(0,n.jsx)(i.Z,{size:20,className:"mr-1"}),Z("ppt.regenerate_tip")]}),(0,n.jsx)(a.A,{color:"primary",size:F?"md":"sm",startContent:T?null:(0,n.jsx)(o.Z,{size:20}),onPress:()=>{k("getUrl"),(0,x.fk)(f.U.TIMEOUT_REGENERATE_PPT,{value:r},!0)},className:"shadow rounded-full",isLoading:T,children:Z("ppt.regenerate")})]}):(0,n.jsxs)(n.Fragment,{children:[S!==w.LB.NOTE?(0,n.jsx)(a.A,{size:"md",color:"primary",startContent:I.copied?(0,n.jsx)(s.Z,{size:20}):(0,n.jsx)(d.Z,{size:20}),className:(0,h.Z)("shadow rounded-full mr-3",F?"w-full":""),onPress:()=>{let e=v.Z.getState().current,t=new URL("".concat(location.origin,"/search/").concat(r));t.searchParams.append("showppt","1"),e&&t.searchParams.append("invite",e),I.copy(t.toString()),b.Z.getState().setShareData({type:"ppt",link:t.toString()}),b.Z.getState().setShowThreadModel(!0),(0,x.fk)(E?f.U.AUTHOR_SHARE_PPT:f.U.SHARE_PPT,{value:r},!0)},children:Z("ppt.share_url")}):null,(0,n.jsx)(a.A,{size:"md",color:"primary",as:l.O,startContent:(0,n.jsx)(c.Z,{size:20}),href:t,target:"_blank",onClick:_,download:!0,className:(0,h.Z)("shadow rounded-full",F?"w-full":""),children:Z("ppt.download_ppt_btn")})]})})]})}},78467:function(e,t,r){"use strict";var n=r(52676),a=r(26595),l=r(29197),i=r(438),o=r(7717);t.Z=e=>{let{message:t,handleOpen:r,type:s}=e,d=(0,o.useTranslations)();return(0,n.jsx)("div",{className:"flex justify-center items-center h-[calc(77dvh-270px)] felo--ppt__result",children:(0,n.jsxs)("div",{className:"flex flex-wrap",children:[(0,n.jsx)("div",{className:"w-full flex justify-center items-center my-2",children:(0,n.jsx)(l.Z,{size:30})}),(0,n.jsx)("div",{className:"w-full flex justify-center items-center text-base",children:d("empty"===s?"ppt.empty_ppt_tip":"ppt.failed_generate")}),t&&(0,n.jsx)("div",{className:"w-full flex justify-center items-center text-sm mt-2",children:(0,n.jsx)("p",{children:t})}),"empty"===s?null:(0,n.jsx)("div",{className:"w-full my-10 flex justify-center items-center",children:(0,n.jsx)(a.A,{size:"sm",radius:"full",color:"primary",startContent:(0,n.jsx)(i.Z,{size:14}),onPress:()=>{r({type:"retry"})},children:d("ppt.retry_generate")})})]})})}},40341:function(e,t,r){"use strict";r.d(t,{$E:function(){return a},IQ:function(){return l}});var n=r(45360);r(94572);let a=async e=>{let{threadId:t,businessType:r}=e,a=await (0,n.gi)({threadId:t,businessType:r});return console.log("getImportJob",a),a},l=async e=>{let{threadId:t,jobId:r,businessType:a}=e;return await (0,n.B0)({threadId:t,jobId:r,businessType:a})}},64787:function(e,t,r){"use strict";r.d(t,{Es:function(){return i},Iv:function(){return l},TW:function(){return o},qf:function(){return a}});var n=r(45360);r(94572);let a=async e=>{let{threadId:t,businessType:r}=e;return new Promise(async(e,a)=>{try{let l=await (0,n.N)({threadId:t,businessType:r});if(console.log("\uD83D\uDE80 ~ returnnewPromise<boolean> ~ redirectUrl:",l),!l)return a(null),null;let o=Math.max(0,(window.innerWidth-800)/2),s=Math.max(0,(window.innerHeight-800)/2),d=window.open(l,"",["popup","width=".concat(800),"height=".concat(800),"left=".concat(o),"top=".concat(s)].join(","));window.addEventListener("message",t=>{"authorization_success"===t.data?(e(!0),null==d||d.close()):"authorization_error"===t.data&&(a(null),null==d||d.close())});let c=async()=>{try{let n=await i({threadId:t,businessType:r});e(n.status)}catch(e){a(null)}},u=setInterval(()=>{(null==d?void 0:d.closed)&&(clearInterval(u),c())},1e3)}catch(e){console.error("Authorization failed",e),a(null)}})},l=async e=>{let{threadId:t,businessType:r}=e;return await (0,n.Wd)({threadId:t,businessType:r})},i=async e=>{let{threadId:t,businessType:r}=e;return await (0,n.sR)({threadId:t,businessType:r})},o=async()=>{let e=localStorage.getItem("CANVA_CALLBACK_REDIRECT_URL");return new Promise(t=>{t(e||"")})}},40176:function(e,t,r){"use strict";r.d(t,{O:function(){return l}});var n=r(52676),a=r(46571);function l(e){let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md",t),...r})}},13003:function(e,t,r){"use strict";r.d(t,{Z:function(){return L}});var n=r(52676),a=r(75271),l=r(75154),i=r(90488),o=r(57606),s=r(4389),d=r(4590),c=r(31022),u=r(27585),h=r(49992),p=r(7717),m=r(27571),g=r(80538),x=r(26595),f=r(46024),v=r(49905),C=r(3295),b=r(36551),w=r(64412),y=r(23083),j=r(30674),k=a.memo(e=>{var t,r,k,_,N,S,F,T,E,Z,I,D,A,L,M,O,P,B;let{source:z,precedingText:R,rid:H}=e,U=(0,p.useTranslations)(),{snippet:V,url:q,link:G,title:J,engine_name:X,source_type:W}=z,$=q||G||"",K=(0,u.lx)($).hostname,Y=(0,l.a)(V),[Q,ee]=(0,a.useState)(!1),{sourceHighlightList:et,sourceOriginalList:er,sourceAllMatchList:en,sourceTranslatedList:ea}=(0,o.Z)(),[el,ei]=(0,a.useState)(C.Z.getState().autoTranslateSources),[eo,es]=(0,a.useState)({translatedTitle:"",translatedSnippet:""}),ed=(0,c.Z)(e=>e.extensionEnable),ec=(0,c.Z)(e=>e.legacyExtensionEnable),eu=(0,y.Z)(e=>e.threads),[eh,ep]=(0,a.useState)([]),[em,eg]=(0,a.useState)(!1),[ex,ef]=(0,a.useState)(null),ev=(0,a.useRef)(null),[eC,eb]=(0,a.useState)(!1),[ew,ey]=(0,a.useState)((0,s.ND)(z.snippet)),[ej,ek]=(0,a.useState)(null),e_=(0,a.useRef)(null),[eN,eS]=(0,a.useState)("");(0,a.useEffect)(()=>{if(R){let e="".concat(H,"-").concat($,"-").concat(R),t=et.find(t=>t.id===e);t?eS(em?"":t.translatedHighlightContent):eS("")}else{let e=z.link,t=et.find(t=>t.link===e);t?eS(em?"":t.translatedHighlightContent):eS("")}},[$,el,R,z.link,et,em,H]),(0,a.useEffect)(()=>{let e=(0,v.w0)();ee(!!(0,v.SG)(J,V,e))},[z]);let eF=async()=>{try{let e=(0,v.w0)(),t=z.url||z.link||"",r="".concat(H,"-").concat(t,"-").concat(e),n=er.findIndex(e=>e.id===r);if(-1!==n)return;let a=(0,s.ND)(z.snippet);await (0,v.R6)(z.title,a,H||"",z.link||"",e,r)}catch(e){console.warn("error:",e)}};(0,a.useEffect)(()=>{Q&&el&&eF()},[el]);let eT=(0,a.useCallback)(()=>{try{let e=(0,v.w0)(),t="".concat(H,"-").concat($,"-").concat(e),r=er.findIndex(e=>e.id===t);-1!==r?eZ(r,e):(ei(!1),eI(e),eE())}catch(e){console.warn("error:",e)}},[H,er,$,et,ea]),eE=()=>{let e=(0,v.w0)(),t="".concat($,"-").concat(e),r=ea.findIndex(e=>e.id===t);-1!==r&&(es({translatedTitle:ea[r].translatedTitle,translatedSnippet:ea[r].translatedSnippet}),ei(C.Z.getState().autoTranslateSources))},eZ=(e,t)=>{let r={translatedTitle:er[e].translatedTitle,translatedSnippet:er[e].translated.join("\n")};if(eI(t),!R){let t=et.filter(e=>e.rid===H&&e.link===G),a=[];for(var n=0;n<t.length;n++){let r=er[e].original.findIndex(e=>e===t[n].originalTargetChunk);if(-1!==r){let l=t[n];l.translatedTargetChunk=er[e].translated[r],a.push(l)}}let l=(0,s.KB)(er[e].translated,a,!0);r.translatedSnippet=l,es(r);return}let a="".concat(H,"-").concat($,"-").concat(R),l=et.find(e=>e.id===a);if(!l){es(r);return}let i=er[e].original.findIndex(e=>e===l.originalTargetChunk);es({translatedTitle:er[e].translatedTitle,translatedSnippet:-1!==i?(0,s.LA)(er[e].translated[i],er[e].translated):r.translatedSnippet})},eI=e=>{if(R){let e="".concat(H,"-").concat($,"-").concat(R),t=et.find(t=>t.id===e);t?ey(t.originalHighlightContent):ey((0,s.ND)(z.snippet))}else{let t=z.snippet,r=et.filter(e=>e.rid===H&&e.link===G);if(r.length>0){let e=en.findIndex(e=>e.rid===H&&e.link===G);ey((0,s.KB)(en[e].snippet.split("\n"),r,!1))}else ey((0,s.ND)(t,e))}},eD=()=>{if(e_.current){let e=e_.current.scrollHeight;ei(!el),setTimeout(()=>{if(e_.current){let t=e_.current.scrollHeight;t>e?ek(t):ej||ek(e)}},0)}};(0,a.useEffect)(()=>{("scholar"===z.engine_name||"scholar"===z.engine)&&eM()},[]),(0,a.useEffect)(()=>{eT()},[et,ea,er]);let eA=(0,n.jsxs)("p",{className:"text-sm text-[#8896AA] dark:text-[#B9BFCA]",children:[(0,n.jsx)("a",{className:"hover:underline hover:underline-offset-2",href:(null===(B=z.link)||void 0===B?void 0:B.includes(".file"))?void 0:z.link,target:"_blank",children:K}),Y&&(0,n.jsxs)("span",{className:"inline-block text-sm text-bold ml-2",children:["[",Y,"]"]})]}),eL=ed?(0,d.m1)(z.link):ec?(0,d.m1)(z.link,!0):z.link;async function eM(){try{let e=await (0,m.q)({sources:[z]});ep(e)}catch(e){console.error("Error fetching articles:",e)}}let{other_info:eO}=z;eO||(eO=z);let eP=eO,eB=(null===(t=eh[0])||void 0===t?void 0:t.articleData)||{},ez=(100*eP.relevance).toFixed(0),eR=()=>{eg(!em)},eH=em?eP:eB,eU="title"in eH&&eH.title?eH.title:J,eV="abstracts"in eH&&eH.abstracts?eH.abstracts:V;(0,a.useEffect)(()=>{ev.current&&eH.abstracts&&null===ex&&ef(ev.current.offsetHeight)},[ex,eH.abstracts]);let eq=U("scholar.translated_by"),eG="Glarity",eJ=eq.split(eG);return(0,a.useEffect)(()=>{if("scholar"!==z.engine_name&&"scholar"!==z.engine)return;let e=()=>{document.getElementById("abstractsId")},t=t=>{let r=document.getElementById("abstractsId");if(r||e(),!r){t.preventDefault();return}let{scrollTop:n,clientHeight:a,scrollHeight:l}=r;r.contains(t.target)?"wheel"===t.type?(t.deltaY<0&&n<=0||t.deltaY>0&&n+a>=l-1)&&t.preventDefault():t.stopPropagation():t.preventDefault()},r=["wheel","touchmove"];return eC&&r.forEach(e=>document.addEventListener(e,t,{passive:!1})),()=>{r.forEach(e=>document.removeEventListener(e,t))}},[eC,z.engine_name,z.engine]),(0,a.useEffect)(()=>{let e=e=>{if(!e_.current)return;let{scrollHeight:t,clientHeight:r}=e_.current;t>r&&e_.current.contains(document.elementFromPoint(e.clientX,e.clientY))&&(e.preventDefault(),e_.current.scrollTop+=e.deltaY)};return document.addEventListener("wheel",e,{passive:!1}),()=>{document.removeEventListener("wheel",e)}},[]),"scholar"===z.engine_name||"scholar"===z.engine?(0,n.jsx)("div",{"data-tooltip":"true",className:"flex max-w-[512px] gap-3 w-full rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-[#444549]",onMouseEnter:()=>{eb(!0)},onMouseLeave:()=>{eb(!1)},children:(0,n.jsxs)("section",{children:[(0,n.jsx)("span",{className:"text-sm font-semibold dark:text-[#F5F5F6]",children:eH.topic||eP.topic}),(0,n.jsx)("section",{className:"mt-1 leading-4 mb-4",children:(0,n.jsxs)("span",{className:"text-sm text-bold text-md",children:[(0,n.jsx)("div",{className:"text-[#0A1C38] font-semibold leading-5 dark:text-[#F5F5F6]",children:(0,n.jsx)("a",{className:"hover:underline hover:underline-offset-2 font-semibold",href:eP.source_url,target:"_blank",children:(0,n.jsx)("span",{children:eU})})}),(0,n.jsx)("div",{className:"text-[#7A90B1] dark:text-[#94A2B8] text-xs leading-4 my-2",children:(0,n.jsx)("span",{children:eH.source||eP.source})}),(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-3 border-b border-dashed border-gray-300 pb-3 dark:border-[#434955]",children:[(0,n.jsxs)(x.A,{radius:"sm",variant:"bordered",className:"bg-[#0080FF] text-[#ffffff] h-6 text-xs border-0 rounded-md px-2 py-1",onPress:()=>{window.open(G||eP.source_url,"_blank")},children:[(0,n.jsx)(g.Z,{size:16,className:"mr-0"}),"SEMANTIC_SCHOLAR"===eP.article_channel?"Semantic Scholar":U("scholar.view_via_publisher")]}),eP.source_url_pdf&&(0,n.jsx)(x.A,{radius:"sm",size:"sm",variant:"bordered",className:"text-[#0080FF] h-6 text-xs px-1 py-2 border rounded-md border-[#0080FF] font-medium",onPress:()=>{window.open(eP.source_url_pdf,"_blank")},children:"PDF"})]}),eV&&(0,n.jsx)("div",{id:"abstractsId",ref:ev,style:{height:ex?"".concat(ex,"px"):"auto"},className:"text-[#1D3C6D] dark:text-[#CECFD2] text-sm leading-5 box-border mb-3 max-h-[140px] overflow-y-auto custom-scrollbar",children:eN?null==eN?void 0:eN.split("\n").map((e,t)=>(0,n.jsx)("p",{className:"whitespace-pre-wrap mb-3 last:mb-0 leading-relaxed",dangerouslySetInnerHTML:{__html:e}},t)):(0,s.ND)(eV).split("\n").map((e,t)=>(0,n.jsx)("p",{className:"whitespace-pre-wrap mb-3 last:mb-0 leading-relaxed",dangerouslySetInnerHTML:{__html:e}},t))}),(0,n.jsxs)("div",{className:"flex text-xs leading-5 text-[#667085] gap-2 flex-wrap dark:text-[#94A2B8]",children:[(null==eP?void 0:eP.authors)&&(null==eP?void 0:null===(r=eP.authors)||void 0===r?void 0:r.length)!==0&&(0,n.jsx)("span",{className:"py-0.5 px-1.5 bg-[#EDF0F3] rounded whitespace-nowrap dark:bg-[#2D323C]",children:(0,h.$)((null==eH?void 0:eH.authors)||(null==eP?void 0:eP.authors))}),eP.publication_date&&(0,n.jsx)("span",{className:"py-0.5 px-1.5 bg-[#EDF0F3] rounded whitespace-nowrap dark:bg-[#2D323C]",children:eP.publication_date.slice(0,10)}),eP.type&&(0,n.jsx)("span",{className:"py-0.5 px-1.5 bg-[#EDF0F3] rounded whitespace-nowrap dark:bg-[#2D323C]",children:eH.type||eP.type}),void 0!==eP.cited_by_count&&(0,n.jsxs)("span",{className:"py-0.5 px-1.5 bg-[#EDF0F3] rounded whitespace-nowrap dark:bg-[#2D323C]",children:[eP.cited_by_count," ",U("scholar.citations")]})]})]})}),(0,n.jsx)("span",{className:"py-2 px-3 bg-[#E7F3FF] rounded-lg border border-[#A4D1FD] dark:border-[#6F9ECD] text-[#0080FF] text-xs font-medium dark:bg-[#2D323C]",children:"".concat(ez,"% ").concat(U("scholar.relevant"))}),(null==eP?void 0:null===(k=eP.lang)||void 0===k?void 0:k.toLowerCase())!==(null==eP?void 0:null===(_=eP.target_lang)||void 0===_?void 0:_.toLowerCase())&&(0,n.jsx)("div",{className:"text-xs text-gray-500 dark:text-[#BABDC5] text-center border-t border-dashed border-gray-300 border-[#ECEFF4]  mt-4 pt-2 dark:border-[#2F333B]",children:em?(0,n.jsx)("span",{onClick:eR,className:"text-[#006DD9] dark:text-[#2F95FB] cursor-pointer",children:U("scholar.show_translation")}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{children:[eJ[0]," ",(0,n.jsx)("span",{onClick:()=>{window.open("https://glarity.app/products/webpage-translation-with-chatgpt","_blank")},className:"text-[#006DD9] dark:text-[#2F95FB] cursor-pointer",children:eG}),eJ[1]," "]})," ",(0,n.jsx)("span",{onClick:eR,className:"text-[#006DD9] dark:text-[#2F95FB] cursor-pointer",children:U("scholar.view_original")})]})})]})}):(0,n.jsx)("section",{ref:e_,"data-tooltip":"true",style:{height:ej?"".concat(ej,"px"):"auto"},className:"flex flex-col w-[400px] border border-[#D3D9E4] dark:border-[#454E5D] p-0 overflow-x-hidden overflow-y-auto scrollbar ".concat(R?"max-h-[400px]":"max-h-[40vh]"),children:el?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("header",{className:"pt-4 mx-4 bg-white dark:bg-theme-bg-dark-300 sticky top-0 pb-1.5 border-b-1 border-dashed border-theme-border-100 dark:border-theme-border-dark-100",children:[(0,n.jsxs)("div",{className:"flex items-center pb-2 gap-1",children:[(0,n.jsx)("span",{className:"flex-none w-5 h-5",children:(null==eu?void 0:null===(I=eu[0])||void 0===I?void 0:I.category)===b.J5||(null==eu?void 0:null===(D=eu[0])||void 0===D?void 0:D.category)===b.Ys&&"image"===W?(0,n.jsx)(w.Z,{fileName:J,w:5,h:5}):(0,n.jsx)(i.Z,{src:$.includes(".file")?$:"https://www.google.com/s2/favicons?domain=".concat(K,"&sz=",20),title:J,classNames:{wrapper:"max-w-5 flex-shrink-0"},width:20,height:20})}),(null==eu?void 0:null===(A=eu[0])||void 0===A?void 0:A.category)===b.J5||(null==eu?void 0:null===(L=eu[0])||void 0===L?void 0:L.category)===b.Ys&&"image"===W?null:eA,Q&&(0,n.jsx)("div",{onClick:eD,className:"ml-auto p-1 hover:bg-gray-200 rounded-lg  cursor-pointer dark:hover:bg-gray-600  text-theme-blue-600 dark:text-[#0694FF] bg-[#F6F7F9] dark:bg-[#353B46]",children:(0,n.jsx)(f.vN,{})})]}),(null==eu?void 0:null===(M=eu[0])||void 0===M?void 0:M.category)===b.J5||(null==eu?void 0:null===(O=eu[0])||void 0===O?void 0:O.category)===b.Ys&&"image"===W?(0,n.jsx)("span",{className:"text-md font-medium leading-5",children:J}):(0,n.jsx)("a",{className:"text-[#30394A] pb-3 font-bold text-sm dark:text-white hover:underline hover:underline-offset-2",href:(null==eL?void 0:eL.includes(".file"))?void 0:eL,target:"_blank",children:(0,n.jsx)("span",{className:"text-md font-medium leading-5",children:eo.translatedTitle})})]}),eo.translatedSnippet?(0,n.jsx)("div",{className:"px-4 py-4  text-theme-font-800 dark:text-theme-font-dark-800",children:null===(P=eo.translatedSnippet)||void 0===P?void 0:P.split("\n").map((e,t)=>(0,n.jsx)("p",{className:"whitespace-pre-wrap break-words mb-3 last:mb-0 leading-relaxed",dangerouslySetInnerHTML:{__html:e}},t))}):(0,n.jsx)("div",{className:"flex justify-center items-center h-full text-sm",children:(0,n.jsx)(j.c,{label:U("topic.loading"),size:"sm"})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("header",{className:"pt-4 mx-4 bg-white dark:bg-theme-bg-dark-300 sticky top-0 pb-1.5 border-b-1 border-dashed border-theme-border-100 dark:border-theme-border-dark-100",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 pb-2",children:[(0,n.jsx)("span",{className:"flex-none w-5 h-5",children:(null==eu?void 0:null===(N=eu[0])||void 0===N?void 0:N.category)===b.J5||(null==eu?void 0:null===(S=eu[0])||void 0===S?void 0:S.category)===b.Ys&&"image"===W?(0,n.jsx)(w.Z,{fileName:J,w:5,h:5}):(0,n.jsx)(i.Z,{src:$.includes(".file")?$:"https://www.google.com/s2/favicons?domain=".concat(K,"&sz=",20),classNames:{wrapper:"max-w-5 flex-shrink-0"},width:20,height:20,title:J})}),(null==eu?void 0:null===(F=eu[0])||void 0===F?void 0:F.category)===b.J5||(null==eu?void 0:null===(T=eu[0])||void 0===T?void 0:T.category)===b.Ys&&"image"===W?null:eA,Q&&(0,n.jsx)("div",{onClick:eD,className:"ml-auto p-1 hover:bg-gray-200 rounded-lg text-gray-700 bg-gray-100 cursor-pointer dark:hover:bg-gray-600 dark:bg-gray-700 dark:text-white",children:(0,n.jsx)(f.vN,{})})]}),(null==eu?void 0:null===(E=eu[0])||void 0===E?void 0:E.category)===b.J5||(null==eu?void 0:null===(Z=eu[0])||void 0===Z?void 0:Z.category)===b.Ys&&"image"===W?(0,n.jsx)("span",{className:"text-md font-medium leading-5",children:J}):(0,n.jsx)("a",{className:"text-[#30394A] pb-3 font-bold text-sm dark:text-white hover:underline hover:underline-offset-2",href:(null==eL?void 0:eL.includes(".file"))?void 0:eL,target:"_blank",children:(0,n.jsx)("span",{className:"text-md font-medium leading-5",children:J})})]}),(0,n.jsx)("div",{className:"px-4 py-4 text-theme-font-800 dark:text-theme-font-dark-800",children:null==ew?void 0:ew.split("\n").map((e,t)=>(0,n.jsx)("p",{className:"whitespace-pre-wrap break-words mb-3 last:mb-0 leading-relaxed",dangerouslySetInnerHTML:{__html:e}},t))})]})})}),_=r(76567),N=r(17859),S=a.memo(e=>{let{source:t,openIframe:r}=e,{snippet:a,url:l,link:i,title:o,other_info:s}=t;return s&&"imageUrl"in s?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("section",{"data-tooltip":"true",className:"flex flex-col max-w-[400px] whitespace-pre-wrap cursor-pointer",onClick:()=>window.open(i||l,"_blank"),children:(0,n.jsxs)("section",{className:"relative",children:[(0,n.jsx)("img",{src:(0,N.V)(s.imageUrl),alt:t.title,className:"w-full h-full min-w-80 min-h-96 object-cover"}),(0,n.jsx)("section",{className:"absolute bottom-0 left-0 w-full py-3 px-4 bg-white/90 text-black dark:bg-black/70 dark:text-white",children:(0,n.jsxs)("section",{className:"w-full flex items-center justify-between gap-2",children:[(0,n.jsxs)("section",{className:"flex items-center gap-2",children:[(0,n.jsx)("img",{src:s.avatar,className:"w-6 h-6 rounded-full"}),(0,n.jsx)("span",{className:"truncate",children:s.nickname})]}),(0,n.jsxs)("section",{className:"flex items-center gap-2",children:[(0,n.jsx)(_.Z,{size:14}),(0,n.jsx)("span",{children:null==s?void 0:s.liked_count})]})]})})]})})}):(0,n.jsx)(k,{source:t})}),F=r(96164),T=r(64657),E=r(5687),Z=r(93650),I=r(9455),D=r(29871);let A=e=>{let{source:t,openIframe:r,precedingText:a,rid:l}=e,{url:i,link:o}=t;return(0,u.lx)(i||o||"").hostname.includes("xiaohongshu.com")?(0,n.jsx)(S,{source:t,openIframe:r}):(0,n.jsx)(k,{source:t,precedingText:a,rid:l})};var L=a.memo(e=>{let{source:t,placement:r,children:l,precedingText:i,isVisible:d,rid:c,offset:h}=e,{isMobile:p}=(0,D.Z)(),{isOpen:m,onOpen:g,onClose:x}=(0,I.q)(),[f,b]=(0,a.useState)(!1),[w,y]=(0,a.useState)("top"),j=(0,a.useRef)(null),k=(0,C.Z)(e=>e.autoTranslateSources),{sourceOriginalList:_,sourceAllMatchList:N,sourceTranslatedList:S}=(0,o.Z)(),[L,M]=(0,a.useState)(""),O=async()=>{try{let e=(0,v.w0)(),r=t.url||t.link||"",n="".concat(c,"-").concat(r,"-").concat(e),a=_.findIndex(e=>e.id===n);if(-1!==a)return;let l=(0,s.ND)(t.snippet);await (0,v.R6)(t.title,l,c||"",t.link||"",e,n)}catch(e){console.warn("error:",e)}};return(0,a.useEffect)(()=>{let{url:e,link:r}=t;if(!(0,u.lx)(e||r||"").hostname.includes("xiaohongshu.com")&&t&&"scholar"!==t.engine_name&&"scholar"!==t.engine){if(!d)return;k&&O()}},[t,i,d,k]),p?l:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(F.e,{delay:100,showArrow:!0,onOpenChange:e=>{if(!r&&e){var t;let e=null===(t=j.current)||void 0===t?void 0:t.getBoundingClientRect();if(e){let t=window.innerHeight,r=e.top;t-e.bottom>r?y("bottom"):y("top")}}},placement:r||w,offset:h,className:"notranslate p-0 shadow-xl rounded-xl overflow-hidden bg-white dark:bg-theme-bg-dark-300",content:(0,n.jsx)(A,{source:t,openIframe:e=>{b(!1),M(e),g()},precedingText:i,rid:c}),classNames:{base:"notranslate"},children:(0,n.jsx)("span",{ref:j,children:l})}),(0,n.jsx)(T.R,{isOpen:m,onClose:()=>{M(""),x()},size:"5xl",closeButton:(0,n.jsx)(n.Fragment,{}),children:(0,n.jsx)(E.A,{children:(0,n.jsx)(Z.I,{className:"p-0",children:(0,n.jsx)("section",{className:"h-[80vh]",children:(0,n.jsx)("iframe",{src:L,width:"100%",height:"100%"})})})})})]})})},84915:function(e,t,r){"use strict";r.d(t,{F:function(){return P}});var n=r(52676),a=r(92823),l=r(43378),i=r(26152),o=r(40176),s=r(80626),d=r(60904),c=r(8924),u=r(75271),h=r(27585),p=r(25568),m=r(75154),g=r(90488),x=r(7717),f=r(97571),v=r(13003),C=r(31022),b=r(29871),w=r(4590),y=r(97247),j=r(60635),k=r(57606),_=r(31063),N=r(60161),S=r(49905),F=r(3295),T=r(34180),E=r(46571),Z=r(36551),I=r(64412),D=r(4814),A=r(23083),L=r(84781),M=r(70262);let O=e=>{var t,r,o,c,b,_,N;let{source:E,index:O,isVisible:P,rid:B,showCheckbox:z}=e,R=(0,C.Z)(e=>e.extensionEnable),H=(0,C.Z)(e=>e.legacyExtensionEnable),U=(0,x.useTranslations)(),{selectedSources:V,setSelectedSources:q,sourceOriginalList:G,sourceTranslatedList:J}=(0,k.Z)(),{isDark:X}=(0,f.Z)(),{snippet:W,url:$,link:K,title:Y,other_info:Q}=E,ee=(0,F.Z)(e=>e.autoTranslateSources),et=(0,A.Z)(e=>e.threads),[er,en]=(0,u.useState)(!1),[ea,el]=(0,u.useState)(!1),[ei,eo]=(0,u.useState)({translatedTitle:"",translatedSnippet:""}),[es,ed]=(0,u.useState)(W),ec=(0,h.lx)($||K||"").hostname,[eu,eh]=(0,u.useState)(!1),ep=(0,u.useMemo)(()=>(0,m.a)(W),[W]),em=(e,t)=>{let r="".concat(B,"-").concat(e,"-").concat(t),n=G.find(e=>e.id===r);if(n)return{translatedTitle:n.translatedTitle,translatedSnippet:n.translated.join("\n")};let a="".concat(e,"-").concat(t),l=J.find(e=>e.id===a);return l?{translatedTitle:l.translatedTitle,translatedSnippet:l.translatedSnippet}:null},eg=()=>{if(ea)return;let e=em(E.url||E.link||"",(0,S.w0)());e?(eo(e),el(!0),en(!0)):(el(!1),en(!1))};return(0,u.useEffect)(()=>{eg()},[G,J]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-start w-full notranslate",children:[z&&(0,n.jsx)("div",{className:"flex-none p-2",children:(0,n.jsx)(T.K,{isSelected:V.includes(O),onChange:e=>{let{lastSelectedIndex:t,setLastSelectedIndex:r}=k.Z.getState(),n=e.nativeEvent.shiftKey,a=e.target.checked;if(n&&null!==t){let e=Math.min(t,O),r=Array.from({length:Math.max(t,O)-e+1},(t,r)=>e+r);a?q(Array.from(new Set([...V,...r]))):q(V.filter(e=>!r.includes(e)))}else a?q([...V,O]):q(V.filter(e=>e!==O));r(O)}})}),(0,n.jsx)("div",{className:"relative rounded-lg w-full flex flex-col gap-2",children:(0,n.jsx)(v.Z,{source:E,placement:"left",isVisible:P,rid:B,offset:z?65:void 0,children:(0,n.jsx)("div",{className:(0,D.Z)("flex items-start gap-3 w-full rounded-lg p-2 hover:bg-[#F6F7F9] dark:hover:bg-[#545D6F] mb-6",(null==et?void 0:null===(t=et[0])||void 0===t?void 0:t.category)===Z.J5?"":"cursor-pointer "),onClick:()=>{var e;let t=null==et?void 0:null===(e=et[0])||void 0===e?void 0:e.category;if(!K||t===Z.J5)return;if("image"===E.source_type){eh(!0);return}let r=K;if(!r.includes(".file")){if(r.includes("http")||(r="http://".concat(r)),(0,y.N0)()){(0,j.oh)({url:r});return}R?window.open((0,w.m1)(r),"_blank"):H?window.open((0,w.m1)(r,!0),"_blank"):window.open(r,"_blank")}},children:(0,n.jsxs)("section",{className:"w-full",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 text-[#8896AA] text-xs dark:text-[#B9BFCA] min-h-4",children:[(0,n.jsx)("span",{className:"block flex items-center flex-shrink-0 h-4 px-1 rounded-md text-[9px] bg-[#F6F7F9] dark:bg-[#353B46] text-[#5F7698] dark:text-[#F3F5F7]",children:O+1}),(0,n.jsx)("span",{className:"flex-none inline-block w-[16px] h-[16px]",children:(null==et?void 0:null===(r=et[0])||void 0===r?void 0:r.category)===Z.J5||(null==et?void 0:null===(o=et[0])||void 0===o?void 0:o.category)===Z.Ys&&(null==E?void 0:E.source_type)==="image"?(0,n.jsx)(I.Z,{fileName:Y,w:4,h:4}):(0,n.jsx)(g.Z,{src:(E.url||E.link||"").includes(".file")?E.url||E.link||"":"https://www.google.com/s2/favicons?domain=".concat(ec,"&sz=",16),title:Y})}),(0,n.jsx)("p",{className:"text-sm line-clamp-1 break-all",children:(0,h.CN)({url:(null==E?void 0:E.link)||"",title:(null==E?void 0:E.title)||"",sourceType:(null==E?void 0:E.source_type)||""})})]}),(null==et?void 0:null===(c=et[0])||void 0===c?void 0:c.category)!==Z.J5&&(null==et?void 0:null===(b=et[0])||void 0===b?void 0:b.category)!==Z.Ys?(0,n.jsx)("section",{className:"mt-2 leading-4 text-[#4B5F7E] dark:text-[#F3F5F7]",children:(0,n.jsxs)("span",{className:"text-sm",children:[(0,h.pz)(K||"")?(0,n.jsx)("span",{className:"max-w-fit inline-block mr-1 align-[-2px] ".concat(X?"text-white":"text-black"),children:(0,n.jsx)(p.UK,{})}):"",(0,n.jsx)("span",{children:ea&&ee?ei.translatedTitle:Y}),ep&&(0,n.jsxs)("span",{className:"inline-block text-sm text-bold ml-2",children:["[",ep,"]"]})]})}):null,(0,n.jsx)("section",{className:"mt-2 text-xs text-[#4B5F7E] dark:text-[#F3F5F7] line-clamp-3 leading-normal",children:(null==et?void 0:null===(_=et[0])||void 0===_?void 0:_.category)===Z.Ys&&(null==E?void 0:E.source_type)==="image"?(0,n.jsx)(a.J,{radius:"sm",classNames:{img:"w-full h-[w-full/8] object-cover overflow-hidden"},alt:(null==E?void 0:E.title)||"image",src:(0,M.UK)((null==E?void 0:null===(N=E.other_info)||void 0===N?void 0:N.file_id)||"")}):ea&&ee?ei.translatedSnippet:es}),"topic"===E.engine_name&&(0,n.jsxs)("div",{className:"flex w-full items-center gap-2 mt-2 text-theme-font-600 dark:text-[#F3F5F7]",children:[(0,n.jsxs)("div",{className:"p-1.5 bg-[#F6F7F9] dark:bg-[#353B46] gap-1 rounded-lg ml-auto flex items-center justify-center",children:["document"===E.source_type&&(0,n.jsx)(L.g9,{className:"w-4 h-4"}),"document"===E.source_type&&(0,n.jsx)("div",{className:"text-xs",children:U("topic.file")}),("website"===E.source_type||"webpage"===E.source_type)&&(0,n.jsx)(s.Z,{size:16}),("website"===E.source_type||"webpage"===E.source_type)&&(0,n.jsx)("div",{className:"text-xs",children:U("topic.link")})]}),(0,n.jsx)("div",{className:"p-1.5 bg-[#F6F7F9] rounded-lg dark:bg-[#353B46]",children:(0,n.jsx)(L.HV,{className:"w-4 h-4"})})]})]})})})},O)]}),(0,n.jsx)(l.Vq,{open:eu,onOpenChange:()=>{eh(!1)},children:(0,n.jsxs)(l.cZ,{hideCloseButton:!0,"aria-describedby":void 0,className:(0,D.Z)("max-w-screen-sm","bg-transparent border-none shadow-none"),children:[(0,n.jsx)(i.T,{children:(0,n.jsx)(l.$N,{className:"dark:bg-gray-600",children:Y||"image"})}),(0,n.jsxs)(l.a7,{className:"w-full max-w-md mx-auto relative",children:[(0,n.jsx)("div",{className:"absolute -top-8 right-2 z-20",children:(0,n.jsx)(l.GG,{className:"rounded-full p-1 bg-white/80 outline-none dark:bg-gray-700",children:(0,n.jsx)(d.Z,{size:20})})}),(0,n.jsx)("div",{className:"relative mb-4 -mt-3  flex justify-center z-0 rounded-xl bg-[#E4E4E7] dark:bg-[#27272A]  min-h-[200px]",children:(0,n.jsx)(a.J,{classNames:{img:"max-h-[calc(100vh-160px)]"},radius:"sm",alt:Y||"image",src:(0,M.UK)((null==Q?void 0:Q.file_id)||"")})})]})]})})]})},P=e=>{let{sources:t,canEdit:r,isDone:a,isAll:l,isAllDisabled:i,onOpen:s,isVisible:d,rid:p}=e,m=(0,x.useTranslations)(),[f,v]=(0,u.useState)(!0),{isMobile:C}=(0,b.Z)(),w=(0,u.useMemo)(()=>t.length<=3?t:t.slice(0,3),[t]),y=(0,u.useMemo)(()=>t.length<=3?[]:t.slice(3,t.length).map(e=>{let{url:t,link:r,title:n}=e,a=t||r||"",l=(0,h.lx)(a).hostname;return{src:a.includes(".file")?a:"https://www.google.com/s2/favicons?domain=".concat(l,"&sz=",16),title:n}}),[t]);return(0,u.useEffect)(()=>{l&&v(!1)},[l]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex flex-col  ".concat(l?"":"overflow-hidden"),children:[t.length>0?(f?w:t).map((e,t)=>(0,n.jsx)("div",{children:l?(0,n.jsx)(O,{index:t,source:e,isVisible:d,rid:p,showCheckbox:r}):(0,n.jsx)(O,{index:t,source:e,isVisible:d,rid:p})},t)):a?(0,n.jsx)("section",{className:"text-center my-10",children:m("no_sources")}):(0,n.jsx)("section",{className:"flex flex-col gap-5",children:[,,,].fill("").map((e,t)=>(0,n.jsx)(o.O,{className:"max-w-sm h-28 bg-zinc-200 dark:bg-gray-900/30"},t))}),f&&(0,n.jsx)("section",{children:(0,n.jsxs)("section",{className:"relative z-[1] flex justify-end items-center",children:[(0,n.jsx)("section",{className:"flex flex-wrap gap-2",children:Array.from(new Set(y)).slice(0,3).map((e,t)=>(0,n.jsx)(g.Z,{src:e.src,title:e.title},t))}),!!y.length&&(0,n.jsxs)("button",{className:(0,E.cn)("flex items-center gap-1 text-sm m-1 px-3 py-1.5 rounded-lg","text-theme-font-600 dark:text-theme-font-dark-600","bg-transparent hover:bg-default-100","transition-colors duration-150","disabled:opacity-50 disabled:cursor-not-allowed"),disabled:i,onClick:()=>{C?v(!1):s&&s(),(0,_.fk)(N.U.THREAD_MORE_SOURCES,{sources:t.length},!0)},children:[m("view_more_num",{number:y.length}),(0,n.jsx)(c.Z,{size:18})]})]})})]})})}},67185:function(e,t,r){"use strict";r.d(t,{Oq:function(){return s},Qz:function(){return i},TE:function(){return d},jW:function(){return a},jo:function(){return o}});var n=r(14386);let a=[{id:"basic-1",textColor:"#323232",styleObject:{backgroundColor:"#3E81F4",color:"#FFFFFF"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#323232"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n.UW)(),qrcodeBg:"linear-gradient(to right bottom, rgb(36, 171, 247), rgb(40, 121, 251))"},{id:"basic-2",textColor:"#6E553B",styleObject:{backgroundColor:"#FFDF76",color:"#361B00"},titleColor:"#361B00",threadTitleStyle:{color:"#353535"},markdownStyle:{},bodyStyle:{backgroundColor:"#FEF7E2"},logoIcon:(0,n._j)(),qrcodeBg:"rgba(54,27,0,1)",otherOptions:{}},{id:"basic-3",textColor:"#83785A",styleObject:{backgroundColor:"#8E875E",color:"#FFFFFF"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#D76439"},markdownStyle:{},bodyStyle:{backgroundColor:"#FBFCF7"},logoIcon:(0,n.UW)(),qrcodeBg:"#8E875E",otherOptions:{}},{id:"basic-4",textColor:"#0B3E51",styleObject:{backgroundColor:"#54A6B4",color:"#FFFFFF"},titleColor:"#F6ED4D",threadTitleStyle:{color:"#BAB33E"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n.UW)(),qrcodeBg:"#54A6B4",otherOptions:{}},{id:"basic-5",textColor:"#393532",styleObject:{backgroundColor:"#D77455",color:"#FFFFFF"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#D77455"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFF8F6"},logoIcon:(0,n._j)(),qrcodeBg:"#000",otherOptions:{}},{id:"basic-6",textColor:"#321450",styleObject:{backgroundColor:"#FF7F2C",color:"#FFFFFF"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#FF7F2C"},markdownStyle:{},bodyStyle:{backgroundColor:"#FDFEFF"},logoIcon:(0,n._j)(),qrcodeBg:"rgb(195,85,37)",otherOptions:{}},{id:"basic-7",textColor:"#368B86",styleObject:{backgroundColor:"#D8E4D8",color:"#5F5A44"},titleColor:"#5F5A44",threadTitleStyle:{color:"#5F5A44"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"rgb(95,90,68)",otherOptions:{}},{id:"basic-8",textColor:"#434343",styleObject:{backgroundColor:"#EDEAD9",color:"#4A4B44"},titleColor:"#4A4B44",threadTitleStyle:{color:"#D88C39"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"rgb(102.106,81)",otherOptions:{}},{id:"basic-9",textColor:"#405B1C",styleObject:{backgroundColor:"#D6D8B1",color:"#4E6C1E"},titleColor:"#4E6C1E",threadTitleStyle:{color:"#B29604"},markdownStyle:{},bodyStyle:{backgroundColor:"#F7F5F1"},logoIcon:(0,n._j)(),qrcodeBg:"rgb(78,108,30)",otherOptions:{}},{id:"basic-10",textColor:"#021A36",styleObject:{backgroundColor:"#F5F2EB",color:"#6C5526"},titleColor:"#9D8046",threadTitleStyle:{color:"#9D8046"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"rgb(108, 85, 38)",otherOptions:{}},{id:"basic-11",textColor:"#271F1D",styleObject:{backgroundColor:"#F5F2EB",color:"#3D6F2D"},titleColor:"#3D6F2D",threadTitleStyle:{color:"#53963D"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"#3D6F2D",otherOptions:{}},{id:"basic-12",textColor:"#004489",styleObject:{backgroundColor:"#004489",color:"# fff"},titleColor:"#FF8D00",threadTitleStyle:{color:"#FE8C01"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"#004489 ",otherOptions:{}},{id:"basic-13",textColor:"#030303",styleObject:{backgroundColor:"#22B4E5",color:"#FFFFFF"},titleColor:"#EFEA38",threadTitleStyle:{color:"#B4B01B"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n.UW)(),qrcodeBg:"rgb(13, 80, 102)",otherOptions:{}},{id:"basic-14",textColor:"#4E4E4E",styleObject:{background:"url(/shareThreadImg/iosTag.png)",color:"#353535"},titleColor:"#404040",threadTitleStyle:{color:"#404040"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"linear-gradient(to right bottom, rgb(36, 171, 247), rgb(40, 121, 251))",previewImg:"/shareThreadImg/preview9.png"},{id:"basic-15",textColor:"#64846F",styleObject:{backgroundColor:"#B3C3B9",color:"#3F5947"},titleColor:"#64846F",threadTitleStyle:{color:"#B65D63"},markdownStyle:{},bodyStyle:{backgroundColor:"rgb(255,249,242)"},logoIcon:(0,n._j)(),qrcodeBg:"#3F5947",otherOptions:{}},{id:"basic-16",textColor:"#6F2D3D",styleObject:{backgroundColor:"#FDEFDF",color:"#6F2D3D"},titleColor:"#E3A972",threadTitleStyle:{color:"#6F2D3D"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"#6F2D3D",otherOptions:{dotBg:"#B3C3B9",lineBg:"#EEE8E1",lineBorder:"#4A7B5D",dotBorder:"#4A7B5D"}},{id:"basic-17",textColor:"#2B689B",styleObject:{backgroundColor:"#D3E9FC",color:"#2B689B"},titleColor:"#2B689B",threadTitleStyle:{color:"#B65D63"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"#2B689B",otherOptions:{dotBg:"#d3e9fc",dotBorder:"#4D98D9",lineBg:"#E1E5EE",lineBorder:"#4D98D9"}},{id:"basic-18",textColor:"#1D1210",styleObject:{backgroundColor:"rgb(172,158,100)",color:"#1D1210"},titleColor:"#9C8746",threadTitleStyle:{color:"#9C8746"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFF9F3"},logoIcon:(0,n._j)(),qrcodeBg:"#1D1210",otherOptions:{styleDocument:{background:"url(/shareThreadImg/pattern1.png)"}},previewImg:"/shareThreadImg/preview1.png"},{id:"basic-19",textColor:"#1D1210",styleObject:{backgroundColor:"rgb(65,94,70)",color:"#1D1210"},titleColor:"#488352",threadTitleStyle:{color:"#488352"},markdownStyle:{},bodyStyle:{backgroundColor:"#F2F2E7"},logoIcon:(0,n._j)(),qrcodeBg:"#1D1210",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern2.png)"}},previewImg:"/shareThreadImg/preview2.png"},{id:"basic-20",textColor:"#4F586B",styleObject:{backgroundColor:"rgb(217,217,217)",color:"#343B47"},titleColor:"#005F9E",threadTitleStyle:{color:"#005F9E"},markdownStyle:{},bodyStyle:{backgroundColor:"#F5F5F5"},logoIcon:(0,n._j)(),qrcodeBg:"#343B47",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern3.png)"}},previewImg:"/shareThreadImg/preview3.png"},{id:"basic-21",textColor:"#4F586B",styleObject:{backgroundColor:"rgb(44,45,101)",color:"#343B47"},titleColor:"#A63939",threadTitleStyle:{color:"#A63939"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"#343B47",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern4.png)"}},previewImg:"/shareThreadImg/preview4.png"},{id:"basic-22",textColor:"#002323",styleObject:{backgroundColor:"rgb(238,225,192)",color:"#002323"},titleColor:"#E24100",threadTitleStyle:{color:"#E24100"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFBF2"},logoIcon:(0,n._j)(),qrcodeBg:"#002323",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern5.png)"}},previewImg:"/shareThreadImg/preview5.png"},{id:"basic-23",textColor:"#481F56",styleObject:{backgroundColor:"rgb(86,24,107)",color:"#481F56"},titleColor:"#E93C5A",threadTitleStyle:{color:"#E93C5A"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFF6FA"},logoIcon:(0,n._j)(),qrcodeBg:"#481F56",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern6.png)"}},previewImg:"/shareThreadImg/preview6.png"},{id:"basic-24",textColor:"#434343",styleObject:{backgroundColor:"rgb(215,236,253)",color:"#000"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#B65D63"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"#000",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/cartoonGridBg.png)"}},previewImg:"/shareThreadImg/preview7.png"},{id:"basic-25",textColor:"#808080",styleObject:{background:"linear-gradient(to bottom, #D4E9FC, #5DADEC)",color:"#010101"},titleColor:"#010101",threadTitleStyle:{color:"#010101"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"#010101",otherOptions:{headerLineStyle:{border:"10px solid #035E8D",background:"#02293E"},headerBg:"linear-gradient(0deg, rgba(74, 150, 199, 0.00) 0%, #4A96C7 100%)"},previewImg:"/shareThreadImg/preview8.png"},{id:"basic-26",textColor:"#808080",styleObject:{background:"#BA9B7C",color:"#010101"},titleColor:"#010101",threadTitleStyle:{color:"#010101"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"#010101",otherOptions:{headerLineStyle:{border:"10px solid #816345",background:"#23180C"},headerBg:"linear-gradient(0deg, rgba(186, 155, 124, 0.00) 0%, #BA9B7C 100%)"}},{id:"basic-27",textColor:"#434343",styleObject:{background:"#53A5F7",color:"#010101"},titleColor:"#0E60B4",threadTitleStyle:{color:"#0E60B4"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,n._j)(),qrcodeBg:"#434343",otherOptions:{collisionBg:"#F1DF50"}}],l=e=>a.find(t=>t.id===e),i=[{parentId:"shareTemplate3",templateImg:"/shareThreadImg/template11.png",defaultBgID:"basic-17",defaultBg:l("basic-17")},{parentId:"shareTemplate1",templateImg:"/shareThreadImg/template1.png",defaultBgID:"basic-1",defaultBg:l("basic-1")},{parentId:"shareTemplate2",templateImg:"/shareThreadImg/template2.png",defaultBgID:"basic-14",defaultBg:l("basic-14")},{parentId:"shareTemplate3",templateImg:"/shareThreadImg/template3.png",defaultBgID:"basic-15",defaultBg:l("basic-15")},{parentId:"shareTemplate4",templateImg:"/shareThreadImg/template4.png",defaultBgID:"basic-16",defaultBg:l("basic-16")},{parentId:"shareTemplate5",templateImg:"/shareThreadImg/template5.png",defaultBgID:"basic-18",defaultBg:l("basic-18")},{parentId:"shareTemplate6",templateImg:"/shareThreadImg/template6.png",defaultBgID:"basic-19",defaultBg:l("basic-19")},{parentId:"shareTemplate7",templateImg:"/shareThreadImg/template7.png",defaultBgID:"basic-20",defaultBg:l("basic-20")},{parentId:"shareTemplate8",templateImg:"/shareThreadImg/template8.png",defaultBgID:"basic-21",defaultBg:l("basic-21")},{parentId:"shareTemplate9",templateImg:"/shareThreadImg/template9.png",defaultBgID:"basic-22",defaultBg:l("basic-22")},{parentId:"shareTemplate10",templateImg:"/shareThreadImg/template10.png",defaultBgID:"basic-23",defaultBg:l("basic-23")},{parentId:"shareTemplate15",templateImg:"/shareThreadImg/template15.png",defaultBgID:"basic-24",defaultBg:l("basic-24")},{parentId:"shareTemplate16",templateImg:"/shareThreadImg/template16.png",defaultBgID:"basic-25",defaultBg:l("basic-25")},{parentId:"shareTemplate17",templateImg:"/shareThreadImg/template17.png",defaultBgID:"basic-26",defaultBg:l("basic-26")},{parentId:"shareTemplate18",templateImg:"/shareThreadImg/template14.png",defaultBgID:"basic-27",defaultBg:l("basic-27")}],o=10,s=[{id:"Base",value:""},{id:"Classic",value:"ShipporiMincho"},{id:"Elegance",value:"CustomOutfit"}],d=[1.2,1.4,1.6,1.8]},72035:function(e,t,r){"use strict";r.d(t,{O:function(){return y}});var n=r(52676),a=r(75271),l=r(43378),i=r(79736),o=r(52502),s=r(13003),d=r(97247),c=r(60635),u=r(952),h=r(50633),p=r(1711),m=r(10382),g=r(60904),x=r(1167),f=r(7717),v=r(27976),C=r(46571),b=r(23083),w=r(20796);function y(e){let{src:t,alt:r,sources:y}=e,j=(0,f.useTranslations)(),[k,_]=(0,a.useState)(1.2),[N,S]=(0,a.useState)(!1),[F,T]=(0,a.useState)({x:0,y:0}),[E,Z]=(0,a.useState)({x:0,y:0}),[I,D]=(0,a.useState)(!1),[A,L]=(0,a.useState)(!1),[M,O]=(0,a.useState)(t),[P,B]=(0,a.useState)("dark"),{addFailedImageUrl:z}=(0,b.Z)(),[R,H]=(0,a.useState)(!1),U=e=>{e.stopPropagation(),H(!R)},V=e=>{if((0,d.N0)()){(0,c.oh)({url:e});return}window.open(e,"_blank")},q=e=>e.split(/(\[\d+\])/g).map((e,t)=>{let r=e.match(/\[(\d+)\]/);if(r){let a=r[1],l=null==y?void 0:y[Number(a)-1];return l?(0,n.jsx)("span",{className:"footnote-ref inline-block mx-[2px] my-0 select-none",children:(0,n.jsx)(s.Z,{source:l,rid:l.url,children:(0,n.jsx)("a",{className:"inline-block text-[#475467] dark:text-[#babdc5] leading-normal cursor-pointer no-underline font-medium bg-theme-bg-300 dark:bg-theme-bg-dark-300 min-w-4 h-4 text-center rounded-full align-top text-xs",href:l.url,target:"_blank",onClick:e=>{e.preventDefault(),e.stopPropagation(),V(l.url)},children:a})})},t):(0,n.jsx)("span",{children:e},t)}return/<[^>]*>/.test(e)?(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:e}},t):(0,n.jsx)("span",{children:e},t)}),G=()=>{S(!1)};return(0,n.jsxs)(n.Fragment,{children:[!A&&R&&r&&(0,n.jsx)(x.pn,{delayDuration:0,children:(0,n.jsxs)(x.u,{children:[(0,n.jsx)(x.aJ,{asChild:!0,children:(0,n.jsxs)("span",{className:"p-1 cursor-pointer my-2 bg-[#D1E6FF] dark:bg-[#242A38] text-sm rounded-lg",onClick:U,children:[(0,n.jsx)(h.Z,{className:"w-4 h-4 mr-2 inline-block"}),(0,n.jsx)("span",{className:"align-middle",children:q(r)})]})}),(0,n.jsx)(x._v,{children:j("show_image")})]})}),A?(0,n.jsx)("span",{className:"inline-block [br:has(+&)]:hidden [&~br]:hidden"}):(0,n.jsx)("span",{className:"".concat(R&&"hidden"," ").concat(I?"mb-6 mt-4":"w-0 h-0"," text-center max-w  flex items-center justify-center"),onClick:e=>{e.stopPropagation(),e.preventDefault()},children:(0,n.jsxs)("span",{className:"border-1 border-transparent p-4 group rounded-lg relative hover:border-[#EAEFF4] hover:dark:border-[#242A38]",children:[(0,n.jsxs)(l.Vq,{onOpenChange:e=>{e?_(1.2):(_(1),T({x:0,y:0}))},children:[(0,n.jsx)(l.hg,{asChild:!0,children:(0,n.jsxs)("span",{className:"inline-block",children:[(0,n.jsx)("img",{src:M,alt:r,onLoad:()=>{L(!1),D(!0)},onError:()=>{D(!1),M.includes(v.XJ)?(L(!0),z(t)):O((0,w.YA)(M))},className:"inline-block mt-0 cursor-pointer object-cover select-none outline-none mb-2"}),(0,n.jsx)("span",{className:"absolute top-0 right-[-35px] opacity-0  group-hover:opacity-100 transition-opacity bg-[#F6F7F9]  dark:bg-[#2F333C] rounded-md flex items-center",children:(0,n.jsx)(x.pn,{delayDuration:0,children:(0,n.jsxs)(x.u,{children:[(0,n.jsx)(x.aJ,{asChild:!0,children:(0,n.jsx)("button",{className:"p-1.5 rounded-l-md",onClick:U,children:(0,n.jsx)(u.Z,{size:16,className:"text-[#64778A] dark:text-[#BBBDC5]"})})}),(0,n.jsx)(x._v,{children:j("hide_image")})]})})})]})}),(0,n.jsx)(l.cZ,{hideCloseButton:!0,className:"max-w-[100vw] max-h-[100vh] w-screen h-screen p-0 border-none transition-colors duration-300 ".concat("dark"===P?"bg-black/90":"bg-white/95"),children:(0,n.jsxs)(l.a7,{children:[(0,n.jsxs)("div",{className:"absolute top-4 left-4 right-4 z-20 flex items-center justify-between",children:[(0,n.jsxs)("div",{className:(0,C.cn)("rounded-2xl py-1 px-2 flex items-center gap-2","dark"===P?"bg-white":"bg-[#374151]"),children:[(0,n.jsx)("div",{className:(0,C.cn)("text-sm rounded-full h-5 flex items-center justify-center cursor-pointer","dark"===P?"text-[#374151] ":"text-black bg-white px-[2px]"),onClick:()=>B("light"),children:"dark"===P?j("light"):(0,n.jsx)(p.Z,{size:16})}),(0,n.jsx)("div",{className:(0,C.cn)("text-sm rounded-full h-5 flex items-center justify-center cursor-pointer","dark"===P?"text-white bg-[#374151] px-[2px] ":"text-white"),onClick:()=>B("dark"),children:"dark"===P?(0,n.jsx)(m.Z,{size:16}):j("dark")})]}),(0,n.jsx)(l.GG,{className:(0,C.cn)("rounded-full p-1 outline-none text-white bg-[#374151]"),children:(0,n.jsx)(g.Z,{size:20})})]}),(0,n.jsx)(i.M,{children:(0,n.jsx)(o.E.div,{className:"w-full h-full flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},children:(0,n.jsx)(o.E.img,{src:M,alt:r,className:"max-w-full max-h-[90vh] object-contain cursor-move",style:{scale:k,x:F.x,y:F.y,touchAction:"none"},onWheel:e=>{e.preventDefault(),_(e.deltaY>0?Math.max(.5,.95*k):Math.min(5,k/.95))},onTouchStart:e=>{2===e.touches.length&&Z({x:Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientY-e.touches[1].clientY),y:0})},onTouchMove:e=>{if(2===e.touches.length){let t=Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientY-e.touches[1].clientY);_(Math.min(Math.max(.5,k+(t-E.x)*.01),5)),Z({x:t,y:0})}},onMouseDown:e=>{S(!0),Z({x:e.clientX-F.x,y:e.clientY-F.y})},onMouseMove:e=>{N&&T({x:e.clientX-E.x,y:e.clientY-E.y})},onMouseUp:G,onMouseLeave:G,drag:!0,dragConstraints:{top:-300,left:-300,right:300,bottom:300}})})})]})})]}),!!r&&(0,n.jsx)("span",{className:"".concat(!I&&"hidden"," block text-center text-xs font-normal text-gray-400 dark:text-gray-500 select-text"),children:q(r)})]})})]})}},25339:function(e,t,r){"use strict";r.d(t,{FK:function(){return a},fh:function(){return l}});let n=/[A-Za-z0-9.-]*[A-Za-z0-9-]/,a=["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]+:(?![A-Za-z][-.+A-Za-z0-9]+:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,n.source,")","|","(?:",/(?:www\.)/.source,n.source,")","|","(?:",n.source,/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/.source,")",")","(?:"+/[-A-Za-z0-9+&@#\\/%=~_()|'$*[\]?!:,.;]*[-A-Za-z0-9+&@#/%=~_()|'$*[\]]/.source+")?"].join("");class l{getUrl(){let e=this._url;return this._protocolMatched||this.protocolPrepended||(e="http://"+e,this.protocolPrepended=!0),e}getAnchorHref(){return this.getUrl().replace(/&amp;/g,"&")}getAnchorText(){return this._url}constructor(e,t){this.protocolPrepended=!1,this._url=e,this._protocolMatched=t}}},44634:function(e,t,r){"use strict";let n;var a=r(60161),l=r(31063),i=r(65819),o=r(57546),s=r(65105),d=r(45360),c=r(84706),u=r(18881),h=r(7717),p=r(77844),m=r(70017),g=r(64787),x=r(94572),f=r(40341),v=r(77998),C=r(39109),b=r(33451),w=r(98795);let y=()=>{o.Z.getState().setLoginModalVisible(!0)},j=()=>{u.Z.getState().setIsRegenerate(!1),u.Z.getState().setIsShowPptModal(!0)},k=0;async function _(e){let{threadId:t,jobId:r,time:a,businessType:l}=e;return new Promise(e=>{n=setInterval(async()=>{++k>=10&&(clearInterval(n),e({editUrl:"",thumbnailUrl:""}));let a=await (0,f.IQ)({threadId:t,jobId:r,businessType:l});console.log("\uD83D\uDE80 ~ interval=setInterval ~ res:",a),(null==a?void 0:a.status)==="success"?(e({editUrl:null==a?void 0:a.editUrl,thumbnailUrl:null==a?void 0:a.thumbnailUrl}),clearInterval(n)):(null==a?void 0:a.status)==="failed"?(e({editUrl:"",thumbnailUrl:""}),clearInterval(n)):console.log("Not obtaining the permission to continue polling...")},a||5e3)})}t.Z=()=>{let e=(0,h.useTranslations)(),t=(0,m.V)(),r=(0,i.ZP)(e=>e.isLogin),n=(0,C.Z)(),{setUiModalType:o,setIsCanvaConnectedLoading:k,isCanvaConnectedLoading:N,setIsCanvaAuthorized:S,setIsShowCanvaModal:F,setIsOpenCanvaEditorLoading:T,setIsImportLoading:E,setDesign:Z,setIsReauthorized:I,setBusinessType:D,setBesinessId:A}=(0,u.Z)(),{setPptDetail:L}=(0,v.Z)();(0,s.Oi)("pptUsage"),(0,s.GS)("pptUsage");let M=async e=>{var t,r,n;let{noteId:a,businessType:l}=e,{subscriptionInfo:i}=s.ZP.getState();if(!i)return!1;let o=null!==(n=null===(r=b.Z.getState().pointsConfig)||void 0===r?void 0:null===(t=r.find(e=>"PPT_BASIC"===e.deduction_item))||void 0===t?void 0:t.points)&&void 0!==n?n:0,{balance:d,total_limit:u}=i.pointsUsage,{balance:h=0,total_limit:p=w.a.LIMITED}=(null==i?void 0:i.pointsEnterpriseUsage)||{};return u===w.a.UNLIMITED||!(d<o)||p===w.a.UNLIMITED||!(h<o)||(c.$.publish("showSubscriptionPlan",void 0),!1)},O=async e=>{let{noteId:t,businessType:r}=e;try{let{status:e}=await (0,g.Es)({threadId:t,businessType:r});return S(e),e}catch(e){return console.error("Error checking authorization:",e),S(!1),!1}},P=async t=>{let{noteId:r,businessType:a}=t;k(!0);try{if(await (0,g.qf)({threadId:r,businessType:a}))return S(!0),n.default(e("ppt.canva_connected")),!0;return S(!1),n.default(e("ppt.canva_connect_failed")),!1}catch(t){return console.error(t),S(!1),n.default(e("ppt.canva_connect_failed")),!1}finally{k(!1)}},B=async t=>{let{noteId:r,businessType:a}=t;N||(k(!0),await (0,g.Iv)({threadId:r,businessType:a})?(S(!1),n.default(e("ppt.canva_disconnected")),F(!1)):n.default(e("ppt.canva_disconnect_failed")),k(!1))},z=async t=>{let{noteId:r,businessType:a}=t;E(!0),T(!0);try{let t=await (0,f.$E)({threadId:r,businessType:a});if(!t)return n.default(e("ppt.import_ppt_failed")),!1;let l=await _({time:5e3,jobId:t,threadId:r,businessType:a}),i=null==l?void 0:l.editUrl;if(!i)return n.default(e("ppt.import_ppt_failed")),!1;return(0,x.bs)({threadId:r,canvaEditUrl:i,canvaThumbnailUrl:null==l?void 0:l.thumbnailUrl}),Z(l),window.open(i),F(!0),!0}catch(t){if(console.error(t,null==t?void 0:t.message),!u.Z.getState().isReauthorized&&(null==t?void 0:t.message)==="CANVA_GET_TOKEN_FAIL")return F(!1),T(!0),S(!1),I(!0),R({retry:!0,noteId:r,businessType:x.LB.NOTE}),!1;return n.default(e("ppt.import_ppt_failed")),!1}finally{E(!1)}},R=async e=>{let{retry:t,noteId:r,businessType:n}=e;T(!0);let i=await O({noteId:r,businessType:n});if(!0!==t&&i){let{canvaEditUrl:e,canvaThumbnailUrl:t}=(0,x.OW)({threadId:r});if(F(!0),!e){if(!await z({noteId:r,businessType:n})){T(!1),F(!1);return}T(!1);return}Z({editUrl:e,thumbnailUrl:t}),(0,l.fk)(a.U.THREAD_CANVA_EDIT,{id:r},!0),window.open(e),T(!1);return}if((0,l.fk)(a.U.THREAD_CONNECT_CANVA,{id:r},!0),!await P({noteId:r,businessType:n})){T(!1);return}if(F(!0),!await z({noteId:r,businessType:n})){T(!1),F(!1);return}T(!1)},H=async e=>{let{threadId:t,businessType:r}=e,n=await (0,d.OQ)({thread_id:t,businessType:r}),a=u.Z.getState().allPptGenerateData;return u.Z.getState().setAllPptGenerateData({...a,[t]:n}),n};return{operatingPpt:async i=>{let{key:s,noteId:d,businessType:c,pptDetail:u}=i;switch(D(c),A(d),s){case"generate":if((0,l.fk)(a.U.GENERATE_PPT,{value:"generate"},!0),!r){y();return}if(!await M({noteId:d,businessType:c}))return;o("generate"),j();break;case"regenerate":if((0,l.fk)(a.U.REGENERATE_PPT,{value:"generate"},!0),!await M({noteId:d,businessType:c}))return;o("regenerate"),j();break;case"preview":if((0,l.fk)(a.U.PREVIEW_PPT,{value:"preview"},!0),!(null==u?void 0:u.ppt_url)&&!(null==u?void 0:u.pdf_url)){n.default(e("ppt.generating_ppt_tip"));return}o("preview"),j();break;case"edit":(0,l.fk)(a.U.EDIT_PPT,{value:"edit"},!0),o("edit"),j();break;case"download":(0,l.fk)(a.U.AUTHOR_DOWNLOAD_PPT,{value:"download"},!0),(null==u?void 0:u.ppt_url)?window.open(null==u?void 0:u.ppt_url):n.default(e("ppt.generating_ppt_tip"));break;case"share":{(0,l.fk)(a.U.AUTHOR_SHARE_PPT,{value:d},!0);let r=p.Z.getState().current,i=new URL("".concat(location.origin,"/docs/").concat(d));i.searchParams.append("showppt","1"),r&&i.searchParams.append("invite",r),t.copy(i.toString()),n.default(e("ppt.copied_url_success"));break}case"connectCanva":R({noteId:d,businessType:c});break;case"revokeCanva":B({noteId:d,businessType:c})}},fetchLastPpt:H,pollLastPpt:e=>{let t,{threadId:r,businessType:n,interval:a=5e3,maxAttempts:l=10,onPollingResult:i}=e,o=0;return new Promise(e=>{t=setInterval(async()=>{try{let a=await H({threadId:r,businessType:n});if(i(a),(null==a?void 0:a.status)===2||(null==a?void 0:a.status)===3){clearInterval(t),e(a);return}++o>=l&&(clearInterval(t),e(null))}catch(r){clearInterval(t),e(null)}},a)})}}}},87921:function(e,t,r){"use strict";r.d(t,{IE:function(){return c}});var n=r(75271),a=r(27976);let l=()=>{let[e,t]=(0,n.useState)(!1),r=(0,n.useCallback)(()=>new Promise((r,n)=>{if(e){n(Error("Authentication already in progress"));return}t(!0);let l=window.screenX+(window.outerWidth-500)/2,i=window.screenY+(window.outerHeight-600)/2,o=null;try{o=window.open("".concat(a.Ez,"/api/auth/google"),"Google Sign In","width=".concat(500,",height=").concat(600,",left=").concat(l,",top=").concat(i))}catch(e){t(!1),n(Error("Failed to open popup window"));return}if(!o){t(!1),n(Error("Popup was blocked"));return}let s=e=>{var a,l;if(e.origin!==window.location.origin){console.log("Ignored message from different origin:",e.origin);return}console.log("Received message:",e.data),(null===(a=e.data)||void 0===a?void 0:a.type)==="GOOGLE_AUTH_SUCCESS"&&(window.removeEventListener("message",s),t(!1),r({...e.data.tokens,expiry_date:Date.now()+1e3*e.data.tokens.expires_in})),(null===(l=e.data)||void 0===l?void 0:l.type)==="GOOGLE_AUTH_ERROR"&&(window.removeEventListener("message",s),t(!1),n(Error(e.data.error)))};window.addEventListener("message",s);let d=()=>{window.removeEventListener("message",s),t(!1)},c=setInterval(()=>{(null==o?void 0:o.closed)&&(clearInterval(c),d(),n(Error("Authentication cancelled")))},1e3);setTimeout(()=>{e&&(d(),clearInterval(c),o&&!o.closed&&o.close(),n(Error("Authentication timeout")))},12e4)}),[e]);return(0,n.useEffect)(()=>()=>{t(!1)},[]),{authenticate:r,isAuthenticating:e}};var i=r(23873),o=r(50403);let s=e=>e.replace(/<img[^>]+>/g,e=>{try{let t=document.createElement("div");t.innerHTML=e;let r=t.firstChild,n=r.getAttribute("width"),a=r.getAttribute("height");if(n||a||(n=600),n=parseInt(n),a=a?parseInt(a):null,n>794){let e=794/n;n=794,a&&(a=Math.floor(a*e))}if(a&&a>1123){let e=1123/a;a=1123,n=Math.floor(n*e)}let l="<img";return Array.from(r.attributes).forEach(e=>{["width","height","style"].includes(e.name)||(l+=" ".concat(e.name,'="').concat(e.value,'"'))}),l+=' width="'.concat(n,'"'),a&&(l+=' height="'.concat(a,'"')),(l+=' style="max-width:100%;height:auto;display:block;margin:auto;"')+">"}catch(t){return console.error("Error processing image:",t),e}}),d=async(e,t,r,n)=>{let a="-------314159265358979323846",l=new i.TU.Renderer;l.image=e=>'<img src="'.concat(e.href,'" style="width: 21cm;" />');let o=n||(0,i.TU)(r,{renderer:l});o=s(o);let d="\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset=\"UTF-8\">\n      <style>\n        body {\n          width: 21cm; /* A4çº¸çš„å®½åº¦ */\n          margin: 0 auto; /* å±…ä¸­æ˜¾ç¤º */\n          padding: 2cm; /* é¡µè¾¹è· */\n          box-sizing: border-box;\n          font-family: Arial, sans-serif;\n          line-height: 1.5;\n        }\n        /* æ·»åŠ å…¶ä»–æ ·å¼ */\n       img{\n      max-width: 21cm; /* A4çº¸çš„å®½åº¦ */\n      max-height: 29.7cm; /* A4çº¸çš„é«˜åº¦ */\n       object-fit: contain; /* ä¿æŒå®½é«˜æ¯” */\n       }\n        pre {\n          background-color: #f5f5f5;\n          padding: 1em;\n          overflow-x: auto;\n        }\n        code {\n          font-family: 'Courier New', Courier, monospace;\n        }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n        }\n        th, td {\n          border: 1px solid #ddd;\n          padding: 8px;\n        }\n      </style>\n    </head>\n    <body>\n      ".concat(o,"\n    </body>\n    </html>\n  "),c=["--".concat(a),"Content-Type: application/json; charset=UTF-8","",JSON.stringify({name:e||"Untitled Document",mimeType:"application/vnd.google-apps.document"}),"--".concat(a),"Content-Type: text/html; charset=UTF-8","",d,"--".concat(a,"--")].join("\r\n"),u=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"multipart/related; boundary=".concat(a)},body:c});if(!u.ok){if(401===u.status)throw Error("AUTH_ERROR_401");throw Error("Failed to create Drive document: ".concat(u.status))}return u.json()},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,n.useState)(""),[a,i]=(0,n.useState)(!1),[s,c]=(0,n.useState)(null),{authenticate:u,isAuthenticating:h}=l(),p=()=>{let e=localStorage.getItem("google_tokens");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},m=e=>!e.expiry_date||Date.now()>=e.expiry_date,g=async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=p();if(r){if(m(r))try{let e=JSON.parse(localStorage.getItem("google_tokens")||""),t=await (0,o.W)(e.refresh_token);r={...e,...t,expiry_date:Date.now()+1e3*t.expires_in},localStorage.setItem("google_tokens",JSON.stringify(r))}catch(e){throw console.error("Authentication refresh failed :",e),Error("Authentication refresh failed")}}else try{let e=await u();r=e,localStorage.setItem("google_tokens",JSON.stringify(e))}catch(e){throw console.error("Authentication failed:",e),Error("Authentication failed")}try{return await e(r.access_token)}catch(r){if(r instanceof Error&&("AUTH_ERROR_401"===r.message||r.message.includes("401"))&&t)return localStorage.removeItem("google_tokens"),g(e,!1);throw r}};return{exportToDriveAndDocs:(0,n.useCallback)(async(t,n,a)=>{var l,o,s;if(!n&&!a){let t=Error("Content cannot be empty");c(t),null===(l=e.onError)||void 0===l||l.call(e,t);return}try{i(!0),c(null);let l=await g(e=>d((null==t?void 0:t.slice(0,100))||"Untitled Document",e,n,a)),s="https://docs.google.com/document/d/".concat(l.id,"/edit");r(s),null===(o=e.onSuccess)||void 0===o||o.call(e,s)}catch(r){let t=r instanceof Error?r:Error("Unknown error occurred");c(t),null===(s=e.onError)||void 0===s||s.call(e,t)}finally{i(!1)}},[e,u]),docUrl:t,isExporting:a||h,error:s}}},33265:function(e,t,r){"use strict";r.r(t),r.d(t,{base64ImagetoBlob:function(){return tp},default:function(){return tg},isAllowedImageType:function(){return tm}});var n,a,l=r(52676),i=r(75271),o=r(53492),s=r(96115),d=r(50403),c=r(66292),u=r.n(c),h=r(1167),p=r(7717),m=e=>{let{editor:t,onClickTitle:r}=e,[n,a]=(0,i.useState)(!1),[o,s]=(0,i.useState)({top:0,left:0}),d=(0,i.useRef)(null),[c,u]=(0,i.useState)(""),m=(0,i.useRef)(0),g=(0,p.useTranslations)(),x=()=>{let e=document.getElementById(c);if(!e||"H1"!==e.tagName)return"";for(;e&&"H1"!==e.tagName;)if(!(e=e.parentElement))return"";if(!e)return"";let t=e=>{var r,n;if("IMG"===e.tagName)return"";if(e.children.length>0){let r="";return Array.from(e.children).forEach(e=>{r+=t(e)}),r+((null===(n=e.textContent)||void 0===n?void 0:n.replace(/[\n\s]+/g," "))||"")}return(null===(r=e.textContent)||void 0===r?void 0:r.replace(/[\n\s]+/g," "))||""},r=t(e),n=e;for(;n.nextElementSibling&&"H1"!==(n=n.nextElementSibling).tagName;)r+="\n"+t(n);return r.trim().replace(/\n\s*\n/g,"\n")},f=(0,i.useCallback)(e=>{e.stopPropagation(),r(x()),t.state.doc.descendants((e,r)=>"heading"!==e.type.name||1!==e.attrs.level||e.attrs.id!==c||(t.chain().setTextSelection(r+e.nodeSize-1).run(),!1))},[x,t,c]),v=(0,i.useCallback)(()=>{m.current&&clearTimeout(m.current);let e=window.getSelection();if(!e||0===e.rangeCount){a(!1);return}let t=e.getRangeAt(0).startContainer;for(;t&&"H1"!==t.tagName&&(t=t.parentElement););if(t&&"H1"===t.tagName){let e=t.getBoundingClientRect();e.top<0||e.bottom>window.innerHeight?a(!1):(s({top:e.top+e.height/2,left:e.left-30}),u(t.getAttribute("id")||""),a(!0))}else m.current=setTimeout(()=>{a(!1)},100)},[]),C=(0,i.useCallback)(e=>{var t;if(m.current&&clearTimeout(m.current),null===(t=d.current)||void 0===t?void 0:t.contains(e.target))return;let r=e.target;for(;r&&"H1"!==r.tagName&&(r=r.parentElement););if(r&&"H1"===r.tagName){let e=r.getBoundingClientRect();s({top:e.top+e.height/2,left:e.left-30}),u(r.getAttribute("id")||""),a(!0)}else m.current=setTimeout(()=>{a(!1)},100)},[]);return((0,i.useEffect)(()=>{var e;return null===(e=document.querySelector(".searchDocs"))||void 0===e||e.addEventListener("scroll",v),document.addEventListener("mousemove",C),()=>{var e;null===(e=document.querySelector(".searchDocs"))||void 0===e||e.removeEventListener("scroll",v),document.removeEventListener("mousemove",C),m.current&&clearTimeout(m.current)}},[C,v]),n)?(0,l.jsx)(h.pn,{delayDuration:100,children:(0,l.jsxs)(h.u,{children:[(0,l.jsx)(h.aJ,{asChild:!0,children:(0,l.jsxs)("button",{ref:d,className:"px-[16px] h-[50px] fixed  z-2  flex items-center justify-center gap-2",style:{top:"".concat(o.top-28,"px"),left:"".concat(o.left-40,"px")},onMouseEnter:()=>{window.clearTimeout(m.current),a(!0)},onMouseLeave:()=>{m.current=setTimeout(()=>{a(!1)},100)},children:[(0,l.jsx)("button",{ref:d,className:"w-[32px] h-[32px] flex items-center justify-center p-1 cursor-pointer text-[#000] dark:text-[#fff] bg-white dark:bg-[#202329] hover:text-[#007aff] rounded-full hover:bg-[#EBEEF3] dark:hover:bg-[#000000] dark:hover:text-[#007aff] transition-colors ",onClick:f,onMouseEnter:()=>{window.clearTimeout(m.current),a(!0)},children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.9338 3.41667C15.5747 3.41667 15.2836 3.70775 15.2836 4.06682C15.2836 4.4259 15.5747 4.71698 15.9338 4.71698C16.2928 4.71698 16.5839 4.4259 16.5839 4.06682C16.5839 3.70775 16.2928 3.41667 15.9338 3.41667ZM13.771 3.23431C14.1055 2.36607 14.9477 1.75 15.9338 1.75C17.2133 1.75 18.2506 2.78728 18.2506 4.06682C18.2506 5.34637 17.2133 6.38365 15.9338 6.38365C14.9483 6.38365 14.1066 5.7684 13.7717 4.90108C13.412 4.90303 13.1365 4.90906 12.9083 4.92771C12.5887 4.95381 12.4358 5.00043 12.3349 5.05187C12.073 5.18531 11.86 5.39825 11.7266 5.66015C11.6752 5.76109 11.6285 5.914 11.6024 6.23353C11.5755 6.56279 11.5749 6.99033 11.5749 7.6272V9.16745L13.7713 9.16745C14.106 8.29964 14.948 7.68396 15.9338 7.68396C17.2133 7.68396 18.2506 8.72124 18.2506 10.0008C18.2506 11.2803 17.2133 12.3176 15.9338 12.3176C14.948 12.3176 14.106 11.7019 13.7713 10.8341H11.5749V12.3744C11.5749 13.0112 11.5755 13.4388 11.6024 13.768C11.6285 14.0876 11.6752 14.2405 11.7266 14.3414C11.86 14.6033 12.073 14.8163 12.3349 14.9497C12.4358 15.0011 12.5887 15.0478 12.9083 15.0739C13.1365 15.0925 13.412 15.0985 13.7717 15.1005C14.1066 14.2332 14.9483 13.6179 15.9338 13.6179C17.2133 13.6179 18.2506 14.6552 18.2506 15.9348C18.2506 17.2143 17.2133 18.2516 15.9338 18.2516C14.9477 18.2516 14.1055 17.6355 13.771 16.7673C13.391 16.7653 13.0591 16.7584 12.7725 16.735C12.3499 16.7005 11.9533 16.6258 11.5782 16.4347C11.0027 16.1415 10.5348 15.6736 10.2416 15.0981C10.0505 14.723 9.97584 14.3264 9.94131 13.9038C9.9082 13.4986 9.90821 13.0025 9.90822 12.4082V10.8341H7.86616L7.86616 14.4773C7.86618 14.8007 7.86619 15.0842 7.85012 15.3197C7.83311 15.569 7.79534 15.8248 7.68981 16.0796C7.45466 16.6473 7.00364 17.0983 6.43595 17.3335C6.18117 17.439 5.92533 17.4768 5.67602 17.4938C5.44049 17.5099 5.15699 17.5098 4.8336 17.5098H4.78159C4.4582 17.5098 4.1747 17.5099 3.93917 17.4938C3.68986 17.4768 3.43401 17.439 3.17924 17.3335C2.61155 17.0983 2.16053 16.6473 1.92538 16.0796C1.81985 15.8248 1.78208 15.569 1.76507 15.3197C1.749 15.0842 1.74901 14.8006 1.74902 14.4773L1.74902 5.52431C1.74901 5.20093 1.749 4.91742 1.76507 4.68189C1.78208 4.43258 1.81985 4.17674 1.92538 3.92196C2.16053 3.35427 2.61155 2.90325 3.17924 2.6681C3.43401 2.56257 3.68986 2.5248 3.93917 2.50779C4.1747 2.49172 4.4582 2.49173 4.78159 2.49175H4.8336C5.15698 2.49173 5.44049 2.49172 5.67602 2.50779C5.92533 2.5248 6.18117 2.56257 6.43595 2.6681C7.00364 2.90325 7.45466 3.35427 7.68981 3.92196C7.79534 4.17673 7.8331 4.43258 7.85012 4.68189C7.86619 4.91742 7.86618 5.20092 7.86616 5.52431L7.86616 9.16745H9.90822V7.59336C9.90821 6.99903 9.9082 6.50301 9.94131 6.09781C9.97584 5.67521 10.0505 5.27856 10.2416 4.9035C10.5348 4.32799 11.0027 3.86009 11.5782 3.56686C11.9533 3.37575 12.3499 3.3011 12.7725 3.26658C13.0591 3.24316 13.391 3.23631 13.771 3.23431ZM6.1995 5.55032C6.1995 5.1933 6.19905 4.96728 6.18731 4.79534C6.17609 4.63089 6.1574 4.57761 6.15001 4.55976C6.08402 4.40046 5.95745 4.27389 5.79814 4.2079C5.7803 4.20051 5.72702 4.18182 5.56257 4.1706C5.39063 4.15886 5.16461 4.15841 4.80759 4.15841C4.45058 4.15841 4.22456 4.15886 4.05262 4.1706C3.88817 4.18182 3.83489 4.20051 3.81704 4.2079C3.65774 4.27389 3.53117 4.40046 3.46518 4.55977C3.45779 4.57761 3.43909 4.63089 3.42787 4.79534C3.41614 4.96728 3.41569 5.1933 3.41569 5.55032L3.41569 14.4513C3.41569 14.8083 3.41614 15.0343 3.42787 15.2062C3.43909 15.3707 3.45779 15.424 3.46518 15.4418C3.53117 15.6011 3.65774 15.7277 3.81704 15.7937C3.83489 15.8011 3.88817 15.8198 4.05262 15.831C4.22456 15.8427 4.45058 15.8432 4.80759 15.8432C5.16461 15.8432 5.39063 15.8427 5.56257 15.831C5.72702 15.8198 5.7803 15.8011 5.79814 15.7937C5.95745 15.7277 6.08402 15.6011 6.15001 15.4418C6.1574 15.424 6.17609 15.3707 6.18731 15.2062C6.19905 15.0343 6.1995 14.8083 6.1995 14.4513V5.55032ZM15.9338 9.35063C15.5747 9.35063 15.2836 9.64172 15.2836 10.0008C15.2836 10.3599 15.5747 10.6509 15.9338 10.6509C16.2928 10.6509 16.5839 10.3599 16.5839 10.0008C16.5839 9.64171 16.2928 9.35063 15.9338 9.35063ZM15.9338 15.2846C15.5747 15.2846 15.2836 15.5757 15.2836 15.9348C15.2836 16.2938 15.5747 16.5849 15.9338 16.5849C16.2928 16.5849 16.5839 16.2938 16.5839 15.9348C16.5839 15.5757 16.2928 15.2846 15.9338 15.2846Z",fill:"currentColor"})})}),(0,l.jsx)("div",{className:"w-[4px] h-[32px] bg-[#007aff] ",onMouseEnter:()=>{window.clearTimeout(m.current),a(!0)}})]})}),(0,l.jsx)(h._v,{side:"bottom",children:g("note.format.create_mindmap")})]})}):null},g=r(70400),x=r(24321),f=r(76972),v=r(57527),C=r(79057);let b=(0,i.forwardRef)((e,t)=>{let{onSave:r,openMindMapModal:n}=e,{editor:a}=(0,g._)(),{noteData:c,setNoteData:h}=(0,s.Z)();(0,p.useTranslations)();let[b,w]=(0,i.useState)(null),{setShowGraphicModel:y,setGraphicQueryData:j}=(0,C.Z)();(0,p.useLocale)();let k=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{let e,t;if(!a)return;let n=u()(e=>{let{noteData:n}=s.Z.getState();if(!n)return;t&&t.abort(),t=new AbortController;let a={...n,note_id:n.note_id,content:e,other:{...n.other,aICreateImageList:f.Z.getState().createImgList}};(0,d.SB)(a,t).then(()=>{h(a)}).finally(()=>{t=void 0}),k.current||r()},800);return a.on("update",e=>{n(JSON.stringify(e.editor.getJSON()))}),()=>{k.current=!0,window.clearInterval(e),e=void 0}},[a]),(0,i.useEffect)(()=>{if(a&&(null==c?void 0:c.note_id))try{let e=JSON.parse(null==c?void 0:c.content);e?a.commands.setContent(e):null==a||a.storage.markdown.set(" ".concat((null==c?void 0:c.content)||"")).focus()}catch(e){null==a||a.storage.markdown.set(" ".concat((null==c?void 0:c.content)||""))}null==a||a.commands.focus("start")},[a,null==c?void 0:c.note_id]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.Z,{}),a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m,{editor:a,onClickTitle:e=>{s.Z.getState().setMindmapContent(e),n()}})," ",(0,l.jsx)(x.Z,{height:"calc(100vh - 136px)",editor:a})]}),(0,l.jsx)(v.C,{type:"note",onNoteAddGraphic:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!a)return;let{to:n}=a.state.selection;a.chain().focus().insertContentAt(n,{type:"customImage",attrs:{src:t,"data-id":e,class:"smart-art ".concat(r?"image-loading":"")}}).run()},onNoteUpdateGraphic:(e,t,r)=>{a&&a.chain().updateSmartArtImage({oldId:e,src:t,newId:r||e,removeClass:"image-loading"}).run()}})]})});b.displayName="Tiptap";var w=r(84593),y=r(65077),j=r(17224),k=r(93992),_=r.n(k);r(16832);var N=r(9455),S=r(39676),F=r(26831),T=r(76356),E=r(70017);r(77844);var Z=r(97571),I=r(60904),D=e=>{let{visible:t,closeDrawer:r,children:n}=e,a=(0,i.useRef)(null),o=(0,i.useRef)(null),{isDark:s}=(0,Z.Z)();return((0,i.useEffect)(()=>{function e(){let e=window.innerHeight;a.current&&(a.current.style.height="".concat(e,"px"))}return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,i.useEffect)(()=>{let e=e=>{let t=e.target;!a.current||a.current.contains(e.target)||t.closest('[data-tooltip="true"]')||r()};return t?document.addEventListener("mousedown",e):document.removeEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[t,r]),(0,i.useEffect)(()=>{if(t){document.body.style.overflow="hidden";let e=setTimeout(()=>{var e;null===(e=o.current)||void 0===e||e.focus()},100);return()=>clearTimeout(e)}document.body.style.overflow=""},[t]),t)?(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 backdrop-saturate-150 backdrop-blur-md",onClick:r}),(0,l.jsxs)("div",{ref:a,className:"fixed z-50 top-0 right-0 bg-content1 md:w-[50vw] h-full flex flex-col ".concat(s?"dark":""," transition-all ").concat(t?"":" opacity-0 invisible"),children:[(0,l.jsx)("button",{onClick:r,ref:o,className:"absolute top-4 right-4 text-gray-600 hover:text-gray-800",children:(0,l.jsx)(I.Z,{color:s?"white":"gray",className:"cursor-pointer",size:18})}),n]})]}):null},A=r(84915),L=r(65819),M=r(66040),O=r(3317),P=r(88955);let B=M.hj.create({name:"tableOfContents",addGlobalAttributes:()=>[{types:["heading"],attributes:{id:{default:null,parseHTML:e=>e.getAttribute("id"),renderHTML:e=>e.id?{id:e.id}:{}}}}],addOptions:()=>({onUpdate:()=>{}}),addProseMirrorPlugins(){let e=[];return[new O.Sy({key:new O.H$("tableOfContents"),appendTransaction:(e,t,r)=>{if(!e.some(e=>e.docChanged))return null;let n=r.tr,a=!1;return r.doc.descendants((e,t)=>{if("heading"===e.type.name&&!e.attrs.id){a=!0;let r="heading-".concat((0,P.x0)(6));n.setNodeMarkup(t,null,{...e.attrs,id:r})}}),a?n:null},view:()=>({update:t=>{let r=[];return t.state.doc.descendants(e=>{if("heading"===e.type.name){let t=e.attrs.id||"heading-".concat((0,P.x0)(6));r.push({level:e.attrs.level,text:e.textContent,id:t})}}),JSON.stringify(e)!==JSON.stringify(r)&&(e=r,this.options.onUpdate(r),!0)}})})]}}),z="isExpanded";var R=r(37481),H=r(44342),U=r(74976);let V=e=>{var t;let{toc:r}=e,[n,a]=(0,i.useState)((null===(t=r[0])||void 0===t?void 0:t.id)||""),o=(0,p.useTranslations)(),[s,d]=(0,i.useState)(!1),{isMobile:c}=(0,H.b)(),[u,m]=(0,i.useState)("true"===localStorage.getItem(z));(0,i.useEffect)(()=>{!n&&r.length>0&&a(r[0].id)},[r,n]);let g=e=>{let t=document.querySelector(".searchDocs"),r=document.querySelector("#".concat(e.id));if(!r||!t)return;d(!0),a(e.id);let n=r.offsetTop;t.scrollTo({top:n-20,behavior:"smooth"});let l=()=>{setTimeout(()=>{d(!1),t.removeEventListener("scrollend",l)},100)};t.addEventListener("scrollend",l)};(0,i.useEffect)(()=>{let e;let t=document.querySelector(".searchDocs");if(!t)return;let n=t.scrollTop,l=()=>{s||(e=requestAnimationFrame(()=>{let e=t.scrollTop;if(5>Math.abs(e-n))return;n=e;let l=t.clientHeight,i=r.map(e=>({id:e.id,element:document.getElementById(e.id)})).filter(e=>e.element),o=null,s=1/0;i.forEach(t=>{let{id:r,element:n}=t,a=n.offsetTop-e;if(a<=l/4){let e=Math.abs(a);e<s&&(s=e,o=r)}}),o&&a(o)}))};return t.addEventListener("scroll",l,{passive:!0}),()=>{t.removeEventListener("scroll",l),cancelAnimationFrame(e)}},[r,s]);let x=e=>{let t=document.querySelector(".custom-scrollbar"),r=null==t?void 0:t.querySelector('[data-id="'.concat(e,'"]'));t&&r&&r.scrollIntoView({behavior:"smooth",block:"nearest"})};return(0,i.useEffect)(()=>{n&&u&&x(n)},[n,u]),!c&&(0,l.jsxs)("div",{className:(0,R.cn)("relative border-[#EBEEF3]  dark:border-[#323538]",u&&"border-r-1"),children:[(0,l.jsx)("div",{className:(0,R.cn)(u&&"p-4 pr-0","outlineContainer relative h-full flex flex-col box-border",u?"w-[288px]":"w-0"),children:u&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"w-full flex justify-end mb-2 pr-4",children:(0,l.jsx)(h.pn,{delayDuration:100,children:(0,l.jsxs)(h.u,{children:[(0,l.jsx)(h.aJ,{asChild:!0,children:(0,l.jsx)("div",{className:"hover:text-[#007aff] hover:border-[#007aff] w-6 h-6 border rounded-[8px] flex items-center justify-center cursor-pointer",onClick:()=>{m(!1),localStorage.setItem(z,"false")},children:(0,l.jsx)(U.Z,{size:16})})}),(0,l.jsx)(h._v,{children:o("note.format.hide_outlines")})]})})}),(0,l.jsx)("div",{className:"flex-1 overflow-auto custom-scrollbar transition-all duration-100",children:(0,l.jsx)("div",{className:"flex flex-col w-full",children:r.map((e,t)=>(0,l.jsx)("div",{onClick:()=>g(e),title:e.text,"data-id":e.id,className:"heading-".concat(e.level," w-full text-left cursor-pointer overflow-hidden whitespace-nowrap text-ellipsis ").concat(e.id===n?"text-[#007aff !important]":""),style:{color:e.id===n?"#007aff":""},children:e.text},t))})})]})}),!u&&(0,l.jsx)(h.pn,{delayDuration:100,children:(0,l.jsxs)(h.u,{children:[(0,l.jsx)(h.aJ,{asChild:!0,children:(0,l.jsx)("div",{className:"absolute top-4 left-2 z-10 flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center cursor-pointer border hover:text-[#007aff] hover:border-[#007aff]",onClick:()=>{m(!0),localStorage.setItem(z,"true")},children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.7587 2H16.2413C17.0463 1.99999 17.7106 1.99998 18.2518 2.04419C18.8139 2.09012 19.3306 2.18868 19.816 2.43598C20.5686 2.81947 21.1805 3.43139 21.564 4.18404C21.8113 4.66937 21.9099 5.18608 21.9558 5.74817C22 6.28936 22 6.95372 22 7.75868V16.2413C22 17.0463 22 17.7106 21.9558 18.2518C21.9099 18.8139 21.8113 19.3306 21.564 19.816C21.1805 20.5686 20.5686 21.1805 19.816 21.564C19.3306 21.8113 18.8139 21.9099 18.2518 21.9558C17.7106 22 17.0463 22 16.2413 22H7.75868C6.95372 22 6.28936 22 5.74817 21.9558C5.18608 21.9099 4.66937 21.8113 4.18404 21.564C3.43139 21.1805 2.81947 20.5686 2.43598 19.816C2.18868 19.3306 2.09012 18.8139 2.04419 18.2518C1.99998 17.7106 1.99999 17.0463 2 16.2413V7.7587C1.99999 6.95373 1.99998 6.28937 2.04419 5.74817C2.09012 5.18608 2.18868 4.66937 2.43597 4.18404C2.81947 3.43139 3.43139 2.81947 4.18404 2.43597C4.66937 2.18868 5.18608 2.09012 5.74817 2.04419C6.28937 1.99998 6.95373 1.99999 7.7587 2ZM10 20H16.2C17.0566 20 17.6389 19.9992 18.089 19.9624C18.5274 19.9266 18.7516 19.8617 18.908 19.782C19.2843 19.5903 19.5903 19.2843 19.782 18.908C19.8617 18.7516 19.9266 18.5274 19.9624 18.089C19.9992 17.6389 20 17.0566 20 16.2V7.8C20 6.94342 19.9992 6.36113 19.9624 5.91104C19.9266 5.47262 19.8617 5.24842 19.782 5.09202C19.5903 4.7157 19.2843 4.40973 18.908 4.21799C18.7516 4.1383 18.5274 4.07337 18.089 4.03755C17.6389 4.00078 17.0566 4 16.2 4H10L10 20ZM8 4L8 20H7.8C6.94342 20 6.36113 19.9992 5.91104 19.9624C5.47262 19.9266 5.24842 19.8617 5.09202 19.782C4.7157 19.5903 4.40973 19.2843 4.21799 18.908C4.1383 18.7516 4.07337 18.5274 4.03755 18.089C4.00078 17.6389 4 17.0566 4 16.2V7.8C4 6.94342 4.00078 6.36113 4.03755 5.91104C4.07337 5.47262 4.1383 5.24842 4.21799 5.09202C4.40973 4.7157 4.7157 4.40973 5.09202 4.21799C5.24842 4.1383 5.47262 4.07337 5.91104 4.03755C6.36113 4.00078 6.94342 4 7.8 4H8ZM11.5 7C11.5 6.44772 11.9477 6 12.5 6H17.5C18.0523 6 18.5 6.44772 18.5 7C18.5 7.55229 18.0523 8 17.5 8H12.5C11.9477 8 11.5 7.55229 11.5 7ZM11.5 11C11.5 10.4477 11.9477 10 12.5 10H17.5C18.0523 10 18.5 10.4477 18.5 11C18.5 11.5523 18.0523 12 17.5 12H12.5C11.9477 12 11.5 11.5523 11.5 11ZM11.5 15C11.5 14.4477 11.9477 14 12.5 14H17.5C18.0523 14 18.5 14.4477 18.5 15C18.5 15.5523 18.0523 16 17.5 16H12.5C11.9477 16 11.5 15.5523 11.5 15Z",fill:"currentColor"})})})}),(0,l.jsx)(h._v,{children:o("note.format.show_outline")})]})})]})};var q=r(67742),G=r(91625),J=r(98065),X=r(62814),W=r(60351),$=r(44433),K=r(70469),Y=r(96022),Q=r(13976),ee=r(84644),et=r(65740),er=r(37280),en=r(37909),ea=r(15180),el=r(46529),ei=r(95214),eo=r(80010),es=r(80626),ed=r(71686),ec=r(51853),eu=r(55571),eh=r(92683),ep=r(62967),em=r(25010),eg=r(67975);let ex=e=>{let{initialUrl:t,initialOpenInNewTab:r,onSetLink:n}=e,[a,l]=(0,i.useState)(t||""),[o,s]=(0,i.useState)(r||!1),d=(0,i.useCallback)(e=>{l(e.target.value)},[]),c=(0,i.useMemo)(()=>/^(\S+):(\/\/)?\S+$/.test(a),[a]),u=(0,i.useCallback)(e=>{e.preventDefault(),c&&n(a,o)},[a,c,o,n]);return{url:a,setUrl:l,openInNewTab:o,setOpenInNewTab:s,onChange:d,handleSubmit:u,isValidUrl:c}},ef=e=>{let{onSetLink:t,initialOpenInNewTab:r,initialUrl:n}=e,a=(0,p.useTranslations)(),i=ex({onSetLink:t,initialOpenInNewTab:r,initialUrl:n});return(0,l.jsxs)("div",{className:"bg-white dark:bg-theme-bg-dark-100 border border-theme-border-200 dark:border-theme-border-dark-200 p-3 shadow-md rounded-lg",children:[(0,l.jsxs)("form",{onSubmit:i.handleSubmit,className:"flex items-center gap-2",children:[(0,l.jsx)("label",{className:"flex items-center gap-2 p-2 rounded-lg bg-neutral-100 dark:bg-neutral-900 cursor-text",children:(0,l.jsx)("input",{type:"url",className:"flex-1 bg-transparent outline-none min-w-[12rem] text-black text-sm dark:text-white",placeholder:"Enter URL",value:i.url,onChange:i.onChange})}),(0,l.jsx)(em.z,{type:"submit",disabled:!i.isValidUrl,children:a("note.set_link")})]}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsxs)("label",{className:"flex items-center justify-start gap-2 text-sm font-semibold cursor-pointer select-none text-neutral-500 dark:text-neutral-400",children:[a("note.open_web"),(0,l.jsx)(eg.r,{checked:i.openInNewTab,onCheckedChange:i.setOpenInNewTab})]})})]})},ev=e=>{let{onSetLink:t,children:r}=e;return(0,l.jsxs)(ep.fC,{children:[(0,l.jsx)(ep.xz,{asChild:!0,children:r}),(0,l.jsx)(ep.VY,{children:(0,l.jsx)(ef,{onSetLink:t})})]})};var eC=r(19370),eb=()=>{let{editor:e}=(0,g._)(),t=(0,p.useTranslations)(),r=(null==e?void 0:e.getAttributes("textStyle").fontFamily)||"inherit",n=[{label:t("default"),value:"inherit"},{label:"Noto Sans Japanese",value:'"Noto Sans JP", serif'},{label:"Noto Serif Japanese",value:'"Noto Serif JP", serif'},{label:"Noto Sans Korean",value:'"Noto Sans KR", serif'},{label:"ë‚˜ëˆ”ê³ ë”• (Nanum Gothic)",value:'"Nanum Gothic", serif'},{label:"Arial",value:"Arial, sans-serif"},{label:"Times New Roman",value:'"Times New Roman", serif'},{label:"å®‹ä½“",value:"SimSun, serif"},{label:"é»‘ä½“",value:"STHeiti, SimHei, sans-serif"},{label:"æ­£é»‘é«”",value:'"Microsoft JhengHei"'},{label:"æ–°ç´°æ˜Žé«”",value:'"æ–°ç´°æ˜Žé«”", PMingLiU'},{label:"åœ‹å­—æ¨™æº–å­—é«”",value:"DFKai-SB, BiauKai, æ¨™æ¥·é«”"}];return(0,l.jsxs)(eC.Ph,{value:r,onValueChange:t=>{e&&(null==e||e.chain().setMark("textStyle",{fontFamily:t}).run())},children:[(0,l.jsx)(eC.i4,{className:"w-[120px]",children:(0,l.jsx)(eC.ki,{placeholder:t("note.format.select_font")})}),(0,l.jsx)(eC.Bw,{style:{userSelect:"none"},children:n.map(e=>(0,l.jsx)(eC.Ql,{value:e.value,style:{fontFamily:e.value},children:e.label},e.value))})]})},ew=r(17112),ey=r(72696);let ej=(0,i.forwardRef)((e,t)=>{let{onClick:r,isActive:n,disabled:a,children:i,tipText:o}=e;return o?(0,l.jsx)(h.pn,{delayDuration:100,children:(0,l.jsxs)(h.u,{children:[(0,l.jsx)(h.aJ,{asChild:!0,children:(0,l.jsx)("button",{ref:t,onClick:r,className:(0,R.cn)("p-2 rounded-lg [&_svg]:size-4 hover:bg-theme-bg-100 dark:hover:bg-theme-bg-dark-200",n&&"text-theme-blue-500 bg-theme-blue-100 hover:bg-theme-blue-200 dark:bg-theme-bg-dark-200",a&&"opacity-60"),disabled:a,children:i})}),(0,l.jsx)(h._v,{side:"bottom",children:o})]})}):(0,l.jsx)("button",{ref:t,onClick:r,className:(0,R.cn)("p-2 rounded-lg [&_svg]:size-4 hover:bg-theme-bg-100 dark:hover:bg-theme-bg-dark-200",n&&"bg-theme-bg-200 dark:bg-theme-bg-dark-300",a&&"opacity-60"),disabled:a,children:i})});function ek(e){let{editor:t}=e,{noteData:r}=(0,s.Z)(),n=(0,p.useTranslations)(),a=async e=>{var a;let l=null===(a=e.target.files)||void 0===a?void 0:a[0];if(l){if(l.size>5242880){ew.Z.error(n("note.format.img_limit_size",{size:"5"})),e.target.value="";return}try{let e=await (0,d.Jd)(l,(null==r?void 0:r.note_id)||"");e.data&&(null==t||t.commands.insertImage({src:e.data,alt:"image",title:""}))}catch(e){console.error("Upload error:",e)}e.target.value=""}};return t?(0,l.jsxs)("div",{onMouseDown:()=>window.blur(),className:"flex relative z-10 flex-wrap items-center justify-center gap-1 px-2 md:px-2 py-2 bg-white dark:bg-background border-b border-theme-border-200 dark:border-theme-border-dark-200 select-none",children:[(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)(ej,{disabled:!t.can().undo(),onClick:()=>t.commands.undo(),tipText:n("note.format.undo"),children:(0,l.jsx)(q.Z,{})}),(0,l.jsx)(ej,{disabled:!t.can().redo(),onClick:()=>t.commands.redo(),tipText:n("note.format.redo"),children:(0,l.jsx)(G.Z,{})}),(0,l.jsx)(eh.T,{editor:t})]}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)(ej,{isActive:t.isActive("bold"),onClick:()=>t.chain().toggleBold().run(),tipText:n("note.format.bold"),children:(0,l.jsx)(J.Z,{})}),(0,l.jsx)(ej,{isActive:t.isActive("italic"),onClick:()=>t.chain().toggleItalic().run(),tipText:n("note.format.italic"),children:(0,l.jsx)(X.Z,{})}),(0,l.jsx)(ej,{isActive:t.isActive("strike"),onClick:()=>t.chain().toggleStrike().run(),tipText:n("note.format.strike_through"),children:(0,l.jsx)(W.Z,{})}),(0,l.jsx)(ej,{isActive:t.isActive("underline"),onClick:()=>t.chain().toggleUnderline().run(),tipText:n("note.format.underline"),children:(0,l.jsx)($.Z,{})}),(0,l.jsx)(ej,{tipText:n("note.format.text_color"),children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.5525 2.62864C10.8585 2.77937 11.0199 3.04358 11.0981 3.1813C11.1819 3.3289 11.2678 3.51797 11.3532 3.70601L14.9255 11.5649C15.1159 11.9839 14.9306 12.4779 14.5117 12.6684C14.0927 12.8588 13.5986 12.6736 13.4082 12.2546L12.1151 9.40975H7.88524L6.59214 12.2546C6.40169 12.6736 5.90765 12.8588 5.48866 12.6684C5.06968 12.4779 4.88441 11.9839 5.07486 11.5649L8.63461 3.73345C8.63877 3.72431 8.64293 3.71516 8.64708 3.70601C8.73252 3.51797 8.81841 3.3289 8.90225 3.1813C8.98047 3.04358 9.14183 2.77937 9.44784 2.62864C9.79608 2.45712 10.2042 2.45712 10.5525 2.62864ZM8.64282 7.74308H11.3575L10.0002 4.75692L8.64282 7.74308Z",fill:"currentColor"}),(0,l.jsx)("path",{d:"M0.833496 15.8333H19.1668V18.3333H0.833496V15.8333Z",fill:t.getAttributes("textStyle").color||"currentColor"})]}),(0,l.jsx)("input",{type:"color",value:t.getAttributes("textStyle").color||"#000",onChange:e=>{t.chain().setColor(e.target.value).run()},className:"absolute z-10 left-0 top-0 bottom-0 right-0 w-4 h-6 p-0 border-none rounded cursor-pointer opacity-0"})]})})]}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)(ej,{isActive:t.isActive({textAlign:"left"}),onClick:()=>t.chain().setTextAlign("left").run(),tipText:n("note.format.align_left"),children:(0,l.jsx)(K.Z,{})}),(0,l.jsx)(ej,{isActive:t.isActive({textAlign:"center"}),onClick:()=>t.chain().setTextAlign("center").run(),tipText:n("note.format.align_center"),children:(0,l.jsx)(Y.Z,{})}),(0,l.jsx)(ej,{isActive:t.isActive({textAlign:"right"}),onClick:()=>t.chain().setTextAlign("right").run(),tipText:n("note.format.align_right"),children:(0,l.jsx)(Q.Z,{})}),(0,l.jsx)(ej,{isActive:t.isActive({textAlign:"justify"}),onClick:()=>t.chain().setTextAlign("justify").run(),tipText:n("note.format.align_justify"),children:(0,l.jsx)(ee.Z,{})})]}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)(ej,{isActive:t.isActive("bulletList"),tipText:n("note.format.bullet_list"),onClick:()=>t.chain().toggleBulletList().run(),children:(0,l.jsx)(et.Z,{})}),(0,l.jsx)(ej,{isActive:t.isActive("orderedList"),onClick:()=>t.chain().toggleOrderedList().run(),tipText:n("note.format.numbered_list"),children:(0,l.jsx)(er.Z,{})})]}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)(ej,{onClick:()=>t.chain().indent().run(),tipText:n("note.format.increase_indent"),children:(0,l.jsx)(en.Z,{})}),(0,l.jsx)(ej,{onClick:()=>t.chain().outdent().run(),tipText:n("note.format.decrease_indent"),children:(0,l.jsx)(ea.Z,{})})]}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)(ej,{isActive:t.isActive("code"),onClick:()=>t.chain().toggleCode().run(),tipText:n("note.format.mark_as_code"),children:(0,l.jsx)(el.Z,{})}),(0,l.jsx)(ej,{isActive:t.isActive("blockquote"),onClick:()=>t.chain().toggleBlockquote().run(),tipText:n("note.format.quote"),children:(0,l.jsx)(ei.Z,{})}),(0,l.jsx)(ej,{onClick:()=>{null==t||t.chain().setParagraph().unsetAllMarks().run()},tipText:n("note.format.clear_formatting"),children:(0,l.jsx)(eo.Z,{})}),(0,l.jsx)(ev,{onSetLink:(e,r)=>{null==t||t.chain().setLink({href:e,target:r?"_blank":""}).run()},children:(0,l.jsx)(ej,{tipText:n("note.format.insert_link"),children:(0,l.jsx)(es.Z,{})})})]}),(0,l.jsx)(ej,{tipText:n("note.format.select_font"),children:(0,l.jsx)(eb,{})}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsxs)(ey.h_,{children:[(0,l.jsx)(ey.$F,{asChild:!0,children:(0,l.jsx)("div",{children:(0,l.jsx)(ej,{children:(0,l.jsxs)("div",{className:"p-2 text-[#0080FF] flex items-center justify-center rounded-[8px] border-1 border-[#0080FF]",children:[" ",(0,l.jsx)(ed.Z,{size:20})]})})})}),(0,l.jsxs)(ey.AW,{align:"center",className:"max-w-68",children:[(0,l.jsxs)(ey.Xi,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{var e;return null===(e=document.getElementById("image-upload"))||void 0===e?void 0:e.click()},children:[(0,l.jsx)(ec.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{children:n("note.upload_file")})]}),(0,l.jsxs)(ey.Xi,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{f.Z.getState().setShowAICreateModal(!0)},children:[(0,l.jsx)(eu.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{children:n("note.ai_tool.drawing")})]})]})]}),(0,l.jsx)("input",{id:"image-upload",type:"file",accept:"image/png, image/jpeg, image/jpg",onChange:a,className:"hidden"})]})]}):null}ej.displayName="ToolbarButton";var e_=r(34391),eN=r(51385),eS=r(91438),eF=r(94487),eT=r(51220),eE=r(8510),eZ=r(41529),eI=r(60161),eD=r(31063),eA=r(66336),eL=r(39344),eM=r(54857),eO=r(58619),eP=r(85216),eB=r(67241),ez=r(62500),eR=r(41223),eH=r(26595),eU=r(4814),eV=r(24213),eq=r(44634),eG=r(94572),eJ=r(15133),eX=e=>{let{noteId:t,notePPTCacheData:r}=e,n=(0,p.useTranslations)(),a=(0,L.ZP)(e=>e.isLogin),o=(0,eq.Z)(),s=(0,i.useMemo)(()=>{let e=[{key:"preview",value:"ppt.preview_ppt_btn"},{key:"edit",value:"ppt.edit_ppt_btn"},{key:"generate",value:"ppt.generate_ppt_btn"},{key:"regenerate",value:"ppt.regenerate_btn"},{key:"download",value:"ppt.download_ppt_btn"}];return(null==r?void 0:r.status)==4?e.filter(e=>"generate"!==e.key):e=(null==r?void 0:r.status)===2?[...e]:[1,3,5].includes((null==r?void 0:r.status)||-1)?[{key:"edit",value:"ppt.edit_ppt_btn"},{key:"regenerate",value:"ppt.regenerate_btn"}]:[{key:"generate",value:"ppt.generate_ppt_btn"}],e},[null==r?void 0:r.status]);return a?(0,l.jsxs)(l.Fragment,{children:[s.map(e=>(0,l.jsx)(ey.Xi,{className:(0,eU.Z)("py-0 px-1"),children:(0,l.jsxs)(eH.A,{size:"md",variant:"flat",className:(0,eU.Z)("rounded-sm","h-8 min-h-8 justify-start w-full px-1","bg-transparent","hover:text-gray-900","dark:hover:text-white dark:text-white"),onPress:()=>{o.operatingPpt({key:(null==e?void 0:e.key)||"generate",noteId:t,businessType:eG.LB.NOTE,pptDetail:r}),(0,eD.fk)(eI.U.DOCS_GENERATE_PPT,{value:"generate"},!0)},children:[(null==e?void 0:e.key)==="generate"?(0,l.jsx)(eV.$U,{className:(0,eU.Z)("w-[24px]")}):(null==e?void 0:e.key)==="preview"?(0,l.jsx)(eV.$U,{className:(0,eU.Z)("w-[24px]")}):(null==e?void 0:e.key)==="edit"?(0,l.jsx)(eV.e8,{className:(0,eU.Z)("w-[24px]")}):(null==e?void 0:e.key)==="regenerate"?(0,l.jsx)(eV.RM,{className:(0,eU.Z)("w-[24px]")}):(null==e?void 0:e.key)==="connectCanva"?(0,l.jsx)(eV.y_,{className:(0,eU.Z)("w-[24px]")}):(null==e?void 0:e.key)==="download"?(0,l.jsx)(eJ.Z,{size:20}):null,n((null===eG.Oz||void 0===eG.Oz?void 0:eG.Oz[(null==e?void 0:e.key)||"generate"])||(null==e?void 0:e.value)||"")]})},null==e?void 0:e.key)),(null==s?void 0:s.length)>1&&(0,l.jsx)(ey.VD,{})]}):null},eW=e=>{let{noteId:t,notePPTCacheData:r}=e,n=(0,p.useLocale)();return!(0,L.ZP)(e=>e.isLogin)||!["en","ja","ko","zh-hant"].includes(null==n?void 0:n.toLocaleLowerCase())||(0,eR.s2)()?null:(0,l.jsx)(eX,{noteId:t,notePPTCacheData:r})},e$=function(){let e=(0,p.useTranslations)(),t=(0,s.Z)(e=>e.noteData),[r,n]=(0,i.useState)(!1),[a,o]=(0,i.useState)((null==t?void 0:t.title)||"");return((0,i.useEffect)(()=>{o((null==t?void 0:t.title)||"")},[null==t?void 0:t.title]),r)?(0,l.jsx)("input",{type:"text",value:a,onChange:e=>o(e.target.value),onBlur:()=>{n(!1),t&&a!==t.title&&(0,d.SB)({...t,other:{...t.other,aICreateImageList:f.Z.getState().createImgList},title:a}).then(e=>{200===e.status&&s.Z.getState().setNoteDataItem({title:a})})},onKeyDown:e=>{"Enter"===e.key&&e.currentTarget.blur()},autoFocus:!0,className:"max-w-[50%] text-lg font-semibold w-full bg-transparent border-transparent outline-none",placeholder:e("note.editor")}):(0,l.jsx)("h1",{className:"max-w-[50%] text-lg font-semibold dark:text-[#EDF3FC] overflow-hidden overflow-ellipsis whitespace-nowrap",onClick:()=>n(!0),children:a||e("note.editor")})},eK=r(43378),eY=function(e){let{open:t,onOpenChange:r,noteId:n}=e,a=(0,p.useTranslations)(),i=(0,j.useRouter)();return(0,l.jsx)(eK.Vq,{open:t,onOpenChange:r,children:(0,l.jsxs)(eK.cZ,{"aria-describedby":void 0,children:[(0,l.jsx)(eK.fK,{children:(0,l.jsx)(eK.$N,{children:a("note.confirm_delete")})}),(0,l.jsx)(eK.a7,{children:(0,l.jsx)("p",{children:a("note.confirm_delete_desc")})}),(0,l.jsxs)(eK.cN,{children:[(0,l.jsx)(em.z,{variant:"secondary",onClick:()=>r(!1),children:a("cancel")}),(0,l.jsx)(em.z,{variant:"destructive",onClick:()=>{(0,d.f_)(n).then(()=>{r(!1),i.replace("/")})},children:a("confirm")})]})]})})},eQ=r(89039),e0=r(75963),e1=r(87921),e2=r(84660),e5=r(69996);r(59928);var e3=r(69683),e4=r(11227);r(49905),(n=a||(a={}))[n.width=595.28]="width",n[n.height=841.89]="height";var e6=r(90515),e9=r(45360),e7=r(18881),e8=r(48482),te=r(7363),tt=r(22313),tr=r(77998),tn=r(35030),ta=e=>{let{noteId:t,notePPTCacheData:r}=e,n=(0,p.useLocale)(),a=(0,eq.Z)(),{isShowPptModal:o,setIsShowPptModal:s,setUiModalType:d,setBesinessId:c,setBusinessType:u,setPptBtnEntrance:h,showPpt:m,setShowPpt:g,isGeneratedSuccess:x,setIsGeneratedSuccess:f,setPreviewPPTData:v}=(0,e7.Z)(),{setPptModalType:C,setGeneratePptProgress:b,setPptStatus:w}=(0,tr.Z)(),y=(0,L.ZP)(e=>e.isLogin),j=(0,i.useCallback)(async()=>{!(0,eR.s2)()&&n&&t&&(h([]),a.fetchLastPpt({threadId:t,businessType:eG.LB.NOTE}))},[n,t]);return(0,i.useEffect)(()=>{f(!1),j();let e=(0,e8.E)("showppt",location.href);g(e||""),"1"===e&&r&&r.status>0&&(s(!0),d("preview"),u(eG.LB.NOTE),c(t),b(100),v(r),C("preview"),w("preview"))},[t,y,r]),(0,l.jsxs)(l.Fragment,{children:[(0,eR.s2)()?null:(0,l.jsx)(tn.Z,{threadId:t,businessType:eG.LB.NOTE}),"1"===m||o?(0,eR.s2)()?(0,l.jsx)(te.Z,{shortId:t}):(0,l.jsx)(tt.Z,{shortId:t,businessType:eG.LB.NOTE}):null]})},tl=r(64105),ti=e=>{var t,r;let{lastSave:n,noteId:a,editor:o,openMindMapModal:c}=e,u=(0,p.useTranslations)(),{isMobile:m}=(0,H.b)(),{isOpen:g,onOpen:x,onClose:f}=(0,N.q)(),{noteData:v}=(0,s.Z)(),{handleSaveNotion:C}=(0,eQ.H)({onSuccess:e=>{ew.Z.close(),ew.Z.show({content:(0,l.jsx)(e5.E,{children:(0,l.jsxs)("div",{className:"flex items-center gap-20",children:[(0,l.jsxs)("span",{children:[" ",u("notion.save_success")]}),(0,l.jsx)("div",{className:"flex items-center border-1  text-[#0080FF] bg-[#fff] border-[#0694FF] cursor-pointer dark:bg-[#202531] py-[4px] px-[12px] rounded-[8px] ",onClick:()=>{window.open(e.data.url)},children:u("open")})," "]})}),duration:6e3,type:"custom"})},onFailed:e=>{ew.Z.error("".concat(u("notion.save_failed"),":").concat(e),6e3)}});(0,e0.useRouter)();let b=(0,p.useLocale)(),{exportToDriveAndDocs:w}=(0,e1.IE)({onSuccess:e=>{ew.Z.close(),ew.Z.show({content:(0,l.jsx)(e5.E,{children:(0,l.jsxs)("div",{className:"flex items-center gap-20",children:[(0,l.jsxs)("span",{children:[" ",u("save_success")]}),(0,l.jsx)("div",{className:"flex items-center border-1  text-[#0080FF] bg-[#fff] border-[#0694FF] cursor-pointer dark:bg-[#202531] py-[4px] px-[12px] rounded-[8px] ",onClick:()=>{window.open(e)},children:u("open")})," "]})}),duration:5e3,type:"custom"})},onError:e=>{ew.Z.close(),ew.Z.error("".concat(u("ppt.import_ppt_failed"),"  ").concat(e))}}),y=(0,eq.Z)(),{isGeneratedSuccess:j,setIsGeneratedSuccess:k}=(0,e7.Z)(),_=(0,L.ZP)(e=>e.isLogin),[S,F]=(0,i.useState)(),T=(0,i.useCallback)(async()=>{if((0,eR.s2)()||!a)return;let e=await (0,e9.OQ)({thread_id:a,businessType:eG.LB.NOTE});if(e&&(null==e?void 0:e.status)){F(e);let t=e7.Z.getState().allPptGenerateData;e7.Z.getState().setAllPptGenerateData({...t,[a]:e})}},[a]);(0,i.useEffect)(()=>{_&&a&&(k(!1),T())},[_,a]),(0,i.useEffect)(()=>{a&&j&&a===e7.Z.getState().businessId&&(y.pollLastPpt({threadId:a,businessType:eG.LB.NOTE,onPollingResult:e=>{e&&F(e)}}).then(e=>{F(e)}),k(!1))},[j,a]);let E=(0,i.useMemo)(()=>{let e=Math.floor((Date.now()-n)/1e3);if(e<60)return u("note.times.just");let t=Math.floor(e/60);if(t<60)return u("note.times.minutes",{minutes:t});let r=Math.floor(t/60);if(r<24)return u("note.times.hours",{hours:r});let a=Math.floor(r/24);if(a<7)return u("note.times.days",{days:a});let l=Math.floor(a/7);if(l<4)return u("note.times.weeks",{weeks:l});let i=Math.floor(a/30);return i<12?u("note.times.months",{months:i}):u("note.times.years",{years:Math.floor(i/12)})},[n]),Z=async()=>{if(o){var e;let t=(0,e6.M$)(o.storage.markdown.get());t=(t=t.replace(/(\/s3\/view\?)/g,"/s3/view.svg?")).replace(/(\[.*?\]\(\d+\))/g,"[$1]"),ew.Z.show({content:(0,l.jsx)(e5.E,{children:u("saving_to_notion")}),duration:99999,type:"custom"}),C({content:t,sources:(null==v?void 0:null===(e=v.other)||void 0===e?void 0:e.sources)||[],title:null==v?void 0:v.title,threadId:null==v?void 0:v.thread_id})}},I=async()=>{if(o){let e=(0,e6.M$)(o.storage.markdown.get()).replaceAll("\\[","[");e=(e=(e=e.replace(/(\/s3\/view\?)/g,"/s3/view.svg?")).replace(/(\[.*?\]\(\d+\))/g,"[$1]")).replace(/(\d+)\.\s+/g,"$1."),ew.Z.show({content:(0,l.jsx)(e5.E,{children:u("topic.creating")}),duration:99999,type:"custom"}),await w((null==v?void 0:v.title)||"","",(0,e6.Hd)((0,e6.kn)(o.getHTML().replace(/(\/s3\/view\?)/g,"/s3/view.svg?").replace(/<a[^>]*href="(\d+)"[^>]*>(.*?)<\/a>/g,(e,t,r)=>'<a href="'.concat(t,'">').concat(r,"</a>"))))),(0,eD.fk)(eI.U.DOCS_SAVE_TO_GOOGLE,{noteId:null==v?void 0:v.note_id},!0)}},D=async e=>{if(o){(0,eD.fk)(eI.U.DOCS_EXPORT_FILE_START,{noteId:null==v?void 0:v.note_id,format:e,url:location.href},!0);let a=(0,e6.M$)(o.storage.markdown.get());switch(a=(a=a.replace(/(\/s3\/view\?)/g,"/s3/view.svg?")).replace(/(\[.*?\]\(\d+\))/g,"[$1]"),ew.Z.show({content:(0,l.jsx)(e5.E,{children:u("topic.creating")}),duration:99999,type:"custom"}),e){case"DOCX":var t,r,n;(t=(0,e6.Hd)((0,e6.kn)(o.getHTML().replace(/(\/s3\/view\?)/g,"/s3/view.svg?").replace(/<a[^>]*href="(\d+)"[^>]*>(.*?)<\/a>/g,(e,t,r)=>'<a href="'.concat(t,'">').concat(r,"</a>")),600)),r=(null==v?void 0:v.title)||"document",n=b||"en",new Promise(e=>{let a=document.createElement("div");a.innerHTML=t;let l="\n    body {\n      font-family: ".concat((()=>{let e=n.toLowerCase();return e.includes("ja")?"Noto Sans JP":e.includes("ko")?"Noto Sans Korean":e.includes("tw")||e.includes("hant")?"Noto Sans Traditional Chinese":"system-ui"})(),', -apple-system, BlinkMacSystemFont,\n          "Microsoft YaHei", "PingFang SC", "Segoe UI", Roboto, "Helvetica Neue",\n          Arial, "Noto Sans", "Source Han Sans SC", sans-serif;\n    }\n    table {\n      border-collapse: collapse !important;\n      width: 100%;\n      margin: 10px 0;\n    }\n    table, th, td {\n      border: 1px solid #000000 !important;\n      padding: 8px;\n    }\n    th {\n      background-color: #f2f2f2;\n    }\n      img{\n      max-width: 200px;\n      }\n  '),i=(function(e,t){let r=document.createElement("div");r.innerHTML=e;let n=(()=>{let e=t.toLowerCase();return e.includes("ja")?"Noto Sans JP":e.includes("ko")?"Noto Sans Korean":e.includes("tw")||e.includes("hant")?"Noto Sans Traditional Chinese":"system-ui, -apple-system, BlinkMacSystemFont, 'Microsoft YaHei', 'PingFang SC', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Source Han Sans SC', sans-serif"})();return["h1","h2","h3","h4","h5","h6"].forEach(e=>{Array.from(r.getElementsByTagName(e)).forEach(e=>{let t=e.getAttribute("style")||"",r={};t.split(";").forEach(e=>{let[t,n]=e.split(":").map(e=>e.trim());t&&n&&(r[t.toLowerCase()]=n)}),r["font-family"]&&r["font-family"].includes(n.split(",")[0])||(r["font-family"]=n),r["font-weight"]||(r["font-weight"]="bold"),r["line-height"]||(r["line-height"]="1.5");let a=Object.entries(r).map(e=>{let[t,r]=e;return"".concat(t,": ").concat(r)}).join("; ");e.setAttribute("style",a)})}),r.innerHTML})(a.innerHTML,n).replace(/[\u0100-\uffff]/g,e=>"&#".concat(e.charCodeAt(0),";")).replace(/<strong>/g,"<b>").replace(/<\/strong>/g,"</b>").replace(/<mark/g,"<span").replace(/<\/mark>/g,"</span>").replace(/<\/ol><ol.*?>/g,"").replace(/<\/ul><ul.*?>/g,""),o='<!DOCTYPE html>\n      <html lang="'.concat(n,'">\n      <head>\n        <meta charset="UTF-8">\n        <style type="text/css">').concat(l,"</style> \n      </head>\n      <body>\n        <div>").concat(i,"</div>\n      </body>\n      </html>");(0,e3.m)(o,{margins:{top:1440}}).then(t=>{(0,e4.saveAs)(t,r+".docx"),e()})})).then(e=>{console.log(e),ew.Z.close()}).finally(()=>{ew.Z.close()});break;case"PDF":try{(0,d.t1)({file_type:e,html:(0,e6.Hd)((0,e6.kn)(o.getHTML().replace(/(\/s3\/view\?)/g,"/s3/view.svg?").replace(/<a[^>]*href="(\d+)"[^>]*>(.*?)<\/a>/g,(e,t,r)=>'<a href="'.concat(t,'">').concat(r,"</a>")))),lang:(null==b?void 0:b.toLocaleLowerCase().replace("-","_"))||"en"},t=>{(null==t?void 0:t.status)==="success"&&(0,eD.fk)(eI.U.DOCS_EXPORT_FILE_SUCCESS,{noteId:null==v?void 0:v.note_id,format:e,url:location.href},!0),ew.Z.close()},null==v?void 0:v.title)}catch(e){ew.Z.error(u("ppt.generate_failure_tip"))}break;case"MD":let i=new Blob([a],{type:"text/markdown"}),s=URL.createObjectURL(i),c=document.createElement("a");c.href=s,c.download="".concat((null==v?void 0:v.title)||"document",".md"),c.click(),URL.revokeObjectURL(s),ew.Z.close()}}};return(0,l.jsxs)(ez.Z,{children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center w-[80%]",children:[(0,l.jsx)(h.pn,{children:(0,l.jsxs)(h.u,{children:[(0,l.jsx)(h.aJ,{asChild:!0,children:(0,l.jsx)(em.z,{variant:"ghost",size:"icon",onClick:()=>{location.href="/library"},children:(0,l.jsx)(eM.Z,{className:"h-5 w-5"})})}),(0,l.jsx)(h._v,{align:"start",children:(0,l.jsx)("p",{children:u("drive.backDrive")})})]})}),(0,l.jsx)(e$,{})]}),(0,l.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-sm opacity-60 whitespace-nowrap",children:n&&"".concat(E)}),(0,l.jsxs)(ey.h_,{children:[(0,l.jsx)(ey.$F,{asChild:!0,children:(0,l.jsx)(em.z,{className:(0,eA.cn)("rounded-lg",!v&&"hidden"),variant:m?"ghost":"outline-primary",size:m?"icon-sm":void 0,children:(0,l.jsx)(eO.Z,{})})}),(0,l.jsxs)(ey.AW,{align:"end",className:"rounded-2xl p-3 z-[10001]",children:[(0,l.jsx)(eW,{noteId:a||"",notePPTCacheData:S}),(0,l.jsxs)(ey.Xi,{className:"cursor-pointer",onClick:()=>{let e=(null==o?void 0:o.getText())||"";s.Z.getState().setMindmapContent(e),s.Z.getState().setmindmapType("note"),setTimeout(()=>{c()},100),(0,eD.fk)(eI.U.DOCS_CREATE_MINDMAP,{noteId:null==v?void 0:v.note_id},!0)},children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.9338 3.41667C15.5747 3.41667 15.2836 3.70775 15.2836 4.06682C15.2836 4.4259 15.5747 4.71698 15.9338 4.71698C16.2928 4.71698 16.5839 4.4259 16.5839 4.06682C16.5839 3.70775 16.2928 3.41667 15.9338 3.41667ZM13.771 3.23431C14.1055 2.36607 14.9477 1.75 15.9338 1.75C17.2133 1.75 18.2506 2.78728 18.2506 4.06682C18.2506 5.34637 17.2133 6.38365 15.9338 6.38365C14.9483 6.38365 14.1066 5.7684 13.7717 4.90108C13.412 4.90303 13.1365 4.90906 12.9083 4.92771C12.5887 4.95381 12.4358 5.00043 12.3349 5.05187C12.073 5.18531 11.86 5.39825 11.7266 5.66015C11.6752 5.76109 11.6285 5.914 11.6024 6.23353C11.5755 6.56279 11.5749 6.99033 11.5749 7.6272V9.16745L13.7713 9.16745C14.106 8.29964 14.948 7.68396 15.9338 7.68396C17.2133 7.68396 18.2506 8.72124 18.2506 10.0008C18.2506 11.2803 17.2133 12.3176 15.9338 12.3176C14.948 12.3176 14.106 11.7019 13.7713 10.8341H11.5749V12.3744C11.5749 13.0112 11.5755 13.4388 11.6024 13.768C11.6285 14.0876 11.6752 14.2405 11.7266 14.3414C11.86 14.6033 12.073 14.8163 12.3349 14.9497C12.4358 15.0011 12.5887 15.0478 12.9083 15.0739C13.1365 15.0925 13.412 15.0985 13.7717 15.1005C14.1066 14.2332 14.9483 13.6179 15.9338 13.6179C17.2133 13.6179 18.2506 14.6552 18.2506 15.9348C18.2506 17.2143 17.2133 18.2516 15.9338 18.2516C14.9477 18.2516 14.1055 17.6355 13.771 16.7673C13.391 16.7653 13.0591 16.7584 12.7725 16.735C12.3499 16.7005 11.9533 16.6258 11.5782 16.4347C11.0027 16.1415 10.5348 15.6736 10.2416 15.0981C10.0505 14.723 9.97584 14.3264 9.94131 13.9038C9.9082 13.4986 9.90821 13.0025 9.90822 12.4082V10.8341H7.86616L7.86616 14.4773C7.86618 14.8007 7.86619 15.0842 7.85012 15.3197C7.83311 15.569 7.79534 15.8248 7.68981 16.0796C7.45466 16.6473 7.00364 17.0983 6.43595 17.3335C6.18117 17.439 5.92533 17.4768 5.67602 17.4938C5.44049 17.5099 5.15699 17.5098 4.8336 17.5098H4.78159C4.4582 17.5098 4.1747 17.5099 3.93917 17.4938C3.68986 17.4768 3.43401 17.439 3.17924 17.3335C2.61155 17.0983 2.16053 16.6473 1.92538 16.0796C1.81985 15.8248 1.78208 15.569 1.76507 15.3197C1.749 15.0842 1.74901 14.8006 1.74902 14.4773L1.74902 5.52431C1.74901 5.20093 1.749 4.91742 1.76507 4.68189C1.78208 4.43258 1.81985 4.17674 1.92538 3.92196C2.16053 3.35427 2.61155 2.90325 3.17924 2.6681C3.43401 2.56257 3.68986 2.5248 3.93917 2.50779C4.1747 2.49172 4.4582 2.49173 4.78159 2.49175H4.8336C5.15698 2.49173 5.44049 2.49172 5.67602 2.50779C5.92533 2.5248 6.18117 2.56257 6.43595 2.6681C7.00364 2.90325 7.45466 3.35427 7.68981 3.92196C7.79534 4.17673 7.8331 4.43258 7.85012 4.68189C7.86619 4.91742 7.86618 5.20092 7.86616 5.52431L7.86616 9.16745H9.90822V7.59336C9.90821 6.99903 9.9082 6.50301 9.94131 6.09781C9.97584 5.67521 10.0505 5.27856 10.2416 4.9035C10.5348 4.32799 11.0027 3.86009 11.5782 3.56686C11.9533 3.37575 12.3499 3.3011 12.7725 3.26658C13.0591 3.24316 13.391 3.23631 13.771 3.23431ZM6.1995 5.55032C6.1995 5.1933 6.19905 4.96728 6.18731 4.79534C6.17609 4.63089 6.1574 4.57761 6.15001 4.55976C6.08402 4.40046 5.95745 4.27389 5.79814 4.2079C5.7803 4.20051 5.72702 4.18182 5.56257 4.1706C5.39063 4.15886 5.16461 4.15841 4.80759 4.15841C4.45058 4.15841 4.22456 4.15886 4.05262 4.1706C3.88817 4.18182 3.83489 4.20051 3.81704 4.2079C3.65774 4.27389 3.53117 4.40046 3.46518 4.55977C3.45779 4.57761 3.43909 4.63089 3.42787 4.79534C3.41614 4.96728 3.41569 5.1933 3.41569 5.55032L3.41569 14.4513C3.41569 14.8083 3.41614 15.0343 3.42787 15.2062C3.43909 15.3707 3.45779 15.424 3.46518 15.4418C3.53117 15.6011 3.65774 15.7277 3.81704 15.7937C3.83489 15.8011 3.88817 15.8198 4.05262 15.831C4.22456 15.8427 4.45058 15.8432 4.80759 15.8432C5.16461 15.8432 5.39063 15.8427 5.56257 15.831C5.72702 15.8198 5.7803 15.8011 5.79814 15.7937C5.95745 15.7277 6.08402 15.6011 6.15001 15.4418C6.1574 15.424 6.17609 15.3707 6.18731 15.2062C6.19905 15.0343 6.1995 14.8083 6.1995 14.4513V5.55032ZM15.9338 9.35063C15.5747 9.35063 15.2836 9.64172 15.2836 10.0008C15.2836 10.3599 15.5747 10.6509 15.9338 10.6509C16.2928 10.6509 16.5839 10.3599 16.5839 10.0008C16.5839 9.64171 16.2928 9.35063 15.9338 9.35063ZM15.9338 15.2846C15.5747 15.2846 15.2836 15.5757 15.2836 15.9348C15.2836 16.2938 15.5747 16.5849 15.9338 16.5849C16.2928 16.5849 16.5839 16.2938 16.5839 15.9348C16.5839 15.5757 16.2928 15.2846 15.9338 15.2846Z",fill:"currentColor"})})," ",(null==v?void 0:null===(r=v.other)||void 0===r?void 0:null===(t=r.mindmapConfig)||void 0===t?void 0:t.layout)?u("look_mindmap"):u("note.generating_midmap")]}),(0,l.jsxs)(ey.Xi,{className:"cursor-pointer",onClick:Z,children:[(0,l.jsx)(eL.oDT,{}),u("notion.save_to_notion")]}),(0,l.jsxs)(ey.Xi,{className:"cursor-pointer",onClick:I,children:[(0,l.jsx)(e2.X,{}),u("save_google_docs")]}),(0,l.jsxs)(ey.Ph,{children:[(0,l.jsxs)(ey.kt,{children:[(0,l.jsx)(eP.Z,{className:"mr-2 h-4 w-4"}),(0,l.jsx)("span",{children:u("download.label")})]}),(0,l.jsxs)(ey.TG,{children:[(0,l.jsx)(ey.Xi,{onClick:()=>D("DOCX"),children:(0,l.jsx)("span",{children:u("download_word")})}),(0,l.jsx)(ey.Xi,{onClick:()=>D("PDF"),children:(0,l.jsx)("span",{children:u("download_pdf")})}),(0,l.jsx)(ey.Xi,{onClick:()=>D("MD"),children:(0,l.jsx)("span",{children:u("download_md")})})]})]}),(0,l.jsx)(ey.VD,{}),(0,l.jsxs)(ey.Xi,{className:"text-red-400 cursor-pointer",onClick:()=>{x(),(0,eD.fk)(eI.U.DOCS_DELETE,{id:null==v?void 0:v.note_id},!0)},children:[(0,l.jsx)(eB.vW,{className:"w-5 h-5"}),u("note.delete_note")]})]})]}),(0,l.jsx)(tl.Z,{isOpen:!1})]}),(0,l.jsx)(eY,{open:g,onOpenChange:f,noteId:a||""}),["en","ja","ko","zh-hant"].includes(null==b?void 0:b.toLocaleLowerCase())?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(ta,{noteId:a||"",notePPTCacheData:S})}):null]})},to=r(25794),ts=r(60635),td=r(13263);let tc=e=>{let{open:t,onClose:r,onInsertMindmap:n}=e,a=(0,p.useTranslations)(),o=(0,p.useLocale)(),{isDark:d}=(0,Z.Z)(),c=(0,i.useRef)(null),u=(0,i.useRef)(null),h=(0,i.useRef)(void 0);(0,i.useEffect)(()=>{let e=async e=>{var t,l,i,o,d,c,p,m,g,x,f,v,C,b,w;if(e.data.type){if("mindmap:init"===e.data.type){let{anonymousToken:e}=L.ZP.getState();null===(i=u.current)||void 0===i||null===(l=i.contentWindow)||void 0===l||l.postMessage({type:"mindmap:init",value:{tokens:{login:(0,to.Nh)(),anonymous:e,visitor:(0,to.Kd)()},options:{canEdit:!0,mode:s.Z.getState().mindmapType||"generator",content:s.Z.getState().mindmapContent,note_id:null===(t=s.Z.getState().noteData)||void 0===t?void 0:t.note_id}}},"*")}"mindmap:insertData"===e.data.type&&(h.current=e.data.value,"note"===s.Z.getState().mindmapType&&(s.Z.getState().setNoteData({...s.Z.getState().noteData,other:{...null===(o=s.Z.getState().noteData)||void 0===o?void 0:o.other,mindmapConfig:{layout:(null===(d=h.current)||void 0===d?void 0:d.layout)||"",theme:(null===(c=h.current)||void 0===c?void 0:c.theme)||""}}}),await (0,td.Qx)({note_id:(null===(p=s.Z.getState().noteData)||void 0===p?void 0:p.note_id)||"",seq:(null===(m=h.current)||void 0===m?void 0:m.seq)||void 0}),await (0,td.sI)({type:(null===(g=h.current)||void 0===g?void 0:g.layout)||"",note_id:(null===(x=s.Z.getState().noteData)||void 0===x?void 0:x.note_id)||"",content:{config:{layout:(null===(f=h.current)||void 0===f?void 0:f.layout)||"",theme:(null===(v=h.current)||void 0===v?void 0:v.theme)||""}}})),n(e.data.value),s.Z.getState().setmindmapType("generator")),"mindmap:data"===e.data.type?(h.current=e.data.value,"note"===s.Z.getState().mindmapType&&s.Z.getState().setNoteData({...s.Z.getState().noteData,other:{...null===(C=s.Z.getState().noteData)||void 0===C?void 0:C.other,mindmapConfig:{layout:(null===(b=h.current)||void 0===b?void 0:b.layout)||"",theme:(null===(w=h.current)||void 0===w?void 0:w.theme)||""}}}),r()):"mindmap:themeChange"===e.data.type?(0,eD.fk)(eI.U.MINDMAP_THEME_CHANGE,{value:e.data.value},!0):"mindmap:layoutChange"===e.data.type?(0,eD.fk)(eI.U.MINDMAP_LAYOUT_CHANGE,{value:e.data.value},!0):"mindmap:setting"===e.data.type?(0,eD.fk)(eI.U.MINDMAP_SETTING_CLICK,{value:e.data.value},!0):"mindmap:retry"===e.data.type?(0,eD.fk)(eI.U.MINDMAP_RETRY,{},!0):"mindmap:download"===e.data.type&&(0,ts.DB)({type:"image/png",filename:"".concat(a("mindmap"),".png"),data:e.data.value.replace("data:image/png;base64,","")})}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);let m=function(){var e,t;let n=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null===(t=u.current)||void 0===t||null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"mindmap:requestData"},"*");let a=window.setTimeout(async()=>{if(h.current&&"note"===s.Z.getState().mindmapType)try{var e,t,l,i,o,d,c,u,p;await (0,td.Qx)({note_id:(null===(e=s.Z.getState().noteData)||void 0===e?void 0:e.note_id)||"",seq:(null===(t=h.current)||void 0===t?void 0:t.seq)||void 0}),await (0,td.sI)({type:(null===(l=h.current)||void 0===l?void 0:l.layout)||"",note_id:(null===(i=s.Z.getState().noteData)||void 0===i?void 0:i.note_id)||"",content:{config:{layout:(null===(o=h.current)||void 0===o?void 0:o.layout)||"",theme:(null===(d=h.current)||void 0===d?void 0:d.theme)||""}}}),s.Z.getState().setNoteData({...s.Z.getState().noteData,other:{...null===(c=s.Z.getState().noteData)||void 0===c?void 0:c.other,mindmapConfig:{layout:(null===(u=h.current)||void 0===u?void 0:u.layout)||"",theme:(null===(p=h.current)||void 0===p?void 0:p.theme)||""}}})}catch(e){}s.Z.getState().setmindmapType("generator"),n&&r(),window.clearTimeout(a)},200)};return(0,l.jsx)(eK.Vq,{open:t,onOpenChange:()=>{m()},children:(0,l.jsxs)(eK.cZ,{className:"max-w-screen-xl overflow-hidden",ref:c,onOpenAutoFocus:e=>e.preventDefault(),children:[(0,l.jsx)(eK.fK,{className:"relative z-10 pointer-events-none",children:(0,l.jsx)(eK.$N,{children:a("mindmap")})}),(0,l.jsx)("iframe",{ref:u,allow:"clipboard-write",className:"-mt-[3.75rem] flex-1 min-h-[80vh] w-full",src:(()=>{let e=new URL("https://mindmap.felo.ai");return e.searchParams.append("v","2"),e.searchParams.append("locale",o),e.searchParams.append("theme",d?"dark":"light"),e.toString()})(),style:{visibility:"hidden"},onLoad:()=>u.current&&(u.current.style.visibility="visible")})]})})};var tu=r(36578);let th=M.hj.create({name:"aiWriting",addOptions:()=>({HTMLAttributes:{}}),addStorage:()=>({isGenerating:!1,originalText:"",generatedContent:"",selectionRange:{from:0,to:0},generatedContentPos:{from:0,to:0}}),addCommands(){return{startAIWriting:()=>e=>{let{editor:t}=e,{from:r,to:n}=t.state.selection;return this.storage.selectionRange={from:r,to:n},this.storage.originalText=t.state.doc.textBetween(r,n),this.storage.isGenerating=!0,!0},cancelAIWriting:()=>e=>{let{editor:t}=e;return this.storage.isGenerating=!1,!0},acceptAIWriting:()=>e=>{let{editor:t}=e,r=this.storage.selectionRange,n=this.storage.generatedContentPos,a=this.storage.generatedContent;if(r&&a)try{let e=t.state.tr;e.delete(r.from,r.to),t.view.dispatch(e),(e=t.state.tr).insertText(a,r.from),t.view.dispatch(e),n&&n.from!==n.to&&((e=t.state.tr).delete(n.from,n.to),t.view.dispatch(e))}catch(e){}return this.storage.isGenerating=!1,!0},rejectAIWriting:()=>e=>{let{editor:t}=e;return this.storage.isGenerating=!1,!0},insertAIWritingBelow:()=>e=>{let{editor:t}=e;return this.storage.isGenerating=!1,!0},retryAIWriting:()=>e=>{let{editor:t}=e,r=this.storage.generatedContentPos;if(r&&r.from!==r.to)try{let e=t.state.tr;e.delete(r.from,r.to),t.view.dispatch(e)}catch(e){}return!0},setGeneratedContent:e=>t=>{let{editor:r}=t;return this.storage.generatedContent=e,!0},cleanupAIWriting:()=>e=>{let{editor:t}=e,r=this.storage.generatedContentPos;if(r&&r.from!==r.to)try{let e=t.state.tr;e.delete(r.from,r.to),t.view.dispatch(e)}catch(e){}return this.storage.isGenerating=!1,!0}}}}),tp=async e=>{let t=await fetch(e);return await t.blob()},tm=e=>["image/png","image/jpeg","image/jpg"].includes(e.toLowerCase());function tg(){let e=(0,j.useRouter)(),t=(0,p.useTranslations)();(0,p.useLocale)();let r=(0,L._n)(),{isOpen:n,onOpen:a,onClose:o}=(0,N.q)(),c=(0,L.ZP)(e=>e.anonymousToken),u=(0,i.useMemo)(()=>Array.isArray(e.query.id)?e.query.id[0]:e.query.id,[e.query.id]),[h,m]=(0,i.useState)([]);(0,E.V)();let x=async e=>{if(!tm(e.type)){ew.Z.error(t("note.format.img_type_error"));return}if(e.size>5242880){ew.Z.error(t("note.format.img_limit_size",{size:"5"}));return}try{let t=await (0,d.Jd)(e,(null==k?void 0:k.note_id)||"");t.data&&(null==f||f.commands.insertImage({src:t.data,alt:"image",title:""}))}catch(e){console.error("Upload error:",e),ew.Z.error(t("note.format.upload_failed"))}},f=(0,F.jE)({extensions:[T.Vg.configure({image:!1,blockMenu:!1}),T.X6,B.configure({onUpdate:m}),e_.Z,eN.I.configure({types:[e_.Z.name]}),eS.Z.configure({types:["heading","paragraph"]}),eF.A.configure({types:["listItem","paragraph"],minLevel:0,maxLevel:8}),eT.b,eE.Z,eZ.d.configure({inline:!0,allowBase64:!0}),tu.ZP.configure({HTMLAttributes:{class:"bg-blue-100 dark:bg-blue-800/30"}}),th],content:"",enablePasteRules:!0,autofocus:!1,parseOptions:{preserveWhitespace:"full"},editorProps:{handleScrollToSelection:()=>!1,handleDOMEvents:{scroll:()=>!0},handlePaste:(e,t)=>{var r,n;let a=Array.from((null===(r=t.clipboardData)||void 0===r?void 0:r.items)||[]);if(a.some(e=>-1!==e.type.indexOf("image")))return t.preventDefault(),a.forEach(e=>{if(0===e.type.indexOf("image")){let t=e.getAsFile();t&&x(t)}}),!0;let l=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");if(l){t.preventDefault();let e=document.createElement("div");e.innerHTML=l,e.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(e=>{e.removeAttribute("id")});let r=e.innerHTML;return null==f||f.commands.insertContent(r),!0}return!1},handleDrop:(e,t)=>{var r;let n=null===(r=t.dataTransfer)||void 0===r?void 0:r.files;if(!(null==n?void 0:n.length))return!1;let a=Array.from(n).filter(e=>tm(e.type));return!!a.length&&(t.preventDefault(),a.forEach(x),!0)},transformPastedHTML:e=>e,transformPastedText:e=>e},onUpdate:()=>{}}),v=(0,i.useRef)(null);v.current=f;let{queryNoteById:C,noteData:k,error:Z,showSourceList:I,showSource:M,setShowSource:O,setShowSourceList:P}=(0,s.Z)();(0,i.useEffect)(()=>{c&&void 0!==r&&u&&C(u)},[u,r,c]);let[z,R]=(0,i.useState)();(0,i.useEffect)(()=>{k&&R(new Date(k.gmt_modified).getTime())},[k]),(0,i.useEffect)(()=>()=>{s.Z.getState().setNoteData(void 0)},[]);let H=async e=>{if(!v.current)return;o();let{noteData:r}=s.Z.getState(),n=await tp(e.png);if(n.size>5242880){ew.Z.error(t("note.format.img_limit_size",{size:"5"}));return}try{let e=await (0,d.Jd)(n,(null==r?void 0:r.note_id)||""),t=v.current;e.data&&(null==t||t.commands.insertImage({width:800,src:e.data,alt:"image",title:""}))}catch(e){console.error("Upload error:",e)}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(_(),{children:[(0,l.jsx)("title",{children:(null==k?void 0:k.title)||"Felo Docs"}),(0,l.jsx)("script",{src:"https://aippt-international-api-static.aippt.cn/aippt-iframe-sdk.js",async:!0,defer:!0}),(0,l.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,l.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"}),(0,l.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Noto+Sans+JP:wght@100..900&family=Noto+Sans+KR:wght@100..900&display=swap",rel:"stylesheet"})]}),(0,l.jsx)(ti,{editor:f,lastSave:z,noteId:u,openMindMapModal:a}),(0,l.jsxs)("section",{className:"mx-auto w-full ",style:{height:"calc(100vh - 137px)"},id:"docsContainer",children:[(()=>{if(Z){let e="";return"server_error"===Z?e=t("error.server_error"):"unauthorized"===Z?e=t("error.unauthorized"):"not_found"===Z&&(e=t("error.not_found")),(0,l.jsxs)("div",{className:"my-8 text-center",children:[(0,l.jsx)(w.Z,{className:"h-12 w-12 mx-auto mb-4 text-red-400"}),(0,l.jsx)("h2",{className:"text-xl",children:e})]})}return k?null:(0,l.jsxs)("div",{className:"max-w-3xl p-8",children:[(0,l.jsx)("div",{className:"animate-pulse rounded-md h-12 w-96 max-w-full bg-theme-bg-100 dark:bg-theme-bg-dark-100 mb-4"}),(0,l.jsx)("div",{className:"animate-pulse rounded-md h-5 w-[80%] bg-theme-bg-100 dark:bg-theme-bg-dark-100 mb-4"}),(0,l.jsx)("div",{className:"animate-pulse rounded-md h-5 w-[60%] bg-theme-bg-100 dark:bg-theme-bg-dark-100 mb-4"}),(0,l.jsx)("div",{className:"animate-pulse rounded-md h-5 w-[40%] bg-theme-bg-100 dark:bg-theme-bg-dark-100 mb-4"}),(0,l.jsx)("div",{className:"animate-pulse rounded-md h-5 bg-theme-bg-100 dark:bg-theme-bg-dark-100 mb-4"}),(0,l.jsx)("div",{className:"animate-pulse rounded-md h-5 bg-theme-bg-100 dark:bg-theme-bg-dark-100 mb-4"}),(0,l.jsx)("div",{className:"animate-pulse rounded-md h-5 bg-theme-bg-100 dark:bg-theme-bg-dark-100 mb-4"}),(0,l.jsx)("div",{className:"animate-pulse rounded-md h-5 bg-theme-bg-100 dark:bg-theme-bg-dark-100 mb-4"})]})})(),f&&k&&(0,l.jsxs)(g.K,{editor:f,children:[(0,l.jsx)(ek,{editor:f}),(0,l.jsxs)("div",{className:"flex h-full",children:[(0,l.jsx)(V,{toc:h}),(0,l.jsx)(F.kg,{editor:f,className:"flex-1 [&>div]:mx-auto [&>div]:max-w-screen-lg [&>div]:outline-none overflow-y-auto pt-16 p-16 searchDocs relative",children:(0,l.jsx)(b,{onSave:()=>{R(new Date().getTime())},openMindMapModal:a})})]})]})]}),(0,l.jsx)(D,{visible:M,closeDrawer:()=>O(!1),children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"py-4 px-6 flex-initial text-large font-semibold border-b border-slate-200 dark:border-[#6D7276] flex flex-col gap-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(y.Z,{})," ",t("sources")]}),(0,l.jsx)("div",{className:"text-sm font-normal",children:null==k?void 0:k.title})]}),(0,l.jsx)(S.o,{className:"p-6",children:(0,l.jsx)(A.F,{sources:I||[],canEdit:!1,isDone:!1,isAll:!0,isVisible:!0})})]})}),(0,l.jsx)(tc,{open:n,onClose:o,onInsertMindmap:H})]})}},87106:function(e,t,r){"use strict";r.d(t,{Ef:function(){return f},GK:function(){return c},P:function(){return d},RV:function(){return m},VN:function(){return s},Vk:function(){return C},WN:function(){return b},YX:function(){return u},ZR:function(){return v},_Z:function(){return p},hX:function(){return h},hi:function(){return g},qP:function(){return x}});var n=r(27976),a=r(52166),l=r(65819),i=r(13263),o=r(5517);let s=async e=>{try{let t=(0,a.a1)(),r=await (0,o.Z)("".concat(n.XJ,"/threads/templates/").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"".concat(t)}});if(!r.ok){let e=await r.json().catch(()=>({}));return{success:!1,error:e.message||"failed to get template",code:r.status,detail:e.detail}}let l=await r.json();return{success:!0,data:l}}catch(e){return{success:!1,error:e instanceof Error?e.message:"failed to get template",code:500}}},d=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t,r,l;let i=(0,a.a1)(),s=new URLSearchParams({system:(null===(t=e.system)||void 0===t||t).toString(),language:null!==(r=e.language)&&void 0!==r?r:"en",from_org:(null!==(l=null==e?void 0:e.from_org)&&void 0!==l&&l).toString()}),d=await (0,o.Z)("".concat(n.XJ,"/threads/templates?").concat(s),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"".concat(i)}});if(!d.ok){let e=await d.json().catch(()=>({}));return{success:!1,error:e.message||"failed to get templates",code:d.status}}let c=await d.json();return{success:!0,data:c}}catch(e){return{success:!1,error:e instanceof Error?e.message:"failed to get templates",code:500}}},c=async(e,t)=>{try{let r=(0,a.a1)(),l=await (0,o.Z)("".concat(n.XJ,"/threads/templates/").concat(e,"/plan"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"".concat(r)},body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));if(422===l.status)return{success:!1,error:e.message||"failed to validate params",code:l.status};return{success:!1,error:e.message||"failed to get template plan",code:l.status}}let i=await l.json();return{success:!0,data:i}}catch(e){return{success:!1,error:e instanceof Error?e.message:"failed to get template plan",code:500}}},u=async e=>{try{let t=(0,a.a1)(),r=await (0,o.Z)("".concat(n.XJ,"/threads/templates"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"".concat(t)},body:JSON.stringify(e)});if(!r.ok){let e=await r.json().catch(()=>({}));if(422===r.status)return{success:!1,error:e.message||"failed to validate params",code:r.status};return{success:!1,error:e.message||"failed to create template",code:r.status}}let l=await r.json();return{success:!0,data:l}}catch(e){return{success:!1,error:e instanceof Error?e.message:"failed to create template",code:500}}},h=async e=>{try{let t=(0,a.a1)(),r=await (0,o.Z)("".concat(n.XJ,"/threads/templates"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"".concat(t)},body:JSON.stringify({short_ids:e})});if(!r.ok){let e=await r.json().catch(()=>({}));if(422===r.status)return{success:!1,error:e.message||"failed to validate params",code:r.status};return{success:!1,error:e.message||"failed to delete templates",code:r.status}}return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"failed to delete templates",code:500}}},p=async e=>{try{let t=(0,a.a1)(),{short_id:r,...l}=e,i=await (0,o.Z)("".concat(n.XJ,"/threads/templates/").concat(r),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"".concat(t)},body:JSON.stringify(l)});if(!i.ok){let e=await i.json().catch(()=>({}));if(422===i.status)return{success:!1,error:e.message||"failed to validate params",code:i.status};return{success:!1,error:e.message||"failed to update template",code:i.status}}let s=await i.json();return{success:!0,data:s}}catch(e){return{success:!1,error:e instanceof Error?e.message:"failed to update template",code:500}}},m=async e=>{try{let t=(0,a.a1)(),r=await (0,o.Z)("".concat(n.XJ,"/threads/templates/generate"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"".concat(t)},body:JSON.stringify(e)});if(!r.ok){let e=await r.json().catch(()=>({}));if(422===r.status)return{success:!1,error:e.message||"failed to validate params",code:r.status};return{success:!1,error:e.message||"failed to generate template",code:r.status}}let l=await r.json();return{success:!0,data:l}}catch(e){return{success:!1,error:e instanceof Error?e.message:"failed to generate template",code:500}}},g=async e=>{try{let t=(0,a.a1)(),r=await (0,o.Z)("".concat(n.XJ,"/threads/templates/").concat(e,"/resources?"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"".concat(t)}});if(!r.ok){let e=await r.json().catch(()=>({}));return{success:!1,error:e.message||"failed to get template topic",code:r.status}}let l=await r.json();return{success:!0,data:l}}catch(e){return{success:!1,error:e instanceof Error?e.message:"failed to get templates",code:500}}},x=async e=>{var t,r,a;let s=(0,i.LP)();return(0,o.Z)("".concat(n.Ez,"/sharePermission/update"),{headers:{"Content-Type":"application/json",Authorization:"".concat(s)},body:JSON.stringify({business_id:e.agent_id,read_permission:e.read_permission,business_type:"AGENT",org_id:"PARTIAL_PUBLIC"===e.read_permission?null===(a=l.ZP.getState().userInfo)||void 0===a?void 0:null===(r=a.user_org_member)||void 0===r?void 0:null===(t=r.org)||void 0===t?void 0:t.org_id:null,access_emails:null==e?void 0:e.access_emails}),method:"POST"}).then(async e=>await e.json()).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e)})},f=async e=>{let{topic_short_id:t}=e,r=(0,i.LP)();return(0,o.Z)("".concat(n.XJ,"/threads/templates/").concat(t,"/org_shares"),{headers:{"Content-Type":"application/json",Authorization:"".concat(r)},method:"POST"}).then(async e=>!![200,204].includes(e.status)).catch(()=>!1)},v=async e=>{let{topic_short_id:t}=e,r=(0,i.LP)();return(0,o.Z)("".concat(n.XJ,"/threads/templates/").concat(t,"/org_shares"),{headers:{"Content-Type":"application/json",Authorization:"".concat(r)},method:"DELETE"}).then(async e=>!![200,204].includes(e.status)).catch(()=>!1)},C=async(e,t)=>{try{let r=(0,a.a1)(),l=await (0,o.Z)("".concat(n.XJ,"/threads/templates/render_info?lang=").concat(e,"&code=").concat(t),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"".concat(r)}});if(!l.ok)return{success:!1,code:500};let i=await l.json();return{success:!0,data:i}}catch(e){return{success:!1,code:500}}},b=async(e,t)=>{try{let r=(0,a.a1)(),l=await (0,o.Z)("".concat(n.XJ,"/threads/templates/").concat(e,"/save_user_tool_selections"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"".concat(r)},body:JSON.stringify({tools:t})});if(!l.ok){let e=await l.json().catch(()=>({}));return{success:!1,error:e.message||"failed to save tool selections",code:l.status,detail:e.detail}}return{success:!0,data:void 0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"failed to save tool selections",code:500}}}},66945:function(e,t,r){"use strict";r.d(t,{O:function(){return l}});var n=r(27976),a=r(52166);let l=e=>{let t=(0,a.a1)();return fetch("".concat(n.XJ,"/websearch/google?query=").concat(e),{method:"GET",headers:{Authorization:"".concat(t)}}).then(async e=>200!==e.status?Promise.reject(null):await e.json()).catch(e=>null)}},19583:function(e,t,r){"use strict";let n=(0,r(75910).Ue)(e=>({currentData:void 0,setCurrentData:t=>e({currentData:t}),clearCurrentData:()=>e({currentData:void 0})}));t.Z=n},73522:function(e,t,r){"use strict";let n=(0,r(75910).Ue)(e=>({isSaveLoading:!1,setIsSaveLoading:t=>e({isSaveLoading:t}),notionTemplateId:"",setNotionTemplateId:t=>e({notionTemplateId:t}),notionDirectories:[],setNotionDirectories:t=>e({notionDirectories:t})}));t.Z=n},92774:function(e,t,r){"use strict";var n=r(75910),a=r(34097),l=r(23083);let i=(0,n.Ue)((e,t)=>({editMessage:void 0,setEditMessage:t=>e(()=>({editMessage:t})),openMessageEditor:!1,setOpenMessageEditor:t=>e(()=>({openMessageEditor:t})),editMessageMarkdown:"",setEditMessageMarkdown:t=>e(()=>({editMessageMarkdown:t})),uploading:!1,setUploading:t=>e(()=>({uploading:t})),editThreadId:"",setEditThreadId:t=>e(()=>({editThreadId:t})),saveEdit:async(r,n,i)=>{let o=t();if(!o.editMessage)return;let s=o.editMessage,d=r.replace(/\\\[/g,"[").replace(/\\\]/g,"]");try{let t=await (0,a.x2)(s.id,{answer:d});e(e=>({editMessage:s?{...s,answer:t.answer,metadata:{...t.metadata}}:void 0})),l.Z.setState(e=>({threads:e.threads.map(e=>e.id===(null==s?void 0:s.id)?{...e,answer:t.answer,metadata:{...t.metadata}}:e)})),null==n||n(t)}catch(e){throw null==i||i(),e}},saveEditById:async(e,t,r,n,i)=>{if(!e)return;let o=t.replace(/\\\[/g,"[").replace(/\\\]/g,"]");try{let t=await (0,a.x2)(e,{answer:o,update_edit_time:i});l.Z.setState(r=>({threads:r.threads.map(r=>r.id===e?{...r,answer:t.answer,metadata:{...t.metadata}}:r)})),null==r||r(t)}catch(e){throw null==n||n(),e}}}));t.Z=i},19527:function(e,t,r){"use strict";var n=r(67185),a=r(57231),l=r(75910),i=r(65819);let o=(0,l.Ue)(e=>({thread_id:"",showThreadModel:!1,shareStatus:"PRIVATE",backgroundTemplate:n.jW[16],shareTemplate:n.Qz[0],fontSize:1.4,typographyTheme:n.Oq[0],is_self:!1,is_change:!1,cacheThreadImg:{},showLimitModal:!1,showThreadLimitModalData:null,shareData:{type:"share",link:""},setShareData:t=>e({shareData:t}),setIsChange:t=>e({is_change:t}),setShowThreadLimitModalData:t=>e({showThreadLimitModalData:t}),setShareStatus:function(t){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];e({shareStatus:t}),r&&i.ZP.getState().isLogin&&((0,a.ws)({thread_id:o.getState().thread_id,read_permission:t}),e({is_change:!0}))},setShareTemplate:t=>e({shareTemplate:t}),setFontSize:t=>e({fontSize:t}),setTypographyTheme:t=>e({typographyTheme:t}),saveToLocalStorage:()=>{let e=o.getState();localStorage.setItem("shareState",JSON.stringify(e))},setCacheThreadImg:t=>e({cacheThreadImg:t}),setShowThreadModel:t=>e({showThreadModel:t}),setShowLimitModal:t=>e({showLimitModal:t}),setSortThreadId:t=>e({thread_id:t}),setIsSelf:t=>e({is_self:t}),setBackgroundTemplate:t=>e({backgroundTemplate:t}),setShareThreadId:t=>e({thread_id:t})}));t.Z=o},50802:function(e,t,r){"use strict";let n=(0,r(75910).Ue)(e=>({threadPPTCacheData:void 0,setThreadPPTCacheData:t=>e({threadPPTCacheData:t}),pptThreadBtnEntrance:[],setThreadPptBtnEntrance:t=>e({pptThreadBtnEntrance:t})}));t.Z=n},75154:function(e,t,r){"use strict";r.d(t,{a:function(){return n}});let n=e=>{if(!e)return"";let t=[...e.matchAll(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{1,2}), (\d{4})/g)];if(t.length>0){let r=t[0];if(0===e.indexOf(r[0])){let e=new Date("".concat(r[1]," ").concat(r[2],", ").concat(r[3])),t=e.getFullYear().toString(),n=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getDate().toString().padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a)}}return""}},27571:function(e,t,r){"use strict";r.d(t,{q:function(){return l}});var n=r(13263);let a=new Map,l=async e=>{let{sources:t,retries:r=1}=e,l=async(e,t,r)=>{let i="".concat(e,"-").concat(t);if(a.has(i))return a.get(i);try{let r=await (0,n.bo)(e,t);return a.set(i,r),r}catch(n){if(r>0)return l(e,t,r-1);return null}};try{let e=Array.isArray(t)?t:[t],n=e.filter(e=>e.other_info&&"article_id"in e.other_info).map(e=>({article_id:e.other_info.article_id,session_id:e.other_info.session_id})),a=await Promise.all(n.map(e=>{let{article_id:t,session_id:n}=e;return l(t,n,r)}));return e.map((e,t)=>{var r,n,l,i;let o=a[t];return o?{...e,articleData:o}:{...e,articleData:{title:e.title,abstracts:e.snippet,authors:(null==e?void 0:null===(r=e.other_info)||void 0===r?void 0:r.authors)||[],source:(null==e?void 0:null===(n=e.other_info)||void 0===n?void 0:n.source)||"",topic:(null==e?void 0:null===(l=e.other_info)||void 0===l?void 0:l.topic)||"",type:(null==e?void 0:null===(i=e.other_info)||void 0===i?void 0:i.type)||""}}})}catch(e){throw Error("èŽ·å–æ–‡ç« ä¿¡æ¯æ—¶å‡ºé”™: ".concat(e))}}},17859:function(e,t,r){"use strict";r.d(t,{V:function(){return n}});let n=e=>e?e.includes("https://sns-webpic-qc.xhscdn.com")?e.replace("https://sns-webpic-qc.xhscdn.com","https://felo.ai/webpic"):e.includes("http://sns-webpic-qc.xhscdn.com")?e.replace("http://sns-webpic-qc.xhscdn.com","https://felo.ai/webpic"):e:""},49992:function(e,t,r){"use strict";r.d(t,{$:function(){return n}});let n=e=>{if(!e||0===e.length)return"";let t=e[0],r=e.length-1;return r>0?"".concat(t," +").concat(r):t}},4389:function(e,t,r){"use strict";r.d(t,{Hl:function(){return o},KB:function(){return g},LA:function(){return p},ND:function(){return d},Si:function(){return c},UA:function(){return u}});var n=r(29499),a=r(32096),l=r(13263),i=r(57606);let o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;try{if(!e)return"...";if((e=e.replace(/\n/g," ")).length<=t)return e;let r=e.slice(0,t),n=r.lastIndexOf("ã€‚");if(-1!==n&&n>t-100)return r.slice(0,n)+"...";let a=r.lastIndexOf(".");if(-1!==a&&a>t-100)return r.slice(0,a)+"...";let l=r.lastIndexOf(" ");if(-1!==l&&l>t-100)return r.slice(0,l)+"...";return r+"..."}catch(t){return console.log(t),e}},s=(e,t,r)=>{if("bn"===r||"hi"===r){let e=t.match(/[^à¥¤]*à¥¤/g);if(e)return e}if("ur"===r){let e=t.match(/[^Û”]*Û”/g);if(e)return e}return e},d=(e,t)=>e?m(e,t).join("\n"):"",c=async(e,t)=>{try{let r=[],a=[];for(let t=0;t<e.length;t++){let l=[],o=[],s=i.Z.getState().sourceOriginalList.find(r=>r.rid==e[t].rid&&r.link===e[t].link);s?(l=(null==s?void 0:s.translated)||[],o=(null==s?void 0:s.original)||[]):l=e[t].snippet.split("\n");let d=l.join("\n"),c=(0,n.h4)(e[t].matchContent);if(d){let n={content:d,chunk:c};r.push(n);let i={contentSentences:l,id:e[t].id,originalSentences:o,matchContent:c};a.push(i)}}let o=await (0,l.d4)(r);if(!o)return null;await Promise.all(o.map(async(r,n)=>{let l=p(r.target_chunk,a[n].contentSentences,t),o=a[n].contentSentences.findIndex(e=>e===r.target_chunk),s=a[n].originalSentences.length>0,d={id:a[n].id,translatedHighlightContent:s?l:"",originalHighlightContent:s?p(a[n].originalSentences[o],a[n].originalSentences,t):l,originalTargetChunk:s?a[n].originalSentences[o]:r.target_chunk,translatedTargetChunk:s?r.target_chunk:"",rid:e[n].rid,link:e[n].link};i.Z.getState().addHighlightItem(d)}))}catch(e){return console.log(e),null}},u=async(e,t)=>{try{let a=[],o=[];for(let t=0;t<e.length;t++){let r=[],l=[],s=i.Z.getState().sourceOriginalList.find(r=>r.rid==e[t].rid&&r.link===e[t].link);s?(r=(null==s?void 0:s.translated)||[],l=(null==s?void 0:s.original)||[]):r=e[t].snippet.split("\n");let d=r.join("\n"),c=(0,n.h4)(e[t].matchContent);if(d){let n={content:d,chunk:c};a.push(n);let i={contentSentences:r,id:e[t].id,originalSentences:l};o.push(i)}}let s=await (0,l.d4)(a);if(!s)return null;let d=[];for(var r=0;r<s.length;r++){let n=p(s[r].target_chunk,o[r].contentSentences,t),a=o[r].originalSentences.length>0,l={id:o[r].id,translatedHighlightContent:a?n:"",originalHighlightContent:"",originalTargetChunk:"",translatedTargetChunk:a?s[r].target_chunk:"",rid:e[r].rid,link:e[r].link};d.push(l)}return d}catch(e){return console.log(e),null}};function h(e){return e?e.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()Â·\s]/g,""):""}let p=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n='<span class="bg-blue-200 text-black px-1 rounded">'.concat(e,"</span>"),a=t.findIndex(t=>t===e||h(t).includes(h(e)));-1==a&&(t=[e,...t],a=0);let l=t.slice(Math.max(0,a-2),a),i=t.slice(a+1,a+3);return(r?t.map((e,t)=>t===a?n:e):[...l.map(e=>e),n,...i.map(e=>e)]).join("\n")},m=(e,t)=>e?(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(RegExp("([^\\p{P}])\\n","gu"),"$1,").replace(RegExp("(\\p{P})\\n","gu"),"$1"),s((0,a.Vl)(e).filter(e=>"Sentence"===e.type).map(e=>e.raw).map(e=>e.replace(RegExp("^[\\p{P}]+","u"),"")),e,t)):[],g=(e,t,r)=>{let n=[];for(let a of e){let e=a;for(let n of t){let t=r?n.translatedTargetChunk:n.originalTargetChunk,l=e=>e.replace(/\s+/g,"").trim();if(l(a)==l(t)&&!a.includes("<span>")){e=a.replace(a,'<span class="bg-blue-200 text-black px-1 rounded">'.concat(a,"</span>"));break}}n.push(e)}return n.join("\n")}},99421:function(e,t,r){"use strict";r.d(t,{$5:function(){return x},LY:function(){return m},SK:function(){return u},cC:function(){return g},h_:function(){return f},k5:function(){return h},rP:function(){return v}});var n=r(57606),a=r(49905),l=r(4389),i=r(97247),o=r(23873),s=r(75534),d=r(3295),c=r(23083);function u(e){let t="";for(let r=0;r<e.length;r+=1){let n=e[r],a=e[r-1]||" ",l=e[r+1]||" ";"$"===n&&l>="0"&&l<="9"&&"$"!==a&&(n="\\$"),"~"===n&&l>="0"&&l<="9"&&(n="\\~"),t+=n}return t}function h(e){return e.replace(/(```[\s\S]*?```|`.*?`)|\\\[([\s\S]*?[^\\])\\\]|\\\((.*?)\\\)|\[(\d+)\]|([ï¼ˆ(])(https?:\/\/\S+)([ï¼‰)])/g,(e,t,r,n,a,l,i,o)=>t?t:r?"$$".concat(r,"$$"):n?"$".concat(n,"$"):a?"[".concat(a,"](").concat(a,")"):i?"".concat(l).concat(i).concat(o):e)}let p=async e=>{try{let t=[];for(let r=0;r<e.length;r+=6)t.push(e.slice(r,r+6));await Promise.all(t.map(e=>(0,l.Si)(e)))}catch(e){console.warn("error:",e)}},m=async e=>{if((0,i.N0)())return;let t=n.Z.getState().sourceAllMatchList.filter(t=>t.rid===e);try{d.Z.getState().autoTranslateSources&&await (0,a.mj)(t,n.Z.getState().sourceOriginalList),await p(t)}catch(e){console.warn("Error processing match content:",e)}},g=(e,t,r,a)=>{let i=e.url||e.link||"",o="".concat(t,"-").concat(i,"-").concat(r);if(!n.Z.getState().sourceAllMatchList.some(e=>e.id===o)){let i={rid:t||"",id:o,matchContent:r,snippet:(0,l.ND)(e.snippet),title:e.title,link:a};n.Z.getState().addSourceAllMatchListItem(i)}},x=e=>{var t,r,n;let a=document.getSelection();if(!a||0===a.rangeCount)return;let l=a.getRangeAt(0),i=document.createElement("div");i.appendChild(l.cloneContents());let o=i.getElementsByClassName("footnote-ref");for(;o.length>0;){let e=o[0];null===(n=e.parentNode)||void 0===n||n.removeChild(e)}let s=i.innerHTML,d=i.textContent||"";null===(t=e.clipboardData)||void 0===t||t.setData("text/html",s),null===(r=e.clipboardData)||void 0===r||r.setData("text/plain",d)},f=async e=>{try{let t=e.replace(/(`[\s\S]*?`|`.*?`)|\[(\d+)\]/g,(e,t,r)=>t||(r?"":e)),r=await o.TU.parse(t);return(0,s.s9)(r,{wordwrap:!1,selectors:[{selector:"h1",options:{uppercase:!1}},{selector:"h2",options:{uppercase:!1}},{selector:"h3",options:{uppercase:!1}}]}).replace(/[^\S\n]+/g," ").replace(/\n\s*\n+/g,"\n").trim()}catch(t){return console.log("error",t),e}},v=e=>{try{let t=c.Z.getState().failedImageList;if(t&&t.length>0)return e.replace(/!\[([^\]]*(?:\[[^\]]*\][^\]]*)*)\]\(([^)]+?)(?:\s+"[^"]*")?\)/g,(e,r,n)=>{let a=n.trim().replace(/["']/g,"");return t.some(e=>a===e||a.includes(e)||e.includes(a))?"<<<REMOVE_IMAGE>>>":e}).replace(/\n\s*<<<REMOVE_IMAGE>>>\s*\n/g,"\n").replace(/<<<REMOVE_IMAGE>>>\s*\n/g,"").replace(/\n\s*<<<REMOVE_IMAGE>>>/g,"").replace(/<<<REMOVE_IMAGE>>>/g,"").replace(/\n{3,}/g,"\n\n").trim();return e}catch(t){return console.log("error",t),e}}},86386:function(e){e.exports={"bg--colors":"style_bg--colors___5ol8","bg--outline":"style_bg--outline__dCZdN","bg--ppt":"style_bg--ppt__p9NqR","bg--ppt__img":"style_bg--ppt__img__BEDGc","fade-out":"style_fade-out__SaDlj",fadeOut:"style_fadeOut__pwzp8"}},43220:function(e){e.exports={footnoteRef:"footnote_footnoteRef__k_UCF"}},14701:function(e){e.exports={markdown:"markdown_markdown__wTkaE"}}}]);