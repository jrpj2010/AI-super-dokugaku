"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9622],{89622:function(e,r,l){l.r(r);var t=l(52676),n=l(75271),o=l(26595),d=l(4814),i=l(72070),s=l.n(i),u=l(7717),a=l(39344),p=l(18881),v=l(94572),h=l(17224),c=l(77998),f=l(41223),g=l(39109);r.default=()=>{var e;let r=(0,u.useTranslations)(),l=(0,u.useLocale)(),i=(0,h.useRouter)(),{isShowPptModal:_,setIsShowPptModal:b,setBesinessId:m}=(0,p.Z)(),x=(0,g.Z)(),{updatePptGenerateStatusList:w,pptGenerateStatusList:j,setPptStatus:T,clearUpdateGeneratePptProgress:k,setOutlineStatus:I,isHiddenModal:y,setPptDetail:C}=(0,c.Z)(),E=e=>{var l,t;let{thread:n}=e;if(console.log("handlePreview thread",n),!(null==n?void 0:n.threadId))return;if((null==n?void 0:n.status)===v.nV.TIMEOUT){x.default(r("ppt.generate_failure_tip"));return}if((null==n?void 0:n.progress)&&(null==n?void 0:n.progress)<100){x.default(r("ppt.generating_ppt_tip"));return}let o=null===(t=location)||void 0===t?void 0:null===(l=t.pathname)||void 0===l?void 0:l.match(/\/search\/([^\/\?]+)/),d=o?o[1]:null;if((0,v.bs)({threadId:null==n?void 0:n.threadId,isProgress:!1}),d===(null==n?void 0:n.threadId)){b(!0),m(null==n?void 0:n.threadId),T("preview");return}i.push({pathname:"/search/".concat(null==n?void 0:n.threadId),query:{showppt:"1"}})};return((0,n.useEffect)(()=>{let e=async()=>{var e,r;w();let l=(0,v.Q0)();if(!l)return;let t=Object.keys(Object.entries(l).filter(e=>{let[r,l]=e;return(null==l?void 0:l.isProgress)&&(null==l?void 0:l.status)!==v.nV.SUCCESS&&(null==l?void 0:l.status)!==v.nV.TIMEOUT}).reduce((e,r)=>{let[l,t]=r;return e[l]=t,e},{}));if(!(null==t?void 0:t.length)||y)return;let n=null===(r=location)||void 0===r?void 0:null===(e=r.pathname)||void 0===e?void 0:e.match(/\/search\/([^\/\?]+)/),o=n?n[1]:null;o&&(k(),(0,v.TT)({threadId:o}).then(e=>{if(!e){I("error");return}(0,v.bs)({threadId:o,expiryTime:Date.now()+348e4,pptUrl:null==e?void 0:e.ppt_url,pdfUrl:null==e?void 0:e.pdf_url,coverUrl:null==e?void 0:e.cover_url,progress:100}),C({cover_url:null==e?void 0:e.cover_url,ppt_url:null==e?void 0:e.ppt_url,pdf_url:null==e?void 0:e.pdf_url,status:v.nV.SUCCESS})}))};l&&["en","ja","ko","zh-hant"].includes(null==l?void 0:l.toLocaleLowerCase())&&(0,f.s2)()&&e()},[l]),(!_||y)&&(0,f.s2)()&&j&&(null===(e=Object.keys(j))||void 0===e?void 0:e.length))?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:(0,d.Z)("fixed z-[999] right-0 top-[50vh]"),children:Object.entries(j).map(e=>{var r;let[l,n]=e;return(0,t.jsx)("div",{className:"mb-1 flex justify-end opacity-0 pointer-events-none",children:(0,t.jsx)(o.A,{color:"primary",variant:"bordered",size:"sm",startContent:(0,t.jsx)(s(),{src:"/icons/nav/ppt-highlight.svg",width:18,height:18,alt:"PPT",className:"mr-[2px]"}),className:(0,d.Z)("w-auto p-0 pr-1 pl-1.5 rounded-none rounded-s-full min-w-0","text-[#FA7931] border-[#FA7931]","shadow-[0_35px_60px_-15px_rgba(0,0,0,0.3)] bg-white border border-r-0 gap-1 dark:bg-[#45464A] dark:border-0 dark:text-white"),onPress:()=>{E({thread:n})},children:(null==n?void 0:n.progress)&&(null==n?void 0:n.progress)>=100?"":(null==n?void 0:n.status)===v.nV.TIMEOUT?(0,t.jsx)(a.LPM,{}):"".concat(null!==(r=null==n?void 0:n.progress)&&void 0!==r?r:0,"%")})},l)})})}):null}}}]);