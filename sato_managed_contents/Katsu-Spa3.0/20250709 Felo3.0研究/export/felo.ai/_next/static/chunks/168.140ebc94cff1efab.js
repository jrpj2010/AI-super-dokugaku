"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[168],{77249:function(e,s,i){i.d(s,{Z:function(){return t}});let t=(0,i(41650).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},84593:function(e,s,i){i.d(s,{Z:function(){return t}});let t=(0,i(41650).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},30168:function(e,s,i){i.r(s);var t=i(52676),r=i(43378),n=i(5588),a=i(25010),l=i(7717),o=i(67975),d=i(20311),c=i(75271),u=i(59197),m=i(77249),x=i(84593),p=i(25773),v=i(68605),f=i(70017),_=i(22617),g=i(65819),h=i(39109);s.default=()=>{var e,s,i;let b=(0,l.useTranslations)(),j=(0,h.Z)(),{copy:N}=(0,f.V)(),{enterpriseInfo:k,isOpenInviteModal:y,setIsOpenInviteModal:w,orgInvitationLink:E,setOrgInvitationLink:C}=(0,_.ZP)(),O=(0,g.ZP)(e=>e.userInfo),[S,Z]=(0,c.useState)(!1),[I,A]=(0,c.useState)(!1),[B,D]=(0,c.useState)(E||{id:"",uuid:"",gmt_expired:"",status:""}),[F,L]=(0,c.useState)(""),[M,T]=(0,c.useState)(!1),[z,R]=(0,c.useState)(0),[G,P]=(0,c.useState)([]),[H,J]=(0,c.useState)(!1),U=async e=>{let s=await (0,v.Ob)(e||1);P((null==s?void 0:s.records)||[]),R((null==s?void 0:s.pages)||0)},V=async()=>{var e,s;let i=null==O?void 0:null===(s=O.user_org_member)||void 0===s?void 0:null===(e=s.org)||void 0===e?void 0:e.org_id;if(!i||E)return;let t=await (0,v.JS)(i);D(t),A((null==t?void 0:t.status)==="ENABLE")};(0,c.useEffect)(()=>{y&&(L(""),U(1),V())},[y]),(0,c.useEffect)(()=>{if(E){D(E),A("ENABLE"===E.status);return}A(!1)},[E]),(0,c.useEffect)(()=>{y&&Z(!1)},[y]);let $=async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(J(!0),e){let e=null;if(B&&(null==B?void 0:B.uuid)&&!s)e=await (0,v.s2)((null==B?void 0:B.id)||"","ENABLE");else{var i,t;e=await (0,v.y)((null==O?void 0:null===(t=O.user_org_member)||void 0===t?void 0:null===(i=t.org)||void 0===i?void 0:i.org_id)||"")}e&&(C(e),A(!0))}else{let e=await (0,v.s2)((null==B?void 0:B.id)||"","DISABLE");e&&(C(e),A(!1))}J(!1)},q=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),K=async()=>{if(!F.trim()||!q(F)){j.error(b("enterprise.input_email_tip"));return}T(!0);let e=await (0,v.fA)(F);T(!1),200===e.status?(j.success(b("enterprise.invite_success")),L(""),U(1)):"Your Email has already joined Organization"===e.message?j.error(b("enterprise.email_has_joined")):"NOT_ENOUGH_ORG_SEAT"===e.code||(null==e?void 0:e.code)==="NONE_ORG_SUBSCRIPTION"?j.error(b("enterprise.invite_failed_tip")):(null==e?void 0:e.code)==="ORG_REACH_JOIN_MAX_LIMIT"?j.error(b("enterprise.org_reach_join_max_limit_tip")):j.error(e.message||b("enterprise.invite_failed"))},X=(0,c.useMemo)(()=>{try{if(B){let e=new Date(null==B?void 0:B.gmt_expired),s=new Date,i=(e.getTime()-s.getTime())/864e5;if(i>=6.95)return 7;return i=Math.floor(i)}return 0}catch(e){return 0}},[B]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(r.Vq,{open:y,onOpenChange:()=>w(!1),children:(0,t.jsxs)(r.cZ,{className:"max-w-xl w-full max-h-full dark:bg-[#454E5D]",children:[(0,t.jsx)(r.fK,{children:(0,t.jsx)(r.$N,{className:"p-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 mr-3",children:[S&&(0,t.jsx)(a.z,{className:"bg-transparent h-auto p-1 dark:text-gray-500 hover:bg-gray-300 dark:hover:bg-gray-500 focus:!ring-0 focus-visible:!ring-offset-0",size:"sm",variant:"secondary",onClick:()=>Z(!1),children:(0,t.jsx)(m.Z,{className:"font-bold dark:text-white",size:20})}),(0,t.jsx)("span",{className:"text-lg font-bold",children:S?b("enterprise.invite_by_email"):b("enterprise.invite_member")})]})})}),(0,t.jsx)(r.a7,{className:"px-8 py-2",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(null==k?void 0:null===(e=k.org_sso)||void 0===e?void 0:e.enabled)&&(null===(s=k.org_sso)||void 0===s?void 0:s.domain)&&(0,t.jsxs)("div",{className:"text-sm flex items-start text-[#0080FF] bg-[#4285F4]/20 p-2 rounded-md",children:[(0,t.jsx)(x.Z,{className:"w-4 h-4 mr-2 mt-1"}),b("enterprise.ssoLogin.sso_login_tip",{email:null===(i=k.org_sso)||void 0===i?void 0:i.domain})]}),!S&&(0,t.jsx)("div",{className:"text-base font-bold",children:b("enterprise.invite_by_email")}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(n.I,{placeholder:b("enterprise.input_member_email"),onChange:e=>L(e.target.value),className:"text-base focus:!ring-0 focus-visible:!ring-offset-0 dark:bg-[#202531] dark:[&:-webkit-autofill]:!shadow-[0_0_0_30px_#202531_inset]",autoComplete:"off",spellCheck:"false",value:F,autoFocus:!1,tabIndex:-1,onFocus:()=>Z(!0)}),(0,t.jsx)(a.z,{onClick:K,className:"p-3 text-base ".concat(!F.trim()&&"bg-[#EBEEF3] text-[#ACB9CD] dark:bg-[#454E5D] dark:text-[#B9BFCA]"),disabled:!F.trim(),children:M?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 animate-spin"}),b("enterprise.send_invite")]}):b("enterprise.send_invite")})]}),!S&&(0,t.jsx)(d.O,{className:"mt-2 mb-2 dark:!bg-[#606B80]"}),!S&&(0,t.jsxs)("div",{className:"flex flex-col gap-4 mb-4",children:[(0,t.jsx)("div",{className:"text-base font-bold",children:b("enterprise.invite_by_link")}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-[-8px]",children:[(0,t.jsx)("div",{children:b("enterprise.invite_secret_link")}),(0,t.jsx)("div",{className:"ml-auto relative",children:H?(0,t.jsx)(p.Z,{className:"animate-spin ml-auto"}):(0,t.jsx)(o.r,{checked:I,onCheckedChange:e=>$(e),className:"ml-auto"})})]}),I&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(n.I,{placeholder:b("enterprise.input_member_email"),className:"focus:!ring-0 focus-visible:!ring-offset-0 dark:bg-[#202531]",autoComplete:"off",spellCheck:"false",readOnly:!0,value:"".concat(window.location.origin,"/enterprise/org/join/").concat(null==B?void 0:B.uuid)}),(0,t.jsx)(a.z,{onClick:()=>{N("".concat(window.location.origin,"/enterprise/org/join/").concat(null==B?void 0:B.uuid)),j.success(b("enterprise.link_copy_success",{count:X>=1?b("enterprise.day",{count:X}):b("enterprise.less_than_one_day")}))},children:b("invite.copy_link")})]}),(0,t.jsxs)("div",{className:"text-sm flex items-center mt-2 text-muted-foreground",children:[(0,t.jsx)("div",{className:"text-[#5F7698] dark:text-[#D0D4DC]",children:b("enterprise.link_validity")}),(0,t.jsxs)("div",{className:"".concat(X<=0?"text-red-500":"text-primary"," ml-1"),children:[X<=0&&b("enterprise.expired"),X<1&&X>0&&b("enterprise.less_than_one_day"),X>=1&&b("enterprise.day",{count:X})]}),(0,t.jsx)(a.z,{variant:"link",onClick:()=>{$(!0,!0),j.success(b("enterprise.invite_link_refresh"))},children:b("enterprise.regenerate")})]})]})]}),S&&(0,t.jsx)("div",{className:"flex flex-col gap-4 mb-4",children:(0,t.jsx)(u.Z,{memberList:G,enterpriseInfo:k,getMemberList:U,pageTotal:z,isModal:!0,isLoading:!1})})]})})]})})})}}}]);