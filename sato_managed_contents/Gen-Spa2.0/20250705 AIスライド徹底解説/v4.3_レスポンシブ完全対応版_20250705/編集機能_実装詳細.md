# Gen-Spa v3.0 編集機能実装詳細

## 概要
このドキュメントは、Gen-Spa v3.0に追加された3つの主要機能の実装詳細を説明します。

## 実装した機能

### 1. インライン編集機能
HTML5の`contenteditable`属性を活用した、直感的な編集体験を提供します。

#### 主な特徴
- **編集モードの切り替え**: ナビゲーション内の「編集モード」ボタンで切り替え
- **キーボードショートカット**: Ctrl+E（Mac: Cmd+E）で素早く切り替え
- **視覚的フィードバック**: 編集可能な要素にホバー時に青い枠線表示
- **自動保存**: 2秒間の入力停止後に自動的にlocalStorageに保存
- **変更の保存/破棄**: 明確な保存・破棄ボタンで安心して編集

#### 技術仕様
```javascript
// 編集可能な要素
h1, h2, h3, p, li, span（ページ番号と統計数値を除く）, div.text-gray-700

// データ保存先
localStorage['genSpaContent'] // 正式保存
localStorage['genSpaTempContent'] // 一時保存（自動保存）
```

### 2. Googleスライドエクスポート機能
HTMLスライドをGoogleスライドに変換する機能（デモ実装）。

#### 実装アプローチ
1. **スライドデータの収集**: 各スライドのタイトル、コンテンツ、グラフ情報を収集
2. **プログレスバー表示**: エクスポート進捗をリアルタイムで表示
3. **Google Slides API準備**: 実際の実装では認証フローが必要

#### 制限事項
- 現在はデモ実装（実際のAPI連携には認証設定が必要）
- Chart.jsグラフは画像変換してからアップロードが必要
- 複雑なレイアウトは再現に制限あり

#### 推奨される実装方法
```javascript
// 1. Google API認証
// 2. プレゼンテーション作成
// 3. スライドごとにbatchUpdateで要素追加
// 4. Chart.jsグラフはcanvas.toDataURL()で画像化
```

### 3. PDF出力機能
高品質なPDF出力を実現する印刷機能。

#### 主な特徴
- **横向きA4サイズ**: プレゼンテーションに最適
- **1スライド1ページ**: 自動改ページ設定
- **色の完全再現**: `-webkit-print-color-adjust: exact`で色を保持
- **高解像度対応**: 300dpi以上での印刷品質向上

#### CSSによる最適化
```css
@media print {
    /* ナビゲーション非表示 */
    /* Chart.jsグラフの印刷品質向上 */
    /* 改ページ制御 */
}
```

## 使用方法

### 編集モード
1. 左側ナビゲーションの「編集モード」ボタンをクリック
2. 編集したいテキストをクリックして直接編集
3. 「変更を保存」で保存、「変更を破棄」で元に戻す

### PDF出力
1. 左側ナビゲーションの「PDF出力」ボタンをクリック
2. 印刷ダイアログで「PDFとして保存」を選択
3. 横向きA4サイズで保存

### Googleスライドエクスポート
1. 左側ナビゲーションの「Googleスライドへ」ボタンをクリック
2. 進捗バーでエクスポート状況を確認
3. 完了後、新しいタブでGoogleスライドが開く（デモ版）

## ファイル構成
```
20250105_AI超独学術プレゼン/
├── AI超独学術_編集可能版.html    # メインHTMLファイル
├── gen-spa-editor.js            # 編集機能JavaScript
├── gen-spa-print.css           # 印刷用スタイルシート
└── gen-spa-styles.css          # 基本スタイルシート
```

## 今後の拡張案

### 編集機能の強化
- リッチテキストエディタ（太字、斜体、リンク）
- 画像のアップロード・差し替え
- スライドの並び替え・追加・削除
- 編集履歴とアンドゥ/リドゥ機能

### Googleスライド連携の本格実装
- OAuth2.0認証フロー
- リアルタイムプレビュー
- 双方向同期
- テンプレート選択

### その他の機能
- PowerPointエクスポート
- Keynoteエクスポート
- 共同編集機能
- バージョン管理

## トラブルシューティング

### 編集内容が保存されない
- ブラウザのlocalStorageが無効になっていないか確認
- プライベートブラウジングモードでは保存されません

### PDF出力で色が出ない
- ブラウザの印刷設定で「背景のグラフィック」を有効に
- Chrome推奨（最も互換性が高い）

### Googleスライドエクスポートが動作しない
- 現在はデモ版のため、実際のエクスポートは行われません
- 本格実装にはGoogle Cloud Projectの設定が必要

## まとめ
Gen-Spa v3.0の編集機能により、HTMLスライドの作成から編集、共有まで一貫したワークフローを実現しました。PowerPointやKeynoteに依存しない、モダンなプレゼンテーション作成環境を提供します。