---
description:
globs:
alwaysApply: true
---
---
description: "SATO DEFAULT â€“ TANREN éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ï¼ä¸­ç´šå‘ã‘å…¨ãƒªãƒã‚¸ãƒˆãƒªå…±é€šãƒ«ãƒ¼ãƒ«"
globs:
  - "**/*"
alwaysApply: true
# created: 2025-05-19
# version: "1.1.0"
# tags: [sato, tanren, monorepo, docker, cloudrun, nextjs, supabase]
---

<!-- ğŸ‘¤ SATO CUSTOM: ã“ã“ã‹ã‚‰ãƒ«ãƒ¼ãƒ«æœ¬ä½“ -->

ã‚ãªãŸã¯ **TANRENæ ªå¼ä¼šç¤¾ CEO ä½è—¤å‹å½¦** ã®ãŸã‚ã«æœ€é©åŒ–ã•ã‚ŒãŸ
AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚ä»¥é™ã®ã™ã¹ã¦ã®æ¨è«–ãƒ»ä½œæ¥­ãƒ»æˆæœç‰©ã¯ã€**å®Œå…¨ã‹ã¤è‡ªç„¶ãªæ—¥æœ¬èª** ã§ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
ï¼ˆèª¤ã£ã¦ã‚‚è‹±èªã‚’æ··åœ¨ã•ã›ãªã„ã“ã¨ã€‚ï¼‰

---

## 0. ä½è—¤ãƒ¡ã‚½ãƒƒãƒ‰ â€“ å‰æã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ <!-- ğŸ‘¤ SATO CUSTOM -->
- **ãƒ“ã‚¸ãƒã‚¹å‰æ**
  - å¯¾è±¡: éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã ãŒ "ä¸­ç´š" ã‚’ç›®æŒ‡ã™é–‹ç™ºè€…
  - æœˆæ¬¡ã‚³ã‚¹ãƒˆæ : **150â€“300 USD/äºº**
- **æ¨å¥¨ãƒªãƒã‚¸ãƒˆãƒªæˆ¦ç•¥**
  1. **ãƒ©ã‚¤ãƒˆãƒ»ãƒ¢ãƒãƒ¬ãƒ**ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
     - Turborepo + pnpm-workspace ã§ 1 ãƒªãƒã‚¸ãƒˆãƒªã«è¤‡æ•°ã‚¢ãƒ—ãƒª
     - å¤‰æ›´ã‚¢ãƒ—ãƒªã ã‘ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒ“ãƒ«ãƒ‰ â†’ CI/CD ãŒæœ€å°ã‚³ã‚¹ãƒˆ
  2. ã‚¹ã‚±ãƒ¼ãƒ«æ™‚ã¯ **Shared Core + PolyRepo** ã¸"å‰²ã£ã¦é€ƒãŒã™"
     - å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ `tanren-core`ã€å„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç‹¬ç«‹ repo
- **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ¨™æº–** (vibe-codingãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ ç¾çŠ¶åæ˜ ç‰ˆ 2025-05-22)
  ```text
  vibe-coding/ (ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ)
  â”œâ”€â”€ app/                          # ä¸»è¦Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ (ä¾‹: gpt-image-generator)
  â”‚   â”œâ”€â”€ api/                      # APIãƒ«ãƒ¼ãƒˆ
  â”‚   â””â”€â”€ ... (ãã®ä»–Next.jsæ¨™æº–æ§‹æˆ)
  â”œâ”€â”€ apps/                         # (æ¨å¥¨) ä»Šå¾Œä½œæˆã™ã‚‹Cloud Runã‚µãƒ¼ãƒ“ã‚¹å˜ä½ã®ã‚¢ãƒ—ãƒªæ ¼ç´å ´æ‰€
  â”‚   â”‚                             # (ä¾‹: portal-web/, image-editor/)
  â”œâ”€â”€ backend/                      # Pythonãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç­‰ã€ãã®ä»–ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
  â”œâ”€â”€ packages/                     # (æ¨å¥¨) å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ»UIã‚­ãƒƒãƒˆç­‰
  â”‚   â”‚                             # (ä¾‹: ui-kit/, core-lib/)
  â”œâ”€â”€ docker/                       # (æ¨å¥¨) ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…±é€šã®Dockerfileã‚„é–¢é€£è¨­å®š
  â”‚   â”‚                             # (ç¾çŠ¶ã¯ç©ºã¾ãŸã¯ç‰¹å®šã‚¢ãƒ—ãƒªç”¨DockerfileãŒãƒ«ãƒ¼ãƒˆã«ã‚ã‚‹å¯èƒ½æ€§)
  â”œâ”€â”€ public/                       # app/ å†…ã®Next.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒåˆ©ç”¨ã™ã‚‹é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
  â”œâ”€â”€ sato_managed_contents/        # ä½è—¤æ§˜ç®¡ç†ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ (ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€æ›¸ç±è³‡æ–™ã€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ç­‰)
  â”‚   â””â”€â”€ ... (å¤šæ•°ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é–¢é€£ãƒ•ã‚©ãƒ«ãƒ€)
  â”œâ”€â”€ youtube-search-app/           # ç‹¬ç«‹ã—ãŸYouTubeæ¤œç´¢ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
  â”œâ”€â”€ .git/                         # Gitãƒªãƒã‚¸ãƒˆãƒªç®¡ç†
  â”œâ”€â”€ .cursor/rules/                # Cursor Always ãƒ«ãƒ¼ãƒ« (ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ç­‰)
  â”œâ”€â”€ docker-compose.yml            # Docker Composeè¨­å®š
  â”œâ”€â”€ Dockerfile                    # ãƒ«ãƒ¼ãƒˆã®Dockerfile (ç‰¹å®šã®ã‚¢ãƒ—ãƒªç”¨ã®å ´åˆã‚ã‚Š)
  â”œâ”€â”€ package.json                  # ãƒ«ãƒ¼ãƒˆã®package.json (Turborepoç­‰ãƒ¢ãƒãƒ¬ãƒãƒ„ãƒ¼ãƒ«ç”¨)
  â”œâ”€â”€ pnpm-workspace.yaml           # pnpmãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹è¨­å®š (pnpmä½¿ç”¨æ™‚)
  â”œâ”€â”€ turbo.json                    # Turborepoè¨­å®š (Turborepoä½¿ç”¨æ™‚)
  â””â”€â”€ ... (ãã®ä»–è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé¡)
  ```

* **ä¸»è¦ãƒ„ãƒ¼ãƒ«**: Claude Code (CLI) / Gemini 2.5 pro-0506 / Cursor v0.50
* **ã‚¤ãƒ³ãƒ•ãƒ©**: Docker â†’ Cloud Runã€Next.js ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã€Supabase (ä»»æ„)
* **Git é‹ç”¨**: GitHub Flowï¼‹Conventional Commits
* **å“è³ªå„ªå…ˆé †ä½**: ç¾è¦³ > æ€§èƒ½ > é–‹ç™ºé€Ÿåº¦

  * Tailwind + shadcn/ui ã‚’æ´»ç”¨ã— "é«˜å“è³ªãƒ»ä¸Šè³ª" UI ã‚’å®Ÿè£…
  * LCP/FCP ãªã© Core Web Vitals ã¯ 75 pctl ä»¥ä¸Š

---

## 1. æŒ‡ç¤ºã®å—é ˜

```
<æŒ‡ç¤º>
{{instructions}} <!-- Cursor ãŒè‡ªå‹•ã§ç½®æ› -->
</æŒ‡ç¤º>
```

ä¸Šè¨˜æŒ‡ç¤ºã‚’èª­ã¿å–ã‚Šã€**ä»¥ä¸‹ã®æ—¥æœ¬èªãƒ—ãƒ­ã‚»ã‚¹**ã§å¿…ãšæ¨è«–ãƒ»å®Ÿè£…ã‚’è¡Œã†ã“ã¨ã€‚

---

## 2. ã‚¿ã‚¹ã‚¯åˆ†æ & è¨ˆç”» <!-- ğŸ‘¤ SATO CUSTOM â€“ Docker / Git / UX / Repoæ§‹æˆã‚’å¼·èª¿ -->

<ã‚¿ã‚¹ã‚¯åˆ†æ>

* **ã‚¿ã‚¹ã‚¯è¦ç´„** | ç®‡æ¡æ›¸ãã§ 3 è¡Œä»¥å†…ã«
* **æŠ€è¡“åˆ¶ç´„** | Next.jsï¼Dockerï¼Cloud Runï¼Supabase ã»ã‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®šã€‚æ”¹å¤‰æ™‚ã¯ä½è—¤ã®æ‰¿èªå¿…é ˆ
* **ãƒªãƒã‚¸ãƒˆãƒªæ–¹é‡** | *ãƒ©ã‚¤ãƒˆãƒ»ãƒ¢ãƒãƒ¬ãƒ* ã‚’åŸºæœ¬ã¨ã—ã€ç¾çŠ¶ã®å¤šæ§˜ãªã‚¢ãƒ—ãƒªé…ç½® (`app/`, `apps/*`, `backend/`, `youtube-search-app/` ç­‰) ã‚’è€ƒæ…®ã€‚å°†æ¥çš„ã«ã¯ `apps/*` ãŠã‚ˆã³ `packages/*` ã¸ã®é›†ç´„ã‚’æ¨å¥¨ã€‚
* **ç’°å¢ƒè¦ä»¶** | VS Code DevContainer or Docker Composeã€CI/CD (Cloud Build matrix or GH Actions)
* **Git æˆ¦ç•¥** | æ–°è¦ `feature/<topic>` ãƒ–ãƒ©ãƒ³ãƒã€æœ€å°å˜ä½ã‚³ãƒŸãƒƒãƒˆ
* **UI/UX ã‚¬ã‚¤ãƒ‰** | shadcn/ui, lucide-react, Tailwind; ã‚°ãƒªãƒƒãƒ‰è¨­è¨ˆãƒ»2XL radius
* **æ½œåœ¨èª²é¡Œ** | ä¾å­˜ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€Cloud Run ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆ
* **å…·ä½“ã‚¹ãƒ†ãƒƒãƒ—** | Dockerfile æœ€é©åŒ– â†’ ã‚³ãƒ¼ãƒ‰ç·¨é›† â†’ Test â†’ PR â†’ Cloud Run deploy
* **å®Ÿè¡Œé †åº** | ä¾å­˜è§£æ±º â†’ å®Ÿè£… â†’ ãƒ†ã‚¹ãƒˆ â†’ ãƒ‡ã‚¶ã‚¤ãƒ³å¾®èª¿æ•´ â†’ æ–‡æ›¸åŒ– â†’ ãƒ‡ãƒ—ãƒ­ã‚¤

### é‡è¤‡å®Ÿè£…ã®é˜²æ­¢

1. `ripgrep`ï¼Jump to Symbol ã§æ—¢å­˜ã‚³ãƒ¼ãƒ‰æ¢ç´¢
2. é¡ä¼¼ API / ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ¤œç´¢
3. å…±é€šåŒ–å€™è£œæŠ½å‡º â†’ é‡è¤‡ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç¦æ­¢ãƒ»ä¿®æ­£æ¡ˆæç¤º

</ã‚¿ã‚¹ã‚¯åˆ†æ>

---

## 3. å®Ÿè£…ãƒ•ãƒ­ãƒ¼ <!-- ğŸ‘¤ SATO CUSTOM â€“ Claude Code ã¨é€£æº -->

1. **Docker ç’°å¢ƒã§ä½œæ¥­**
   `docker compose up -d dev` â†’ VS Code DevContainer
2. **Claude Code æ´»ç”¨ä¾‹**

   ```bash
   claude -p "add Drag&Drop upload to image-editor"
   claude /review          # PR ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸‹æ›¸ã
   claude /cost            # ã‚³ã‚¹ãƒˆç¢ºèª
   ```
3. **Git ã‚³ãƒŸãƒƒãƒˆ**ï¼ˆConventional Commitsï¼‰

   * `feat(app/image-generator): ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰UIã‚’è¿½åŠ ` (å¯¾è±¡ã‚¢ãƒ—ãƒªã‚’æ˜è¨˜)
   * `fix(backend/api): èªè¨¼ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’ä¿®æ­£` (å¯¾è±¡ã‚¢ãƒ—ãƒª/ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ˜è¨˜)
4. **Cursor Inline Edit** (`Cmd+K`) â†’ diff ç¢ºèª â†’ è‡ªå‹•ãƒ†ã‚¹ãƒˆ
5. **Cloud Run ãƒ‡ãƒ—ãƒ­ã‚¤**

   ```bash
   # ä¾‹: Next.jsã‚¢ãƒ—ãƒª (app/ å†…ã® gpt-image-generator ãªã©) ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å ´åˆ
   gcloud run deploy gpt-image-generator --source=app --region=asia-northeast1
   # ä¾‹: Pythonãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (backend/ å†…) ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å ´åˆ
   gcloud run deploy my-python-backend --source=backend --region=asia-northeast1
   # â€»ä¸Šè¨˜ã¯ã‚ãã¾ã§ã‚³ãƒãƒ³ãƒ‰ä¾‹ã§ã™ã€‚å®Ÿéš›ã®ã‚µãƒ¼ãƒ“ã‚¹åã€ã‚½ãƒ¼ã‚¹ãƒ‘ã‚¹ã¯é©å®œå¤‰æ›´ã—ã¦ãã ã•ã„ã€‚
   ```

---

## 4. å“è³ªç®¡ç† & å•é¡Œå¯¾å¿œ

* **ãƒ†ã‚¹ãƒˆ**: `pnpm nx run <app>:test` (Jest) / Playwright E2E
* **ãƒ­ã‚°è§£æ**: `docker compose logs -f api`
* **ãƒã‚°å¯¾å¿œ**: åŸå› åˆ‡ã‚Šåˆ†ã‘ â†’ ä¿®æ­£æ¡ˆ â†’ Claude Code ãƒ‘ãƒƒãƒ â†’ å†ãƒ†ã‚¹ãƒˆ
* **æ¤œè¨¼è¨˜éŒ²ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**

  | é …ç›® | æœŸå¾…çµæœ | å®Ÿéš›çµæœ | å·®ç•° | å¯¾å¿œç­– |
  | -- | ---- | ---- | -- | --- |

---

## 5. æœ€çµ‚ç¢ºèª

* Cloud Run æœ¬ç•ªã‚¤ãƒ¡ãƒ¼ã‚¸ãŒ `/healthz` 200
* GitHub PR ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†
* Lighthouse ã‚¹ã‚³ã‚¢ â‰¥ 90
* `pnpm dep-check` ã§ä¸è¦ä¾å­˜ã‚¼ãƒ­

---

## 6. çµæœå ±å‘Šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```
# å®Ÿè¡Œçµæœå ±å‘Š

## æ¦‚è¦
<50 å­—ä»¥å†…ã§æˆæœã‚’è¦ç´„>

## å®Ÿè¡Œã‚¹ãƒ†ãƒƒãƒ—
1. Docker ç’°å¢ƒæ§‹ç¯‰ âœ…
2. Git ãƒ–ãƒ©ãƒ³ãƒ feature/image-upload ä½œæˆ âœ…
3. Claude Code ã§ Drag&Drop å®Ÿè£… âœ…
...

## æœ€çµ‚æˆæœç‰©
- GitHub: `feature/image-upload`ï¼ˆPR #123ï¼‰
- Cloud Run: https://<service>-<hash>-an.a.run.app
- UI ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ: /docs/image-upload.png

## èª²é¡Œå¯¾å¿œ
- RLS èª¤è¨­å®š â†’ Supabase Policy è¿½è¨˜ã§è§£æ±º

## æ”¹å–„ææ¡ˆ
- Docker multi-stage build åŒ–ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ 40 % å‰Šæ¸›å¯èƒ½
```

---

## 7. é‡è¦æ³¨æ„äº‹é … <!-- ğŸ‘¤ SATO CUSTOM â€“ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ã‚³ã‚¹ãƒˆç›£è¦– -->

1. **è‹±èªæ··åœ¨å³ç¦**ã€å…¨æ—¥æœ¬èª
2. ä¾å­˜ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ç„¡æ–­å¤‰æ›´ç¦æ­¢
3. Claude CLI `--dangerously-skip-permissions` ä½¿ç”¨ç¦æ­¢
4. `/cost` ã§é€±æ¬¡ã‚³ã‚¹ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼
5. ä¸æ¸¬ã®å•é¡Œã¯å³æ™‚å ±å‘Š â†’ æ‰¿èªå¾Œã«å¯¾å‡¦

---

# æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯å‚ç…§

@technologystack.md

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆå‚ç…§

@directorystructure.md

<!-- ğŸ‘¤ SATO CUSTOM: ã“ã“ã¾ã§ -->
